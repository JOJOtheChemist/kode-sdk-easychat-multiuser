# 核心配置文件修改记录

## 1. demo-model.ts - 智谱API集成

**文件路径**：`/Users/yeya/FlutterProjects/kode-sdk/kode-sdk/examples/shared/demo-model.ts`

### 修改前：
```typescript
const apiKey =
  config.apiKey ??
  process.env.ANTHROPIC_API_KEY ??
  process.env.ANTHROPIC_API_TOKEN ??
  process.env.ANTHROPIC_API_Token;
if (!apiKey) {
  throw new Error('Anthropic API key/token is required. Set ANTHROPIC_API_KEY or ANTHROPIC_API_TOKEN.');
}

const baseUrl = config.baseUrl ?? process.env.ANTHROPIC_BASE_URL;
const modelId = config.model ?? process.env.ANTHROPIC_MODEL_ID ?? 'claude-sonnet-4.5-20250929';
```

### 修改后：
```typescript
const apiKey =
  config.apiKey ??
  process.env.ANTHROPIC_API_KEY ??
  process.env.ANTHROPIC_API_TOKEN ??
  process.env.ANTHROPIC_API_Token ??
  process.env.ZHIPU_API_KEY;
if (!apiKey) {
  throw new Error('API key is required. Set ANTHROPIC_API_KEY, ANTHROPIC_API_TOKEN or ZHIPU_API_KEY.');
}

const baseUrl = config.baseUrl ?? process.env.ANTHROPIC_BASE_URL ?? 'https://open.bigmodel.cn/api/paas/v4';
const modelId = config.model ?? process.env.ANTHROPIC_MODEL_ID ?? 'glm-4.5-air';
```

### 关键变更：
- 新增 `ZHIPU_API_KEY` 环境变量支持
- 设置智谱默认API地址：`https://open.bigmodel.cn/api/paas/v4`
- 设置默认模型为：`glm-4.5-air`

## 2. getting-started.ts - 默认模型调整

**文件路径**：`/Users/yeya/FlutterProjects/kode-sdk/kode-sdk/examples/getting-started.ts`

### 修改前：
```typescript
const modelId = process.env.ANTHROPIC_MODEL_ID || 'claude-sonnet-4.5-20250929';
```

### 修改后：
```typescript
const modelId = process.env.ANTHROPIC_MODEL_ID || 'glm-4.5-air';
```

## 3. package.json - 新增脚本命令

**文件路径**：`/Users/yeya/FlutterProjects/kode-sdk/kode-sdk/package.json`

### 新增脚本：
```json
"example:html-creator": "ts-node examples/html-creator.ts"
```

## 4. html-creator.ts - 新建完整示例

**文件路径**：`/Users/yeya/FlutterProjects/kode-sdk/kode-sdk/examples/html-creator.ts`

### 核心配置：
```typescript
// 工具注册
registerBuiltin('fs');    // 文件系统工具
registerBuiltin('todo');   // Todo管理工具

// 模板配置
templates.register({
  id: 'html-creator',
  systemPrompt: '你是一个前端开发助手，能够创建HTML文件并响应用户的需求。你会使用todo工具来管理任务列表。',
  tools: ['fs_read', 'fs_write', 'fs_edit', 'todo_read', 'todo_write'],
  model: modelId,
  runtime: { todo: { enabled: true, reminderOnStart: false } },
});

// Agent创建
const agent = await Agent.create({
  templateId: 'html-creator',
  sandbox: { 
    kind: 'local', 
    workDir: './html-workspace', 
    enforceBoundary: true 
  },
}, deps);
```

## 运行命令速查

```bash
# 环境变量设置
export ZHIPU_API_KEY=ef22d69d218e4cad8ae3c15bcc77d30d.eULl6aqOo8YEDKzG

# 运行HTML创建示例
npm run example:html-creator

# 其他示例
npm run example:getting-started
npm run example:agent-inbox
npm run example:approval
npm run example:room
npm run example:scheduler
```

---

*记录时间：2025-10-14*