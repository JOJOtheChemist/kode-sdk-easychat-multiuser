# å¤šç”¨æˆ·å­¦ä¹ ç¬”è®° - ç›®å½•ç´¢å¼•

> æœ¬ç›®å½•åŒ…å« kode-sdk å¤šç”¨æˆ·å¤šä¼šè¯åŠŸèƒ½çš„å®Œæ•´å­¦ä¹ ç¬”è®°ã€æµ‹è¯•è„šæœ¬å’Œå®æˆ˜ç»éªŒæ€»ç»“ã€‚

---

## ğŸ“š å­¦ä¹ ç¬”è®°æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰

1. **[01å¤šç”¨æˆ·å­¦ä¹ ç¬”è®°.md](./01å¤šç”¨æˆ·å­¦ä¹ ç¬”è®°.md)**
   - å¤šç”¨æˆ·æ¶æ„åŸºç¡€æ¦‚å¿µ
   - ä¼šè¯éš”ç¦»åŸç†
   - åŸºæœ¬çš„å®ç°æ€è·¯

2. **[02yeyaä¸nuoç”¨æˆ·å¹¶å‘è°ƒç”¨å®æˆ˜.md](./02yeyaä¸nuoç”¨æˆ·å¹¶å‘è°ƒç”¨å®æˆ˜.md)**
   - ä¸¤ä¸ªç”¨æˆ·å¹¶å‘è°ƒç”¨æµ‹è¯•
   - ä¼šè¯éš”ç¦»éªŒè¯
   - å®é™…è¿è¡Œç»“æœåˆ†æ

3. **[03Agentå†…å­˜ç®¡ç†æœºåˆ¶æ·±åº¦è§£æ.md](./03Agentå†…å­˜ç®¡ç†æœºåˆ¶æ·±åº¦è§£æ.md)**
   - Agent å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
   - å†…å­˜ç¼“å­˜æœºåˆ¶
   - è‡ªåŠ¨æ¸…ç†å’Œè¶…æ—¶å¤„ç†

4. **[04æ™ºè°±AIä¸¤ç§APIæ¥å£å¯¹æ¯”åˆ†æ.md](./04æ™ºè°±AIä¸¤ç§APIæ¥å£å¯¹æ¯”åˆ†æ.md)**
   - æ™ºè°± AI ä¸åŒ API æ¥å£å¯¹æ¯”
   - æµå¼ vs éæµå¼è°ƒç”¨
   - æ€§èƒ½å’ŒåŠŸèƒ½å·®å¼‚

5. **[05æœåŠ¡å™¨å¯åŠ¨ä¸å¹¶å‘æµ‹è¯•æˆåŠŸè®°å½•.md](./05æœåŠ¡å™¨å¯åŠ¨ä¸å¹¶å‘æµ‹è¯•æˆåŠŸè®°å½•.md)** â­
   - æœåŠ¡å™¨å¯åŠ¨é—®é¢˜è¯Šæ–­ä¸ä¿®å¤
   - TypeScript ç±»å‹é”™è¯¯è§£å†³
   - GLMClient æ¨¡å—åˆ›å»º
   - å¹¶å‘æµ‹è¯•æˆåŠŸéªŒè¯
   - **é‡è¦**: åŒ…å«ä¸‰ä¸ªå…³é”®é—®é¢˜çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ

6. **[06å­˜å‚¨ç»“æ„ä¼˜åŒ–-æ‰å¹³åŒ–æ”¹é€ .md](./06å­˜å‚¨ç»“æ„ä¼˜åŒ–-æ‰å¹³åŒ–æ”¹é€ .md)** â­
   - å­˜å‚¨è·¯å¾„åµŒå¥—é—®é¢˜åˆ†æ
   - æ‰å¹³åŒ–æ”¹é€ æ–¹æ¡ˆ
   - ä» 5 å±‚å‡å°‘åˆ° 3 å±‚ç›®å½•ç»“æ„
   - **é‡è¦**: ä¼˜åŒ–åçš„æ¸…æ™°å­˜å‚¨ç»“æ„

7. **[07å‰ç«¯å¤šä¼šè¯ç•Œé¢é›†æˆæˆåŠŸ.md](./07å‰ç«¯å¤šä¼šè¯ç•Œé¢é›†æˆæˆåŠŸ.md)** â­â­â­
   - ç”¨æˆ·å¤šå¯¹è¯ç®¡ç†å‰ç«¯å®ç°
   - SSE æµå¼å“åº”è§£æé—®é¢˜ä¸è§£å†³
   - React + TypeScript + Vite æ¶æ„
   - **é‡è¦**: å®Œæ•´çš„å‰ç«¯é›†æˆæˆåŠŸæ¡ˆä¾‹

---

## ğŸ§ª æµ‹è¯•è„šæœ¬

### åŸºç¡€å¹¶å‘æµ‹è¯•

#### 1. **concurrent-test-1.js** âœ…
- **ç”¨é€”**: ç”¨æˆ·1åˆ›å»ºæ—¥ç¨‹æµ‹è¯•
- **ç”¨æˆ·**: `user1`
- **ä¼šè¯**: `concurrent_test_1`
- **åŠŸèƒ½**: æµ‹è¯•åˆ›å»ºæ—¥ç¨‹åŠŸèƒ½
- **ç¤ºä¾‹æ¶ˆæ¯**: "åˆ›å»ºä»Šå¤©ä¸‹åˆ4ç‚¹å¼€ä¼šçš„æ—¥ç¨‹"

```bash
node concurrent-test-1.js
```

#### 2. **concurrent-test-2.js** âœ…
- **ç”¨é€”**: ç”¨æˆ·2æŸ¥è¯¢æ—¥ç¨‹æµ‹è¯•
- **ç”¨æˆ·**: `user2`
- **ä¼šè¯**: `concurrent_test_2`
- **åŠŸèƒ½**: æµ‹è¯•æŸ¥è¯¢æ—¥ç¨‹åŠŸèƒ½
- **ç¤ºä¾‹æ¶ˆæ¯**: "æŸ¥çœ‹æ˜å¤©çš„æ—¥ç¨‹å®‰æ’"

```bash
node concurrent-test-2.js
```

#### 3. **concurrent-test.sh** âœ…
- **ç”¨é€”**: å¹¶å‘æ‰§è¡Œæµ‹è¯•1å’Œæµ‹è¯•2
- **åŠŸèƒ½**: éªŒè¯å¤šç”¨æˆ·å¹¶å‘å¤„ç†èƒ½åŠ›
- **ä½¿ç”¨**: åŒæ—¶å¯åŠ¨ä¸¤ä¸ªæµ‹è¯•è„šæœ¬

```bash
bash concurrent-test.sh
```

#### 4. **test-yeya-nuo-concurrent.sh** âœ…
- **ç”¨é€”**: yeya å’Œ nuo ä¸¤ä¸ªç”¨æˆ·çš„å¹¶å‘æµ‹è¯•
- **åŠŸèƒ½**: éªŒè¯çœŸå®ç”¨æˆ·åœºæ™¯çš„å¹¶å‘éš”ç¦»
- **ç‰¹ç‚¹**: åŒ…å«æ•°æ®éªŒè¯å’Œå­˜å‚¨æ£€æŸ¥

```bash
bash test-yeya-nuo-concurrent.sh
```

### åˆ›å»ºå’Œç®¡ç†

#### 5. **concurrent-create.sh**
- **ç”¨é€”**: æ‰¹é‡åˆ›å»ºæµ‹è¯•ä¼šè¯
- **åŠŸèƒ½**: åˆå§‹åŒ–å¤šä¸ªæµ‹è¯•ç”¨æˆ·å’Œä¼šè¯

```bash
bash concurrent-create.sh
```

---

## ğŸ”¬ é«˜çº§æµ‹è¯•è„šæœ¬

ä»¥ä¸‹è„šæœ¬æ˜¯åœ¨å¼€å‘å’Œè°ƒè¯•è¿‡ç¨‹ä¸­åˆ›å»ºçš„ï¼Œç”¨äºéªŒè¯ä¸åŒçš„å®ç°æ–¹æ¡ˆï¼š

### concurrent-yeya-dual-session.js
- **ç”¨é€”**: åŒä¸€ç”¨æˆ·ï¼ˆyeyaï¼‰çš„ä¸¤ä¸ªä¼šè¯æµ‹è¯•
- **ç‰¹ç‚¹**: éªŒè¯å•ç”¨æˆ·å¤šä¼šè¯éš”ç¦»
- **å¤§å°**: 8.5KB

### concurrent-yeya-flat.js
- **ç”¨é€”**: æ‰å¹³åŒ–å­˜å‚¨ç»“æ„æµ‹è¯•
- **ç‰¹ç‚¹**: æµ‹è¯•ä¼˜åŒ–åçš„ç›®å½•ç»“æ„
- **å¤§å°**: 8.4KB

### concurrent-yeya-two-runtimes.js
- **ç”¨é€”**: ä¸¤ä¸ªç‹¬ç«‹è¿è¡Œæ—¶æµ‹è¯•
- **ç‰¹ç‚¹**: éªŒè¯è¿è¡Œæ—¶éš”ç¦»æœºåˆ¶
- **å¤§å°**: 8.8KB

### concurrent-yeya-user-structure.js
- **ç”¨é€”**: ç”¨æˆ·ç›®å½•ç»“æ„æµ‹è¯•
- **ç‰¹ç‚¹**: éªŒè¯ç”¨æˆ·æ•°æ®ç»„ç»‡æ–¹å¼
- **å¤§å°**: 8.4KB

### concurrent-yeya-yue.js
- **ç”¨é€”**: yeya å’Œ yue ä¸¤ä¸ªç”¨æˆ·çš„å¹¶å‘æµ‹è¯•
- **ç‰¹ç‚¹**: å¤šç”¨æˆ·å¹¶å‘åœºæ™¯éªŒè¯
- **å¤§å°**: 6.4KB

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡å™¨

```bash
cd /Users/yeya/FlutterProjects/kode-sdk/kode-sdk
bash restart-backend.sh
```

### 2. è¿è¡ŒåŸºç¡€æµ‹è¯•

```bash
cd /Users/yeya/FlutterProjects/kode-sdk/å¤šç”¨æˆ·å­¦ä¹ ç¬”è®°

# æµ‹è¯•1: ç”¨æˆ·1åˆ›å»ºæ—¥ç¨‹
node concurrent-test-1.js

# æµ‹è¯•2: ç”¨æˆ·2æŸ¥è¯¢æ—¥ç¨‹
node concurrent-test-2.js

# å¹¶å‘æµ‹è¯•
bash concurrent-test.sh
```

### 3. æŸ¥çœ‹ç»“æœ

æµ‹è¯•æˆåŠŸåï¼Œæ£€æŸ¥å­˜å‚¨ç»“æ„ï¼š

```bash
# æŸ¥çœ‹ç›®å½•ç»“æ„
find /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/.kode -type d | grep user

# æŸ¥çœ‹ç”¨æˆ·1çš„æ•°æ®
ls -la /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/.kode/user1/concurrent_test_1/

# æŸ¥çœ‹ç”¨æˆ·2çš„æ•°æ®
ls -la /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/.kode/user2/concurrent_test_2/
```

---

## ğŸ“Š å­˜å‚¨ç»“æ„

ä¼˜åŒ–åçš„å­˜å‚¨ç»“æ„ï¼ˆå‚è§ 06å­˜å‚¨ç»“æ„ä¼˜åŒ–-æ‰å¹³åŒ–æ”¹é€ .mdï¼‰ï¼š

```
.kode/
â”œâ”€â”€ user1/
â”‚   â”œâ”€â”€ concurrent_test_1/        # ä¼šè¯1
â”‚   â”‚   â”œâ”€â”€ runtime/
â”‚   â”‚   â”‚   â”œâ”€â”€ messages.json
â”‚   â”‚   â”‚   â””â”€â”€ tool-calls.json
â”‚   â”‚   â”œâ”€â”€ events/
â”‚   â”‚   â”‚   â”œâ”€â”€ progress.log
â”‚   â”‚   â”‚   â””â”€â”€ monitor.log
â”‚   â”‚   â””â”€â”€ meta.json
â”‚   â””â”€â”€ concurrent_test_2/        # ä¼šè¯2
â”‚       â””â”€â”€ ...
â””â”€â”€ user2/
    â””â”€â”€ concurrent_test_2/
        â””â”€â”€ ...
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### æœåŠ¡å™¨æ— æ³•å¯åŠ¨

å‚è€ƒ **05æœåŠ¡å™¨å¯åŠ¨ä¸å¹¶å‘æµ‹è¯•æˆåŠŸè®°å½•.md** ä¸­çš„è§£å†³æ–¹æ¡ˆï¼š

1. **TypeScript ç¼–è¯‘é”™è¯¯**: ä¿®å¤ axios ç±»å‹å¯¼å…¥
2. **ç¼ºå°‘ GLMClient**: åˆ›å»º `server/utils/glm-client.ts`
3. **JSON è§£æé”™è¯¯**: ä¿®å¤ `Content-Length` è®¡ç®—

### æµ‹è¯•å¤±è´¥

```bash
# æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—
tail -f /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/server.log

# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
lsof -i:2500

# æ¸…é™¤æ—§æ•°æ®é‡æ–°æµ‹è¯•
rm -rf /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/.kode/user*
```

---

## ğŸ“ˆ æµ‹è¯•ç»“æœ

### æ€§èƒ½æŒ‡æ ‡ï¼ˆåŸºäºå®é™…æµ‹è¯•ï¼‰

| æµ‹è¯•é¡¹ | å“åº”æ—¶é—´ | çŠ¶æ€ | è¯´æ˜ |
|-------|---------|------|------|
| åˆ›å»ºæ—¥ç¨‹ (test-1) | ~12ç§’ | âœ… | åŒ…å« AI åˆ†æå’Œæ•°æ®åº“æ“ä½œ |
| æŸ¥è¯¢æ—¥ç¨‹ (test-2) | ~3ç§’ | âœ… | ç®€å•æŸ¥è¯¢ï¼ŒAI åˆ¤æ–­ç¼ºå°‘å‚æ•° |
| å¹¶å‘å¤„ç† | æ­£å¸¸ | âœ… | ä¸åŒä¼šè¯äº’ä¸å¹²æ‰° |

### åŠŸèƒ½éªŒè¯

- âœ… å¤šç”¨æˆ·éš”ç¦»
- âœ… å¤šä¼šè¯éš”ç¦»
- âœ… æ•°æ®æŒä¹…åŒ–
- âœ… å·¥å…·è°ƒç”¨
- âœ… æµå¼å“åº”
- âœ… ä¼šè¯æ¢å¤

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å‘½åè§„èŒƒ

```javascript
// æ¨è
const userId = 'user1';
const sessionId = 'morning_chat_20251021';

// é¿å…
const userId = 'ç”¨æˆ·ä¸€';  // é¿å…ä¸­æ–‡
const sessionId = 'very-long-session-id-with-too-much-information';  // å¤ªé•¿
```

### 2. æµ‹è¯•å‰æ¸…ç†

```bash
# æ¸…é™¤æµ‹è¯•æ•°æ®
rm -rf /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/.kode/user*

# é‡å¯æœåŠ¡å™¨
bash /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/restart-backend.sh
```

### 3. ç›‘æ§æ—¥å¿—

```bash
# å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
tail -f /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/server.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep -i error /Users/yeya/FlutterProjects/kode-sdk/kode-sdk/server.log
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£é“¾æ¥

- [kode-sdk ä¸»æ–‡æ¡£](../kode-sdk/README.md)
- [å·¥å…·å®šä¹‰æ–‡æ¡£](../å­¦ä¹ ç¬”è®°/06-å·¥å…·å®šä¹‰çš„ä¸‰ç§æ–¹å¼å¯¹æ¯”.md)
- [Agent é…ç½®è¯´æ˜](../å­¦ä¹ ç¬”è®°/04-demo-serveré…ç½®è¯¦è§£.md)

---

## ğŸ† é‡è¦é‡Œç¨‹ç¢‘

- âœ… **2025-10-21**: å®ŒæˆæœåŠ¡å™¨å¯åŠ¨é—®é¢˜ä¿®å¤
- âœ… **2025-10-21**: å®Œæˆå­˜å‚¨ç»“æ„æ‰å¹³åŒ–æ”¹é€ 
- âœ… **2025-10-21**: éªŒè¯å¤šç”¨æˆ·å¹¶å‘åŠŸèƒ½
- âœ… **2025-10-21**: åˆ›å»ºå®Œæ•´çš„æµ‹è¯•è„šæœ¬é›†
- âœ… **2025-10-21**: å®Œæˆå‰ç«¯å¤šä¼šè¯ç•Œé¢é›†æˆ ğŸ‰

---

## ğŸ‰ å‰ç«¯é›†æˆå®Œæˆ

### è®¿é—®åœ°å€
**http://localhost:8888**

### åŠŸèƒ½ç‰¹æ€§
- âœ… ç”¨æˆ·å¤šä¼šè¯æ˜¾ç¤ºå’Œåˆ‡æ¢
- âœ… SSE æµå¼æ¶ˆæ¯æ¸²æŸ“
- âœ… å·¥å…·è°ƒç”¨å¯è§†åŒ–
- âœ… æ€è€ƒè¿‡ç¨‹æ˜¾ç¤º
- âœ… æ–°å»ºä¼šè¯åŠŸèƒ½
- âœ… ç°ä»£åŒ– UI è®¾è®¡

### é¡¹ç›®ä½ç½®
`/Users/yeya/FlutterProjects/kode-sdk/user-chat-frontend/`

### ç›¸å…³æ–‡æ¡£
- ä¿®å¤è¯´æ˜: `user-chat-frontend/ä¿®å¤è¯´æ˜.md`
- SSE äº‹ä»¶ç±»å‹: `user-chat-frontend/SSEäº‹ä»¶ç±»å‹è¯´æ˜.md`
- é—®é¢˜æ’æŸ¥æ¸…å•: `user-chat-frontend/é—®é¢˜æ’æŸ¥æ¸…å•.md`
- ä½¿ç”¨æŒ‡å—: `user-chat-frontend/ä½¿ç”¨æŒ‡å—.md`
- æŠ€æœ¯æ€»ç»“: `user-chat-frontend/é¡¹ç›®æ€»ç»“.md`

---

## ğŸ’¡ ä¸‹ä¸€æ­¥è®¡åˆ’

1. [âœ…] ~~æ·»åŠ ä¼šè¯ç®¡ç† API~~ - å·²å®Œæˆ
2. [âœ…] ~~å®ç°ä¼šè¯åˆ—è¡¨å’Œå†å²æŸ¥è¯¢~~ - å·²é€šè¿‡å‰ç«¯å®ç°
3. [ ] æ·»åŠ ä¼šè¯å½’æ¡£å’Œæ¢å¤åŠŸèƒ½
4. [ ] æ€§èƒ½ä¼˜åŒ–å’Œå‹åŠ›æµ‹è¯•
5. [ ] å®Œå–„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
6. [ ] å¤šç”¨æˆ·åˆ‡æ¢åŠŸèƒ½ï¼ˆå‰ç«¯ï¼‰

---

**æœ€åæ›´æ–°**: 2025-10-21  
**ç»´æŠ¤è€…**: kode-sdk å¼€å‘å›¢é˜Ÿ

