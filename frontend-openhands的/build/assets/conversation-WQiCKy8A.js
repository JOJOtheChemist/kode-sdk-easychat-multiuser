const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-wCUGscoc.js","assets/features-animation-DqH_zrht.js","assets/index-JAudiiL9.js","assets/chunk-NISHYRIK-CKdEls7F.js","assets/utils-BVnsmU2z.js","assets/bundle-mjs-0JNfDbnS.js","assets/chunk-TX3FPB7D-DZsJI2yo.js","assets/changes-tab-DH5okyKh.js","assets/index-BDUzCKOA.js","assets/use-config-DZPclKuv.js","assets/open-hands-axios-BIuoB8bl.js","assets/option-service.api-CTPg1Fmy.js","assets/git-service.api-C5gvVLyJ.js","assets/git-provider-icon-Db_Bl_5f.js","assets/brand-button-BQs8JWFf.js","assets/declaration-B9eIPmUJ.js","assets/module-CWLbpm_7.js","assets/parse-pr-url-DDbpIt54.js","assets/index-DWiKAxKp.js","assets/query-client-config-Dd99l1aU.js","assets/i18next-Lgj2Bm8L.js","assets/retrieve-axios-error-message-CYr77e_f.js","assets/custom-toast-handlers-fYPNAJaC.js","assets/infiniteQueryBehavior-D7Qz1qlw.js","assets/use-user-providers-P0hmd5MI.js","assets/use-settings-B2QUSrrJ.js","assets/use-is-authed-Dg_tgDAm.js","assets/close-bbjPMB7Q.js","assets/useTranslation-DONB_giz.js","assets/chunk-MSDKUXDP-Cfu5rKGn.js","assets/index-S5BalIfI.js","assets/tooltip-button-DdCqtqn-.js","assets/preload-helper-BXl3LOEh.js","assets/index-CX-90vHk.js","assets/constants-DE11vt2u.js","assets/typography-dnvkoiv9.js","assets/repo-forked-BC1XV35P.js","assets/modal-backdrop-cp3dlfku.js","assets/modal-body-BthUSAn0.js","assets/base-modal-DLway4p0.js","assets/index-at5IPRPS.js","assets/Trans-CPaTqF-h.js","assets/settings-dropdown-input-CJWg5DfQ.js","assets/optional-tag-SXD2PjYq.js","assets/useSingleSelectListState-Dp1i9X5O.js","assets/loading-spinner-C-wnmolE.js","assets/browser-tab-DVyPwqaf.js","assets/jupyter-tab-Cmu-ipGC.js","assets/served-tab-3shvPpXw.js","assets/server-process-B00scO5q.js","assets/vscode-tab-BEdFrplA.js"])))=>i.map(i=>d[i]);
import{r as H,p as h,R as pe,v as ar,G as ls,o as Fn,H as _s,I as Hn,A as $n,w as Un}from"./chunk-NISHYRIK-CKdEls7F.js";import{u as jt}from"./open-hands-axios-BIuoB8bl.js";import{u as _t,a as Mt,R as lr,b as mt,A as Ci,c as Ce,d as Wn,e as As,f as Ms,g as Si,i as xs,h as Es,j as Vn,M as cr,r as hr,k as ur,o as dr,l as fr,m as pr,S as Js,F as zn,n as _r,p as Kn,q as qn,s as Gn,t as Nt,v as yi,w as is,x as mr,y as Ys,E as wi,z as Ls,B as gr,C as xi,D as Ei,G as ki,H as Zn,I as Jn,J as Yn,K as Xn,L as Xs,N as Ai,O as Qn,P as eo,Q as to,T as Mi,U as Li,V as so,W as ro,X as io,Y as no,Z as oo,_ as ao,$ as lo,a0 as co}from"./parse-pr-url-DDbpIt54.js";import{c as vr,C as st,G as ho,u as br}from"./git-provider-icon-Db_Bl_5f.js";import{u as Rs,a as Zt}from"./use-config-DZPclKuv.js";import{d as pt,a as uo}from"./custom-toast-handlers-fYPNAJaC.js";import{u as fo}from"./use-is-authed-Dg_tgDAm.js";import{u as Jt}from"./use-user-providers-P0hmd5MI.js";import{a as Ri}from"./index-S5BalIfI.js";import{D as Wt}from"./module-CWLbpm_7.js";import{I as Z}from"./declaration-B9eIPmUJ.js";import{t as Cr,T as Ti}from"./tooltip-button-DdCqtqn-.js";import{u as ge}from"./useTranslation-DONB_giz.js";import{E as Qs,C as po,a as je,J as er}from"./constants-DE11vt2u.js";import{i as Sr,d as tr,s as Oi,c as Ee,e as _o,f as Di,h as Ii,j as ji,k as mo,l as go,m as vo,n as bo,o as Co}from"./utils-BVnsmU2z.js";import{c as yr,T as Te}from"./typography-dnvkoiv9.js";import{u as $t,B as It}from"./brand-button-BQs8JWFf.js";import{a as wr,S as So}from"./repo-forked-BC1XV35P.js";import{M as Yt}from"./modal-backdrop-cp3dlfku.js";import{M as Vt}from"./modal-body-BthUSAn0.js";import{B as cs,a as xr}from"./base-modal-DLway4p0.js";import{z as Fr}from"./index-DWiKAxKp.js";import{r as yo}from"./index-CX-90vHk.js";import"./index-at5IPRPS.js";import{i as dt}from"./i18next-Lgj2Bm8L.js";import{s as sr}from"./chunk-MSDKUXDP-Cfu5rKGn.js";import{S as Ni}from"./close-bbjPMB7Q.js";import{T as rr}from"./Trans-CPaTqF-h.js";import{i as Hr}from"./index-BDUzCKOA.js";import{$ as wo,C as xo,b as $r,c as Eo,d as ko,e as Ao,u as Mo,f as Lo,S as Ro,g as To}from"./settings-dropdown-input-CJWg5DfQ.js";import{L as Oo}from"./loading-spinner-C-wnmolE.js";import{u as Do}from"./use-settings-B2QUSrrJ.js";import{_ as Xt}from"./preload-helper-BXl3LOEh.js";import{d as Io,u as Ts,T as zs,L as Ur,m as Wr,a as jo,b as No,$ as Bo,c as Po,A as Fo}from"./index-JAudiiL9.js";import{t as Ho,c as $o,f as Os,a as ns,m as ir,b as Uo,u as Wo,d as Vo,o as zo,e as ms,g as Ko}from"./chunk-TX3FPB7D-DZsJI2yo.js";import{$ as qo}from"./useSingleSelectListState-Dp1i9X5O.js";var Vr=Ho({slots:{wrapper:["flex","w-screen","h-[100dvh]","fixed","inset-0","z-50","overflow-x-auto","justify-center","h-[--visual-viewport-height]"],base:["flex","flex-col","relative","bg-white","z-50","w-full","box-border","bg-content1","outline-solid outline-transparent","mx-1","my-1","sm:mx-6","sm:my-16"],backdrop:"z-50",header:"flex py-4 px-6 flex-initial text-large font-semibold",body:"flex flex-1 flex-col gap-3 px-6 py-2",footer:"flex flex-row gap-2 px-6 py-4 justify-end",closeButton:["absolute","appearance-none","outline-solid outline-transparent","select-none","top-1","end-1","p-2","text-foreground-500","rounded-full","hover:bg-default-100","active:bg-default-200","tap-highlight-transparent",...Io]},variants:{size:{xs:{base:"max-w-xs"},sm:{base:"max-w-sm"},md:{base:"max-w-md"},lg:{base:"max-w-lg"},xl:{base:"max-w-xl"},"2xl":{base:"max-w-2xl"},"3xl":{base:"max-w-3xl"},"4xl":{base:"max-w-4xl"},"5xl":{base:"max-w-5xl"},full:{base:"my-0 mx-0 sm:mx-0 sm:my-0 max-w-full h-[100dvh] min-h-[100dvh] !rounded-none"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"}},placement:{auto:{wrapper:"items-end sm:items-center"},center:{wrapper:"items-center sm:items-center"},top:{wrapper:"items-start sm:items-start"},"top-center":{wrapper:"items-start sm:items-center"},bottom:{wrapper:"items-end sm:items-end"},"bottom-center":{wrapper:"items-end sm:items-center"}},shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},backdrop:{transparent:{backdrop:"hidden"},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-md backdrop-saturate-150 bg-overlay/30"}},scrollBehavior:{normal:{base:"overflow-y-hidden"},inside:{base:"max-h-[calc(100%_-_8rem)]",body:"overflow-y-auto"},outside:{wrapper:"items-start sm:items-start overflow-y-auto",base:"my-16"}},disableAnimation:{false:{wrapper:["[--scale-enter:100%]","[--scale-exit:100%]","[--slide-enter:0px]","[--slide-exit:80px]","sm:[--scale-enter:100%]","sm:[--scale-exit:103%]","sm:[--slide-enter:0px]","sm:[--slide-exit:0px]"]}}},defaultVariants:{size:"md",radius:"lg",shadow:"sm",placement:"auto",backdrop:"opaque",scrollBehavior:"normal"},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"w-screen h-screen fixed inset-0"}}]}),[Go,Ds]=$o({name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Modal />`"}),Bi=Os((s,p)=>{const{as:C,children:w,className:k,...j}=s,{slots:I,classNames:o,bodyId:n,setBodyMounted:u}=Ds(),m=Ts(p),c=C||"div";return H.useEffect(()=>(u(!0),()=>u(!1)),[u]),h.jsx(c,{ref:m,className:I.body({class:ns(o?.body,k)}),id:n,...j,children:w})});Bi.displayName="HeroUI.ModalBody";var Zo=Bi,Jo={enter:{scale:"var(--scale-enter)",y:"var(--slide-enter)",opacity:1,willChange:"auto",transition:{scale:{duration:.4,ease:zs.ease},opacity:{duration:.4,ease:zs.ease},y:{type:"spring",bounce:0,duration:.6}}},exit:{scale:"var(--scale-exit)",y:"var(--slide-exit)",opacity:0,willChange:"transform",transition:{duration:.3,ease:zs.ease}}},At=typeof document<"u"&&window.visualViewport,Yo=pe.createContext(!1);function Xo(){return!1}function Qo(){return!0}function ea(s){return()=>{}}function ta(){return typeof pe.useSyncExternalStore=="function"?pe.useSyncExternalStore(ea,Xo,Qo):H.useContext(Yo)}function sa(){let s=ta(),[p,C]=H.useState(()=>s?{width:0,height:0}:zr());return H.useEffect(()=>{let w=()=>{C(k=>{let j=zr();return j.width===k.width&&j.height===k.height?k:j})};return At?At.addEventListener("resize",w):window.addEventListener("resize",w),()=>{At?At.removeEventListener("resize",w):window.removeEventListener("resize",w)}},[]),p}function zr(){return{width:At&&At?.width||window.innerWidth,height:At&&At?.height||window.innerHeight}}var Kr=()=>Xt(()=>import("./index-wCUGscoc.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(s=>s.default),Pi=s=>{const{as:p,children:C,role:w="dialog",...k}=s,{Component:j,domRef:I,slots:o,classNames:n,motionProps:u,backdrop:m,closeButton:c,hideCloseButton:f,disableAnimation:v,getDialogProps:S,getBackdropProps:g,getCloseButtonProps:a,onClose:t}=Ds(),e=p||j||"div",r=sa(),{dialogProps:i}=wo({role:w},I),_=H.isValidElement(c)?H.cloneElement(c,a()):h.jsx("button",{...a(),children:h.jsx(xo,{})}),l=H.useCallback(N=>{N.key==="Tab"&&N.nativeEvent.isComposing&&(N.stopPropagation(),N.preventDefault())},[]),b=S(ir(i,k)),d=h.jsxs(e,{...b,onKeyDown:Uo(b.onKeyDown,l),children:[h.jsx($r,{onDismiss:t}),!f&&_,typeof C=="function"?C(t):C,h.jsx($r,{onDismiss:t})]}),y=H.useMemo(()=>m==="transparent"?null:v?h.jsx("div",{...g()}):h.jsx(Ur,{features:Kr,children:h.jsx(Wr.div,{animate:"enter",exit:"exit",initial:"exit",variants:jo.fade,...g()})}),[m,v,g]),M={"--visual-viewport-height":r.height+"px"},D=v?h.jsx("div",{className:o.wrapper({class:n?.wrapper}),"data-slot":"wrapper",style:M,children:d}):h.jsx(Ur,{features:Kr,children:h.jsx(Wr.div,{animate:"enter",className:o.wrapper({class:n?.wrapper}),"data-slot":"wrapper",exit:"exit",initial:"exit",variants:Jo,...u,style:M,children:d})});return h.jsxs("div",{tabIndex:-1,children:[y,D]})};Pi.displayName="HeroUI.ModalContent";var ra=Pi,Fi=Os((s,p)=>{const{as:C,children:w,className:k,...j}=s,{slots:I,classNames:o}=Ds(),n=Ts(p),u=C||"footer";return h.jsx(u,{ref:n,className:I.footer({class:ns(o?.footer,k)}),...j,children:w})});Fi.displayName="HeroUI.ModalFooter";var ia=Fi,Hi=Os((s,p)=>{const{as:C,children:w,className:k,...j}=s,{slots:I,classNames:o,headerId:n,setHeaderMounted:u}=Ds(),m=Ts(p),c=C||"header";return H.useEffect(()=>(u(!0),()=>u(!1)),[u]),h.jsx(c,{ref:m,className:I.header({class:ns(o?.header,k)}),id:n,...j,children:w})});Hi.displayName="HeroUI.ModalHeader";var na=Hi;function oa(s={shouldBlockScroll:!0},p,C){let{overlayProps:w,underlayProps:k}=No({...s,isOpen:p.isOpen,onClose:p.close},C);return Eo({isDisabled:!p.isOpen||!s.shouldBlockScroll}),ko(),H.useEffect(()=>{if(p.isOpen&&C.current)return Ao([C.current])},[p.isOpen,C]),{modalProps:Bo(w),underlayProps:k}}function aa(s){var p,C,w;const k=Wo(),[j,I]=Vo(s,Vr.variantKeys),{ref:o,as:n,className:u,classNames:m,isOpen:c,defaultOpen:f,onOpenChange:v,motionProps:S,closeButton:g,isDismissable:a=!0,hideCloseButton:t=!1,shouldBlockScroll:e=!0,portalContainer:r,isKeyboardDismissDisabled:i=!1,onClose:_,...l}=j,b=n||"section",d=Ts(o),y=H.useRef(null),[M,D]=H.useState(!1),[N,T]=H.useState(!1),z=(C=(p=s.disableAnimation)!=null?p:k?.disableAnimation)!=null?C:!1,J=H.useId(),ie=H.useId(),F=H.useId(),ee=Po({isOpen:c,defaultOpen:f,onOpenChange:Y=>{v?.(Y),Y||_?.()}}),{modalProps:L,underlayProps:B}=oa({isDismissable:a,shouldBlockScroll:e,isKeyboardDismissDisabled:i},ee,d),{buttonProps:P}=Mo({onPress:ee.close},y),{isFocusVisible:W,focusProps:Q}=qo(),ae=ns(m?.base,u),he=H.useMemo(()=>Vr({...I,disableAnimation:z}),[zo(I),z]),me=(Y={},se=null)=>{var le;return{ref:Ko(se,d),...ir(L,l,Y),className:he.base({class:ns(ae,Y.className)}),id:J,"data-open":ms(ee.isOpen),"data-dismissable":ms(a),"aria-modal":ms(!0),"data-placement":(le=s?.placement)!=null?le:"right","aria-labelledby":M?ie:void 0,"aria-describedby":N?F:void 0}},V=H.useCallback((Y={})=>({className:he.backdrop({class:m?.backdrop}),...B,...Y}),[he,m,B]),O=()=>({role:"button",tabIndex:0,"aria-label":"Close","data-focus-visible":ms(W),className:he.closeButton({class:m?.closeButton}),...ir(P,Q)});return{Component:b,slots:he,domRef:d,headerId:ie,bodyId:F,motionProps:S,classNames:m,isDismissable:a,closeButton:g,hideCloseButton:t,portalContainer:r,shouldBlockScroll:e,backdrop:(w=s.backdrop)!=null?w:"opaque",isOpen:ee.isOpen,onClose:ee.close,disableAnimation:z,setBodyMounted:T,setHeaderMounted:D,getDialogProps:me,getBackdropProps:V,getCloseButtonProps:O}}var $i=Os((s,p)=>{const{children:C,...w}=s,k=aa({...w,ref:p}),j=h.jsx(Lo,{portalContainer:k.portalContainer,children:C});return h.jsx(Go,{value:k,children:k.disableAnimation&&k.isOpen?j:h.jsx(Fo,{children:k.isOpen?j:null})})});$i.displayName="HeroUI.Modal";var la=$i;const ca=s=>{const p=pe.useRef(!1);pe.useEffect(()=>{p.current||(p.current=!0,s())},[p.current])},qr={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},os=new Map,gs=s=>{const p=os.get(s);return p?Object.fromEntries(Object.entries(p.stores).map(([C,w])=>[C,w.getState()])):{}},ha=(s,p,C)=>{if(s===void 0)return{type:"untracked",connection:p.connect(C)};const w=os.get(C.name);if(w)return{type:"tracked",store:s,...w};const k={connection:p.connect(C),stores:{}};return os.set(C.name,k),{type:"tracked",store:s,...k}},ua=(s,p)=>{if(p===void 0)return;const C=os.get(s);C&&(delete C.stores[p],Object.keys(C.stores).length===0&&os.delete(s))},da=s=>{var p,C;if(!s)return;const w=s.split(`
`),k=w.findIndex(I=>I.includes("api.setState"));if(k<0)return;const j=((p=w[k+1])==null?void 0:p.trim())||"";return(C=/.+ (.+) .+/.exec(j))==null?void 0:C[1]},fa=(s,p={})=>(C,w,k)=>{const{enabled:j,anonymousActionType:I,store:o,...n}=p;let u;try{u=(j??(qr?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return s(C,w,k);const{connection:m,...c}=ha(o,u,n);let f=!0;k.setState=((g,a,t)=>{const e=C(g,a);if(!f)return e;const r=t===void 0?{type:I||da(new Error().stack)||"anonymous"}:typeof t=="string"?{type:t}:t;return o===void 0?(m?.send(r,w()),e):(m?.send({...r,type:`${o}/${r.type}`},{...gs(n.name),[o]:k.getState()}),e)}),k.devtools={cleanup:()=>{m&&typeof m.unsubscribe=="function"&&m.unsubscribe(),ua(n.name,o)}};const v=(...g)=>{const a=f;f=!1,C(...g),f=a},S=s(k.setState,w,k);if(c.type==="untracked"?m?.init(S):(c.stores[c.store]=k,m?.init(Object.fromEntries(Object.entries(c.stores).map(([g,a])=>[g,g===c.store?S:a.getState()])))),k.dispatchFromDevtools&&typeof k.dispatch=="function"){let g=!1;const a=k.dispatch;k.dispatch=(...t)=>{(qr?"production":void 0)!=="production"&&t[0].type==="__setState"&&!g&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),g=!0),a(...t)}}return m.subscribe(g=>{var a;switch(g.type){case"ACTION":if(typeof g.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return Ks(g.payload,t=>{if(t.type==="__setState"){if(o===void 0){v(t.state);return}Object.keys(t.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const e=t.state[o];if(e==null)return;JSON.stringify(k.getState())!==JSON.stringify(e)&&v(e);return}k.dispatchFromDevtools&&typeof k.dispatch=="function"&&k.dispatch(t)});case"DISPATCH":switch(g.payload.type){case"RESET":return v(S),o===void 0?m?.init(k.getState()):m?.init(gs(n.name));case"COMMIT":if(o===void 0){m?.init(k.getState());return}return m?.init(gs(n.name));case"ROLLBACK":return Ks(g.state,t=>{if(o===void 0){v(t),m?.init(k.getState());return}v(t[o]),m?.init(gs(n.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return Ks(g.state,t=>{if(o===void 0){v(t);return}JSON.stringify(k.getState())!==JSON.stringify(t[o])&&v(t[o])});case"IMPORT_STATE":{const{nextLiftedState:t}=g.payload,e=(a=t.computedStates.slice(-1)[0])==null?void 0:a.state;if(!e)return;v(o===void 0?e:e[o]),m?.send(null,t);return}case"PAUSE_RECORDING":return f=!f}return}}),S},pa=fa,Ks=(s,p)=>{let C;try{C=JSON.parse(s)}catch(w){console.error("[zustand devtools middleware] Could not parse the received json",w)}C!==void 0&&p(C)},_a=()=>{const s=localStorage.getItem("conversation-right-panel-shown");return s!==null?JSON.parse(s):!0},gt=vr()(pa(s=>({isRightPanelShown:_a(),selectedTab:"editor",images:[],files:[],loadingFiles:[],loadingImages:[],messageToSend:null,shouldShownAgentLoading:!1,submittedMessage:null,shouldHideSuggestions:!1,hasRightPanelToggled:!0,setIsRightPanelShown:p=>s({isRightPanelShown:p},!1,"setIsRightPanelShown"),setSelectedTab:p=>s({selectedTab:p},!1,"setSelectedTab"),setShouldShownAgentLoading:p=>s({shouldShownAgentLoading:p},!1,"setShouldShownAgentLoading"),setShouldHideSuggestions:p=>s({shouldHideSuggestions:p},!1,"setShouldHideSuggestions"),addImages:p=>s(C=>({images:[...C.images,...p]}),!1,"addImages"),addFiles:p=>s(C=>({files:[...C.files,...p]}),!1,"addFiles"),removeImage:p=>s(C=>{const w=[...C.images];return w.splice(p,1),{images:w}},!1,"removeImage"),removeFile:p=>s(C=>{const w=[...C.files];return w.splice(p,1),{files:w}},!1,"removeFile"),clearImages:()=>s({images:[]},!1,"clearImages"),clearFiles:()=>s({files:[]},!1,"clearFiles"),clearAllFiles:()=>s({images:[],files:[],loadingFiles:[],loadingImages:[]},!1,"clearAllFiles"),addFileLoading:p=>s(C=>C.loadingFiles.includes(p)?C:{loadingFiles:[...C.loadingFiles,p]},!1,"addFileLoading"),removeFileLoading:p=>s(C=>({loadingFiles:C.loadingFiles.filter(w=>w!==p)}),!1,"removeFileLoading"),addImageLoading:p=>s(C=>C.loadingImages.includes(p)?C:{loadingImages:[...C.loadingImages,p]},!1,"addImageLoading"),removeImageLoading:p=>s(C=>({loadingImages:C.loadingImages.filter(w=>w!==p)}),!1,"removeImageLoading"),clearAllLoading:()=>s({loadingFiles:[],loadingImages:[]},!1,"clearAllLoading"),setMessageToSend:p=>s({messageToSend:{text:p,timestamp:Date.now()}},!1,"setMessageToSend"),setSubmittedMessage:p=>s({submittedMessage:p},!1,"setSubmittedMessage"),resetConversationState:()=>s({shouldHideSuggestions:!1},!1,"resetConversationState"),setHasRightPanelToggled:p=>s({hasRightPanelToggled:p},!1,"setHasRightPanelToggled")}),{name:"conversation-store"})),Ui=()=>{const{data:s}=_t(),{curAgentState:p}=Mt();return s?.status==="RUNNING"&&!lr.includes(p)},qt=s=>["feedback","data",s],ma=(s,p)=>["feedback","exists",s,p],ga=()=>{const{conversationId:s}=mt(),{data:p}=Rs(),C=jt(),w=Ui(),k=Zt({queryKey:qt(s),queryFn:()=>st.getBatchFeedback(s),enabled:w&&!!s&&p?.APP_MODE==="saas",staleTime:1e3*60*5,gcTime:1e3*60*15});return pe.useEffect(()=>{k.data&&s&&Object.entries(k.data).forEach(([j,I])=>{C.setQueryData(ma(s,parseInt(j,10)),I)})},[k.data,s,C]),k},va=()=>{const{conversationId:s}=mt(),p=Ui(),C=Zt({queryKey:["conversation_config",s],queryFn:()=>{if(!s)throw new Error("No conversation ID");return st.getRuntimeId(s)},enabled:p&&!!s,staleTime:1e3*60*5,gcTime:1e3*60*15});return pe.useEffect(()=>{if(C.data){const{runtime_id:w}=C.data;console.log("Runtime ID: %c%s","background: #444; color: #ffeb3b; font-weight: bold; padding: 2px 4px; border-radius: 4px;",w)}},[C.data]),C};function ba(s="OpenHands"){const{data:p}=_t(),C=H.useRef(null);H.useEffect(()=>(p?.title?(C.current=p.title,document.title=`${p.title} | ${s}`):document.title=s,()=>{document.title=s}),[p?.title,s])}const Ca=s=>new Promise((p,C)=>{const w=new FileReader;w.onloadend=()=>{p(w.result)},w.onerror=C,w.readAsDataURL(s)}),Sa=s=>H.createElement("svg",{width:15,height:16,viewBox:"0 0 15 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M13.3125 6.80003C13.1369 6.58918 12.9171 6.41945 12.6687 6.30282C12.4204 6.18619 12.1494 6.1255 11.875 6.12503H9.025L9.375 5.23128C9.52058 4.83995 9.56907 4.41916 9.51629 4.00498C9.46351 3.5908 9.31106 3.19561 9.07199 2.8533C8.83293 2.51099 8.51439 2.23178 8.14371 2.03962C7.77303 1.84746 7.36127 1.74809 6.94375 1.75003C6.82352 1.75028 6.70592 1.7852 6.60504 1.8506C6.50417 1.91601 6.42429 2.00912 6.375 2.11878L4.59375 6.12503H3.125C2.62772 6.12503 2.15081 6.32257 1.79917 6.6742C1.44754 7.02583 1.25 7.50275 1.25 8.00003V12.375C1.25 12.8723 1.44754 13.3492 1.79917 13.7009C2.15081 14.0525 2.62772 14.25 3.125 14.25H11.0812C11.5199 14.2499 11.9446 14.096 12.2815 13.815C12.6183 13.5341 12.846 13.144 12.925 12.7125L13.7188 8.33753C13.7678 8.06714 13.7569 7.78927 13.6867 7.52358C13.6165 7.25788 13.4887 7.01087 13.3125 6.80003ZM4.375 13H3.125C2.95924 13 2.80027 12.9342 2.68306 12.817C2.56585 12.6998 2.5 12.5408 2.5 12.375V8.00003C2.5 7.83427 2.56585 7.6753 2.68306 7.55809C2.80027 7.44088 2.95924 7.37503 3.125 7.37503H4.375V13ZM12.5 8.11253L11.7062 12.4875C11.6796 12.6331 11.6022 12.7646 11.4877 12.8584C11.3733 12.9523 11.2292 13.0024 11.0812 13H5.625V6.88128L7.325 3.05628C7.49999 3.10729 7.6625 3.19403 7.80229 3.31102C7.94207 3.428 8.05608 3.57269 8.13712 3.73596C8.21817 3.89923 8.26449 4.07752 8.27316 4.25959C8.28183 4.44166 8.25266 4.62355 8.1875 4.79378L7.85625 5.68753C7.78567 5.87644 7.76184 6.07962 7.7868 6.27973C7.81176 6.47985 7.88476 6.67095 7.99958 6.83674C8.11441 7.00253 8.26763 7.13807 8.44619 7.2318C8.62475 7.32554 8.82333 7.37468 9.025 7.37503H11.875C11.9668 7.37488 12.0575 7.39496 12.1407 7.43385C12.2239 7.47274 12.2975 7.52948 12.3563 7.60003C12.4165 7.66961 12.4606 7.75162 12.4854 7.84021C12.5103 7.9288 12.5152 8.02179 12.5 8.11253Z",fill:"white"})),ya=s=>H.createElement("svg",{width:15,height:16,viewBox:"0 0 15 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M11.8749 1.75H3.91861C3.47998 1.75015 3.05528 1.90407 2.71841 2.18499C2.38154 2.4659 2.15382 2.85603 2.07486 3.2875L1.28111 7.6625C1.23166 7.93277 1.2422 8.21062 1.31201 8.47636C1.38182 8.74211 1.50917 8.98927 1.68507 9.20035C1.86097 9.41142 2.08111 9.58126 2.32991 9.69785C2.57872 9.81443 2.8501 9.87491 3.12486 9.875H5.97486L5.62486 10.7688C5.47928 11.1601 5.4308 11.5809 5.48357 11.995C5.53635 12.4092 5.68881 12.8044 5.92787 13.1467C6.16694 13.489 6.48547 13.7683 6.85615 13.9604C7.22683 14.1526 7.63859 14.2519 8.05611 14.25C8.17634 14.2497 8.29394 14.2148 8.39482 14.1494C8.4957 14.084 8.57557 13.9909 8.62486 13.8813L10.4061 9.875H11.8749C12.3721 9.875 12.8491 9.67746 13.2007 9.32583C13.5523 8.97419 13.7499 8.49728 13.7499 8V3.625C13.7499 3.12772 13.5523 2.65081 13.2007 2.29917C12.8491 1.94754 12.3721 1.75 11.8749 1.75ZM9.37486 9.11875L7.67486 12.9438C7.50092 12.8911 7.3396 12.8034 7.20083 12.6861C7.06206 12.5688 6.94878 12.4242 6.86798 12.2615C6.78717 12.0987 6.74055 11.9211 6.73099 11.7396C6.72143 11.5581 6.74912 11.3766 6.81236 11.2062L7.14361 10.3125C7.2142 10.1236 7.23803 9.92041 7.21307 9.72029C7.18811 9.52018 7.1151 9.32907 7.00028 9.16329C6.88546 8.9975 6.73223 8.86196 6.55367 8.76823C6.37511 8.67449 6.17653 8.62535 5.97486 8.625H3.12486C3.03304 8.62515 2.94232 8.60507 2.85914 8.56618C2.77597 8.52729 2.70238 8.47055 2.64361 8.4C2.58341 8.33042 2.5393 8.24841 2.51445 8.15982C2.4896 8.07123 2.48462 7.97824 2.49986 7.8875L3.29361 3.5125C3.32024 3.3669 3.39767 3.23548 3.51212 3.14162C3.62657 3.04777 3.77062 2.99759 3.91861 3H9.37486V9.11875ZM12.4999 8C12.4999 8.16576 12.434 8.32473 12.3168 8.44194C12.1996 8.55915 12.0406 8.625 11.8749 8.625H10.6249V3H11.8749C12.0406 3 12.1996 3.06585 12.3168 3.18306C12.434 3.30027 12.4999 3.45924 12.4999 3.625V8Z",fill:"white"}));function Gr({testId:s,onClick:p,icon:C,tooltip:w}){const k=h.jsx("button",{type:"button","data-testid":s,onClick:p,className:"flex items-center justify-center w-[26px] h-[26px] rounded-lg cursor-pointer bg-[#25272D] hover:bg-tertiary",children:C});return w?h.jsx(Cr,{content:w,closeDelay:100,className:"bg-white text-black hover:bg-transparent",children:k}):k}function wa({onPositiveFeedback:s,onNegativeFeedback:p,isSaasMode:C=!1}){const{t:w}=ge();return h.jsx("div",{"data-testid":"feedback-actions",className:"flex gap-1",children:!C&&h.jsxs(h.Fragment,{children:[h.jsx(Gr,{testId:"positive-feedback",onClick:s,icon:h.jsx(Sa,{width:15,height:15}),tooltip:w(Z.BUTTON$MARK_HELPFUL)}),h.jsx(Gr,{testId:"negative-feedback",onClick:p,icon:h.jsx(ya,{width:15,height:15}),tooltip:w(Z.BUTTON$MARK_NOT_HELPFUL)})]})})}function xa(s,p,C,w){return{action:Ci.MESSAGE,args:{content:s,image_urls:p,file_urls:C,timestamp:w}}}const Zr=s=>s.type.startsWith("image/"),Ea=3*1024*1024,ka=3*1024*1024;function Aa(s){const p=s.filter(C=>C.size>Ea);if(p.length>0){const C=p.map(w=>w.name);return{isValid:!1,errorMessage:`Files exceeding 3MB are not allowed: ${C.join(", ")}`,oversizedFiles:C}}return{isValid:!0}}function Ma(s,p=[]){const C=p.reduce((j,I)=>j+I.size,0),w=s.reduce((j,I)=>j+I.size,0),k=C+w;return k>ka?{isValid:!1,errorMessage:`Total file size would be ${(k/1048576).toFixed(1)}MB, exceeding the 3MB limit. Please select fewer or smaller files.`}:{isValid:!0}}function Wi(s,p=[]){const C=Aa(s);return C.isValid?Ma(s,p):C}const Vi=s=>s?(s.innerText||s.textContent||"").trim()==="":!0,nr=s=>{s&&Vi(s)&&(s.innerHTML="",s.textContent="")},Jr=s=>s?.innerText||"",Yr=s=>{s&&(s.textContent="")},Xr=s=>{s&&(s.value="")},La=s=>{if(!s)return;const p=window.getSelection();if(!p||p.rangeCount===0)return;const C=p.getRangeAt(0);if(!C.getBoundingClientRect||!s.getBoundingClientRect)return;const w=C.getBoundingClientRect(),k=s.getBoundingClientRect();w.bottom>k.bottom&&(s.scrollTop=s.scrollHeight-s.clientHeight)},Ra=()=>{const s=H.useRef(null),{messageToSend:p,hasRightPanelToggled:C,setMessageToSend:w,setIsRightPanelShown:k}=gt();H.useEffect(()=>{if(s.current){const n=Jr(s.current);w(n),k(C)}},[C,w,k]);const j=H.useCallback(()=>Vi(s.current),[]),I=H.useCallback(()=>{nr(s.current)},[]),o=H.useCallback(()=>Jr(s.current),[]);return{chatInputRef:s,messageToSend:p,checkIsContentEmpty:j,clearEmptyContentHandler:I,getCurrentMessage:o}},Ta=s=>{const p=H.useRef(null),C=H.useRef(null),[w,k]=H.useState(!1),j=H.useCallback(c=>{s&&c.length>0&&s(c)},[s]);H.useEffect(()=>{const c=f=>{const v=f.detail.files;v&&v.length>0&&j(v)};return document.addEventListener("pasteFiles",c),()=>{document.removeEventListener("pasteFiles",c)}},[j]);const I=H.useCallback(c=>{!c&&p.current&&p.current.click()},[]),o=H.useCallback(c=>{const f=Array.from(c.target.files||[]);j(f)},[j]),n=H.useCallback((c,f)=>{f||(c.preventDefault(),k(!0))},[]),u=H.useCallback((c,f)=>{f||C.current?.contains(c.relatedTarget)||(c.preventDefault(),k(!1))},[]),m=H.useCallback((c,f)=>{if(f)return;c.preventDefault(),k(!1);const v=Array.from(c.dataTransfer.files);j(v)},[j]);return{fileInputRef:p,chatContainerRef:C,isDragOver:w,handleFileIconClick:I,handleFileInputChange:o,handleDragOver:n,handleDragLeave:u,handleDrop:m}},Oa=({elementRef:s,minHeight:p,maxHeight:C,onGripDragStart:w,onGripDragEnd:k,onHeightChange:j,onReachedMinHeight:I})=>{const o=g=>"touches"in g&&g.touches.length>0?g.touches[0].clientY:g.clientY,n=(g,a)=>e=>{e.preventDefault();const r=o(e)-g,i=Math.max(p,Math.min(C,a-r)),_=s.current;if(!_)return;_.style.height=`${i}px`;const b=_.scrollHeight>i||i>=C;_.style.overflowY=b?"auto":"hidden",j&&j(i),I&&Math.abs(i-p)<=Qs&&I()},u=(g,a)=>{const t=()=>{if(k?.(),g){const e=document.getElementById("resize-grip");if(!e)return;e.removeEventListener("mousemove",a),e.removeEventListener("mouseup",t),e.removeEventListener("touchmove",a),e.removeEventListener("touchend",t)}else document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",t)};return t},m=(g,a)=>{const t=document.getElementById("resize-grip");t&&(t.addEventListener("touchmove",g,{passive:!1,capture:!0}),t.addEventListener("touchend",a,{capture:!0}))},c=(g,a)=>{document.addEventListener("mousemove",g),document.addEventListener("mouseup",a)},f=g=>{w?.();const a=Sr(),t=s.current?.offsetHeight||p,e=n(g,t),r=u(a,e);a?m(e,r):c(e,r)};return{handleGripMouseDown:g=>{g.preventDefault(),f(g.clientY)},handleGripTouchStart:g=>{g.preventDefault(),f(g.touches[0].clientY)}}},Da=20,Ia=120,ja=20,Na=50,Ba=()=>{const s=H.useRef(!1),p=H.useRef(null);return{hasUserResizedRef:s,manualHeightRef:p}},Pa=(s,p,C)=>{const{minHeight:w,maxHeight:k}=C,j=Math.max(w,Math.min(p,k));return s.style.setProperty("height",`${j}px`),s.style.setProperty("overflow-y",j>=k?"auto":"hidden"),j},Fa=(s,p,C=Na)=>s>p+C,Ha=(s,p)=>{const C=tr(s,p),w=C;s.style.setProperty("height","auto");const k=s.scrollHeight;return Oi(s,C),{currentHeight:w,currentStyleHeight:C,contentHeight:k}},ss=(s,p)=>{const{finalHeight:C,overflowY:w}=p,k=s;k.style.height=`${C}px`,k.style.overflowY=w},Ut=(s,p)=>{p&&p(s)},$a=(s,p={})=>{const C=H.useRef(null),{minHeight:w=Da,maxHeight:k=Ia,enableManualResize:j=!1,value:I,onGripDragStart:o,onGripDragEnd:n,onHeightChange:u}=p,m={minHeight:w,maxHeight:k},{hasUserResizedRef:c,manualHeightRef:f}=Ba(),v=()=>{c.current=!1,f.current=null},S=H.useCallback(y=>{u?.(y),c.current&&(f.current=y)},[u]),g=H.useCallback(()=>{c.current=!0,o?.()},[o]),a=H.useCallback(()=>{const y=s.current;if(y){const M=tr(y,w);Math.abs(M-w)<=Qs&&(c.current=!1,f.current=null)}n?.()},[w,n]),{handleGripMouseDown:t,handleGripTouchStart:e}=Oa({elementRef:s,minHeight:w,maxHeight:k,onGripDragStart:j?g:void 0,onGripDragEnd:j?a:void 0,onHeightChange:S}),r=H.useCallback((y,M,D)=>{if(c.current&&M>w){ss(y,{finalHeight:M,overflowY:"hidden"}),Ut(M,u);return}const N=Math.max(D,w);ss(y,{finalHeight:N,overflowY:"hidden"}),Ut(N,u)},[w,u]),i=H.useCallback((y,M,D)=>{if(!Fa(M,D)){const N=Math.max(D,w);ss(y,{finalHeight:N,overflowY:"hidden"}),Ut(N,u);return}ss(y,{finalHeight:M,overflowY:"auto"}),Ut(M,u)},[w,u]),_=H.useCallback(y=>{ss(y,{finalHeight:k,overflowY:"auto"}),Ut(k,u)},[k,u]),l=H.useCallback(()=>{const y=s.current;if(!y)return;if((y.textContent??"").trim().length===0&&c.current&&f.current&&f.current>w+Qs){Oi(y,f.current),y.style.overflowY="hidden",Ut(f.current,u);return}const D=Ha(y,w),{currentHeight:N,contentHeight:T}=D;if(T<=N){r(y,N,T);return}if(T<=k){i(y,N,T);return}_(y)},[s,w,k,u,r,i,_]),b=H.useCallback(()=>{C.current&&cancelAnimationFrame(C.current),C.current=requestAnimationFrame(()=>{C.current=null,l()})},[l]),d=()=>{const y=s.current;if(!y)return;const M=tr(y,w),D=Math.min(M+ja,k);if(D>M){const N=Pa(y,D,m);Ut(N,u),c.current=!0,f.current=N}};return H.useEffect(()=>{const y=s.current;y&&I!==void 0&&(y.textContent=I.text,b())},[I,b]),H.useEffect(()=>{b()},[b]),{smartResize:b,handleGripMouseDown:t,handleGripTouchStart:e,increaseHeightForEmptyContent:d,resetManualResize:v}},Ua=(s,p)=>{const[C,w]=H.useState(!1),{setShouldHideSuggestions:k}=gt(),j=H.useRef(null),I=H.useCallback(()=>{j.current&&(j.current.classList.add("opacity-100"),j.current.classList.remove("opacity-0"))},[]),o=H.useCallback(()=>{j.current&&(j.current.classList.remove("opacity-100"),j.current.classList.add("opacity-0"))},[]),n=H.useCallback(g=>{g.stopPropagation(),w(a=>!a)},[]),u=H.useCallback(g=>{const a=g>po.HEIGHT_THRESHOLD;k(a)},[k]),{smartResize:m,handleGripMouseDown:c,handleGripTouchStart:f,increaseHeightForEmptyContent:v,resetManualResize:S}=$a(s,{minHeight:20,maxHeight:400,onHeightChange:u,onGripDragStart:I,onGripDragEnd:o,value:p??void 0,enableManualResize:!0});return{gripRef:j,isGripVisible:C,handleTopEdgeClick:n,smartResize:m,handleGripMouseDown:c,handleGripTouchStart:f,increaseHeightForEmptyContent:v,resetManualResize:S}},Wa=(s,p,C,w,k,j,I)=>{const o=H.useCallback(()=>{p(),s.current&&nr(s.current),La(s.current)},[p,s]),n=H.useCallback(f=>{f.preventDefault();const v=Array.from(f.clipboardData.files);if(v.length>0){const a=new CustomEvent("pasteFiles",{detail:{files:v}});document.dispatchEvent(a);return}const g=f.clipboardData.getData("text/plain");g&&(document.execCommand("insertText",!1,g),setTimeout(p,0))},[p]),u=H.useCallback((f,v,S)=>{if(f.key==="Enter"){if(w()){f.preventDefault(),C();return}!Sr()&&!f.shiftKey&&!v&&(f.preventDefault(),S())}},[w,C]),m=H.useCallback(()=>{s.current&&nr(s.current),I&&I()},[s,I]),c=H.useCallback(()=>{j&&j()},[j]);return{handleInput:o,handlePaste:n,handleKeyDown:u,handleBlur:m,handleFocus:c}},Va=(s,p,C,w,k)=>{const j=H.useCallback(()=>{const n=s.current?.innerText||"";n.trim()&&(w(n),Yr(s.current),Xr(p.current),C(),k?.())},[s,p,C,w,k]),I=H.useCallback(()=>{const n=s.current?.innerText||"continue";w(n.trim()),Yr(s.current),Xr(p.current),C(),k?.()},[s,p,C,w,k]),o=H.useCallback(n=>{n&&n()},[]);return{handleSubmit:j,handleResumeAgent:I,handleStop:o}};function za({gripRef:s,isGripVisible:p,handleTopEdgeClick:C,handleGripMouseDown:w,handleGripTouchStart:k}){return h.jsx("div",{className:"absolute -top-[12px] left-0 w-full h-6 lg:h-3 z-20 group",id:"resize-grip",onClick:C,children:h.jsx("div",{ref:s,className:Ee("absolute top-[4px] left-0 w-full h-[3px] bg-white cursor-ns-resize z-10 transition-opacity duration-200",p?"opacity-100":"opacity-0 group-hover:opacity-100"),onMouseDown:w,onTouchStart:k,style:{userSelect:"none"}})})}const Ka=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M15.5 10C16.3284 10 17 9.32843 17 8.5C17 7.67157 16.3284 7 15.5 7C14.6716 7 14 7.67157 14 8.5C14 9.32843 14.6716 10 15.5 10Z",fill:"currentColor"}),H.createElement("path",{d:"M3 5C3 3.89543 3.89543 3 5 3H19C20.1046 3 21 3.89543 21 5V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5ZM19 5H5V12.9194L8.37534 10.2191C8.74056 9.92696 9.25951 9.92696 9.62473 10.2191L13.9258 13.66L15.2929 12.2929C15.6835 11.9024 16.3166 11.9024 16.7071 12.2929L19 14.5857V5ZM5 19H19V17.4142L16 14.4142L14.7071 15.7071C14.3468 16.0674 13.7732 16.0992 13.3753 15.7809L9.00004 12.2806L5 15.4807V19Z",fill:"currentColor"})),qa=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:17,height:17,viewBox:"0 0 17 17",fill:"none",...s},H.createElement("path",{d:"M14.2541 0.99075C15.0629 0.811957 15.8642 1.32275 16.0432 2.13138C16.222 2.94015 15.7113 3.74145 14.9026 3.92044C10.5163 4.8902 8.31751 8.22203 8.09593 11.8745L10.343 9.62942C10.863 9.10947 11.7057 9.10867 12.2258 9.62845C12.7459 10.1486 12.7459 10.9921 12.2258 11.5122L7.52073 16.2173C7.03316 16.7049 6.26163 16.7357 5.73851 16.3091L5.63694 16.2173L0.93089 11.5122C0.411068 10.9922 0.411047 10.1485 0.93089 9.62845C1.45095 9.10851 2.29457 9.10859 2.81468 9.62845L5.09691 11.9107C5.32362 7.06867 8.20704 2.32786 14.2541 0.99075Z",fill:"currentColor"}));function Ga(){const{t:s}=ge();return h.jsx("div",{className:"drag-over",children:h.jsxs("div",{className:"drag-over-content-wrapper",children:[h.jsxs("div",{className:"relative",children:[h.jsx(Ka,{width:36,height:36,className:"rotate-[-27deg] absolute top-[-40px] left-[-10px]"}),h.jsx(qa,{width:16,height:16,className:"absolute top-[-16px] left-[-20px]"})]}),h.jsx("div",{className:"drag-over-content",children:h.jsx("p",{children:s(Z.COMMON$DROP_YOUR_FILES_HERE)})})]})})}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ja=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(p,C,w)=>w?w.toUpperCase():C.toLowerCase()),Qr=s=>{const p=Ja(s);return p.charAt(0).toUpperCase()+p.slice(1)},zi=(...s)=>s.filter((p,C,w)=>!!p&&p.trim()!==""&&w.indexOf(p)===C).join(" ").trim(),Ya=s=>{for(const p in s)if(p.startsWith("aria-")||p==="role"||p==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=H.forwardRef(({color:s="currentColor",size:p=24,strokeWidth:C=2,absoluteStrokeWidth:w,className:k="",children:j,iconNode:I,...o},n)=>H.createElement("svg",{ref:n,...Xa,width:p,height:p,stroke:s,strokeWidth:w?Number(C)*24/Number(p):C,className:zi("lucide",k),...!j&&!Ya(o)&&{"aria-hidden":"true"},...o},[...I.map(([u,m])=>H.createElement(u,m)),...Array.isArray(j)?j:[j]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=(s,p)=>{const C=H.forwardRef(({className:w,...k},j)=>H.createElement(Qa,{ref:j,iconNode:p,className:zi(`lucide-${Za(Qr(s))}`,`lucide-${s}`,w),...k}));return C.displayName=Qr(s),C};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],tl=hs("arrow-up",el);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ki=hs("chevron-down",sl);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rl=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],qi=hs("chevron-right",rl);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Is=hs("loader-circle",il);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nl=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ol=hs("refresh-cw",nl),al=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.565 6.435L16.065 1.935L15 1.5H6L4.5 3V21L6 22.5H19.5L21 21V7.5L20.565 6.435ZM19.5 21H6V3H13.5V9H19.5V21ZM15 7.5V3L19.5 7.5H15Z",fill:"currentColor"})),Gi=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 13.0605L17.469 18.531L18.531 17.4705L13.0605 12L18.531 6.53099L17.4705 5.46899L12 10.9395L6.53099 5.46899L5.47049 6.53099L10.9395 12L5.47049 17.469L6.53099 18.531L12 13.0605Z",fill:"currentColor"}));function Zi({onClick:s}){const p=Sr();return h.jsx("button",{type:"button",onClick:s,className:Ee("flex w-4 h-4 rounded-full items-center justify-center bg-[#25272D] hover:bg-[#A1A1A1] cursor-pointer absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",p&&"opacity-100"),children:h.jsx(Gi,{width:10,height:10,color:"#ffffff"})})}function ei({file:s,onRemove:p,isLoading:C=!1}){const w=_o(s.name);return h.jsxs("div",{className:"group flex gap-2 rounded-lg bg-[#525252] max-w-[160px] px-3 py-1 relative",children:[h.jsxs("div",{className:"flex flex-col justify-center gap-0.25",children:[h.jsx(Zi,{onClick:p}),h.jsx("div",{className:"flex items-center gap-2 w-full",children:h.jsx("span",{className:Ee("text-sm font-normal leading-5 flex-1 max-w-[136px] truncate",C?"max-w-[108px] text-[#A7A7A7]":"text-white"),children:s.name})}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(al,{width:12,height:12,color:"#A7A7A7"}),h.jsx("span",{className:"text-[9px] font-normal leading-5 text-[#A7A7A7]",children:w})]})]}),C&&h.jsx("div",{className:"flex items-center justify-center",children:h.jsx(Is,{className:"animate-spin w-5 h-5",color:"white"})})]})}function ti({image:s,onRemove:p,isLoading:C=!1}){const[w,k]=pe.useState("");return pe.useEffect(()=>{const j=URL.createObjectURL(s);return k(j),()=>{URL.revokeObjectURL(j)}},[s]),h.jsxs("div",{className:"group min-w-[51px] min-h-[49px] w-[51px] h-[49px] rounded-lg bg-[#525252] relative flex items-center justify-center",children:[h.jsx(Zi,{onClick:p}),C?h.jsx(Is,{className:"animate-spin w-5 h-5",color:"white"}):w&&h.jsx("img",{src:w,alt:s.name,className:"w-full h-full object-cover rounded-lg"})]})}function ll(){const{images:s,files:p,loadingFiles:C,loadingImages:w,removeFile:k,removeImage:j}=gt(),I=n=>{k(n)},o=n=>{j(n)};return s.length===0&&p.length===0&&C.length===0&&w.length===0?null:h.jsxs("div",{className:"flex items-center gap-4 w-full overflow-x-auto custom-scrollbar",children:[p.map((n,u)=>h.jsx(ei,{file:n,onRemove:()=>I(u),isLoading:C.includes(n.name)},`file-${u}-${n.name}`)),C.map((n,u)=>{const m=new File([],n);return h.jsx(ei,{file:m,onRemove:()=>{},isLoading:!0},`loading-file-${u}-${n}`)}),s.map((n,u)=>h.jsx(ti,{image:n,onRemove:()=>o(u),isLoading:w.includes(n.name)},`image-${u}-${n.name}`)),w.map((n,u)=>{const m=new File([],n);return h.jsx(ti,{image:m,onRemove:()=>{},isLoading:!0},`loading-image-${u}-${n}`)})]})}const cl=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:13,height:25,viewBox:"0 0 13 25",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.64286 1.92308C3.10435 1.92308 1.85714 3.21456 1.85714 4.80769V18.2692C1.85714 20.9244 3.93582 23.0769 6.5 23.0769C9.06418 23.0769 11.1429 20.9244 11.1429 18.2692V6.08974H13V18.2692C13 21.9865 10.0899 25 6.5 25C2.91015 25 0 21.9865 0 18.2692V4.80769C0 2.15248 2.07868 0 4.64286 0C7.20704 0 9.28572 2.15248 9.28572 4.80769V17.6282C9.28572 19.2213 8.03851 20.5128 6.5 20.5128C4.96149 20.5128 3.71429 19.2213 3.71429 17.6282V6.08974H5.57143V17.6282C5.57143 18.1592 5.98716 18.5897 6.5 18.5897C7.01284 18.5897 7.42857 18.1592 7.42857 17.6282V4.80769C7.42857 3.21456 6.18136 1.92308 4.64286 1.92308Z",fill:"currentColor"}));function hl({handleFileIconClick:s,disabled:p=!1}){return h.jsx("button",{type:"button",className:Ee("h-[25px] relative shrink-0 w-[13px] cursor-pointer transition-all duration-200 hover:scale-110 active:scale-95",p&&"cursor-not-allowed"),"data-name":"Shape","data-testid":"paperclip-icon",onClick:s,children:h.jsx(cl,{className:"block max-w-none w-[13px] h-[25px]",color:p?"#959CB2":"white"})})}function ul({buttonClassName:s,handleSubmit:p,disabled:C}){return h.jsx("button",{type:"button",className:Ee("flex items-center justify-center rounded-full border border-white size-[35px]",C?"cursor-not-allowed border-neutral-600":"cursor-pointer hover:bg-[#959CB2]",s),"data-name":"arrow-up-circle-fill","data-testid":"submit-button",onClick:p,disabled:C,children:h.jsx(tl,{color:C?"#959CB2":"white"})})}function dl({chatInputRef:s,onInput:p,onPaste:C,onKeyDown:w,onFocus:k,onBlur:j}){const{t:I}=ge();return h.jsx("div",{className:"box-border content-stretch flex flex-row items-center justify-start min-h-6 p-0 relative shrink-0 flex-1","data-name":"Text & caret",children:h.jsx("div",{className:"basis-0 flex flex-col font-normal grow justify-center leading-[0] min-h-px min-w-px overflow-ellipsis overflow-hidden relative shrink-0 text-[#d0d9fa] text-[16px] text-left",children:h.jsx("div",{ref:s,className:"chat-input bg-transparent text-white text-[16px] font-normal leading-[20px] outline-none resize-none custom-scrollbar min-h-[20px] max-h-[400px] [text-overflow:inherit] [text-wrap-mode:inherit] [white-space-collapse:inherit] block whitespace-pre-wrap",contentEditable:!0,"data-placeholder":I("SUGGESTIONS$WHAT_TO_BUILD"),"data-testid":"chat-input",onInput:p,onPaste:C,onKeyDown:w,onFocus:k,onBlur:j})})})}function fl({chatInputRef:s,disabled:p,showButton:C,buttonClassName:w,handleFileIconClick:k,handleSubmit:j,onInput:I,onPaste:o,onKeyDown:n,onFocus:u,onBlur:m}){return h.jsxs("div",{className:"box-border content-stretch flex flex-row items-end justify-between p-0 relative shrink-0 w-full pb-[18px] gap-2",children:[h.jsxs("div",{className:"basis-0 box-border content-stretch flex flex-row gap-4 grow items-end justify-start min-h-px min-w-px p-0 relative shrink-0",children:[h.jsx(hl,{disabled:p,handleFileIconClick:()=>k(p)}),h.jsx(dl,{chatInputRef:s,onInput:I,onPaste:o,onKeyDown:n,onFocus:u,onBlur:m})]}),C&&h.jsx(ul,{buttonClassName:Ee(w,"translate-y-[3px]"),handleSubmit:j,disabled:p})]})}const pl=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M15 12C15 12.7956 14.6839 13.5587 14.1213 14.1213C13.5587 14.6839 12.7956 15 12 15C11.2044 15 10.4413 14.6839 9.87868 14.1213C9.31607 13.5587 9 12.7956 9 12C9 11.2044 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9C12.7956 9 13.5587 9.31607 14.1213 9.87868C14.6839 10.4413 15 11.2044 15 12Z",fill:"currentColor"})),Er=s=>{const p=pe.useRef(null);return pe.useEffect(()=>{const C=w=>{p.current&&!p.current.contains(w.target)&&s()};return document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[s]),p},_l=yr("absolute bg-tertiary rounded-[6px] text-white overflow-hidden z-50 context-menu-box-shadow",{variants:{size:{compact:"py-1 px-1",default:"py-[6px] px-1"},layout:{vertical:"flex flex-col gap-2"},position:{top:"bottom-full",bottom:"top-full"},spacing:{default:"mt-2"},alignment:{left:"left-0",right:"right-0"}},defaultVariants:{size:"default",layout:"vertical",spacing:"default"}});function us({testId:s,children:p,className:C,ref:w,size:k,layout:j,position:I,spacing:o,alignment:n}){return h.jsx("ul",{"data-testid":s,ref:w,className:Ee(_l({size:k,layout:j,position:I,spacing:o,alignment:n}),C),children:p})}const ml=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M9 9H15V15H9V9Z",fill:"currentColor"}),H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.9 1.50004C15.3 1.65004 17.55 2.85004 19.2 4.50004C21.15 6.60004 22.2 9.15004 22.2 12.15C22.2 14.55 21.3 16.8 19.8 18.75C18.3 20.55 16.2 21.9 13.8 22.35C11.4 22.8 9 22.5 6.9 21.3C4.8 20.1 3.15 18.3 2.25 16.05C1.35 13.8 1.2 11.25 1.95 9.00004C2.7 6.60004 4.05 4.65004 6.15 3.30004C8.1 1.95004 10.5 1.35004 12.9 1.50004ZM13.65 20.85C15.6 20.4 17.4 19.35 18.75 17.7C19.95 16.05 20.7 14.1 20.55 12C20.55 9.60004 19.65 7.20004 18 5.55004C16.5 4.05004 14.7 3.15004 12.6 3.00004C10.65 2.85004 8.55 3.30004 6.9 4.50004C5.25 5.70004 4.05 7.35004 3.45 9.45004C2.85 11.4 2.85 13.5 3.75 15.45C4.65 17.4 6 18.9 7.8 19.95C9.6 21 11.7 21.3 13.65 20.85Z",fill:"currentColor"})),gl=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.9 1.50004C15.3 1.65004 17.55 2.85004 19.2 4.50004C21.15 6.60004 22.2 9.15004 22.2 12.15C22.2 14.55 21.3 16.8 19.8 18.75C18.3 20.55 16.2 21.9 13.8 22.35C11.4 22.8 9 22.5 6.9 21.3C4.8 20.1 3.15 18.3 2.25 16.05C1.35 13.8 1.2 11.25 1.95 9.00004C2.7 6.60004 4.05 4.65004 6.15 3.30004C8.1 1.95004 10.5 1.35004 12.9 1.50004ZM13.65 20.85C15.6 20.4 17.4 19.35 18.75 17.7C19.95 16.05 20.7 14.1 20.55 12C20.55 9.60004 19.65 7.20004 18 5.55004C16.5 4.05004 14.7 3.15004 12.6 3.00004C10.65 2.85004 8.55 3.30004 6.9 4.50004C5.25 5.70004 4.05 7.35004 3.45 9.45004C2.85 11.4 2.85 13.5 3.75 15.45C4.65 17.4 6 18.9 7.8 19.95C9.6 21 11.7 21.3 13.65 20.85Z",fill:"currentColor"}),H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 7.49998L10.1655 6.87598L16.9155 11.376V12.624L10.1655 17.124L9 16.5V7.49998ZM10.5 8.90098V15.099L15.1485 12L10.5 8.90098Z",fill:"currentColor"}));function si({icon:s,text:p,onClick:C,testId:w}){return h.jsxs("button",{className:"flex items-center gap-2 p-2 hover:bg-[#5C5D62] rounded text-sm text-white font-normal leading-5 cursor-pointer w-full",onClick:C,"data-testid":w,type:"button",children:[p,s]})}function vl({onClose:s,onStopServer:p,onStartServer:C,conversationStatus:w,position:k="top"}){const{t:j}=ge(),I=Er(s);return h.jsxs(us,{ref:I,testId:"server-status-context-menu",position:k,alignment:"left",size:"default",className:"left-2 w-fit min-w-max",children:[w==="RUNNING"&&p&&h.jsx(si,{icon:h.jsx(ml,{width:18,height:18}),text:j(Z.COMMON$STOP_RUNTIME),onClick:p,testId:"stop-server-button"}),w==="STOPPED"&&C&&h.jsx(si,{icon:h.jsx(gl,{width:18,height:18}),text:j(Z.COMMON$START_RUNTIME),onClick:C,testId:"start-server-button"})]})}const Ji=()=>{const s=jt();return $t({mutationFn:p=>st.startConversation(p.conversationId,p.providers),onMutate:async()=>(await s.cancelQueries({queryKey:["user","conversations"]}),{previousConversations:s.getQueryData(["user","conversations"])}),onError:(p,C,w)=>{w?.previousConversations&&s.setQueryData(["user","conversations"],w.previousConversations)},onSettled:(p,C,w)=>{s.invalidateQueries({queryKey:["user","conversation",w.conversationId]}),s.invalidateQueries({queryKey:["user","conversations"]})}})},Yi=()=>{const s=jt(),p=ar(),{conversationId:C}=ls();return $t({mutationFn:w=>st.stopConversation(w.conversationId),onMutate:async()=>(await s.cancelQueries({queryKey:["user","conversations"]}),{previousConversations:s.getQueryData(["user","conversations"])}),onError:(w,k,j)=>{j?.previousConversations&&s.setQueryData(["user","conversations"],j.previousConversations)},onSettled:(w,k,j)=>{s.invalidateQueries({queryKey:["user","conversation",j.conversationId]}),s.invalidateQueries({queryKey:["user","conversations"]})},onSuccess:(w,k)=>{C&&k.conversationId===C&&p("/")}})};function bl({className:s="",conversationStatus:p}){const[C,w]=H.useState(!1),{curAgentState:k}=Mt(),{t:j}=ge(),{conversationId:I}=mt(),o=Yi(),n=Ji(),{providers:u}=Jt(),m=k===Ce.LOADING||k===Ce.INIT,c=p==="STOPPED",f=()=>m?"#FFD600":c?"#ffffff":k===Ce.ERROR?"#FF684E":"#BCFF8C",v=()=>m?j(Z.COMMON$STARTING):c?j(Z.COMMON$SERVER_STOPPED):k===Ce.ERROR?j(Z.COMMON$ERROR):j(Z.COMMON$RUNNING),S=()=>{(p==="RUNNING"||p==="STOPPED")&&w(!0)},g=()=>{w(!1)},a=i=>{i.preventDefault(),o.mutate({conversationId:I}),w(!1)},t=i=>{i.preventDefault(),n.mutate({conversationId:I,providers:u}),w(!1)},e=f(),r=v();return h.jsxs("div",{className:`relative ${s}`,children:[h.jsxs("div",{className:"flex items-center cursor-pointer",onClick:S,children:[h.jsx(pl,{className:"w-6 h-6",color:e}),h.jsx("span",{className:"text-[11px] text-white font-normal leading-5",children:r})]}),C&&h.jsx(vl,{onClose:g,onStopServer:a,onStartServer:t,conversationStatus:p,position:"top"})]})}const Cl={[Ce.LOADING]:Z.AGENT_STATUS$INITIALIZING,[Ce.INIT]:Z.AGENT_STATUS$INITIALIZING,[Ce.AWAITING_USER_INPUT]:Z.AGENT_STATUS$WAITING_FOR_TASK,[Ce.AWAITING_USER_CONFIRMATION]:Z.AGENT_STATUS$WAITING_FOR_TASK,[Ce.USER_CONFIRMED]:Z.AGENT_STATUS$WAITING_FOR_TASK,[Ce.USER_REJECTED]:Z.AGENT_STATUS$WAITING_FOR_TASK,[Ce.FINISHED]:Z.AGENT_STATUS$WAITING_FOR_TASK,[Ce.RUNNING]:Z.AGENT_STATUS$RUNNING_TASK,[Ce.PAUSED]:Z.AGENT_STATUS$AGENT_STOPPED,[Ce.STOPPED]:Z.AGENT_STATUS$AGENT_STOPPED,[Ce.REJECTED]:Z.AGENT_STATUS$AGENT_STOPPED,[Ce.ERROR]:Z.AGENT_STATUS$ERROR_OCCURRED,[Ce.RATE_LIMITED]:Z.AGENT_STATUS$ERROR_OCCURRED};function Sl(s,p,C,w,k){if(C==="STOPPED"||w==="STATUS$STOPPED")return Z.CHAT_INTERFACE$STOPPED;const j=k&&[Ce.AWAITING_USER_INPUT,Ce.RUNNING,Ce.FINISHED,Ce.PAUSED,Ce.AWAITING_USER_CONFIRMATION,Ce.USER_CONFIRMED,Ce.USER_REJECTED].includes(k);if(w&&!["STATUS$READY","STATUS$RUNTIME_STARTED"].includes(w)&&!j){const I=Z[w];return I||w}return p==="DISCONNECTED"?Z.CHAT_INTERFACE$DISCONNECTED:p==="CONNECTING"?Z.CHAT_INTERFACE$CONNECTING:k?Cl[k]:w&&w!=="STATUS$READY"&&!k?w:Z.CHAT_INTERFACE$AGENT_ERROR_MESSAGE}const yl=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M9 6C9.55228 6 10 6.44772 10 7V17C10 17.5523 9.55228 18 9 18C8.44772 18 8 17.5523 8 17V7C8 6.44772 8.44772 6 9 6ZM15 6C15.5523 6 16 6.44772 16 7V17C16 17.5523 15.5523 18 15 18C14.4477 18 14 17.5523 14 17V7C14 6.44772 14.4477 6 15 6Z",fill:"currentColor"}));function wl({handleStop:s}){return h.jsx("button",{type:"button",onClick:s,"data-testid":"stop-button",className:"cursor-pointer",children:h.jsx(yl,{className:"block max-w-none w-4 h-4"})})}const xl=s=>H.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M15 11H13V7C13 6.73478 12.8946 6.48043 12.7071 6.29289C12.5196 6.10536 12.2652 6 12 6C11.7348 6 11.4804 6.10536 11.2929 6.29289C11.1054 6.48043 11 6.73478 11 7V12C11 12.2652 11.1054 12.5196 11.2929 12.7071C11.4804 12.8946 11.7348 13 12 13H15C15.2652 13 15.5196 12.8946 15.7071 12.7071C15.8946 12.5196 16 12.2652 16 12C16 11.7348 15.8946 11.4804 15.7071 11.2929C15.5196 11.1054 15.2652 11 15 11ZM12 2C10.0222 2 8.08879 2.58649 6.4443 3.6853C4.79981 4.78412 3.51809 6.3459 2.76121 8.17317C2.00433 10.0004 1.8063 12.0111 2.19215 13.9509C2.578 15.8907 3.53041 17.6725 4.92894 19.0711C6.32746 20.4696 8.10929 21.422 10.0491 21.8079C11.9889 22.1937 13.9996 21.9957 15.8268 21.2388C17.6541 20.4819 19.2159 19.2002 20.3147 17.5557C21.4135 15.9112 22 13.9778 22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7363 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2ZM12 20C10.4178 20 8.87104 19.5308 7.55544 18.6518C6.23985 17.7727 5.21447 16.5233 4.60897 15.0615C4.00347 13.5997 3.84504 11.9911 4.15372 10.4393C4.4624 8.88743 5.22433 7.46197 6.34315 6.34315C7.46197 5.22433 8.88743 4.4624 10.4393 4.15372C11.9911 3.84504 13.5997 4.00346 15.0615 4.60896C16.5233 5.21447 17.7727 6.23984 18.6518 7.55544C19.5308 8.87103 20 10.4177 20 12C20 14.1217 19.1572 16.1566 17.6569 17.6569C16.1566 19.1571 14.1217 20 12 20Z",fill:"currentColor"})),El=s=>H.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M8 8.37911C8 7.31633 9.15785 6.65415 10.0798 7.18966L16.3139 10.8105C17.2287 11.3419 17.2287 12.6581 16.3139 13.1895L10.0798 16.8103C9.15785 17.3459 8 16.6837 8 15.6209V8.37911Z",fill:"currentColor"}));function kl({onAgentResumed:s,disabled:p=!1}){return h.jsx("button",{type:"button",onClick:s,"data-testid":"play-button",disabled:p,className:Ee("cursor-pointer",p&&"cursor-not-allowed"),children:h.jsx(El,{className:"block max-w-none w-4 h-4"})})}function Al(){return h.jsx("div",{"data-testid":"agent-loading-spinner",children:h.jsx(Is,{className:"animate-spin w-4 h-4",color:"white"})})}const Ml=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12ZM7.79289 7.79289C8.18342 7.40237 8.81658 7.40237 9.20711 7.79289L12 10.5858L14.7929 7.79289C15.1834 7.40237 15.8166 7.40237 16.2071 7.79289C16.5976 8.18342 16.5976 8.81658 16.2071 9.20711L13.4142 12L16.2071 14.7929C16.5976 15.1834 16.5976 15.8166 16.2071 16.2071C15.8166 16.5976 15.1834 16.5976 14.7929 16.2071L12 13.4142L9.20711 16.2071C8.81658 16.5976 8.18342 16.5976 7.79289 16.2071C7.40237 15.8166 7.40237 15.1834 7.79289 14.7929L10.5858 12L7.79289 9.20711C7.40237 8.81658 7.40237 8.18342 7.79289 7.79289Z",fill:"currentColor"}));function Ll({className:s="",handleStop:p,handleResumeAgent:C,disabled:w=!1}){const{t:k}=ge(),{setShouldShownAgentLoading:j}=gt(),{curAgentState:I}=Mt(),{curStatusMessage:o}=Wn(),{webSocketStatus:n}=As(),{data:u}=_t(),m=Sl(o,n,u?.status||null,u?.runtime_status||null,I),c=I===Ce.INIT||I===Ce.LOADING||n==="CONNECTING",f=I===Ce.ERROR||I===Ce.RATE_LIMITED,v=I===Ce.RUNNING,S=I===Ce.STOPPED;return H.useEffect(()=>{j(c)},[c,j]),h.jsxs("div",{className:Ee("flex items-center gap-1 min-w-0",s),children:[h.jsx("span",{className:"text-[11px] text-white font-normal leading-5 flex-1 min-w-0 max-w-full whitespace-normal break-words",title:k(m),children:k(m)}),h.jsxs("div",{className:Ee("bg-[#525252] box-border content-stretch flex flex-row gap-[3px] items-center justify-center overflow-clip px-0.5 py-1 relative rounded-[100px] shrink-0 size-6 transition-all duration-200 active:scale-95",(v||S)&&"hover:bg-[#737373] cursor-pointer"),children:[c&&h.jsx(Al,{}),v&&h.jsx(wl,{handleStop:p}),S&&h.jsx(kl,{onAgentResumed:C,disabled:w}),f&&h.jsx(Ml,{className:"w-4 h-4"}),!c&&!v&&!S&&!f&&h.jsx(xl,{className:"w-4 h-4"})]})]})}const Rl=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.1595 5.22752L20.9895 4.95152L17.8275 8.09552L16.0365 6.27152L19.1205 3.03602L18.8505 1.84802C18.1988 1.62999 17.5172 1.51461 16.83 1.50602C16.0804 1.49449 15.3365 1.63746 14.6445 1.92602C13.9764 2.22843 13.3725 2.65616 12.8655 3.18602C12.3011 3.72063 11.8542 4.36683 11.553 5.08352C10.9732 6.50984 10.9732 8.10619 11.553 9.53252C8.42587 12.609 5.3391 15.7263 2.29351 18.8835C1.97851 19.296 1.82851 19.8105 1.86751 20.328C1.89825 20.8846 2.14856 21.4063 2.56351 21.7785C2.74951 21.981 2.97151 22.149 3.21901 22.2705C3.47401 22.383 3.74851 22.4475 4.02601 22.461C4.50001 22.452 4.95451 22.272 5.30701 21.9555C7.62901 19.77 12.078 15.2805 14.6055 12.6495C15.291 12.9405 16.0275 13.0905 16.7715 13.089C17.5204 13.0884 18.2616 12.9377 18.9513 12.6458C19.641 12.3539 20.2652 11.9267 20.787 11.3895C21.8588 10.2964 22.4575 8.82543 22.4535 7.29452C22.4708 6.59398 22.3715 5.89544 22.1595 5.22752ZM4.39951 20.892C4.34178 20.9433 4.27218 20.9794 4.19701 20.997C4.12306 21.0098 4.04746 21.0098 3.97351 20.997C3.89598 20.9852 3.82213 20.956 3.75751 20.9115C3.68817 20.8709 3.62955 20.8144 3.58651 20.7465C3.37651 20.532 3.18001 20.124 3.37651 19.8945C5.43151 17.709 9.66301 13.437 12.309 10.8255C12.459 11.0235 12.624 11.2125 12.801 11.3895C12.978 11.574 13.1685 11.745 13.371 11.901C10.812 14.526 6.63901 18.747 4.40101 20.892H4.39951ZM21.0765 7.29452C21.0795 8.44202 20.6325 9.54452 19.8285 10.3665C19.0262 11.1536 17.9472 11.5944 16.8233 11.5944C15.6994 11.5944 14.6203 11.1536 13.818 10.3665C13.23 9.75286 12.8283 8.98485 12.6597 8.15183C12.4911 7.31882 12.5624 6.45505 12.8655 5.66102C13.0673 5.12062 13.3802 4.62858 13.784 4.21671C14.1879 3.80485 14.6737 3.48233 15.21 3.27002C15.7192 3.05688 16.266 2.94774 16.818 2.94902H17.199L14.4735 5.75852V6.80252L17.316 9.63152H18.306L21.0765 6.90752V7.29452ZM4.86001 10.032H7.15651L8.21401 11.1075L9.23101 10.0965L8.23351 9.07952V9.01502L8.31901 6.54152L7.98901 5.88602L3.69901 3.06302L2.81251 3.16202L1.56601 4.43552L1.46701 5.33402L4.22401 9.71102L4.86001 10.0335V10.032ZM3.44251 4.58402L6.91351 6.87002L6.85501 8.55452H5.24101L3.00301 5.01152L3.44251 4.58402ZM14.1 15.024L15.111 14.0145L19.77 18.792C20.1624 19.2045 20.3813 19.752 20.3813 20.3213C20.3813 20.8906 20.1624 21.4381 19.77 21.8505C19.4749 22.1535 19.0955 22.3605 18.6811 22.4448C18.2667 22.5291 17.8365 22.4866 17.4465 22.323C17.1976 22.2126 16.9744 22.0517 16.791 21.8505L12.078 17.046L13.0965 16.029L17.7945 20.82C17.8577 20.8897 17.9363 20.9436 18.024 20.9775C18.1967 21.0476 18.3899 21.0476 18.5625 20.9775C18.6502 20.9436 18.7288 20.8897 18.792 20.82C18.8577 20.755 18.9088 20.6768 18.942 20.5905C18.9764 20.5025 18.9947 20.409 18.996 20.3145C18.9945 20.2202 18.9767 20.1268 18.9435 20.0385C18.9103 19.9523 18.8592 19.8741 18.7935 19.809L14.1 15.024Z",fill:"currentColor"}));function Fe({children:s,testId:p,onClick:C,isDisabled:w,className:k}){return h.jsx("button",{"data-testid":p||"context-menu-list-item",type:"button",onClick:C,disabled:w,className:Ee("text-sm px-4 h-10 w-full text-start hover:bg-white/10 cursor-pointer","disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent text-nowrap",k),children:s})}const Tl=yr("w-full",{variants:{orientation:{horizontal:"h-[1px]"},color:{light:"bg-[#5C5D62]"},size:{thin:"h-[1px]"}},defaultVariants:{orientation:"horizontal",color:"light",size:"thin"}});function ys({orientation:s,color:p,size:C,className:w,testId:k}){return h.jsx("div",{"data-testid":k,className:Ee(Tl({orientation:s,color:p,size:C}),w)})}const Xi=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M9 15C8.80222 15 8.60888 15.0586 8.44443 15.1685C8.27998 15.2784 8.15181 15.4346 8.07612 15.6173C8.00043 15.8 7.98063 16.0011 8.01921 16.1951C8.0578 16.3891 8.15304 16.5673 8.29289 16.7071C8.43275 16.847 8.61093 16.9422 8.80491 16.9808C8.99889 17.0194 9.19996 16.9996 9.38268 16.9239C9.56541 16.8482 9.72159 16.72 9.83147 16.5556C9.94135 16.3911 10 16.1978 10 16C10 15.7348 9.89464 15.4804 9.70711 15.2929C9.51957 15.1054 9.26522 15 9 15ZM2 14C1.73478 14 1.48043 14.1054 1.29289 14.2929C1.10536 14.4804 1 14.7348 1 15V17C1 17.2652 1.10536 17.5196 1.29289 17.7071C1.48043 17.8946 1.73478 18 2 18C2.26522 18 2.51957 17.8946 2.70711 17.7071C2.89464 17.5196 3 17.2652 3 17V15C3 14.7348 2.89464 14.4804 2.70711 14.2929C2.51957 14.1054 2.26522 14 2 14ZM22 14C21.7348 14 21.4804 14.1054 21.2929 14.2929C21.1054 14.4804 21 14.7348 21 15V17C21 17.2652 21.1054 17.5196 21.2929 17.7071C21.4804 17.8946 21.7348 18 22 18C22.2652 18 22.5196 17.8946 22.7071 17.7071C22.8946 17.5196 23 17.2652 23 17V15C23 14.7348 22.8946 14.4804 22.7071 14.2929C22.5196 14.1054 22.2652 14 22 14ZM17 7H13V5.72C13.3023 5.54549 13.5536 5.29491 13.7291 4.99317C13.9045 4.69143 13.9979 4.34903 14 4C14 3.46957 13.7893 2.96086 13.4142 2.58579C13.0391 2.21071 12.5304 2 12 2C11.4696 2 10.9609 2.21071 10.5858 2.58579C10.2107 2.96086 10 3.46957 10 4C10.0021 4.34903 10.0955 4.69143 10.2709 4.99317C10.4464 5.29491 10.6977 5.54549 11 5.72V7H7C6.20435 7 5.44129 7.31607 4.87868 7.87868C4.31607 8.44129 4 9.20435 4 10V19C4 19.7956 4.31607 20.5587 4.87868 21.1213C5.44129 21.6839 6.20435 22 7 22H17C17.7956 22 18.5587 21.6839 19.1213 21.1213C19.6839 20.5587 20 19.7956 20 19V10C20 9.20435 19.6839 8.44129 19.1213 7.87868C18.5587 7.31607 17.7956 7 17 7ZM13.72 9L13.22 11H10.78L10.28 9H13.72ZM18 19C18 19.2652 17.8946 19.5196 17.7071 19.7071C17.5196 19.8946 17.2652 20 17 20H7C6.73478 20 6.48043 19.8946 6.29289 19.7071C6.10536 19.5196 6 19.2652 6 19V10C6 9.73478 6.10536 9.48043 6.29289 9.29289C6.48043 9.10536 6.73478 9 7 9H8.22L9 12.24C9.05475 12.4619 9.18385 12.6583 9.36579 12.7966C9.54774 12.9349 9.77157 13.0067 10 13H14C14.2284 13.0067 14.4523 12.9349 14.6342 12.7966C14.8162 12.6583 14.9452 12.4619 15 12.24L15.78 9H17C17.2652 9 17.5196 9.10536 17.7071 9.29289C17.8946 9.48043 18 9.73478 18 10V19ZM15 15C14.8022 15 14.6089 15.0586 14.4444 15.1685C14.28 15.2784 14.1518 15.4346 14.0761 15.6173C14.0004 15.8 13.9806 16.0011 14.0192 16.1951C14.0578 16.3891 14.153 16.5673 14.2929 16.7071C14.4327 16.847 14.6109 16.9422 14.8049 16.9808C14.9989 17.0194 15.2 16.9996 15.3827 16.9239C15.5654 16.8482 15.7216 16.72 15.8315 16.5556C15.9414 16.3911 16 16.1978 16 16C16 15.7348 15.8946 15.4804 15.7071 15.2929C15.5196 15.1054 15.2652 15 15 15Z",fill:"currentColor"})),Qi=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.1595 5.22752L20.9895 4.95152L17.8275 8.09552L16.0365 6.27152L19.1205 3.03602L18.8505 1.84802C18.1988 1.62999 17.5172 1.51461 16.83 1.50602C16.0804 1.49449 15.3365 1.63746 14.6445 1.92602C13.9764 2.22843 13.3725 2.65616 12.8655 3.18602C12.3011 3.72063 11.8542 4.36683 11.553 5.08352C10.9732 6.50984 10.9732 8.10619 11.553 9.53252C8.42587 12.609 5.3391 15.7263 2.29351 18.8835C1.97851 19.296 1.82851 19.8105 1.86751 20.328C1.89825 20.8846 2.14856 21.4063 2.56351 21.7785C2.74951 21.981 2.97151 22.149 3.21901 22.2705C3.47401 22.383 3.74851 22.4475 4.02601 22.461C4.50001 22.452 4.95451 22.272 5.30701 21.9555C7.62901 19.77 12.078 15.2805 14.6055 12.6495C15.291 12.9405 16.0275 13.0905 16.7715 13.089C17.5204 13.0884 18.2616 12.9377 18.9513 12.6458C19.641 12.3539 20.2652 11.9267 20.787 11.3895C21.8588 10.2964 22.4575 8.82543 22.4535 7.29452C22.4708 6.59398 22.3715 5.89544 22.1595 5.22752ZM4.39951 20.892C4.34178 20.9433 4.27218 20.9794 4.19701 20.997C4.12306 21.0098 4.04746 21.0098 3.97351 20.997C3.89598 20.9852 3.82213 20.956 3.75751 20.9115C3.68817 20.8709 3.62955 20.8144 3.58651 20.7465C3.37651 20.532 3.18001 20.124 3.37651 19.8945C5.43151 17.709 9.66301 13.437 12.309 10.8255C12.459 11.0235 12.624 11.2125 12.801 11.3895C12.978 11.574 13.1685 11.745 13.371 11.901C10.812 14.526 6.63901 18.747 4.40101 20.892H4.39951ZM21.0765 7.29452C21.0795 8.44202 20.6325 9.54452 19.8285 10.3665C19.0262 11.1536 17.9472 11.5944 16.8233 11.5944C15.6994 11.5944 14.6203 11.1536 13.818 10.3665C13.23 9.75286 12.8283 8.98485 12.6597 8.15183C12.4911 7.31882 12.5624 6.45505 12.8655 5.66102C13.0673 5.12062 13.3802 4.62858 13.784 4.21671C14.1879 3.80485 14.6737 3.48233 15.21 3.27002C15.7192 3.05688 16.266 2.94774 16.818 2.94902H17.199L14.4735 5.75852V6.80252L17.316 9.63152H18.306L21.0765 6.90752V7.29452ZM4.86001 10.032H7.15651L8.21401 11.1075L9.23101 10.0965L8.23351 9.07952V9.01502L8.31901 6.54152L7.98901 5.88602L3.69901 3.06302L2.81251 3.16202L1.56601 4.43552L1.46701 5.33402L4.22401 9.71102L4.86001 10.0335V10.032ZM3.44251 4.58402L6.91351 6.87002L6.85501 8.55452H5.24101L3.00301 5.01152L3.44251 4.58402ZM14.1 15.024L15.111 14.0145L19.77 18.792C20.1624 19.2045 20.3813 19.752 20.3813 20.3213C20.3813 20.8906 20.1624 21.4381 19.77 21.8505C19.4749 22.1535 19.0955 22.3605 18.6811 22.4448C18.2667 22.5291 17.8365 22.4866 17.4465 22.323C17.1976 22.2126 16.9744 22.0517 16.791 21.8505L12.078 17.046L13.0965 16.029L17.7945 20.82C17.8577 20.8897 17.9363 20.9436 18.024 20.9775C18.1967 21.0476 18.3899 21.0476 18.5625 20.9775C18.6502 20.9436 18.7288 20.8897 18.792 20.82C18.8577 20.755 18.9088 20.6768 18.942 20.5905C18.9764 20.5025 18.9947 20.409 18.996 20.3145C18.9945 20.2202 18.9767 20.1268 18.9435 20.0385C18.9103 19.9523 18.8592 19.8741 18.7935 19.809L14.1 15.024Z",fill:"currentColor"})),Ol=s=>H.createElement("svg",{width:29,height:28,viewBox:"0 0 29 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M14.5 18.375C12.085 18.375 10.125 16.415 10.125 14C10.125 11.585 12.085 9.625 14.5 9.625C16.915 9.625 18.875 11.585 18.875 14C18.875 16.415 16.915 18.375 14.5 18.375ZM14.5 11.375C13.0533 11.375 11.875 12.5533 11.875 14C11.875 15.4467 13.0533 16.625 14.5 16.625C15.9467 16.625 17.125 15.4467 17.125 14C17.125 12.5533 15.9467 11.375 14.5 11.375Z",fill:"currentColor"}),H.createElement("path",{d:"M18.245 25.8883C18 25.8883 17.755 25.8533 17.51 25.795C16.7867 25.5967 16.18 25.1417 15.795 24.5L15.655 24.2667C14.9667 23.0767 14.0217 23.0767 13.3333 24.2667L13.205 24.4883C12.82 25.1417 12.2133 25.6083 11.49 25.795C10.755 25.9933 9.99668 25.8883 9.35501 25.5033L7.34834 24.3483C6.63668 23.94 6.12334 23.275 5.90168 22.47C5.69168 21.665 5.79668 20.8367 6.20501 20.125C6.54334 19.53 6.63668 18.9933 6.43834 18.655C6.24001 18.3167 5.73834 18.1183 5.05001 18.1183C3.34668 18.1183 1.95834 16.73 1.95834 15.0267V12.9733C1.95834 11.27 3.34668 9.88168 5.05001 9.88168C5.73834 9.88168 6.24001 9.68334 6.43834 9.34501C6.63668 9.00668 6.55501 8.47001 6.20501 7.87501C5.79668 7.16334 5.69168 6.32334 5.90168 5.53001C6.11168 4.72501 6.62501 4.06001 7.34834 3.65168L9.36668 2.49668C10.685 1.71501 12.4233 2.17001 13.2167 3.51168L13.3567 3.74501C14.045 4.93501 14.99 4.93501 15.6783 3.74501L15.8067 3.52334C16.6 2.17001 18.3383 1.71501 19.6683 2.50834L21.675 3.66334C22.3867 4.07168 22.9 4.73668 23.1217 5.54168C23.3317 6.34668 23.2267 7.17501 22.8183 7.88668C22.48 8.48168 22.3867 9.01834 22.585 9.35668C22.7833 9.69501 23.285 9.89334 23.9733 9.89334C25.6767 9.89334 27.065 11.2817 27.065 12.985V15.0383C27.065 16.7417 25.6767 18.13 23.9733 18.13C23.285 18.13 22.7833 18.3283 22.585 18.6667C22.3867 19.005 22.4683 19.5417 22.8183 20.1367C23.2267 20.8483 23.3433 21.6883 23.1217 22.4817C22.9117 23.2867 22.3983 23.9517 21.675 24.36L19.6567 25.515C19.2133 25.76 18.735 25.8883 18.245 25.8883ZM14.5 21.5717C15.5383 21.5717 16.5067 22.225 17.1717 23.38L17.3 23.6017C17.44 23.8467 17.6733 24.0217 17.9533 24.0917C18.2333 24.1617 18.5133 24.1267 18.7467 23.9867L20.765 22.82C21.0683 22.645 21.3017 22.3533 21.395 22.0033C21.4883 21.6533 21.4417 21.2917 21.2667 20.9883C20.6017 19.845 20.52 18.6667 21.0333 17.7683C21.5467 16.87 22.6083 16.3567 23.9383 16.3567C24.685 16.3567 25.28 15.7617 25.28 15.015V12.9617C25.28 12.2267 24.685 11.62 23.9383 11.62C22.6083 11.62 21.5467 11.1067 21.0333 10.2083C20.52 9.31001 20.6017 8.13168 21.2667 6.98834C21.4417 6.68501 21.4883 6.32334 21.395 5.97334C21.3017 5.62334 21.08 5.34334 20.7767 5.15668L18.7583 4.00168C18.2567 3.69834 17.5917 3.87334 17.2883 4.38668L17.16 4.60834C16.495 5.76334 15.5267 6.41668 14.4883 6.41668C13.45 6.41668 12.4817 5.76334 11.8167 4.60834L11.6883 4.37501C11.3967 3.88501 10.7433 3.71001 10.2417 4.00168L8.22334 5.16834C7.92001 5.34334 7.68668 5.63501 7.59334 5.98501C7.50001 6.33501 7.54668 6.69668 7.72168 7.00001C8.38668 8.14334 8.46834 9.32168 7.95501 10.22C7.44168 11.1183 6.38001 11.6317 5.05001 11.6317C4.30334 11.6317 3.70834 12.2267 3.70834 12.9733V15.0267C3.70834 15.7617 4.30334 16.3683 5.05001 16.3683C6.38001 16.3683 7.44168 16.8817 7.95501 17.78C8.46834 18.6783 8.38668 19.8567 7.72168 21C7.54668 21.3033 7.50001 21.665 7.59334 22.015C7.68668 22.365 7.90834 22.645 8.21168 22.8317L10.23 23.9867C10.475 24.1383 10.7667 24.1733 11.035 24.1033C11.315 24.0333 11.5483 23.8467 11.7 23.6017L11.8283 23.38C12.4933 22.2367 13.4617 21.5717 14.5 21.5717Z",fill:"currentColor"})),ri=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M18.2099 13.1289L9.98776 20.3232C9.01788 21.1719 7.5 20.4831 7.5 19.1943L7.5 4.80565C7.5 3.51691 9.01788 2.82815 9.98775 3.67678L18.2099 10.8711C18.8929 11.4688 18.8929 12.5312 18.2099 13.1289Z",fill:"currentColor"}));function ft({icon:s,text:p,rightIcon:C,className:w}){return h.jsxs("div",{className:Ee("flex items-center justify-between p-2 hover:bg-[#5C5D62] rounded",w),children:[h.jsxs("div",{className:"flex items-center gap-2",children:[s,p]}),C&&h.jsx("div",{className:"flex items-center",children:C})]})}const en=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.781 10.5L13.281 3H12.2205L4.72049 10.5L5.78099 11.5605L12 5.3415V21H13.5V5.34L19.719 11.5605L20.781 10.5Z",fill:"currentColor"})),tn=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.72049 13.5L12.2205 21H13.281L20.781 13.5L19.7205 12.4395L13.5 18.6585V3H12V18.66L5.78099 12.438L4.72049 13.5Z",fill:"currentcolor"})),sn=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 12 14",fill:"none",...s},H.createElement("path",{d:"M9.79249 10.1936C10.2876 10.1936 10.6902 10.5962 10.6902 11.0913C10.6902 11.5864 10.2876 11.989 9.79249 11.989C9.29739 11.989 8.89478 11.5864 8.89478 11.0913C8.89478 10.5962 9.29739 10.1936 9.79249 10.1936ZM9.79249 9.10547C8.69891 9.10547 7.80664 9.99774 7.80664 11.0913C7.80664 12.1849 8.69891 13.0772 9.79249 13.0772C10.8861 13.0772 11.7783 12.1849 11.7783 11.0913C11.7783 9.99774 10.8861 9.10547 9.79249 9.10547Z",fill:"currentColor"}),H.createElement("path",{d:"M2.23585 10.1936C2.73095 10.1936 3.13356 10.5962 3.13356 11.0913C3.13356 11.5864 2.73095 11.989 2.23585 11.989C1.74075 11.989 1.33814 11.5864 1.33814 11.0913C1.33814 10.5962 1.74075 10.1936 2.23585 10.1936ZM2.23585 9.10547C1.14227 9.10547 0.25 9.99774 0.25 11.0913C0.25 12.1849 1.14227 13.0772 2.23585 13.0772C3.32943 13.0772 4.2217 12.1849 4.2217 11.0913C4.2217 9.99774 3.32943 9.10547 2.23585 9.10547Z",fill:"currentColor"}),H.createElement("path",{d:"M2.23585 2.16846C2.73095 2.16846 3.13356 2.57107 3.13356 3.06617C3.13356 3.56128 2.73095 3.96389 2.23585 3.96389C1.74075 3.96389 1.33814 3.56128 1.33814 3.06617C1.33814 2.57107 1.74075 2.16846 2.23585 2.16846ZM2.23585 1.08032C1.14227 1.08032 0.25 1.97259 0.25 3.06617C0.25 4.15975 1.14227 5.05202 2.23585 5.05202C3.32943 5.05202 4.2217 4.15975 4.2217 3.06617C4.2217 1.97259 3.32943 1.08032 2.23585 1.08032Z",fill:"currentColor"}),H.createElement("path",{d:"M2.23633 9.17627V4.55713",stroke:"currentColor",strokeMiterlimit:10}),H.createElement("path",{d:"M9.79304 9.17605V4.33928C9.79304 3.63743 9.22176 3.06616 8.51992 3.06616H7.38281",stroke:"currentColor",strokeMiterlimit:10}),H.createElement("path",{d:"M7.38191 5.21531L5.23828 3.06624L7.38191 0.922607V5.21531Z",fill:"currentColor"})),vs="cursor-pointer p-0 h-auto hover:bg-transparent !w-auto whitespace-nowrap";function Dl({onClose:s}){const{t:p}=ge(),{setMessageToSend:C}=gt(),{data:w}=_t(),k=w?.git_provider,j=()=>{C(Di()),s()},I=()=>{C(Ii(k)),s()},o=()=>{C(ji(k)),s()},n=()=>{C(mo()),s()};return h.jsxs(us,{testId:"git-tools-submenu",className:"text-white bg-tertiary rounded-[6px] py-[6px] px-1 flex flex-col gap-2 w-max",children:[h.jsx(Fe,{testId:"git-pull-button",onClick:j,className:vs,children:h.jsx(ft,{icon:h.jsx(tn,{width:16,height:16}),text:p(Z.COMMON$GIT_PULL),className:je})}),h.jsx(Fe,{testId:"git-push-button",onClick:I,className:vs,children:h.jsx(ft,{icon:h.jsx(en,{width:16,height:16}),text:p(Z.COMMON$GIT_PUSH),className:je})}),h.jsx(Fe,{testId:"create-pr-button",onClick:o,className:vs,children:h.jsx(ft,{icon:h.jsx(sn,{width:16,height:16}),text:p(Z.COMMON$CREATE_PR),className:je})}),h.jsx(Fe,{testId:"create-new-branch-button",onClick:n,className:vs,children:h.jsx(ft,{icon:h.jsx(wr,{width:16,height:16}),text:p(Z.COMMON$CREATE_NEW_BRANCH),className:je})})]})}const Il=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:25,viewBox:"0 0 24 25",fill:"none",...s},H.createElement("path",{d:"M15.29 10.79L12.51 13.57C12.3436 13.5257 12.1723 13.5022 12 13.5C11.4696 13.5 10.9609 13.7107 10.5858 14.0858C10.2107 14.4609 10 14.9696 10 15.5C10.0023 15.6722 10.0258 15.8435 10.07 16.01L9.29003 16.79C9.1963 16.883 9.12191 16.9936 9.07114 17.1154C9.02037 17.2373 8.99423 17.368 8.99423 17.5C8.99423 17.632 9.02037 17.7627 9.07114 17.8846C9.12191 18.0064 9.1963 18.117 9.29003 18.21C9.38299 18.3037 9.49359 18.3781 9.61545 18.4289C9.73731 18.4797 9.86802 18.5058 10 18.5058C10.132 18.5058 10.2627 18.4797 10.3846 18.4289C10.5065 18.3781 10.6171 18.3037 10.71 18.21L11.49 17.43C11.6565 17.4743 11.8278 17.4978 12 17.5C12.5305 17.5 13.0392 17.2893 13.4142 16.9142C13.7893 16.5391 14 16.0304 14 15.5C13.9978 15.3278 13.9743 15.1565 13.93 14.99L16.71 12.21C16.8983 12.0217 17.0041 11.7663 17.0041 11.5C17.0041 11.2337 16.8983 10.9783 16.71 10.79C16.5217 10.6017 16.2663 10.4959 16 10.4959C15.7337 10.4959 15.4783 10.6017 15.29 10.79ZM12 4.5C10.6868 4.5 9.38645 4.75866 8.1732 5.2612C6.95994 5.76375 5.85755 6.50035 4.92896 7.42893C3.0536 9.3043 2.00003 11.8478 2.00003 14.5C1.99511 16.4806 2.58375 18.4172 3.69003 20.06C3.83855 20.2801 4.06844 20.4322 4.32911 20.4829C4.58979 20.5335 4.8599 20.4785 5.08003 20.33C5.30016 20.1815 5.45227 19.9516 5.50291 19.6909C5.55354 19.4302 5.49855 19.1601 5.35003 18.94C4.54455 17.7355 4.08131 16.3349 4.00978 14.8877C3.93826 13.4405 4.26113 12.001 4.94392 10.723C5.62671 9.44501 6.64378 8.37643 7.88653 7.63139C9.12928 6.88634 10.5511 6.49281 12 6.49281C13.449 6.49281 14.8708 6.88634 16.1135 7.63139C17.3563 8.37643 18.3734 9.44501 19.0561 10.723C19.7389 12.001 20.0618 13.4405 19.9903 14.8877C19.9188 16.3349 19.4555 17.7355 18.65 18.94C18.5763 19.0489 18.5248 19.1714 18.4985 19.3002C18.4722 19.4291 18.4716 19.5619 18.4966 19.691C18.5217 19.8201 18.572 19.943 18.6447 20.0527C18.7173 20.1623 18.8109 20.2566 18.92 20.33C19.0856 20.4412 19.2806 20.5004 19.48 20.5C19.6438 20.5002 19.8052 20.4603 19.9499 20.3835C20.0946 20.3068 20.2183 20.1957 20.31 20.06C21.4163 18.4172 22.005 16.4806 22 14.5C22 11.8478 20.9465 9.3043 19.0711 7.42893C17.1957 5.55357 14.6522 4.5 12 4.5Z",fill:"currentColor"})),jl=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 20 21",fill:"none",...s},H.createElement("path",{d:"M15.9532 15.8037C16.7679 15.8037 17.4304 16.4662 17.4304 17.2809C17.4304 18.0955 16.7679 18.758 15.9532 18.758C15.1385 18.758 14.4761 18.0955 14.4761 17.2809C14.4761 16.4662 15.1385 15.8037 15.9532 15.8037ZM15.9532 14.0132C14.1538 14.0132 12.6855 15.4814 12.6855 17.2809C12.6855 19.0803 14.1538 20.5485 15.9532 20.5485C17.7527 20.5485 19.2209 19.0803 19.2209 17.2809C19.2209 15.4814 17.7527 14.0132 15.9532 14.0132Z",fill:"currentColor"}),H.createElement("path",{d:"M3.51768 15.8037C4.33236 15.8037 4.99485 16.4662 4.99485 17.2809C4.99485 18.0955 4.33236 18.758 3.51768 18.758C2.703 18.758 2.04051 18.0955 2.04051 17.2809C2.04051 16.4662 2.703 15.8037 3.51768 15.8037ZM3.51768 14.0132C1.71822 14.0132 0.25 15.4814 0.25 17.2809C0.25 19.0803 1.71822 20.5485 3.51768 20.5485C5.31714 20.5485 6.78536 19.0803 6.78536 17.2809C6.78536 15.4814 5.31714 14.0132 3.51768 14.0132Z",fill:"currentColor"}),H.createElement("path",{d:"M3.51768 2.59862C4.33236 2.59862 4.99485 3.2611 4.99485 4.07579C4.99485 4.89047 4.33236 5.55296 3.51768 5.55296C2.703 5.55296 2.04051 4.89047 2.04051 4.07579C2.04051 3.2611 2.703 2.59862 3.51768 2.59862ZM3.51768 0.808105C1.71822 0.808105 0.25 2.27632 0.25 4.07579C0.25 5.87525 1.71822 7.34347 3.51768 7.34347C5.31714 7.34347 6.78536 5.87525 6.78536 4.07579C6.78536 2.27632 5.31714 0.808105 3.51768 0.808105Z",fill:"currentColor"}),H.createElement("path",{d:"M3.51758 14.1295V6.52881",stroke:"currentColor",strokeWidth:2,strokeMiterlimit:10}),H.createElement("path",{d:"M15.9523 14.1294V6.17058C15.9523 5.0157 15.0123 4.07568 13.8574 4.07568H11.9863",stroke:"currentColor",strokeWidth:2,strokeMiterlimit:10}),H.createElement("path",{d:"M11.9863 7.6119L8.45898 4.07565L11.9863 0.54834V7.6119Z",fill:"currentColor"})),Nl=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M4 4C4 2.89543 4.89543 2 6 2H14C14.2652 2 14.5196 2.10536 14.7071 2.29289L19.7071 7.29289C19.8946 7.48043 20 7.73478 20 8V20C20 21.1046 19.1046 22 18 22H6C4.89543 22 4 21.1046 4 20V4ZM17.5858 8L14 4.41421V8H17.5858ZM12 4L6 4V20H18V10H13C12.4477 10 12 9.55228 12 9V4ZM8 13C8 12.4477 8.44772 12 9 12H15C15.5523 12 16 12.4477 16 13C16 13.5523 15.5523 14 15 14H9C8.44772 14 8 13.5523 8 13ZM8 17C8 16.4477 8.44772 16 9 16H15C15.5523 16 16 16.4477 16 17C16 17.5523 15.5523 18 15 18H9C8.44772 18 8 17.5523 8 17Z",fill:"currentColor"})),Bl=s=>H.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M2.71996 7.64998C2.91552 7.7074 3.10351 7.78797 3.27996 7.88998C3.89978 8.25991 4.60814 8.45523 5.32996 8.45523C6.05178 8.45523 6.76015 8.25991 7.37996 7.88998C7.77042 7.66914 8.21137 7.55307 8.65996 7.55307C9.10855 7.55307 9.5495 7.66914 9.93996 7.88998C10.5673 8.24867 11.2773 8.43735 12 8.43735C12.7226 8.43735 13.4327 8.24867 14.06 7.88998C14.4504 7.66914 14.8914 7.55307 15.34 7.55307C15.7885 7.55307 16.2295 7.66914 16.62 7.88998C17.2537 8.25217 17.97 8.44503 18.7 8.44998C19.4051 8.44852 20.0966 8.25492 20.7 7.88998C20.8764 7.78797 21.0644 7.7074 21.26 7.64998C21.5146 7.57572 21.7292 7.40336 21.8568 7.17081C21.9843 6.93827 22.0142 6.66459 21.94 6.40998C21.8657 6.15537 21.6933 5.94069 21.4608 5.81317C21.2282 5.68564 20.9546 5.65572 20.7 5.72998C20.3494 5.83818 20.0135 5.98932 19.7 6.17998C19.3814 6.36627 19.019 6.46446 18.65 6.46446C18.2809 6.46446 17.9185 6.36627 17.6 6.17998C16.9066 5.79105 16.1249 5.58679 15.33 5.58679C14.535 5.58679 13.7533 5.79105 13.06 6.17998C12.738 6.36703 12.3723 6.46556 12 6.46556C11.6276 6.46556 11.2619 6.36703 10.94 6.17998C10.2466 5.79105 9.46495 5.58679 8.66996 5.58679C7.87497 5.58679 7.09332 5.79105 6.39996 6.17998C6.08139 6.36627 5.719 6.46446 5.34996 6.46446C4.98092 6.46446 4.61853 6.36627 4.29996 6.17998C3.98645 5.98932 3.65057 5.83818 3.29996 5.72998C3.04535 5.65572 2.77167 5.68564 2.53913 5.81317C2.30658 5.94069 2.13422 6.15537 2.05996 6.40998C1.9857 6.66459 2.01562 6.93827 2.14315 7.17081C2.27067 7.40336 2.48535 7.57572 2.73996 7.64998H2.71996ZM20.72 15.73C20.3694 15.8382 20.0335 15.9893 19.72 16.18C19.4014 16.3663 19.039 16.4645 18.67 16.4645C18.3009 16.4645 17.9385 16.3663 17.62 16.18C16.9266 15.7911 16.1449 15.5868 15.35 15.5868C14.555 15.5868 13.7733 15.7911 13.08 16.18C12.758 16.367 12.3923 16.4656 12.02 16.4656C11.6476 16.4656 11.2819 16.367 10.96 16.18C10.2666 15.7911 9.48495 15.5868 8.68996 15.5868C7.89497 15.5868 7.11332 15.7911 6.41996 16.18C6.10139 16.3663 5.739 16.4645 5.36996 16.4645C5.00092 16.4645 4.63853 16.3663 4.31996 16.18C4.00645 15.9893 3.67057 15.8382 3.31996 15.73C3.19389 15.6932 3.06182 15.6816 2.93127 15.6959C2.80073 15.7102 2.67427 15.75 2.55913 15.8132C2.44398 15.8763 2.3424 15.9615 2.26019 16.0639C2.17797 16.1663 2.11673 16.2839 2.07996 16.41C2.04319 16.536 2.03161 16.6681 2.04589 16.7987C2.06016 16.9292 2.1 17.0557 2.16315 17.1708C2.22629 17.286 2.3115 17.3875 2.4139 17.4698C2.5163 17.552 2.63389 17.6132 2.75996 17.65C2.95552 17.7074 3.14351 17.788 3.31996 17.89C3.93978 18.2599 4.64814 18.4552 5.36996 18.4552C6.09178 18.4552 6.80015 18.2599 7.41996 17.89C7.81042 17.6691 8.25137 17.5531 8.69996 17.5531C9.14855 17.5531 9.5895 17.6691 9.97996 17.89C10.6073 18.2487 11.3173 18.4374 12.04 18.4374C12.7626 18.4374 13.4727 18.2487 14.1 17.89C14.4904 17.6691 14.9314 17.5531 15.38 17.5531C15.8285 17.5531 16.2695 17.6691 16.66 17.89C17.2937 18.2522 18.01 18.445 18.74 18.45C19.4451 18.4485 20.1366 18.2549 20.74 17.89C20.9164 17.788 21.1044 17.7074 21.3 17.65C21.5546 17.5757 21.7692 17.4034 21.8968 17.1708C22.0243 16.9383 22.0542 16.6646 21.98 16.41C21.9057 16.1554 21.7333 15.9407 21.5008 15.8132C21.2682 15.6856 20.9946 15.6557 20.74 15.73H20.72ZM20.72 10.73C20.3694 10.8382 20.0335 10.9893 19.72 11.18C19.4014 11.3663 19.039 11.4645 18.67 11.4645C18.3009 11.4645 17.9385 11.3663 17.62 11.18C16.9266 10.7911 16.1449 10.5868 15.35 10.5868C14.555 10.5868 13.7733 10.7911 13.08 11.18C12.758 11.367 12.3923 11.4656 12.02 11.4656C11.6476 11.4656 11.2819 11.367 10.96 11.18C10.2666 10.7911 9.48495 10.5868 8.68996 10.5868C7.89497 10.5868 7.11332 10.7911 6.41996 11.18C6.10139 11.3663 5.739 11.4645 5.36996 11.4645C5.00092 11.4645 4.63853 11.3663 4.31996 11.18C4.00645 10.9893 3.67057 10.8382 3.31996 10.73C3.18902 10.6805 3.04917 10.6591 2.90944 10.6672C2.76971 10.6752 2.63322 10.7125 2.5088 10.7766C2.38438 10.8406 2.2748 10.9301 2.18715 11.0393C2.0995 11.1484 2.03573 11.2747 1.99996 11.41C1.96319 11.536 1.95161 11.6681 1.96589 11.7987C1.98016 11.9292 2.02 12.0557 2.08315 12.1708C2.14629 12.286 2.2315 12.3875 2.3339 12.4698C2.4363 12.552 2.55389 12.6132 2.67996 12.65C2.87552 12.7074 3.06351 12.788 3.23996 12.89C3.85978 13.2599 4.56814 13.4552 5.28996 13.4552C6.01178 13.4552 6.72015 13.2599 7.33996 12.89C7.73042 12.6691 8.17137 12.5531 8.61996 12.5531C9.06855 12.5531 9.5095 12.6691 9.89996 12.89C10.5273 13.2487 11.2373 13.4374 11.96 13.4374C12.6826 13.4374 13.3927 13.2487 14.02 12.89C14.4104 12.6691 14.8514 12.5531 15.3 12.5531C15.7485 12.5531 16.1895 12.6691 16.58 12.89C17.2137 13.2522 17.93 13.445 18.66 13.45C19.3651 13.4485 20.0566 13.2549 20.66 12.89C20.8364 12.788 21.0244 12.7074 21.22 12.65C21.4746 12.5757 21.6892 12.4034 21.8168 12.1708C21.9443 11.9383 21.9742 11.6646 21.9 11.41C21.8257 11.1554 21.6533 10.9407 21.4208 10.8132C21.1882 10.6856 20.9146 10.6557 20.66 10.73H20.72Z",fill:"currentColor"})),Pl="INCREASE_TEST_COVERAGE",Fl=`I want to increase the test coverage of the repository in the current directory.

Please investigate the repo to figure out what language is being used, and where tests are located, if there are any.

If there are no tests already in the repo, add a very basic test, using typical testing strategies for the language involved.

If there are existing tests, find a function or method which lacks adequate unit tests, and add unit tests for it. Be sure to respect the projects existing test structures.

Make sure the tests pass before you finish.`,Hl="AUTO_MERGE_PRS",$l="Please add a GitHub action to this repository which automatically merges pull requests from Dependabot so long as the tests are passing.",Ul="FIX_README",Wl=`Please look at the README and make the following improvements, if they make sense:
* correct any typos that you find
* add missing language annotations on codeblocks
* if there are references to other files or other sections of the README, turn them into links
* make sure the readme has an h1 title towards the top
* make sure any existing sections in the readme are appropriately separated with headings

If there are no obvious ways to improve the README, make at least one small change to make the wording clearer or friendlier`,Vl="CLEAN_DEPENDENCIES",zl=`Examine the dependencies of the current codebase. Make sure you can run the code and any tests.

Then run any commands necessary to update all dependencies to the latest versions, and make sure the code continues to run correctly and the tests pass. If changes need to be made to the codebase, go ahead and make those changes. You can look up documentation for new versions using the browser if you need to.

If a particular dependency update is causing trouble (e.g. breaking changes that you can't fix), you can revert it and send a message to the user explaining why.

Additionally, if you're able to prune any dependencies that are obviously unused, please do so. You may use third party tools to check for unused dependencies.`,bs={[Pl]:Fl,[Hl]:$l,[Ul]:Wl,[Vl]:zl},Cs="cursor-pointer p-0 h-auto hover:bg-transparent !w-auto whitespace-nowrap";function Kl({onClose:s}){const{t:p}=ge(),{setMessageToSend:C}=gt(),w=()=>{C(bs.INCREASE_TEST_COVERAGE),s()},k=()=>{C(bs.FIX_README),s()},j=()=>{C(bs.AUTO_MERGE_PRS),s()},I=()=>{C(bs.CLEAN_DEPENDENCIES),s()};return h.jsxs(us,{testId:"macros-submenu",className:"overflow-visible",children:[h.jsx(Fe,{testId:"increase-test-coverage-button",onClick:w,className:Cs,children:h.jsx(ft,{icon:h.jsx(Il,{width:16,height:16}),text:p(Z.INCREASE_TEST_COVERAGE),className:je})}),h.jsx(Fe,{testId:"fix-readme-button",onClick:k,className:Cs,children:h.jsx(ft,{icon:h.jsx(Nl,{width:16,height:16}),text:p(Z.FIX_README),className:je})}),h.jsx(Fe,{testId:"auto-merge-prs-button",onClick:j,className:Cs,children:h.jsx(ft,{icon:h.jsx(jl,{width:16,height:16}),text:p(Z.AUTO_MERGE_PRS),className:je})}),h.jsx(Fe,{testId:"clean-dependencies-button",onClick:I,className:Cs,children:h.jsx(ft,{icon:h.jsx(Bl,{width:16,height:16}),text:p(Z.CLEAN_DEPENDENCIES),className:je})})]})}const Ss=Ee("cursor-pointer p-0 h-auto hover:bg-transparent",je);function ql({onClose:s,onShowMicroagents:p,onShowAgentTools:C}){const{t:w}=ge(),{data:k}=_t(),{providers:j}=Jt(),[I,o]=H.useState(null),n=!!k?.selected_repository,u=j.length>0,m=n&&u,c=S=>{o(I===S?null:S)},f=()=>{o(null),s()},v=Er(f);return h.jsxs(us,{ref:v,testId:"tools-context-menu",position:"top",alignment:"left",className:"left-[-16px] mb-2 bottom-full overflow-visible",children:[m&&h.jsxs("div",{className:"relative group/git",children:[h.jsx(Fe,{testId:"git-tools-button",onClick:()=>c("git"),className:Ss,children:h.jsx(ft,{icon:h.jsx(wr,{width:16,height:16}),text:w(Z.COMMON$GIT_TOOLS),rightIcon:h.jsx(ri,{width:10,height:10}),className:je})}),h.jsx("div",{className:Ee("absolute left-full top-[-6px] z-60 opacity-0 invisible pointer-events-none transition-all duration-200 ml-[1px]","group-hover/git:opacity-100 group-hover/git:visible group-hover/git:pointer-events-auto","hover:opacity-100 hover:visible hover:pointer-events-auto",I==="git"&&"opacity-100 visible pointer-events-auto"),children:h.jsx(Dl,{onClose:f})})]}),h.jsxs("div",{className:"relative group/macros",children:[h.jsx(Fe,{testId:"macros-button",onClick:()=>c("macros"),className:Ss,children:h.jsx(ft,{icon:h.jsx(Ol,{width:16,height:16}),text:w(Z.COMMON$MACROS),rightIcon:h.jsx(ri,{width:10,height:10}),className:je})}),h.jsx("div",{className:Ee("absolute left-full top-[-4px] z-60 opacity-0 invisible pointer-events-none transition-all duration-200 ml-[1px]","group-hover/macros:opacity-100 group-hover/macros:visible group-hover/macros:pointer-events-auto","hover:opacity-100 hover:visible hover:pointer-events-auto",I==="macros"&&"opacity-100 visible pointer-events-auto"),children:h.jsx(Kl,{onClose:f})})]}),h.jsx(ys,{}),h.jsx(Fe,{testId:"show-microagents-button",onClick:p,className:Ss,children:h.jsx(ft,{icon:h.jsx(Xi,{width:16,height:16}),text:w(Z.CONVERSATION$SHOW_MICROAGENTS),className:je})}),h.jsx(Fe,{testId:"show-agent-tools-button",onClick:C,className:Ss,children:h.jsx(ft,{icon:h.jsx(Qi,{width:16,height:16}),text:w(Z.BUTTON$SHOW_AGENT_TOOLS_AND_METADATA),className:je})})]})}function Gl(s){if(!s)return null;try{const p=new URL(s);return p.hostname==="localhost"&&window.location.hostname!=="localhost"?(p.hostname=window.location.hostname,p.toString()):s}catch{return s}}const Zl=()=>{const s=jt();return $t({mutationFn:p=>st.deleteUserConversation(p.conversationId),onMutate:async p=>{await s.cancelQueries({queryKey:["user","conversations"]});const C=s.getQueryData(["user","conversations"]);return s.setQueryData(["user","conversations"],w=>w?.filter(k=>k.conversation_id!==p.conversationId)),{previousConversations:C}},onError:(p,C,w)=>{w?.previousConversations&&s.setQueryData(["user","conversations"],w.previousConversations)},onSettled:()=>{s.invalidateQueries({queryKey:["user","conversations"]})}})},Jl=()=>$t({mutationFn:s=>st.getTrajectory(s)}),ii=(s,p)=>{const C=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),w=URL.createObjectURL(C),k=document.createElement("a");k.href=w,k.download=p,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(w)};function Yl(){return typeof window<"u"&&"showSaveFilePicker"in window}async function Xl(s,p){const C=p||{};if(!Yl()){ii(C,`trajectory-${s}.json`);return}try{const w={suggestedName:`trajectory-${s}.json`,types:[{description:"JSON File",accept:{"application/json":[".json"]}}]},j=await(await window.showSaveFilePicker(w)).createWritable();await j.write(JSON.stringify(p,null,2)),await j.close()}catch(w){w instanceof Error&&w.name!=="AbortError"&&ii(C,`trajectory-${s}.json`)}}function rn({conversationId:s,conversationStatus:p="STOPPED",showOptions:C=!1,onContextMenuToggle:w}){const{t:k}=ge(),{conversationId:j}=ls(),I=ar(),o=Ms(F=>F.events),{mutate:n}=Zl(),{mutate:u}=Yi(),{mutate:m}=Jl(),c=Si(),[f,v]=pe.useState(!1),[S,g]=pe.useState(!1),[a,t]=pe.useState(!1),[e,r]=pe.useState(!1),[i,_]=pe.useState(!1),l=o.filter(xs).filter(Es).find(Vn);return{handleDelete:F=>{F.preventDefault(),F.stopPropagation(),r(!0),w?.(!1)},handleStop:F=>{F.preventDefault(),F.stopPropagation(),_(!0),w?.(!1)},handleEdit:F=>{F.preventDefault(),F.stopPropagation(),w?.(!1)},handleExportConversation:F=>{if(F.preventDefault(),F.stopPropagation(),!s){pt(k(Z.CONVERSATION$DOWNLOAD_ERROR));return}m(s,{onSuccess:async ee=>{await Xl(s??k(Z.CONVERSATION$UNKNOWN),ee.trajectory)},onError:()=>{pt(k(Z.CONVERSATION$DOWNLOAD_ERROR))}}),w?.(!1)},handleDownloadViaVSCode:async F=>{if(F.preventDefault(),F.stopPropagation(),Wt.capture("download_via_vscode_button_clicked"),s)try{const ee=await st.getVSCodeUrl(s);if(ee.vscode_url){const L=Gl(ee.vscode_url);L&&window.open(L,"_blank")}}catch{}w?.(!1)},handleDisplayCost:F=>{F.stopPropagation(),v(!0),w?.(!1)},handleShowAgentTools:F=>{F.stopPropagation(),g(!0),w?.(!1)},handleShowMicroagents:F=>{F.stopPropagation(),t(!0),w?.(!1)},handleConfirmDelete:()=>{s&&n({conversationId:s},{onSuccess:()=>{s===j&&I("/")}}),r(!1)},handleConfirmStop:()=>{s&&u({conversationId:s}),_(!1)},metricsModalVisible:f,setMetricsModalVisible:v,systemModalVisible:S,setSystemModalVisible:g,microagentsModalVisible:a,setMicroagentsModalVisible:t,confirmDeleteModalVisible:e,setConfirmDeleteModalVisible:r,confirmStopModalVisible:i,setConfirmStopModalVisible:_,metrics:c,systemMessage:l,shouldShowStop:p!=="STOPPED",shouldShowDownload:!!(s&&C),shouldShowExport:!!(s&&C),shouldShowDisplayCost:C,shouldShowAgentTools:!!(C&&l),shouldShowMicroagents:!!(C&&s)}}function Ql({agentClass:s,openhandsVersion:p}){const{t:C}=ge();return h.jsxs("div",{className:"flex flex-col gap-6 w-full",children:[h.jsx(cs,{title:C("SYSTEM_MESSAGE_MODAL$TITLE")}),h.jsxs("div",{className:"flex flex-col gap-2",children:[s&&h.jsxs("div",{className:"text-sm",children:[h.jsx(Te.Text,{className:"font-semibold text-gray-300",children:C("SYSTEM_MESSAGE_MODAL$AGENT_CLASS")})," ",h.jsx(Te.Text,{className:"font-medium text-gray-100",children:s})]}),p&&h.jsxs("div",{className:"text-sm",children:[h.jsx(Te.Text,{className:"font-semibold text-gray-300",children:C("SYSTEM_MESSAGE_MODAL$OPENHANDS_VERSION")})," ",h.jsx(Te.Text,{className:"text-gray-100",children:p})]})]})]})}function ni({isActive:s,children:p,onClick:C,className:w,disabled:k=!1}){return h.jsx("button",{type:"button",disabled:k,className:Ee("px-4 py-2 font-medium border-b-2 transition-colors",s?"border-primary text-gray-100":"border-transparent hover:text-gray-700 dark:hover:text-gray-300",k&&"opacity-50 cursor-not-allowed",w),onClick:C,"aria-selected":s,role:"tab",children:p})}function ec({activeTab:s,onTabChange:p,hasTools:C}){const{t:w}=ge();return h.jsxs("div",{className:"flex border-b mb-2",role:"tablist",children:[h.jsx(ni,{isActive:s==="system",onClick:()=>p("system"),children:w("SYSTEM_MESSAGE_MODAL$SYSTEM_MESSAGE_TAB")}),C&&h.jsx(ni,{isActive:s==="tools",onClick:()=>p("tools"),children:w("SYSTEM_MESSAGE_MODAL$TOOLS_TAB")})]})}function tc({content:s}){return h.jsx("div",{className:"p-4 shadow-inner",children:h.jsx(Te.CodeBlock,{children:s})})}var ws={exports:{}},sc=ws.exports,oi;function rc(){return oi||(oi=1,(function(s,p){(function(C,w){s.exports=w(Fn())})(sc,(C=>(()=>{var w={9735:(o,n)=>{n.__esModule=!0,n.default={scheme:"apathy",author:"jannik siebert (https://github.com/janniks)",base00:"#031A16",base01:"#0B342D",base02:"#184E45",base03:"#2B685E",base04:"#5F9C92",base05:"#81B5AC",base06:"#A7CEC8",base07:"#D2E7E4",base08:"#3E9688",base09:"#3E7996",base0A:"#3E4C96",base0B:"#883E96",base0C:"#963E4C",base0D:"#96883E",base0E:"#4C963E",base0F:"#3E965B"},o.exports=n.default},294:(o,n)=>{n.__esModule=!0,n.default={scheme:"ashes",author:"jannik siebert (https://github.com/janniks)",base00:"#1C2023",base01:"#393F45",base02:"#565E65",base03:"#747C84",base04:"#ADB3BA",base05:"#C7CCD1",base06:"#DFE2E5",base07:"#F3F4F5",base08:"#C7AE95",base09:"#C7C795",base0A:"#AEC795",base0B:"#95C7AE",base0C:"#95AEC7",base0D:"#AE95C7",base0E:"#C795AE",base0F:"#C79595"},o.exports=n.default},1733:(o,n)=>{n.__esModule=!0,n.default={scheme:"atelier dune",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/dune)",base00:"#20201d",base01:"#292824",base02:"#6e6b5e",base03:"#7d7a68",base04:"#999580",base05:"#a6a28c",base06:"#e8e4cf",base07:"#fefbec",base08:"#d73737",base09:"#b65611",base0A:"#cfb017",base0B:"#60ac39",base0C:"#1fad83",base0D:"#6684e1",base0E:"#b854d4",base0F:"#d43552"},o.exports=n.default},8974:(o,n)=>{n.__esModule=!0,n.default={scheme:"atelier forest",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/forest)",base00:"#1b1918",base01:"#2c2421",base02:"#68615e",base03:"#766e6b",base04:"#9c9491",base05:"#a8a19f",base06:"#e6e2e0",base07:"#f1efee",base08:"#f22c40",base09:"#df5320",base0A:"#d5911a",base0B:"#5ab738",base0C:"#00ad9c",base0D:"#407ee7",base0E:"#6666ea",base0F:"#c33ff3"},o.exports=n.default},6933:(o,n)=>{n.__esModule=!0,n.default={scheme:"atelier heath",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/heath)",base00:"#1b181b",base01:"#292329",base02:"#695d69",base03:"#776977",base04:"#9e8f9e",base05:"#ab9bab",base06:"#d8cad8",base07:"#f7f3f7",base08:"#ca402b",base09:"#a65926",base0A:"#bb8a35",base0B:"#379a37",base0C:"#159393",base0D:"#516aec",base0E:"#7b59c0",base0F:"#cc33cc"},o.exports=n.default},523:(o,n)=>{n.__esModule=!0,n.default={scheme:"atelier lakeside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/lakeside/)",base00:"#161b1d",base01:"#1f292e",base02:"#516d7b",base03:"#5a7b8c",base04:"#7195a8",base05:"#7ea2b4",base06:"#c1e4f6",base07:"#ebf8ff",base08:"#d22d72",base09:"#935c25",base0A:"#8a8a0f",base0B:"#568c3b",base0C:"#2d8f6f",base0D:"#257fad",base0E:"#5d5db1",base0F:"#b72dd2"},o.exports=n.default},1223:(o,n)=>{n.__esModule=!0,n.default={scheme:"atelier seaside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/seaside/)",base00:"#131513",base01:"#242924",base02:"#5e6e5e",base03:"#687d68",base04:"#809980",base05:"#8ca68c",base06:"#cfe8cf",base07:"#f0fff0",base08:"#e6193c",base09:"#87711d",base0A:"#c3c322",base0B:"#29a329",base0C:"#1999b3",base0D:"#3d62f5",base0E:"#ad2bee",base0F:"#e619c3"},o.exports=n.default},1233:(o,n)=>{n.__esModule=!0,n.default={scheme:"bespin",author:"jan t. sott",base00:"#28211c",base01:"#36312e",base02:"#5e5d5c",base03:"#666666",base04:"#797977",base05:"#8a8986",base06:"#9d9b97",base07:"#baae9e",base08:"#cf6a4c",base09:"#cf7d34",base0A:"#f9ee98",base0B:"#54be0d",base0C:"#afc4db",base0D:"#5ea6ea",base0E:"#9b859d",base0F:"#937121"},o.exports=n.default},2847:(o,n)=>{n.__esModule=!0,n.default={scheme:"brewer",author:"timothe poisot (http://github.com/tpoisot)",base00:"#0c0d0e",base01:"#2e2f30",base02:"#515253",base03:"#737475",base04:"#959697",base05:"#b7b8b9",base06:"#dadbdc",base07:"#fcfdfe",base08:"#e31a1c",base09:"#e6550d",base0A:"#dca060",base0B:"#31a354",base0C:"#80b1d3",base0D:"#3182bd",base0E:"#756bb1",base0F:"#b15928"},o.exports=n.default},8120:(o,n)=>{n.__esModule=!0,n.default={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"},o.exports=n.default},6305:(o,n)=>{n.__esModule=!0,n.default={scheme:"chalk",author:"chris kempson (http://chriskempson.com)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#eda987",base0A:"#ddb26f",base0B:"#acc267",base0C:"#12cfc0",base0D:"#6fc2ef",base0E:"#e1a3ee",base0F:"#deaf8f"},o.exports=n.default},525:(o,n)=>{n.__esModule=!0,n.default={scheme:"codeschool",author:"brettof86",base00:"#232c31",base01:"#1c3657",base02:"#2a343a",base03:"#3f4944",base04:"#84898c",base05:"#9ea7a6",base06:"#a7cfa3",base07:"#b5d8f6",base08:"#2a5491",base09:"#43820d",base0A:"#a03b1e",base0B:"#237986",base0C:"#b02f30",base0D:"#484d79",base0E:"#c59820",base0F:"#c98344"},o.exports=n.default},4124:(o,n)=>{n.__esModule=!0,n.default={scheme:"colors",author:"mrmrs (http://clrs.cc)",base00:"#111111",base01:"#333333",base02:"#555555",base03:"#777777",base04:"#999999",base05:"#bbbbbb",base06:"#dddddd",base07:"#ffffff",base08:"#ff4136",base09:"#ff851b",base0A:"#ffdc00",base0B:"#2ecc40",base0C:"#7fdbff",base0D:"#0074d9",base0E:"#b10dc9",base0F:"#85144b"},o.exports=n.default},7167:(o,n)=>{n.__esModule=!0,n.default={scheme:"default",author:"chris kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"},o.exports=n.default},4582:(o,n)=>{n.__esModule=!0,n.default={scheme:"eighties",author:"chris kempson (http://chriskempson.com)",base00:"#2d2d2d",base01:"#393939",base02:"#515151",base03:"#747369",base04:"#a09f93",base05:"#d3d0c8",base06:"#e8e6df",base07:"#f2f0ec",base08:"#f2777a",base09:"#f99157",base0A:"#ffcc66",base0B:"#99cc99",base0C:"#66cccc",base0D:"#6699cc",base0E:"#cc99cc",base0F:"#d27b53"},o.exports=n.default},7096:(o,n)=>{n.__esModule=!0,n.default={scheme:"embers",author:"jannik siebert (https://github.com/janniks)",base00:"#16130F",base01:"#2C2620",base02:"#433B32",base03:"#5A5047",base04:"#8A8075",base05:"#A39A90",base06:"#BEB6AE",base07:"#DBD6D1",base08:"#826D57",base09:"#828257",base0A:"#6D8257",base0B:"#57826D",base0C:"#576D82",base0D:"#6D5782",base0E:"#82576D",base0F:"#825757"},o.exports=n.default},9887:(o,n)=>{n.__esModule=!0,n.default={scheme:"flat",author:"chris kempson (http://chriskempson.com)",base00:"#2C3E50",base01:"#34495E",base02:"#7F8C8D",base03:"#95A5A6",base04:"#BDC3C7",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ECF0F1",base08:"#E74C3C",base09:"#E67E22",base0A:"#F1C40F",base0B:"#2ECC71",base0C:"#1ABC9C",base0D:"#3498DB",base0E:"#9B59B6",base0F:"#be643c"},o.exports=n.default},7199:(o,n)=>{n.__esModule=!0,n.default={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"},o.exports=n.default},1985:(o,n)=>{n.__esModule=!0,n.default={scheme:"grayscale",author:"alexandre gavioli (https://github.com/alexx2/)",base00:"#101010",base01:"#252525",base02:"#464646",base03:"#525252",base04:"#ababab",base05:"#b9b9b9",base06:"#e3e3e3",base07:"#f7f7f7",base08:"#7c7c7c",base09:"#999999",base0A:"#a0a0a0",base0B:"#8e8e8e",base0C:"#868686",base0D:"#686868",base0E:"#747474",base0F:"#5e5e5e"},o.exports=n.default},8093:(o,n)=>{n.__esModule=!0,n.default={scheme:"green screen",author:"chris kempson (http://chriskempson.com)",base00:"#001100",base01:"#003300",base02:"#005500",base03:"#007700",base04:"#009900",base05:"#00bb00",base06:"#00dd00",base07:"#00ff00",base08:"#007700",base09:"#009900",base0A:"#007700",base0B:"#00bb00",base0C:"#005500",base0D:"#009900",base0E:"#00bb00",base0F:"#005500"},o.exports=n.default},1615:(o,n)=>{n.__esModule=!0,n.default={scheme:"harmonic16",author:"jannik siebert (https://github.com/janniks)",base00:"#0b1c2c",base01:"#223b54",base02:"#405c79",base03:"#627e99",base04:"#aabcce",base05:"#cbd6e2",base06:"#e5ebf1",base07:"#f7f9fb",base08:"#bf8b56",base09:"#bfbf56",base0A:"#8bbf56",base0B:"#56bf8b",base0C:"#568bbf",base0D:"#8b56bf",base0E:"#bf568b",base0F:"#bf5656"},o.exports=n.default},9063:(o,n)=>{n.__esModule=!0,n.default={scheme:"hopscotch",author:"jan t. sott",base00:"#322931",base01:"#433b42",base02:"#5c545b",base03:"#797379",base04:"#989498",base05:"#b9b5b8",base06:"#d5d3d5",base07:"#ffffff",base08:"#dd464c",base09:"#fd8b19",base0A:"#fdcc59",base0B:"#8fc13e",base0C:"#149b93",base0D:"#1290bf",base0E:"#c85e7c",base0F:"#b33508"},o.exports=n.default},9446:(o,n,u)=>{function m(ce){return ce&&ce.__esModule?ce.default:ce}n.__esModule=!0;var c=u(1308);n.threezerotwofour=m(c);var f=u(9735);n.apathy=m(f);var v=u(294);n.ashes=m(v);var S=u(1733);n.atelierDune=m(S);var g=u(8974);n.atelierForest=m(g);var a=u(6933);n.atelierHeath=m(a);var t=u(523);n.atelierLakeside=m(t);var e=u(1223);n.atelierSeaside=m(e);var r=u(1233);n.bespin=m(r);var i=u(2847);n.brewer=m(i);var _=u(8120);n.bright=m(_);var l=u(6305);n.chalk=m(l);var b=u(525);n.codeschool=m(b);var d=u(4124);n.colors=m(d);var y=u(7167);n.default=m(y);var M=u(4582);n.eighties=m(M);var D=u(7096);n.embers=m(D);var N=u(9887);n.flat=m(N);var T=u(7199);n.google=m(T);var z=u(1985);n.grayscale=m(z);var J=u(8093);n.greenscreen=m(J);var ie=u(1615);n.harmonic=m(ie);var F=u(9063);n.hopscotch=m(F);var ee=u(9033);n.isotope=m(ee);var L=u(4112);n.marrakesh=m(L);var B=u(9600);n.mocha=m(B);var P=u(1240);n.monokai=m(P);var W=u(9768);n.ocean=m(W);var Q=u(8293);n.paraiso=m(Q);var ae=u(3093);n.pop=m(ae);var he=u(1951);n.railscasts=m(he);var me=u(6368);n.shapeshifter=m(me);var V=u(2317);n.solarized=m(V);var O=u(1091);n.summerfruit=m(O);var Y=u(6943);n.tomorrow=m(Y);var se=u(5670);n.tube=m(se);var le=u(2536);n.twilight=m(le)},9033:(o,n)=>{n.__esModule=!0,n.default={scheme:"isotope",author:"jan t. sott",base00:"#000000",base01:"#404040",base02:"#606060",base03:"#808080",base04:"#c0c0c0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#ff0000",base09:"#ff9900",base0A:"#ff0099",base0B:"#33ff00",base0C:"#00ffff",base0D:"#0066ff",base0E:"#cc00ff",base0F:"#3300ff"},o.exports=n.default},4112:(o,n)=>{n.__esModule=!0,n.default={scheme:"marrakesh",author:"alexandre gavioli (http://github.com/alexx2/)",base00:"#201602",base01:"#302e00",base02:"#5f5b17",base03:"#6c6823",base04:"#86813b",base05:"#948e48",base06:"#ccc37a",base07:"#faf0a5",base08:"#c35359",base09:"#b36144",base0A:"#a88339",base0B:"#18974e",base0C:"#75a738",base0D:"#477ca1",base0E:"#8868b3",base0F:"#b3588e"},o.exports=n.default},9600:(o,n)=>{n.__esModule=!0,n.default={scheme:"mocha",author:"chris kempson (http://chriskempson.com)",base00:"#3B3228",base01:"#534636",base02:"#645240",base03:"#7e705a",base04:"#b8afad",base05:"#d0c8c6",base06:"#e9e1dd",base07:"#f5eeeb",base08:"#cb6077",base09:"#d28b71",base0A:"#f4bc87",base0B:"#beb55b",base0C:"#7bbda4",base0D:"#8ab3b5",base0E:"#a89bb9",base0F:"#bb9584"},o.exports=n.default},1240:(o,n)=>{n.__esModule=!0,n.default={scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#272822",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#f8f8f2",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"},o.exports=n.default},9768:(o,n)=>{n.__esModule=!0,n.default={scheme:"ocean",author:"chris kempson (http://chriskempson.com)",base00:"#2b303b",base01:"#343d46",base02:"#4f5b66",base03:"#65737e",base04:"#a7adba",base05:"#c0c5ce",base06:"#dfe1e8",base07:"#eff1f5",base08:"#bf616a",base09:"#d08770",base0A:"#ebcb8b",base0B:"#a3be8c",base0C:"#96b5b4",base0D:"#8fa1b3",base0E:"#b48ead",base0F:"#ab7967"},o.exports=n.default},8293:(o,n)=>{n.__esModule=!0,n.default={scheme:"paraiso",author:"jan t. sott",base00:"#2f1e2e",base01:"#41323f",base02:"#4f424c",base03:"#776e71",base04:"#8d8687",base05:"#a39e9b",base06:"#b9b6b0",base07:"#e7e9db",base08:"#ef6155",base09:"#f99b15",base0A:"#fec418",base0B:"#48b685",base0C:"#5bc4bf",base0D:"#06b6ef",base0E:"#815ba4",base0F:"#e96ba8"},o.exports=n.default},3093:(o,n)=>{n.__esModule=!0,n.default={scheme:"pop",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#eb008a",base09:"#f29333",base0A:"#f8ca12",base0B:"#37b349",base0C:"#00aabb",base0D:"#0e5a94",base0E:"#b31e8d",base0F:"#7a2d00"},o.exports=n.default},1951:(o,n)=>{n.__esModule=!0,n.default={scheme:"railscasts",author:"ryan bates (http://railscasts.com)",base00:"#2b2b2b",base01:"#272935",base02:"#3a4055",base03:"#5a647e",base04:"#d4cfc9",base05:"#e6e1dc",base06:"#f4f1ed",base07:"#f9f7f3",base08:"#da4939",base09:"#cc7833",base0A:"#ffc66d",base0B:"#a5c261",base0C:"#519f50",base0D:"#6d9cbe",base0E:"#b6b3eb",base0F:"#bc9458"},o.exports=n.default},6368:(o,n)=>{n.__esModule=!0,n.default={scheme:"shapeshifter",author:"tyler benziger (http://tybenz.com)",base00:"#000000",base01:"#040404",base02:"#102015",base03:"#343434",base04:"#555555",base05:"#ababab",base06:"#e0e0e0",base07:"#f9f9f9",base08:"#e92f2f",base09:"#e09448",base0A:"#dddd13",base0B:"#0ed839",base0C:"#23edda",base0D:"#3b48e3",base0E:"#f996e2",base0F:"#69542d"},o.exports=n.default},2317:(o,n)=>{n.__esModule=!0,n.default={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},o.exports=n.default},1091:(o,n)=>{n.__esModule=!0,n.default={scheme:"summerfruit",author:"christopher corley (http://cscorley.github.io/)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#B0B0B0",base05:"#D0D0D0",base06:"#E0E0E0",base07:"#FFFFFF",base08:"#FF0086",base09:"#FD8900",base0A:"#ABA800",base0B:"#00C918",base0C:"#1faaaa",base0D:"#3777E6",base0E:"#AD00A1",base0F:"#cc6633"},o.exports=n.default},1308:(o,n)=>{n.__esModule=!0,n.default={scheme:"threezerotwofour",author:"jan t. sott (http://github.com/idleberg)",base00:"#090300",base01:"#3a3432",base02:"#4a4543",base03:"#5c5855",base04:"#807d7c",base05:"#a5a2a2",base06:"#d6d5d4",base07:"#f7f7f7",base08:"#db2d20",base09:"#e8bbd0",base0A:"#fded02",base0B:"#01a252",base0C:"#b5e4f4",base0D:"#01a0e4",base0E:"#a16a94",base0F:"#cdab53"},o.exports=n.default},6943:(o,n)=>{n.__esModule=!0,n.default={scheme:"tomorrow",author:"chris kempson (http://chriskempson.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#cc6666",base09:"#de935f",base0A:"#f0c674",base0B:"#b5bd68",base0C:"#8abeb7",base0D:"#81a2be",base0E:"#b294bb",base0F:"#a3685a"},o.exports=n.default},5670:(o,n)=>{n.__esModule=!0,n.default={scheme:"london tube",author:"jan t. sott",base00:"#231f20",base01:"#1c3f95",base02:"#5a5758",base03:"#737171",base04:"#959ca1",base05:"#d9d8d8",base06:"#e7e7e8",base07:"#ffffff",base08:"#ee2e24",base09:"#f386a1",base0A:"#ffd204",base0B:"#00853e",base0C:"#85cebc",base0D:"#009ddc",base0E:"#98005d",base0F:"#b06110"},o.exports=n.default},2536:(o,n)=>{n.__esModule=!0,n.default={scheme:"twilight",author:"david hart (http://hart-dev.com)",base00:"#1e1e1e",base01:"#323537",base02:"#464b50",base03:"#5f5a60",base04:"#838184",base05:"#a7a7a7",base06:"#c3c3c3",base07:"#ffffff",base08:"#cf6a4c",base09:"#cda869",base0A:"#f9ee98",base0B:"#8f9d6a",base0C:"#afc4db",base0D:"#7587a6",base0E:"#9b859d",base0F:"#9b703f"},o.exports=n.default},6481:(o,n,u)=>{var m=u(4176),c={};for(var f in m)m.hasOwnProperty(f)&&(c[m[f]]=f);var v=o.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var S in v)if(v.hasOwnProperty(S)){if(!("channels"in v[S]))throw new Error("missing channels property: "+S);if(!("labels"in v[S]))throw new Error("missing channel labels property: "+S);if(v[S].labels.length!==v[S].channels)throw new Error("channel and label counts mismatch: "+S);var g=v[S].channels,a=v[S].labels;delete v[S].channels,delete v[S].labels,Object.defineProperty(v[S],"channels",{value:g}),Object.defineProperty(v[S],"labels",{value:a})}v.rgb.hsl=function(t){var e,r,i=t[0]/255,_=t[1]/255,l=t[2]/255,b=Math.min(i,_,l),d=Math.max(i,_,l),y=d-b;return d===b?e=0:i===d?e=(_-l)/y:_===d?e=2+(l-i)/y:l===d&&(e=4+(i-_)/y),(e=Math.min(60*e,360))<0&&(e+=360),r=(b+d)/2,[e,100*(d===b?0:r<=.5?y/(d+b):y/(2-d-b)),100*r]},v.rgb.hsv=function(t){var e,r,i,_,l,b=t[0]/255,d=t[1]/255,y=t[2]/255,M=Math.max(b,d,y),D=M-Math.min(b,d,y),N=function(T){return(M-T)/6/D+.5};return D===0?_=l=0:(l=D/M,e=N(b),r=N(d),i=N(y),b===M?_=i-r:d===M?_=.3333333333333333+e-i:y===M&&(_=.6666666666666666+r-e),_<0?_+=1:_>1&&(_-=1)),[360*_,100*l,100*M]},v.rgb.hwb=function(t){var e=t[0],r=t[1],i=t[2];return[v.rgb.hsl(t)[0],100*(.00392156862745098*Math.min(e,Math.min(r,i))),100*(i=1-.00392156862745098*Math.max(e,Math.max(r,i)))]},v.rgb.cmyk=function(t){var e,r=t[0]/255,i=t[1]/255,_=t[2]/255;return[100*((1-r-(e=Math.min(1-r,1-i,1-_)))/(1-e)||0),100*((1-i-e)/(1-e)||0),100*((1-_-e)/(1-e)||0),100*e]},v.rgb.keyword=function(t){var e=c[t];if(e)return e;var r,i,_,l=1/0;for(var b in m)if(m.hasOwnProperty(b)){var d=m[b],y=(i=t,_=d,Math.pow(i[0]-_[0],2)+Math.pow(i[1]-_[1],2)+Math.pow(i[2]-_[2],2));y<l&&(l=y,r=b)}return r},v.keyword.rgb=function(t){return m[t]},v.rgb.xyz=function(t){var e=t[0]/255,r=t[1]/255,i=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)),100*(.2126*e+.7152*r+.0722*i),100*(.0193*e+.1192*r+.9505*i)]},v.rgb.lab=function(t){var e=v.rgb.xyz(t),r=e[0],i=e[1],_=e[2];return i/=100,_/=108.883,r=(r/=95.047)>.008856?Math.pow(r,.3333333333333333):7.787*r+.13793103448275862,[116*(i=i>.008856?Math.pow(i,.3333333333333333):7.787*i+.13793103448275862)-16,500*(r-i),200*(i-(_=_>.008856?Math.pow(_,.3333333333333333):7.787*_+.13793103448275862))]},v.hsl.rgb=function(t){var e,r,i,_,l,b=t[0]/360,d=t[1]/100,y=t[2]/100;if(d===0)return[l=255*y,l,l];e=2*y-(r=y<.5?y*(1+d):y+d-y*d),_=[0,0,0];for(var M=0;M<3;M++)(i=b+.3333333333333333*-(M-1))<0&&i++,i>1&&i--,l=6*i<1?e+6*(r-e)*i:2*i<1?r:3*i<2?e+(r-e)*(.6666666666666666-i)*6:e,_[M]=255*l;return _},v.hsl.hsv=function(t){var e=t[0],r=t[1]/100,i=t[2]/100,_=r,l=Math.max(i,.01);return r*=(i*=2)<=1?i:2-i,_*=l<=1?l:2-l,[e,100*(i===0?2*_/(l+_):2*r/(i+r)),100*((i+r)/2)]},v.hsv.rgb=function(t){var e=t[0]/60,r=t[1]/100,i=t[2]/100,_=Math.floor(e)%6,l=e-Math.floor(e),b=255*i*(1-r),d=255*i*(1-r*l),y=255*i*(1-r*(1-l));switch(i*=255,_){case 0:return[i,y,b];case 1:return[d,i,b];case 2:return[b,i,y];case 3:return[b,d,i];case 4:return[y,b,i];case 5:return[i,b,d]}},v.hsv.hsl=function(t){var e,r,i,_=t[0],l=t[1]/100,b=t[2]/100,d=Math.max(b,.01);return i=(2-l)*b,r=l*d,[_,100*(r=(r/=(e=(2-l)*d)<=1?e:2-e)||0),100*(i/=2)]},v.hwb.rgb=function(t){var e,r,i,_,l,b,d,y=t[0]/360,M=t[1]/100,D=t[2]/100,N=M+D;switch(N>1&&(M/=N,D/=N),i=6*y-(e=Math.floor(6*y)),1&e&&(i=1-i),_=M+i*((r=1-D)-M),e){default:case 6:case 0:l=r,b=_,d=M;break;case 1:l=_,b=r,d=M;break;case 2:l=M,b=r,d=_;break;case 3:l=M,b=_,d=r;break;case 4:l=_,b=M,d=r;break;case 5:l=r,b=M,d=_}return[255*l,255*b,255*d]},v.cmyk.rgb=function(t){var e=t[0]/100,r=t[1]/100,i=t[2]/100,_=t[3]/100;return[255*(1-Math.min(1,e*(1-_)+_)),255*(1-Math.min(1,r*(1-_)+_)),255*(1-Math.min(1,i*(1-_)+_))]},v.xyz.rgb=function(t){var e,r,i,_=t[0]/100,l=t[1]/100,b=t[2]/100;return r=-.9689*_+1.8758*l+.0415*b,i=.0557*_+-.204*l+1.057*b,e=(e=3.2406*_+-1.5372*l+-.4986*b)>.0031308?1.055*Math.pow(e,.4166666666666667)-.055:12.92*e,r=r>.0031308?1.055*Math.pow(r,.4166666666666667)-.055:12.92*r,i=i>.0031308?1.055*Math.pow(i,.4166666666666667)-.055:12.92*i,[255*(e=Math.min(Math.max(0,e),1)),255*(r=Math.min(Math.max(0,r),1)),255*(i=Math.min(Math.max(0,i),1))]},v.xyz.lab=function(t){var e=t[0],r=t[1],i=t[2];return r/=100,i/=108.883,e=(e/=95.047)>.008856?Math.pow(e,.3333333333333333):7.787*e+.13793103448275862,[116*(r=r>.008856?Math.pow(r,.3333333333333333):7.787*r+.13793103448275862)-16,500*(e-r),200*(r-(i=i>.008856?Math.pow(i,.3333333333333333):7.787*i+.13793103448275862))]},v.lab.xyz=function(t){var e,r,i,_=t[0];e=t[1]/500+(r=(_+16)/116),i=r-t[2]/200;var l=Math.pow(r,3),b=Math.pow(e,3),d=Math.pow(i,3);return r=l>.008856?l:(r-.13793103448275862)/7.787,e=b>.008856?b:(e-.13793103448275862)/7.787,i=d>.008856?d:(i-.13793103448275862)/7.787,[e*=95.047,r*=100,i*=108.883]},v.lab.lch=function(t){var e,r=t[0],i=t[1],_=t[2];return(e=360*Math.atan2(_,i)/2/Math.PI)<0&&(e+=360),[r,Math.sqrt(i*i+_*_),e]},v.lch.lab=function(t){var e,r=t[0],i=t[1];return e=t[2]/360*2*Math.PI,[r,i*Math.cos(e),i*Math.sin(e)]},v.rgb.ansi16=function(t){var e=t[0],r=t[1],i=t[2],_=1 in arguments?arguments[1]:v.rgb.hsv(t)[2];if((_=Math.round(_/50))===0)return 30;var l=30+(Math.round(i/255)<<2|Math.round(r/255)<<1|Math.round(e/255));return _===2&&(l+=60),l},v.hsv.ansi16=function(t){return v.rgb.ansi16(v.hsv.rgb(t),t[2])},v.rgb.ansi256=function(t){var e=t[0],r=t[1],i=t[2];return e===r&&r===i?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(r/255*5)+Math.round(i/255*5)},v.ansi16.rgb=function(t){var e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),[e=e/10.5*255,e,e];var r=.5*(1+~~(t>50));return[(1&e)*r*255,(e>>1&1)*r*255,(e>>2&1)*r*255]},v.ansi256.rgb=function(t){if(t>=232){var e=10*(t-232)+8;return[e,e,e]}var r;return t-=16,[Math.floor(t/36)/5*255,Math.floor((r=t%36)/6)/5*255,r%6/5*255]},v.rgb.hex=function(t){var e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},v.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var r=e[0];e[0].length===3&&(r=r.split("").map((function(_){return _+_})).join(""));var i=parseInt(r,16);return[i>>16&255,i>>8&255,255&i]},v.rgb.hcg=function(t){var e,r=t[0]/255,i=t[1]/255,_=t[2]/255,l=Math.max(Math.max(r,i),_),b=Math.min(Math.min(r,i),_),d=l-b;return e=d<=0?0:l===r?(i-_)/d%6:l===i?2+(_-r)/d:4+(r-i)/d+4,e/=6,[360*(e%=1),100*d,100*(d<1?b/(1-d):0)]},v.hsl.hcg=function(t){var e=t[1]/100,r=t[2]/100,i=1,_=0;return(i=r<.5?2*e*r:2*e*(1-r))<1&&(_=(r-.5*i)/(1-i)),[t[0],100*i,100*_]},v.hsv.hcg=function(t){var e=t[1]/100,r=t[2]/100,i=e*r,_=0;return i<1&&(_=(r-i)/(1-i)),[t[0],100*i,100*_]},v.hcg.rgb=function(t){var e=t[0]/360,r=t[1]/100,i=t[2]/100;if(r===0)return[255*i,255*i,255*i];var _,l=[0,0,0],b=e%1*6,d=b%1,y=1-d;switch(Math.floor(b)){case 0:l[0]=1,l[1]=d,l[2]=0;break;case 1:l[0]=y,l[1]=1,l[2]=0;break;case 2:l[0]=0,l[1]=1,l[2]=d;break;case 3:l[0]=0,l[1]=y,l[2]=1;break;case 4:l[0]=d,l[1]=0,l[2]=1;break;default:l[0]=1,l[1]=0,l[2]=y}return _=(1-r)*i,[255*(r*l[0]+_),255*(r*l[1]+_),255*(r*l[2]+_)]},v.hcg.hsv=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e),i=0;return r>0&&(i=e/r),[t[0],100*i,100*r]},v.hcg.hsl=function(t){var e=t[1]/100,r=t[2]/100*(1-e)+.5*e,i=0;return r>0&&r<.5?i=e/(2*r):r>=.5&&r<1&&(i=e/(2*(1-r))),[t[0],100*i,100*r]},v.hcg.hwb=function(t){var e=t[1]/100,r=e+t[2]/100*(1-e);return[t[0],100*(r-e),100*(1-r)]},v.hwb.hcg=function(t){var e=t[1]/100,r=1-t[2]/100,i=r-e,_=0;return i<1&&(_=(r-i)/(1-i)),[t[0],100*i,100*_]},v.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},v.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},v.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},v.gray.hsl=v.gray.hsv=function(t){return[0,0,t[0]]},v.gray.hwb=function(t){return[0,100,t[0]]},v.gray.cmyk=function(t){return[0,0,0,t[0]]},v.gray.lab=function(t){return[t[0],0,0]},v.gray.hex=function(t){var e=255&Math.round(t[0]/100*255),r=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(r.length)+r},v.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}},4732:(o,n,u)=>{var m=u(6481),c=u(1157),f={};Object.keys(m).forEach((function(v){f[v]={},Object.defineProperty(f[v],"channels",{value:m[v].channels}),Object.defineProperty(f[v],"labels",{value:m[v].labels});var S=c(v);Object.keys(S).forEach((function(g){var a=S[g];f[v][g]=(function(t){var e=function(r){if(r==null)return r;arguments.length>1&&(r=Array.prototype.slice.call(arguments));var i=t(r);if(typeof i=="object")for(var _=i.length,l=0;l<_;l++)i[l]=Math.round(i[l]);return i};return"conversion"in t&&(e.conversion=t.conversion),e})(a),f[v][g].raw=(function(t){var e=function(r){return r==null?r:(arguments.length>1&&(r=Array.prototype.slice.call(arguments)),t(r))};return"conversion"in t&&(e.conversion=t.conversion),e})(a)}))})),o.exports=f},1157:(o,n,u)=>{var m=u(6481);function c(S){var g=(function(){for(var b={},d=Object.keys(m),y=d.length,M=0;M<y;M++)b[d[M]]={distance:-1,parent:null};return b})(),a=[S];for(g[S].distance=0;a.length;)for(var t=a.pop(),e=Object.keys(m[t]),r=e.length,i=0;i<r;i++){var _=e[i],l=g[_];l.distance===-1&&(l.distance=g[t].distance+1,l.parent=t,a.unshift(_))}return g}function f(S,g){return function(a){return g(S(a))}}function v(S,g){for(var a=[g[S].parent,S],t=m[g[S].parent][S],e=g[S].parent;g[e].parent;)a.unshift(g[e].parent),t=f(m[g[e].parent][e],t),e=g[e].parent;return t.conversion=a,t}o.exports=function(S){for(var g=c(S),a={},t=Object.keys(g),e=t.length,r=0;r<e;r++){var i=t[r];g[i].parent!==null&&(a[i]=v(i,g))}return a}},4176:o=>{o.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},4877:o=>{o.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},6138:(o,n,u)=>{var m=u(4877),c=u(301),f=Object.hasOwnProperty,v=Object.create(null);for(var S in m)f.call(m,S)&&(v[m[S]]=S);var g=o.exports={to:{},get:{}};function a(e,r,i){return Math.min(Math.max(r,e),i)}function t(e){var r=Math.round(e).toString(16).toUpperCase();return r.length<2?"0"+r:r}g.get=function(e){var r,i;switch(e.substring(0,3).toLowerCase()){case"hsl":r=g.get.hsl(e),i="hsl";break;case"hwb":r=g.get.hwb(e),i="hwb";break;default:r=g.get.rgb(e),i="rgb"}return r?{model:i,value:r}:null},g.get.rgb=function(e){if(!e)return null;var r,i,_,l=[0,0,0,1];if(r=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(_=r[2],r=r[1],i=0;i<3;i++){var b=2*i;l[i]=parseInt(r.slice(b,b+2),16)}_&&(l[3]=parseInt(_,16)/255)}else if(r=e.match(/^#([a-f0-9]{3,4})$/i)){for(_=(r=r[1])[3],i=0;i<3;i++)l[i]=parseInt(r[i]+r[i],16);_&&(l[3]=parseInt(_+_,16)/255)}else if(r=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(i=0;i<3;i++)l[i]=parseInt(r[i+1],0);r[4]&&(r[5]?l[3]=.01*parseFloat(r[4]):l[3]=parseFloat(r[4]))}else{if(!(r=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(r=e.match(/^(\w+)$/))?r[1]==="transparent"?[0,0,0,0]:f.call(m,r[1])?((l=m[r[1]])[3]=1,l):null:null;for(i=0;i<3;i++)l[i]=Math.round(2.55*parseFloat(r[i+1]));r[4]&&(r[5]?l[3]=.01*parseFloat(r[4]):l[3]=parseFloat(r[4]))}for(i=0;i<3;i++)l[i]=a(l[i],0,255);return l[3]=a(l[3],0,1),l},g.get.hsl=function(e){if(!e)return null;var r=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(r){var i=parseFloat(r[4]);return[(parseFloat(r[1])%360+360)%360,a(parseFloat(r[2]),0,100),a(parseFloat(r[3]),0,100),a(isNaN(i)?1:i,0,1)]}return null},g.get.hwb=function(e){if(!e)return null;var r=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(r){var i=parseFloat(r[4]);return[(parseFloat(r[1])%360+360)%360,a(parseFloat(r[2]),0,100),a(parseFloat(r[3]),0,100),a(isNaN(i)?1:i,0,1)]}return null},g.to.hex=function(){var e=c(arguments);return"#"+t(e[0])+t(e[1])+t(e[2])+(e[3]<1?t(Math.round(255*e[3])):"")},g.to.rgb=function(){var e=c(arguments);return e.length<4||e[3]===1?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},g.to.rgb.percent=function(){var e=c(arguments),r=Math.round(e[0]/255*100),i=Math.round(e[1]/255*100),_=Math.round(e[2]/255*100);return e.length<4||e[3]===1?"rgb("+r+"%, "+i+"%, "+_+"%)":"rgba("+r+"%, "+i+"%, "+_+"%, "+e[3]+")"},g.to.hsl=function(){var e=c(arguments);return e.length<4||e[3]===1?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},g.to.hwb=function(){var e=c(arguments),r="";return e.length>=4&&e[3]!==1&&(r=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+r+")"},g.to.keyword=function(e){return v[e.slice(0,3)]}},3639:(o,n,u)=>{var m=u(6138),c=u(4732),f=[].slice,v=["keyword","gray","hex"],S={};Object.keys(c).forEach((function(i){S[f.call(c[i].labels).sort().join("")]=i}));var g={};function a(i,_){if(!(this instanceof a))return new a(i,_);if(_&&_ in v&&(_=null),_&&!(_ in c))throw new Error("Unknown model: "+_);var l,b;if(i==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(i instanceof a)this.model=i.model,this.color=i.color.slice(),this.valpha=i.valpha;else if(typeof i=="string"){var d=m.get(i);if(d===null)throw new Error("Unable to parse color from string: "+i);this.model=d.model,b=c[this.model].channels,this.color=d.value.slice(0,b),this.valpha=typeof d.value[b]=="number"?d.value[b]:1}else if(i.length){this.model=_||"rgb",b=c[this.model].channels;var y=f.call(i,0,b);this.color=r(y,b),this.valpha=typeof i[b]=="number"?i[b]:1}else if(typeof i=="number")i&=16777215,this.model="rgb",this.color=[i>>16&255,i>>8&255,255&i],this.valpha=1;else{this.valpha=1;var M=Object.keys(i);"alpha"in i&&(M.splice(M.indexOf("alpha"),1),this.valpha=typeof i.alpha=="number"?i.alpha:0);var D=M.sort().join("");if(!(D in S))throw new Error("Unable to parse color from object: "+JSON.stringify(i));this.model=S[D];var N=c[this.model].labels,T=[];for(l=0;l<N.length;l++)T.push(i[N[l]]);this.color=r(T)}if(g[this.model])for(b=c[this.model].channels,l=0;l<b;l++){var z=g[this.model][l];z&&(this.color[l]=z(this.color[l]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function t(i,_,l){return(i=Array.isArray(i)?i:[i]).forEach((function(b){(g[b]||(g[b]=[]))[_]=l})),i=i[0],function(b){var d;return arguments.length?(l&&(b=l(b)),(d=this[i]()).color[_]=b,d):(d=this[i]().color[_],l&&(d=l(d)),d)}}function e(i){return function(_){return Math.max(0,Math.min(i,_))}}function r(i,_){for(var l=0;l<_;l++)typeof i[l]!="number"&&(i[l]=0);return i}a.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(i){var _=this.model in m.to?this:this.rgb(),l=(_=_.round(typeof i=="number"?i:1)).valpha===1?_.color:_.color.concat(this.valpha);return m.to[_.model](l)},percentString:function(i){var _=this.rgb().round(typeof i=="number"?i:1),l=_.valpha===1?_.color:_.color.concat(this.valpha);return m.to.rgb.percent(l)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var i={},_=c[this.model].channels,l=c[this.model].labels,b=0;b<_;b++)i[l[b]]=this.color[b];return this.valpha!==1&&(i.alpha=this.valpha),i},unitArray:function(){var i=this.rgb().color;return i[0]/=255,i[1]/=255,i[2]/=255,this.valpha!==1&&i.push(this.valpha),i},unitObject:function(){var i=this.rgb().object();return i.r/=255,i.g/=255,i.b/=255,this.valpha!==1&&(i.alpha=this.valpha),i},round:function(i){return i=Math.max(i||0,0),new a(this.color.map((function(_){return function(l){return(function(b,d){return Number(b.toFixed(d))})(l,_)}})(i)).concat(this.valpha),this.model)},alpha:function(i){return arguments.length?new a(this.color.concat(Math.max(0,Math.min(1,i))),this.model):this.valpha},red:t("rgb",0,e(255)),green:t("rgb",1,e(255)),blue:t("rgb",2,e(255)),hue:t(["hsl","hsv","hsl","hwb","hcg"],0,(function(i){return(i%360+360)%360})),saturationl:t("hsl",1,e(100)),lightness:t("hsl",2,e(100)),saturationv:t("hsv",1,e(100)),value:t("hsv",2,e(100)),chroma:t("hcg",1,e(100)),gray:t("hcg",2,e(100)),white:t("hwb",1,e(100)),wblack:t("hwb",2,e(100)),cyan:t("cmyk",0,e(100)),magenta:t("cmyk",1,e(100)),yellow:t("cmyk",2,e(100)),black:t("cmyk",3,e(100)),x:t("xyz",0,e(100)),y:t("xyz",1,e(100)),z:t("xyz",2,e(100)),l:t("lab",0,e(100)),a:t("lab",1),b:t("lab",2),keyword:function(i){return arguments.length?new a(i):c[this.model].keyword(this.color)},hex:function(i){return arguments.length?new a(i):m.to.hex(this.rgb().round().color)},rgbNumber:function(){var i=this.rgb().color;return(255&i[0])<<16|(255&i[1])<<8|255&i[2]},luminosity:function(){for(var i=this.rgb().color,_=[],l=0;l<i.length;l++){var b=i[l]/255;_[l]=b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4)}return .2126*_[0]+.7152*_[1]+.0722*_[2]},contrast:function(i){var _=this.luminosity(),l=i.luminosity();return _>l?(_+.05)/(l+.05):(l+.05)/(_+.05)},level:function(i){var _=this.contrast(i);return _>=7.1?"AAA":_>=4.5?"AA":""},isDark:function(){var i=this.rgb().color;return(299*i[0]+587*i[1]+114*i[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var i=this.rgb(),_=0;_<3;_++)i.color[_]=255-i.color[_];return i},lighten:function(i){var _=this.hsl();return _.color[2]+=_.color[2]*i,_},darken:function(i){var _=this.hsl();return _.color[2]-=_.color[2]*i,_},saturate:function(i){var _=this.hsl();return _.color[1]+=_.color[1]*i,_},desaturate:function(i){var _=this.hsl();return _.color[1]-=_.color[1]*i,_},whiten:function(i){var _=this.hwb();return _.color[1]+=_.color[1]*i,_},blacken:function(i){var _=this.hwb();return _.color[2]+=_.color[2]*i,_},grayscale:function(){var i=this.rgb().color,_=.3*i[0]+.59*i[1]+.11*i[2];return a.rgb(_,_,_)},fade:function(i){return this.alpha(this.valpha-this.valpha*i)},opaquer:function(i){return this.alpha(this.valpha+this.valpha*i)},rotate:function(i){var _=this.hsl(),l=_.color[0];return l=(l=(l+i)%360)<0?360+l:l,_.color[0]=l,_},mix:function(i,_){if(!i||!i.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof i);var l=i.rgb(),b=this.rgb(),d=_===void 0?.5:_,y=2*d-1,M=l.alpha()-b.alpha(),D=((y*M==-1?y:(y+M)/(1+y*M))+1)/2,N=1-D;return a.rgb(D*l.red()+N*b.red(),D*l.green()+N*b.green(),D*l.blue()+N*b.blue(),l.alpha()*d+b.alpha()*(1-d))}},Object.keys(c).forEach((function(i){if(v.indexOf(i)===-1){var _=c[i].channels;a.prototype[i]=function(){if(this.model===i)return new a(this);if(arguments.length)return new a(arguments,i);var l,b=typeof arguments[_]=="number"?_:this.valpha;return new a((l=c[this.model][i].raw(this.color),Array.isArray(l)?l:[l]).concat(b),i)},a[i]=function(l){return typeof l=="number"&&(l=r(f.call(arguments),_)),new a(l,i)}}})),o.exports=a},9784:o=>{var n,u=typeof Reflect=="object"?Reflect:null,m=u&&typeof u.apply=="function"?u.apply:function(b,d,y){return Function.prototype.apply.call(b,d,y)};n=u&&typeof u.ownKeys=="function"?u.ownKeys:Object.getOwnPropertySymbols?function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:function(b){return Object.getOwnPropertyNames(b)};var c=Number.isNaN||function(b){return b!=b};function f(){f.init.call(this)}o.exports=f,o.exports.once=function(b,d){return new Promise((function(y,M){function D(T){b.removeListener(d,N),M(T)}function N(){typeof b.removeListener=="function"&&b.removeListener("error",D),y([].slice.call(arguments))}l(b,d,N,{once:!0}),d!=="error"&&(function(T,z,J){typeof T.on=="function"&&l(T,"error",z,J)})(b,D,{once:!0})}))},f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var v=10;function S(b){if(typeof b!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof b)}function g(b){return b._maxListeners===void 0?f.defaultMaxListeners:b._maxListeners}function a(b,d,y,M){var D,N,T,z;if(S(y),(N=b._events)===void 0?(N=b._events=Object.create(null),b._eventsCount=0):(N.newListener!==void 0&&(b.emit("newListener",d,y.listener?y.listener:y),N=b._events),T=N[d]),T===void 0)T=N[d]=y,++b._eventsCount;else if(typeof T=="function"?T=N[d]=M?[y,T]:[T,y]:M?T.unshift(y):T.push(y),(D=g(b))>0&&T.length>D&&!T.warned){T.warned=!0;var J=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(d)+" listeners added. Use emitter.setMaxListeners() to increase limit");J.name="MaxListenersExceededWarning",J.emitter=b,J.type=d,J.count=T.length,z=J,console&&console.warn&&console.warn(z)}return b}function t(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function e(b,d,y){var M={fired:!1,wrapFn:void 0,target:b,type:d,listener:y},D=t.bind(M);return D.listener=y,M.wrapFn=D,D}function r(b,d,y){var M=b._events;if(M===void 0)return[];var D=M[d];return D===void 0?[]:typeof D=="function"?y?[D.listener||D]:[D]:y?(function(N){for(var T=new Array(N.length),z=0;z<T.length;++z)T[z]=N[z].listener||N[z];return T})(D):_(D,D.length)}function i(b){var d=this._events;if(d!==void 0){var y=d[b];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}function _(b,d){for(var y=new Array(d),M=0;M<d;++M)y[M]=b[M];return y}function l(b,d,y,M){if(typeof b.on=="function")M.once?b.once(d,y):b.on(d,y);else{if(typeof b.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof b);b.addEventListener(d,(function D(N){M.once&&b.removeEventListener(d,D),y(N)}))}}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return v},set:function(b){if(typeof b!="number"||b<0||c(b))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+b+".");v=b}}),f.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(b){if(typeof b!="number"||b<0||c(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this},f.prototype.getMaxListeners=function(){return g(this)},f.prototype.emit=function(b){for(var d=[],y=1;y<arguments.length;y++)d.push(arguments[y]);var M=b==="error",D=this._events;if(D!==void 0)M=M&&D.error===void 0;else if(!M)return!1;if(M){var N;if(d.length>0&&(N=d[0]),N instanceof Error)throw N;var T=new Error("Unhandled error."+(N?" ("+N.message+")":""));throw T.context=N,T}var z=D[b];if(z===void 0)return!1;if(typeof z=="function")m(z,this,d);else{var J=z.length,ie=_(z,J);for(y=0;y<J;++y)m(ie[y],this,d)}return!0},f.prototype.addListener=function(b,d){return a(this,b,d,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(b,d){return a(this,b,d,!0)},f.prototype.once=function(b,d){return S(d),this.on(b,e(this,b,d)),this},f.prototype.prependOnceListener=function(b,d){return S(d),this.prependListener(b,e(this,b,d)),this},f.prototype.removeListener=function(b,d){var y,M,D,N,T;if(S(d),(M=this._events)===void 0)return this;if((y=M[b])===void 0)return this;if(y===d||y.listener===d)--this._eventsCount==0?this._events=Object.create(null):(delete M[b],M.removeListener&&this.emit("removeListener",b,y.listener||d));else if(typeof y!="function"){for(D=-1,N=y.length-1;N>=0;N--)if(y[N]===d||y[N].listener===d){T=y[N].listener,D=N;break}if(D<0)return this;D===0?y.shift():(function(z,J){for(;J+1<z.length;J++)z[J]=z[J+1];z.pop()})(y,D),y.length===1&&(M[b]=y[0]),M.removeListener!==void 0&&this.emit("removeListener",b,T||d)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(b){var d,y,M;if((y=this._events)===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[b]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete y[b]),this;if(arguments.length===0){var D,N=Object.keys(y);for(M=0;M<N.length;++M)(D=N[M])!=="removeListener"&&this.removeAllListeners(D);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(d=y[b])=="function")this.removeListener(b,d);else if(d!==void 0)for(M=d.length-1;M>=0;M--)this.removeListener(b,d[M]);return this},f.prototype.listeners=function(b){return r(this,b,!0)},f.prototype.rawListeners=function(b){return r(this,b,!1)},f.listenerCount=function(b,d){return typeof b.listenerCount=="function"?b.listenerCount(d):i.call(b,d)},f.prototype.listenerCount=i,f.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},8336:o=>{o.exports=function(n){return!(!n||typeof n=="string")&&(n instanceof Array||Array.isArray(n)||n.length>=0&&(n.splice instanceof Function||Object.getOwnPropertyDescriptor(n,n.length-1)&&n.constructor.name!=="String"))}},3989:o=>{var n="__lodash_placeholder__",u=32,m=1/0,c=NaN,f=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",u],["partialRight",64],["rearg",256]],v="[object Function]",S="[object GeneratorFunction]",g=/^\s+|\s+$/g,a=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,t=/\{\n\/\* \[wrapped with (.+)\] \*/,e=/,? & /,r=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,_=/^\[object .+?Constructor\]$/,l=/^0o[0-7]+$/i,b=/^(?:0|[1-9]\d*)$/,d=parseInt,y=typeof _s=="object"&&_s&&_s.Object===Object&&_s,M=typeof self=="object"&&self&&self.Object===Object&&self,D=y||M||Function("return this")();function N(te,G,ne){switch(ne.length){case 0:return te.call(G);case 1:return te.call(G,ne[0]);case 2:return te.call(G,ne[0],ne[1]);case 3:return te.call(G,ne[0],ne[1],ne[2])}return te.apply(G,ne)}function T(te,G){return!!(te&&te.length)&&(function(ne,_e,we){if(_e!=_e)return(function(We,rt,it,Je){for(var ct=We.length,Ve=it+-1;++Ve<ct;)if(rt(We[Ve],Ve,We))return Ve;return-1})(ne,z,we);for(var ye=we-1,Pe=ne.length;++ye<Pe;)if(ne[ye]===_e)return ye;return-1})(te,G,0)>-1}function z(te){return te!=te}function J(te,G){for(var ne=-1,_e=te.length,we=0,ye=[];++ne<_e;){var Pe=te[ne];Pe!==G&&Pe!==n||(te[ne]=n,ye[we++]=ne)}return ye}var ie,F,ee,L=Function.prototype,B=Object.prototype,P=D["__core-js_shared__"],W=(ie=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+ie:"",Q=L.toString,ae=B.hasOwnProperty,he=B.toString,me=RegExp("^"+Q.call(ae).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=Object.create,O=Math.max,Y=Math.min,se=(F=be(Object,"defineProperty"),(ee=be.name)&&ee.length>2?F:void 0);function le(te){if(!Ue(te)||(function(ne){return!!W&&W in ne})(te))return!1;var G=(function(ne){var _e=Ue(ne)?he.call(ne):"";return _e==v||_e==S})(te)||(function(ne){var _e=!1;if(ne!=null&&typeof ne.toString!="function")try{_e=!!(ne+"")}catch{}return _e})(te)?me:_;return G.test((function(ne){if(ne!=null){try{return Q.call(ne)}catch{}try{return ne+""}catch{}}return""})(te))}function ce(te){return function(){var G=arguments;switch(G.length){case 0:return new te;case 1:return new te(G[0]);case 2:return new te(G[0],G[1]);case 3:return new te(G[0],G[1],G[2]);case 4:return new te(G[0],G[1],G[2],G[3]);case 5:return new te(G[0],G[1],G[2],G[3],G[4]);case 6:return new te(G[0],G[1],G[2],G[3],G[4],G[5]);case 7:return new te(G[0],G[1],G[2],G[3],G[4],G[5],G[6])}var ne,_e=Ue(ne=te.prototype)?V(ne):{},we=te.apply(_e,G);return Ue(we)?we:_e}}function xe(te,G,ne,_e,we,ye,Pe,We,rt,it){var Je=128&G,ct=1&G,Ve=2&G,bt=24&G,nt=512&G,Ct=Ve?void 0:ce(te);return function ot(){for(var Me=arguments.length,Ie=Array(Me),ze=Me;ze--;)Ie[ze]=arguments[ze];if(bt)var at=He(ot),Ot=(function(Ne,Xe){for(var Qe=Ne.length,De=0;Qe--;)Ne[Qe]===Xe&&De++;return De})(Ie,at);if(_e&&(Ie=(function(Ne,Xe,Qe,De){for(var Ke=-1,yt=Ne.length,wt=Qe.length,et=-1,ht=Xe.length,xt=O(yt-wt,0),Dt=Array(ht+xt),Pt=!De;++et<ht;)Dt[et]=Xe[et];for(;++Ke<wt;)(Pt||Ke<yt)&&(Dt[Qe[Ke]]=Ne[Ke]);for(;xt--;)Dt[et++]=Ne[Ke++];return Dt})(Ie,_e,we,bt)),ye&&(Ie=(function(Ne,Xe,Qe,De){for(var Ke=-1,yt=Ne.length,wt=-1,et=Qe.length,ht=-1,xt=Xe.length,Dt=O(yt-et,0),Pt=Array(Dt+xt),Bs=!De;++Ke<Dt;)Pt[Ke]=Ne[Ke];for(var ds=Ke;++ht<xt;)Pt[ds+ht]=Xe[ht];for(;++wt<et;)(Bs||Ke<yt)&&(Pt[ds+Qe[wt]]=Ne[Ke++]);return Pt})(Ie,ye,Pe,bt)),Me-=Ot,bt&&Me<it){var St=J(Ie,at);return Re(te,G,xe,ot.placeholder,ne,Ie,St,We,rt,it-Me)}var Ye=ct?ne:this,Bt=Ve?Ye[te]:te;return Me=Ie.length,We?Ie=(function(Ne,Xe){for(var Qe=Ne.length,De=Y(Xe.length,Qe),Ke=(function(wt,et){var ht=-1,xt=wt.length;for(et||(et=Array(xt));++ht<xt;)et[ht]=wt[ht];return et})(Ne);De--;){var yt=Xe[De];Ne[De]=Ge(yt,Qe)?Ke[yt]:void 0}return Ne})(Ie,We):nt&&Me>1&&Ie.reverse(),Je&&rt<Me&&(Ie.length=rt),this&&this!==D&&this instanceof ot&&(Bt=Ct||ce(Bt)),Bt.apply(Ye,Ie)}}function Re(te,G,ne,_e,we,ye,Pe,We,rt,it){var Je=8&G;G|=Je?u:64,4&(G&=~(Je?64:u))||(G&=-4);var ct=ne(te,G,we,Je?ye:void 0,Je?Pe:void 0,Je?void 0:ye,Je?void 0:Pe,We,rt,it);return ct.placeholder=_e,Rt(ct,te,G)}function Oe(te,G,ne,_e,we,ye,Pe,We){var rt=2&G;if(!rt&&typeof te!="function")throw new TypeError("Expected a function");var it=_e?_e.length:0;if(it||(G&=-97,_e=we=void 0),Pe=Pe===void 0?Pe:O(vt(Pe),0),We=We===void 0?We:vt(We),it-=we?we.length:0,64&G){var Je=_e,ct=we;_e=we=void 0}var Ve=[te,G,ne,_e,we,Je,ct,ye,Pe,We];if(te=Ve[0],G=Ve[1],ne=Ve[2],_e=Ve[3],we=Ve[4],!(We=Ve[9]=Ve[9]==null?rt?0:te.length:O(Ve[9]-it,0))&&24&G&&(G&=-25),G&&G!=1)bt=G==8||G==16?(function(nt,Ct,ot){var Me=ce(nt);return function Ie(){for(var ze=arguments.length,at=Array(ze),Ot=ze,St=He(Ie);Ot--;)at[Ot]=arguments[Ot];var Ye=ze<3&&at[0]!==St&&at[ze-1]!==St?[]:J(at,St);return(ze-=Ye.length)<ot?Re(nt,Ct,xe,Ie.placeholder,void 0,at,Ye,void 0,void 0,ot-ze):N(this&&this!==D&&this instanceof Ie?Me:nt,this,at)}})(te,G,We):G!=u&&G!=33||we.length?xe.apply(void 0,Ve):(function(nt,Ct,ot,Me){var Ie=1&Ct,ze=ce(nt);return function at(){for(var Ot=-1,St=arguments.length,Ye=-1,Bt=Me.length,Ne=Array(Bt+St),Xe=this&&this!==D&&this instanceof at?ze:nt;++Ye<Bt;)Ne[Ye]=Me[Ye];for(;St--;)Ne[Ye++]=arguments[++Ot];return N(Xe,Ie?ot:this,Ne)}})(te,G,ne,_e);else var bt=(function(nt,Ct,ot){var Me=1&Ct,Ie=ce(nt);return function ze(){return(this&&this!==D&&this instanceof ze?Ie:nt).apply(Me?ot:this,arguments)}})(te,G,ne);return Rt(bt,te,G)}function He(te){return te.placeholder}function be(te,G){var ne=(function(_e,we){return _e?.[we]})(te,G);return le(ne)?ne:void 0}function Lt(te){var G=te.match(t);return G?G[1].split(e):[]}function oe(te,G){var ne=G.length,_e=ne-1;return G[_e]=(ne>1?"& ":"")+G[_e],G=G.join(ne>2?", ":" "),te.replace(a,`{
/* [wrapped with `+G+`] */
`)}function Ge(te,G){return!!(G=G??9007199254740991)&&(typeof te=="number"||b.test(te))&&te>-1&&te%1==0&&te<G}var Rt=se?function(te,G,ne){var _e,we=G+"";return se(te,"toString",{configurable:!0,enumerable:!1,value:(_e=oe(we,Tt(Lt(we),ne)),function(){return _e})})}:function(te){return te};function Tt(te,G){return(function(ne,_e){for(var we=-1,ye=ne?ne.length:0;++we<ye&&_e(ne[we],we,ne)!==!1;);})(f,(function(ne){var _e="_."+ne[0];G&ne[1]&&!T(te,_e)&&te.push(_e)})),te.sort()}function $e(te,G,ne){var _e=Oe(te,8,void 0,void 0,void 0,void 0,void 0,G=ne?void 0:G);return _e.placeholder=$e.placeholder,_e}function Ue(te){var G=typeof te;return!!te&&(G=="object"||G=="function")}function Ze(te){return te?(te=(function(G){if(typeof G=="number")return G;if((function(we){return typeof we=="symbol"||(function(ye){return!!ye&&typeof ye=="object"})(we)&&he.call(we)=="[object Symbol]"})(G))return c;if(Ue(G)){var ne=typeof G.valueOf=="function"?G.valueOf():G;G=Ue(ne)?ne+"":ne}if(typeof G!="string")return G===0?G:+G;G=G.replace(g,"");var _e=i.test(G);return _e||l.test(G)?d(G.slice(2),_e?2:8):r.test(G)?c:+G})(te))===m||te===-1/0?17976931348623157e292*(te<0?-1:1):te==te?te:0:te===0?te:0}function vt(te){var G=Ze(te),ne=G%1;return G==G?ne?G-ne:G:0}$e.placeholder={},o.exports=$e},301:(o,n,u)=>{var m=u(8336),c=Array.prototype.concat,f=Array.prototype.slice,v=o.exports=function(S){for(var g=[],a=0,t=S.length;a<t;a++){var e=S[a];m(e)?g=c.call(g,f.call(e)):g.push(e)}return g};v.wrap=function(S){return function(){return S(v(arguments))}}},4119:o=>{o.exports=C}},k={};function j(o){var n=k[o];if(n!==void 0)return n.exports;var u=k[o]={exports:{}};return w[o](u,u.exports,j),u.exports}j.n=o=>{var n=o&&o.__esModule?()=>o.default:()=>o;return j.d(n,{a:n}),n},j.d=(o,n)=>{for(var u in n)j.o(n,u)&&!j.o(o,u)&&Object.defineProperty(o,u,{enumerable:!0,get:n[u]})},j.o=(o,n)=>Object.prototype.hasOwnProperty.call(o,n),j.r=o=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var I={};return(()=>{function o(R){return o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},o(R)}function n(R){var x=(function(E,A){if(o(E)!="object"||!E)return E;var $=E[Symbol.toPrimitive];if($!==void 0){var q=$.call(E,A);if(o(q)!="object")return q;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(E)})(R,"string");return o(x)=="symbol"?x:x+""}function u(R,x,E){return(x=n(x))in R?Object.defineProperty(R,x,{value:E,enumerable:!0,configurable:!0,writable:!0}):R[x]=E,R}function m(R,x){var E=Object.keys(R);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(R);x&&(A=A.filter((function($){return Object.getOwnPropertyDescriptor(R,$).enumerable}))),E.push.apply(E,A)}return E}function c(R){for(var x=1;x<arguments.length;x++){var E=arguments[x]!=null?arguments[x]:{};x%2?m(Object(E),!0).forEach((function(A){u(R,A,E[A])})):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(E)):m(Object(E)).forEach((function(A){Object.defineProperty(R,A,Object.getOwnPropertyDescriptor(E,A))}))}return R}function f(R,x){if(!(R instanceof x))throw new TypeError("Cannot call a class as a function")}function v(R,x){for(var E=0;E<x.length;E++){var A=x[E];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(R,n(A.key),A)}}function S(R,x,E){return x&&v(R.prototype,x),E&&v(R,E),Object.defineProperty(R,"prototype",{writable:!1}),R}function g(R){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},g(R)}function a(){try{var R=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch{}return(a=function(){return!!R})()}function t(R,x){if(x&&(o(x)=="object"||typeof x=="function"))return x;if(x!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E})(R)}function e(R,x,E){return x=g(x),t(R,a()?Reflect.construct(x,E||[],g(R).constructor):x.apply(R,E))}function r(R,x){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(E,A){return E.__proto__=A,E},r(R,x)}function i(R,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(x&&x.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),Object.defineProperty(R,"prototype",{writable:!1}),x&&r(R,x)}j.r(I),j.d(I,{default:()=>Bn});var _=j(4119),l=j.n(_);function b(){var R=this.constructor.getDerivedStateFromProps(this.props,this.state);R!=null&&this.setState(R)}function d(R){this.setState((function(x){var E=this.constructor.getDerivedStateFromProps(R,x);return E??null}).bind(this))}function y(R,x){try{var E=this.props,A=this.state;this.props=R,this.state=x,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(E,A)}finally{this.props=E,this.state=A}}function M(R){var x=R.prototype;if(!x||!x.isReactComponent)throw new Error("Can only polyfill class components");if(typeof R.getDerivedStateFromProps!="function"&&typeof x.getSnapshotBeforeUpdate!="function")return R;var E=null,A=null,$=null;if(typeof x.componentWillMount=="function"?E="componentWillMount":typeof x.UNSAFE_componentWillMount=="function"&&(E="UNSAFE_componentWillMount"),typeof x.componentWillReceiveProps=="function"?A="componentWillReceiveProps":typeof x.UNSAFE_componentWillReceiveProps=="function"&&(A="UNSAFE_componentWillReceiveProps"),typeof x.componentWillUpdate=="function"?$="componentWillUpdate":typeof x.UNSAFE_componentWillUpdate=="function"&&($="UNSAFE_componentWillUpdate"),E!==null||A!==null||$!==null){var q=R.displayName||R.name,K=typeof R.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+q+" uses "+K+" but also contains the following legacy lifecycles:"+(E!==null?`
  `+E:"")+(A!==null?`
  `+A:"")+($!==null?`
  `+$:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof R.getDerivedStateFromProps=="function"&&(x.componentWillMount=b,x.componentWillReceiveProps=d),typeof x.getSnapshotBeforeUpdate=="function"){if(typeof x.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");x.componentWillUpdate=y;var U=x.componentDidUpdate;x.componentDidUpdate=function(X,re,ue){var de=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:ue;U.call(this,X,re,de)}}return R}function D(R,x){if(R==null)return{};var E={};for(var A in R)if({}.hasOwnProperty.call(R,A)){if(x.includes(A))continue;E[A]=R[A]}return E}function N(R,x){if(R==null)return{};var E,A,$=D(R,x);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(R);for(A=0;A<q.length;A++)E=q[A],x.includes(E)||{}.propertyIsEnumerable.call(R,E)&&($[E]=R[E])}return $}function T(R,x){if(x&&R?.constructor===x)return"bigNumber";var E=(function(A){return{}.toString.call(A).match(/\s([a-zA-Z]+)/)[1].toLowerCase()})(R);return E==="number"&&(E=isNaN(R)?"nan":(0|R)!=R?"float":"integer"),E}function z(R){return R.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\f/g,"\\f")}b.__suppressDeprecationWarning=!0,d.__suppressDeprecationWarning=!0,y.__suppressDeprecationWarning=!0;var J={scheme:"rjv-default",author:"mac gainor",base00:"rgba(0, 0, 0, 0)",base01:"rgb(245, 245, 245)",base02:"rgb(235, 235, 235)",base03:"#93a1a1",base04:"rgba(0, 0, 0, 0.3)",base05:"#586e75",base06:"#073642",base07:"#002b36",base08:"#d33682",base09:"#cb4b16",base0A:"#dc322f",base0B:"#859900",base0C:"#6c71c4",base0D:"#586e75",base0E:"#2aa198",base0F:"#268bd2"},ie={scheme:"rjv-grey",author:"mac gainor",base00:"rgba(1, 1, 1, 0)",base01:"rgba(1, 1, 1, 0.1)",base02:"rgba(0, 0, 0, 0.2)",base03:"rgba(1, 1, 1, 0.3)",base04:"rgba(0, 0, 0, 0.4)",base05:"rgba(1, 1, 1, 0.5)",base06:"rgba(1, 1, 1, 0.6)",base07:"rgba(1, 1, 1, 0.7)",base08:"rgba(1, 1, 1, 0.8)",base09:"rgba(1, 1, 1, 0.8)",base0A:"rgba(1, 1, 1, 0.8)",base0B:"rgba(1, 1, 1, 0.8)",base0C:"rgba(1, 1, 1, 0.8)",base0D:"rgba(1, 1, 1, 0.8)",base0E:"rgba(1, 1, 1, 0.8)",base0F:"rgba(1, 1, 1, 0.8)"};const F={globalFontFamily:"monospace",globalCursor:"default",braceFontWeight:"bold",braceCursor:"pointer",ellipsisFontSize:"18px",ellipsisLineHeight:"10px",ellipsisCursor:"pointer",keyMargin:"0px 5px",keyLetterSpacing:"0.5px",keyFontStyle:"none",keyVerticalAlign:"top",keyOpacity:"0.85",keyOpacityHover:"1",keyValPaddingTop:"3px",keyValPaddingBottom:"3px",keyValPaddingRight:"5px",keyValBorderLeft:"1px solid",keyValBorderHover:"2px solid",pushedContentMarginLeft:"6px",variableValuePaddingRight:"6px",nullFontSize:"11px",nullFontWeight:"bold",nullPadding:"1px 2px",nullBorderRadius:"3px",nanFontSize:"11px",nanFontWeight:"bold",nanPadding:"1px 2px",nanBorderRadius:"3px",undefinedFontSize:"11px",undefinedPadding:"1px 2px",undefinedBorderRadius:"3px",dataTypeFontSize:"11px",dataTypeMarginRight:"4px",datatypeOpacity:"0.8",objectSizeBorderRadius:"3px",objectSizeFontStyle:"italic",objectSizeMargin:"0px 6px 0px 0px",clipboardCursor:"pointer",clipboardCheckMarginLeft:"-12px",metaDataPadding:"0px 0px 0px 10px",arrayGroupMetaPadding:"0px 0px 0px 4px",iconContainerWidth:"17px",tooltipPadding:"4px",editInputMinWidth:"130px",editInputBorderRadius:"2px",editInputPadding:"5px",editInputMarginRight:"4px",editInputFontFamily:"monospace",iconCursor:"pointer",iconFontSize:"15px",iconPaddingRight:"1px",dateValueMarginLeft:"2px",iconMarginRight:"3px",detectedRowPaddingTop:"3px",addKeyCoverBackground:"rgba(255, 255, 255, 0.3)",addKeyCoverPosition:"absolute",addKeyCoverPositionPx:"0px",addKeyModalWidth:"200px",addKeyModalMargin:"auto",addKeyModalPadding:"10px",addKeyModalRadius:"3px",commaColor:"#666",commaFontSize:"12px",commaMarginRight:"4px"};function ee(R,x){(x==null||x>R.length)&&(x=R.length);for(var E=0,A=Array(x);E<x;E++)A[E]=R[E];return A}function L(R,x){if(R){if(typeof R=="string")return ee(R,x);var E={}.toString.call(R).slice(8,-1);return E==="Object"&&R.constructor&&(E=R.constructor.name),E==="Map"||E==="Set"?Array.from(R):E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E)?ee(R,x):void 0}}function B(R,x){return(function(E){if(Array.isArray(E))return E})(R)||(function(E,A){var $=E==null?null:typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if($!=null){var q,K,U,X,re=[],ue=!0,de=!1;try{if(U=($=$.call(E)).next,A===0){if(Object($)!==$)return;ue=!1}else for(;!(ue=(q=U.call($)).done)&&(re.push(q.value),re.length!==A);ue=!0);}catch(ve){de=!0,K=ve}finally{try{if(!ue&&$.return!=null&&(X=$.return(),Object(X)!==X))return}finally{if(de)throw K}}return re}})(R,x)||L(R,x)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}var P=j(9446),W=j(3639),Q=j.n(W),ae=j(3989),he=j.n(ae);function me(R,x){var E=Object.keys(R);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(R);x&&(A=A.filter((function($){return Object.getOwnPropertyDescriptor(R,$).enumerable}))),E.push.apply(E,A)}return E}function V(R){for(var x=1;x<arguments.length;x++){var E=arguments[x]!=null?arguments[x]:{};x%2?me(Object(E),!0).forEach((function(A){u(R,A,E[A])})):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(E)):me(Object(E)).forEach((function(A){Object.defineProperty(R,A,Object.getOwnPropertyDescriptor(E,A))}))}return R}var O=P.default,Y=Object.keys(O),se=function(R){var x,E=(function(X){var re=X[0]/255,ue=X[1]/255,de=X[2]/255;return[.299*re+.587*ue+.114*de,-.14713*re+-.28886*ue+.436*de,.615*re+-.51499*ue+-.10001*de]})(Q()(R).array()),A=B(E,3),$=A[0],q=A[1],K=A[2],U=(function(X){var re,ue,de,ve=X[0],fe=X[1],ke=X[2];return re=1*ve+0*fe+1.13983*ke,ue=1*ve+-.39465*fe+-.5806*ke,de=1*ve+2.02311*fe+0*ke,[255*(re=Math.min(Math.max(0,re),1)),255*(ue=Math.min(Math.max(0,ue),1)),255*(de=Math.min(Math.max(0,de),1))]})([(x=$,x<.25?1:x<.5?.9-x:1.1-x),q,K]);return Q().rgb(U).hex()},le=function(R){return function(x){return{className:[x.className,R.className].filter(Boolean).join(" "),style:V(V({},x.style||{}),R.style||{})}}},ce=function(R,x){var E=Object.keys(x);for(var A in R)E.indexOf(A)===-1&&E.push(A);return E.reduce((function($,q){return $[q]=(function(K,U){if(K===void 0)return U;if(U===void 0)return K;var X=o(K),re=o(U);switch(X){case"string":switch(re){case"string":return[U,K].filter(Boolean).join(" ");case"object":return le({className:K,style:U});case"function":return function(ue){for(var de=arguments.length,ve=new Array(de>1?de-1:0),fe=1;fe<de;fe++)ve[fe-1]=arguments[fe];return le({className:K})(U.apply(void 0,[ue].concat(ve)))}}break;case"object":switch(re){case"string":return le({className:U,style:K});case"object":return V(V({},U),K);case"function":return function(ue){for(var de=arguments.length,ve=new Array(de>1?de-1:0),fe=1;fe<de;fe++)ve[fe-1]=arguments[fe];return le({style:K})(U.apply(void 0,[ue].concat(ve)))}}break;case"function":switch(re){case"string":return function(ue){for(var de=arguments.length,ve=new Array(de>1?de-1:0),fe=1;fe<de;fe++)ve[fe-1]=arguments[fe];return K.apply(void 0,[le(ue)({className:U})].concat(ve))};case"object":return function(ue){for(var de=arguments.length,ve=new Array(de>1?de-1:0),fe=1;fe<de;fe++)ve[fe-1]=arguments[fe];return K.apply(void 0,[le(ue)({style:U})].concat(ve))};case"function":return function(ue){for(var de=arguments.length,ve=new Array(de>1?de-1:0),fe=1;fe<de;fe++)ve[fe-1]=arguments[fe];return K.apply(void 0,[U.apply(void 0,[ue].concat(ve))].concat(ve))}}}})(R[q],x[q]),$}),{})},xe=function(R,x){for(var E=arguments.length,A=new Array(E>2?E-2:0),$=2;$<E;$++)A[$-2]=arguments[$];if(x===null)return R;Array.isArray(x)||(x=[x]);var q=x.map((function(K){return R[K]})).filter(Boolean).reduce((function(K,U){return typeof U=="string"?K.className=[K.className,U].filter(Boolean).join(" "):o(U)==="object"?K.style=V(V({},K.style),U):typeof U=="function"&&(K=V(V({},K),U.apply(void 0,[K].concat(A)))),K}),{className:"",style:{}});return q.className||delete q.className,Object.keys(q.style).length===0&&delete q.style,q},Re=function(R){return Object.keys(R).reduce((function(x,E){return x[E]=/^base/.test(E)?se(R[E]):E==="scheme"?R[E]+":inverted":R[E],x}),{})},Oe=he()((function(R){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=x.defaultBase16,$=A===void 0?O:A,q=x.base16Themes,K=be(E,q===void 0?null:q);K&&(E=V(V({},K),E));for(var U=Y.reduce((function(ke,Ae){return ke[Ae]=E[Ae]||$[Ae],ke}),{}),X=Object.keys(E).reduce((function(ke,Ae){return Y.indexOf(Ae)===-1&&(ke[Ae]=E[Ae]),ke}),{}),re=R(U),ue=ce(X,re),de=arguments.length,ve=new Array(de>3?de-3:0),fe=3;fe<de;fe++)ve[fe-3]=arguments[fe];return he()(xe,2).apply(void 0,[ue].concat(ve))}),3),He=function(R){return!!R.extend},be=function(R,x){if(R&&He(R)&&R.extend&&(R=R.extend),typeof R=="string"){var E=B(R.split(":"),2),A=E[0],$=E[1];R=x?x[A]:P[A],$==="inverted"&&(R=Re(R))}return R&&Object.prototype.hasOwnProperty.call(R,"base00")?R:void 0},Lt=function(R){var x=(function(E){return{backgroundColor:E.base00,ellipsisColor:E.base09,braceColor:E.base07,expandedIcon:E.base0D,collapsedIcon:E.base0E,keyColor:E.base07,arrayKeyColor:E.base0C,objectSize:E.base04,copyToClipboard:E.base0F,copyToClipboardCheck:E.base0D,objectBorder:E.base02,dataTypes:{boolean:E.base0E,date:E.base0D,float:E.base0B,function:E.base0D,integer:E.base0F,string:E.base09,nan:E.base08,null:E.base0A,undefined:E.base05,regexp:E.base0A,background:E.base02,bigNumber:E.base09},editVariable:{editIcon:E.base0E,cancelIcon:E.base09,removeIcon:E.base09,addIcon:E.base0E,checkIcon:E.base0E,background:E.base01,color:E.base0A,border:E.base07},addKeyModal:{background:E.base05,border:E.base04,color:E.base0A,labelColor:E.base01},validationFailure:{background:E.base09,iconColor:E.base01,fontColor:E.base01}}})(R);return{"app-container":{fontFamily:F.globalFontFamily,cursor:F.globalCursor,backgroundColor:x.backgroundColor,position:"relative"},ellipsis:{display:"inline-block",color:x.ellipsisColor,fontSize:F.ellipsisFontSize,lineHeight:F.ellipsisLineHeight,cursor:F.ellipsisCursor},"brace-row":{display:"inline-block",cursor:"pointer"},brace:{display:"inline-block",cursor:F.braceCursor,fontWeight:F.braceFontWeight,color:x.braceColor},"expanded-icon":{color:x.expandedIcon},"collapsed-icon":{color:x.collapsedIcon},colon:{display:"inline-block",margin:F.keyMargin,color:x.keyColor,verticalAlign:"top"},objectKeyVal:function(E,A){return{style:c({paddingTop:F.keyValPaddingTop,paddingRight:F.keyValPaddingRight,paddingBottom:F.keyValPaddingBottom,borderLeft:F.keyValBorderLeft+" "+x.objectBorder,":hover":{paddingLeft:A.paddingLeft-1+"px",borderLeft:F.keyValBorderHover+" "+x.objectBorder}},A)}},"object-key-val-no-border":{padding:F.keyValPadding},"pushed-content":{marginLeft:F.pushedContentMarginLeft},variableValue:function(E,A){return{style:c({display:"inline-block",paddingRight:F.variableValuePaddingRight,position:"relative"},A)}},"object-name":{display:"inline-block",color:x.keyColor,letterSpacing:F.keyLetterSpacing,fontStyle:F.keyFontStyle,verticalAlign:F.keyVerticalAlign,opacity:F.keyOpacity,":hover":{opacity:F.keyOpacityHover}},"array-key":{display:"inline-block",color:x.arrayKeyColor,letterSpacing:F.keyLetterSpacing,fontStyle:F.keyFontStyle,verticalAlign:F.keyVerticalAlign,opacity:F.keyOpacity,":hover":{opacity:F.keyOpacityHover}},"object-size":{color:x.objectSize,borderRadius:F.objectSizeBorderRadius,fontStyle:F.objectSizeFontStyle,margin:F.objectSizeMargin,cursor:"default"},"data-type-label":{fontSize:F.dataTypeFontSize,marginRight:F.dataTypeMarginRight,opacity:F.datatypeOpacity},boolean:{display:"inline-block",color:x.dataTypes.boolean},date:{display:"inline-block",color:x.dataTypes.date},"date-value":{marginLeft:F.dateValueMarginLeft},float:{display:"inline-block",color:x.dataTypes.float},function:{display:"inline-block",color:x.dataTypes.function,cursor:"pointer",whiteSpace:"pre-line"},"function-value":{fontStyle:"italic"},integer:{display:"inline-block",color:x.dataTypes.integer},bigNumber:{display:"inline-block",color:x.dataTypes.bigNumber},string:{display:"inline-block",color:x.dataTypes.string},nan:{display:"inline-block",color:x.dataTypes.nan,fontSize:F.nanFontSize,fontWeight:F.nanFontWeight,backgroundColor:x.dataTypes.background,padding:F.nanPadding,borderRadius:F.nanBorderRadius},null:{display:"inline-block",color:x.dataTypes.null,fontSize:F.nullFontSize,fontWeight:F.nullFontWeight,backgroundColor:x.dataTypes.background,padding:F.nullPadding,borderRadius:F.nullBorderRadius},undefined:{display:"inline-block",color:x.dataTypes.undefined,fontSize:F.undefinedFontSize,padding:F.undefinedPadding,borderRadius:F.undefinedBorderRadius,backgroundColor:x.dataTypes.background},regexp:{display:"inline-block",color:x.dataTypes.regexp},"copy-to-clipboard":{cursor:F.clipboardCursor},"copy-icon":{color:x.copyToClipboard,fontSize:F.iconFontSize,marginRight:F.iconMarginRight,verticalAlign:"top"},"copy-icon-copied":{color:x.copyToClipboardCheck,marginLeft:F.clipboardCheckMarginLeft},"array-group-meta-data":{display:"inline-block",padding:F.arrayGroupMetaPadding},"object-meta-data":{display:"inline-block",padding:F.metaDataPadding},"icon-container":{display:"inline-block",width:F.iconContainerWidth},tooltip:{padding:F.tooltipPadding},removeVarIcon:{verticalAlign:"top",display:"inline-block",color:x.editVariable.removeIcon,cursor:F.iconCursor,fontSize:F.iconFontSize,marginRight:F.iconMarginRight},addVarIcon:{verticalAlign:"top",display:"inline-block",color:x.editVariable.addIcon,cursor:F.iconCursor,fontSize:F.iconFontSize,marginRight:F.iconMarginRight},editVarIcon:{verticalAlign:"top",display:"inline-block",color:x.editVariable.editIcon,cursor:F.iconCursor,fontSize:F.iconFontSize,marginRight:F.iconMarginRight},"edit-icon-container":{display:"inline-block",verticalAlign:"top"},"check-icon":{display:"inline-block",cursor:F.iconCursor,color:x.editVariable.checkIcon,fontSize:F.iconFontSize,paddingRight:F.iconPaddingRight},"cancel-icon":{display:"inline-block",cursor:F.iconCursor,color:x.editVariable.cancelIcon,fontSize:F.iconFontSize,paddingRight:F.iconPaddingRight},"edit-input":{display:"inline-block",minWidth:F.editInputMinWidth,borderRadius:F.editInputBorderRadius,backgroundColor:x.editVariable.background,color:x.editVariable.color,padding:F.editInputPadding,marginRight:F.editInputMarginRight,fontFamily:F.editInputFontFamily},"detected-row":{paddingTop:F.detectedRowPaddingTop},"key-modal-request":{position:F.addKeyCoverPosition,top:F.addKeyCoverPositionPx,left:F.addKeyCoverPositionPx,right:F.addKeyCoverPositionPx,bottom:F.addKeyCoverPositionPx,backgroundColor:F.addKeyCoverBackground},"key-modal":{width:F.addKeyModalWidth,backgroundColor:x.addKeyModal.background,marginLeft:F.addKeyModalMargin,marginRight:F.addKeyModalMargin,padding:F.addKeyModalPadding,borderRadius:F.addKeyModalRadius,marginTop:"15px",position:"relative"},"key-modal-label":{color:x.addKeyModal.labelColor,marginLeft:"2px",marginBottom:"5px",fontSize:"11px"},"key-modal-input-container":{overflow:"hidden"},"key-modal-input":{width:"100%",padding:"3px 6px",fontFamily:"monospace",color:x.addKeyModal.color,border:"none",boxSizing:"border-box",borderRadius:"2px"},"key-modal-cancel":{backgroundColor:x.editVariable.removeIcon,position:"absolute",top:"0px",right:"0px",borderRadius:"0px 3px 0px 3px",cursor:"pointer"},"key-modal-cancel-icon":{color:x.addKeyModal.labelColor,fontSize:F.iconFontSize,transform:"rotate(45deg)"},"key-modal-submit":{color:x.editVariable.addIcon,fontSize:F.iconFontSize,position:"absolute",right:"2px",top:"3px",cursor:"pointer"},"function-ellipsis":{display:"inline-block",color:x.ellipsisColor,fontSize:F.ellipsisFontSize,lineHeight:F.ellipsisLineHeight,cursor:F.ellipsisCursor},"validation-failure":{float:"right",padding:"3px 6px",borderRadius:"2px",cursor:"pointer",color:x.validationFailure.fontColor,backgroundColor:x.validationFailure.background},"validation-failure-label":{marginRight:"6px"},"validation-failure-clear":{position:"relative",verticalAlign:"top",cursor:"pointer",color:x.validationFailure.iconColor,fontSize:F.iconFontSize,transform:"rotate(45deg)"},comma:{display:"inline-block",color:F.commaColor,fontSize:F.commaFontSize,marginRight:F.commaMarginRight,cursor:"default"}}};function oe(R,x,E){return R||console.error("theme has not been set"),(function(A){var $=J;return A!==!1&&A!=="none"||($=ie),Oe(Lt,{defaultBase16:$})(A)})(R)(x,E)}var Ge=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=(E.rjvId,E.type_name),$=E.displayDataTypes,q=E.theme;return $?l().createElement("span",Object.assign({className:"data-type-label"},oe(q,"data-type-label")),A):null}}])})(l().PureComponent),Rt=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props;return l().createElement("div",oe(E.theme,"boolean"),l().createElement(Ge,Object.assign({type_name:"bool"},E)),E.value?"true":"false")}}])})(l().PureComponent),Tt=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props;return l().createElement("div",oe(E.theme,"date"),l().createElement(Ge,Object.assign({type_name:"date"},E)),l().createElement("span",Object.assign({className:"date-value"},oe(E.theme,"date-value")),E.value.toLocaleTimeString("en-us",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})))}}])})(l().PureComponent),$e=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props;return l().createElement("div",oe(E.theme,"float"),l().createElement(Ge,Object.assign({type_name:"float"},E)),this.props.value)}}])})(l().PureComponent);function Ue(R){return(function(x){if(Array.isArray(x))return ee(x)})(R)||(function(x){if(typeof Symbol<"u"&&x[Symbol.iterator]!=null||x["@@iterator"]!=null)return Array.from(x)})(R)||L(R)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}var Ze=j(9784),vt=(function(){return S((function R(){f(this,R),this.handler=function(){}}),[{key:"register",value:function(R){this.handler=R}},{key:"dispatch",value:function(R){var x;(x=this.handler)===null||x===void 0||x.call(this,R)}}])})();globalThis.__globalDispatcherInstance||(globalThis.__globalDispatcherInstance=new vt);const te=globalThis.__globalDispatcherInstance;var G=new((function(R){function x(){var E;f(this,x);for(var A=arguments.length,$=new Array(A),q=0;q<A;q++)$[q]=arguments[q];return(E=e(this,x,[].concat($))).objects={},E.set=function(K,U,X,re){E.objects[K]===void 0&&(E.objects[K]={}),E.objects[K][U]===void 0&&(E.objects[K][U]={}),E.objects[K][U][X]=re},E.get=function(K,U,X,re){return E.objects[K]===void 0||E.objects[K][U]===void 0||E.objects[K][U][X]==null?re:E.objects[K][U][X]},E.handleAction=function(K){var U=K.rjvId,X=K.data;switch(K.name){case"RESET":E.emit("reset-"+U);break;case"VARIABLE_UPDATED":K.data.updated_src=E.updateSrc(U,X),E.set(U,"action","variable-update",c(c({},X),{},{type:"variable-edited"})),E.emit("variable-update-"+U);break;case"VARIABLE_REMOVED":K.data.updated_src=E.updateSrc(U,X),E.set(U,"action","variable-update",c(c({},X),{},{type:"variable-removed"})),E.emit("variable-update-"+U);break;case"VARIABLE_ADDED":K.data.updated_src=E.updateSrc(U,X),E.set(U,"action","variable-update",c(c({},X),{},{type:"variable-added"})),E.emit("variable-update-"+U);break;case"ADD_VARIABLE_KEY_REQUEST":E.set(U,"action","new-key-request",X),E.emit("add-key-request-"+U)}},E.updateSrc=function(K,U){var X=U.name,re=U.namespace,ue=U.new_value,de=(U.existing_value,U.variable_removed);re.shift();var ve,fe=E.get(K,"global","src"),ke=E.deepCopy(fe,Ue(re)),Ae=ke,Se=(function(Le,lt){var Be=typeof Symbol<"u"&&Le[Symbol.iterator]||Le["@@iterator"];if(!Be){if(Array.isArray(Le)||(Be=L(Le))||lt){Be&&(Le=Be);var Et=0,tt=function(){};return{s:tt,n:function(){return Et>=Le.length?{done:!0}:{done:!1,value:Le[Et++]}},e:function(kt){throw kt},f:tt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var es,zt=!0,Kt=!1;return{s:function(){Be=Be.call(Le)},n:function(){var kt=Be.next();return zt=kt.done,kt},e:function(kt){Kt=!0,es=kt},f:function(){try{zt||Be.return==null||Be.return()}finally{if(Kt)throw es}}}})(re);try{for(Se.s();!(ve=Se.n()).done;)Ae=Ae[ve.value]}catch(Le){Se.e(Le)}finally{Se.f()}return de?T(Ae)=="array"?Ae.splice(X,1):delete Ae[X]:X!==null?Ae[X]=ue:ke=ue,E.set(K,"global","src",ke),ke},E.deepCopy=function(K,U){var X,re=T(K),ue=U.shift();return re=="array"?X=Ue(K):re=="object"&&(X=c({},K)),ue!==void 0&&(X[ue]=E.deepCopy(K[ue],U)),X},E}return i(x,R),S(x)})(Ze.EventEmitter));te.register(G.handleAction.bind(G));const ne=G;var _e=(function(R){function x(E){var A;return f(this,x),(A=e(this,x,[E])).toggleCollapsed=function(){A.setState({collapsed:!A.state.collapsed},(function(){ne.set(A.props.rjvId,A.props.namespace,"collapsed",A.state.collapsed)}))},A.getFunctionDisplay=function($){var q=A.props;return $?l().createElement("span",null,A.props.value.toString().slice(9,-1).replace(/\{[\s\S]+/,""),l().createElement("span",{className:"function-collapsed",style:{fontWeight:"bold"}},l().createElement("span",null,"{"),l().createElement("span",oe(q.theme,"ellipsis"),"..."),l().createElement("span",null,"}"))):A.props.value.toString().slice(9,-1)},A.state={collapsed:ne.get(E.rjvId,E.namespace,"collapsed",!0)},A}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=this.state.collapsed;return l().createElement("div",oe(E.theme,"function"),l().createElement(Ge,Object.assign({type_name:"function"},E)),l().createElement("span",Object.assign({},oe(E.theme,"function-value"),{className:"rjv-function-container",onClick:this.toggleCollapsed}),this.getFunctionDisplay(A)))}}])})(l().PureComponent),we=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){return l().createElement("div",oe(this.props.theme,"nan"),"NaN")}}])})(l().PureComponent),ye=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){return l().createElement("div",oe(this.props.theme,"null"),"NULL")}}])})(l().PureComponent),Pe=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props;return l().createElement("div",oe(E.theme,"integer"),l().createElement(Ge,Object.assign({type_name:"int"},E)),this.props.value)}}])})(l().PureComponent),We=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props;return l().createElement("div",oe(E.theme,"regexp"),l().createElement(Ge,Object.assign({type_name:"regexp"},E)),this.props.value.toString())}}])})(l().PureComponent),rt=(function(R){function x(E){var A;return f(this,x),(A=e(this,x,[E])).toggleCollapsed=function(){A.setState({collapsed:!A.state.collapsed},(function(){ne.set(A.props.rjvId,A.props.namespace,"collapsed",A.state.collapsed)}))},A.state={collapsed:ne.get(E.rjvId,E.namespace,"collapsed",!0)},A}return i(x,R),S(x,[{key:"render",value:function(){var E=this.state.collapsed,A=this.props,$=A.collapseStringsAfterLength,q=A.theme,K=A.escapeStrings,U=A.value,X=T($)==="integer",re={style:{cursor:"default",wordBreak:"break-all"}};return K&&(U=z(U)),X&&U.length>$&&(re.style.cursor="pointer",E&&(U=l().createElement("span",null,U.substring(0,$),l().createElement("span",oe(q,"ellipsis")," ...")))),l().createElement("div",oe(q,"string"),l().createElement(Ge,Object.assign({type_name:"string"},A)),l().createElement("span",Object.assign({className:"string-value"},re,{onClick:this.toggleCollapsed}),'"',U,'"'))}}])})(l().PureComponent),it=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){return l().createElement("div",oe(this.props.theme,"undefined"),"undefined")}}])})(l().PureComponent),Je=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props;return l().createElement("div",oe(E.theme,"bigNumber"),l().createElement(Ge,Object.assign({type_name:"bigNumber"},E)),this.props.value.toString())}}])})(l().PureComponent);function ct(){return ct=Object.assign?Object.assign.bind():function(R){for(var x=1;x<arguments.length;x++){var E=arguments[x];for(var A in E)({}).hasOwnProperty.call(E,A)&&(R[A]=E[A])}return R},ct.apply(null,arguments)}const Ve=_.useLayoutEffect;var bt=function(R,x){typeof R!="function"?R.current=x:R(x)};const nt=function(R,x){var E=(0,_.useRef)();return(0,_.useCallback)((function(A){R.current=A,E.current&&bt(E.current,null),E.current=x,x&&bt(x,A)}),[x])};var Ct={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},ot=function(R){Object.keys(Ct).forEach((function(x){R.style.setProperty(x,Ct[x],"important")}))},Me=null,Ie=function(R,x){var E=R.scrollHeight;return x.sizingStyle.boxSizing==="border-box"?E+x.borderSize:E-x.paddingSize},ze=function(){},at=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],Ot=!!document.documentElement.currentStyle,St=function(R){var x=window.getComputedStyle(R);if(x===null)return null;var E,A=(E=x,at.reduce((function(q,K){return q[K]=E[K],q}),{})),$=A.boxSizing;return $===""?null:(Ot&&$==="border-box"&&(A.width=parseFloat(A.width)+parseFloat(A.borderRightWidth)+parseFloat(A.borderLeftWidth)+parseFloat(A.paddingRight)+parseFloat(A.paddingLeft)+"px"),{sizingStyle:A,paddingSize:parseFloat(A.paddingBottom)+parseFloat(A.paddingTop),borderSize:parseFloat(A.borderBottomWidth)+parseFloat(A.borderTopWidth)})};function Ye(R,x,E){var A,$,q=(A=E,$=_.useRef(A),Ve((function(){$.current=A})),$);_.useLayoutEffect((function(){var K=function(U){return q.current(U)};if(R)return R.addEventListener(x,K),function(){return R.removeEventListener(x,K)}}),[])}var Bt=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],Ne=function(R,x){var E=R.cacheMeasurements,A=R.maxRows,$=R.minRows,q=R.onChange,K=q===void 0?ze:q,U=R.onHeightChange,X=U===void 0?ze:U,re=D(R,Bt),ue=re.value!==void 0,de=_.useRef(null),ve=nt(de,x),fe=_.useRef(0),ke=_.useRef(),Ae=function(){var Se=de.current,Le=E&&ke.current?ke.current:St(Se);if(Le){ke.current=Le;var lt=(function(tt,es,zt,Kt){zt===void 0&&(zt=1),Kt===void 0&&(Kt=1/0),Me||((Me=document.createElement("textarea")).setAttribute("tabindex","-1"),Me.setAttribute("aria-hidden","true"),ot(Me)),Me.parentNode===null&&document.body.appendChild(Me);var kt=tt.paddingSize,Nr=tt.borderSize,$s=tt.sizingStyle,Br=$s.boxSizing;Object.keys($s).forEach((function(Pn){var Pr=Pn;Me.style[Pr]=$s[Pr]})),ot(Me),Me.value=es;var ts=Ie(Me,tt);Me.value=es,ts=Ie(Me,tt),Me.value="x";var Us=Me.scrollHeight-kt,Ws=Us*zt;Br==="border-box"&&(Ws=Ws+kt+Nr),ts=Math.max(Ws,ts);var Vs=Us*Kt;return Br==="border-box"&&(Vs=Vs+kt+Nr),[ts=Math.min(Vs,ts),Us]})(Le,Se.value||Se.placeholder||"x",$,A),Be=lt[0],Et=lt[1];fe.current!==Be&&(fe.current=Be,Se.style.setProperty("height",Be+"px","important"),X(Be,{rowHeight:Et}))}};return _.useLayoutEffect(Ae),(function(Se,Le){Ye(document.body,"reset",(function(lt){Se.current.form===lt.target&&Le(lt)}))})(de,(function(){if(!ue){var Se=de.current.value;requestAnimationFrame((function(){var Le=de.current;Le&&Se!==Le.value&&Ae()}))}})),Ye(window,"resize",Ae),(function(Se){Ye(document.fonts,"loadingdone",Se)})(Ae),_.createElement("textarea",ct({},re,{onChange:function(Se){ue||Ae(),K(Se)},ref:ve}))},Xe=_.forwardRef(Ne);function Qe(R,x){R=R.trim();try{if((R=structuredClone(R))[0]==="[")return De("array",JSON.parse(R));if(R[0]==="{")return De("object",JSON.parse(R));if(R.match(/\-?\d+\.\d+/)&&R.match(/\-?\d+\.\d+/)[0]===R)return x&&parseFloat(R).toString()!==R?De("bigNumber",R):De("float",parseFloat(R));if(R.match(/\-?\d+e-\d+/)&&R.match(/\-?\d+e-\d+/)[0]===R)return De("float",Number(R));if(R.match(/\-?\d+/)&&R.match(/\-?\d+/)[0]===R)return x&&parseInt(R).toString()!==R?De("bigNumber",R):De("integer",parseInt(R));if(R.match(/\-?\d+e\+\d+/)&&R.match(/\-?\d+e\+\d+/)[0]===R)return De("integer",Number(R))}catch{}switch(R=R.toLowerCase()){case"undefined":return De("undefined",void 0);case"nan":return De("nan",NaN);case"null":return De("null",null);case"true":return De("boolean",!0);case"false":return De("boolean",!1);default:if(R=Date.parse(R))return De("date",new Date(R))}return De(!1,null)}function De(R,x){return{type:R,value:x}}var Ke=["style"],yt=["style"],wt=["style"],et=["style"],ht=["style"],xt=["style"],Dt=["style"],Pt=["style"],Bs=["style"],ds=["style"],bn=["style"],Cn=["style"],Sn=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,Ke);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 24 24",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("path",{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,13H17V11H7"})))}}])})(l().PureComponent),yn=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,yt);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 24 24",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("path",{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z"})))}}])})(l().PureComponent),wn=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,wt),q=ut(A).style;return l().createElement("span",$,l().createElement("svg",{fill:q.color,width:q.height,height:q.width,style:q,viewBox:"0 0 1792 1792"},l().createElement("path",{d:"M1344 800v64q0 14-9 23t-23 9h-832q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h832q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"})))}}])})(l().PureComponent),xn=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,et),q=ut(A).style;return l().createElement("span",$,l().createElement("svg",{fill:q.color,width:q.height,height:q.width,style:q,viewBox:"0 0 1792 1792"},l().createElement("path",{d:"M1344 800v64q0 14-9 23t-23 9h-352v352q0 14-9 23t-23 9h-64q-14 0-23-9t-9-23v-352h-352q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h352v-352q0-14 9-23t23-9h64q14 0 23 9t9 23v352h352q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"})))}}])})(l().PureComponent),En=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,ht);return l().createElement("span",$,l().createElement("svg",{style:c(c({},ut(A).style),{},{paddingLeft:"2px",verticalAlign:"top"}),viewBox:"0 0 15 15",fill:"currentColor"},l().createElement("path",{d:"M0 14l6-6-6-6z"})))}}])})(l().PureComponent),kn=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,xt);return l().createElement("span",$,l().createElement("svg",{style:c(c({},ut(A).style),{},{paddingLeft:"2px",verticalAlign:"top"}),viewBox:"0 0 15 15",fill:"currentColor"},l().createElement("path",{d:"M0 5l6 6 6-6z"})))}}])})(l().PureComponent),Mr=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,Dt);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("g",null,l().createElement("path",{d:"m30 35h-25v-22.5h25v7.5h2.5v-12.5c0-1.4-1.1-2.5-2.5-2.5h-7.5c0-2.8-2.2-5-5-5s-5 2.2-5 5h-7.5c-1.4 0-2.5 1.1-2.5 2.5v27.5c0 1.4 1.1 2.5 2.5 2.5h25c1.4 0 2.5-1.1 2.5-2.5v-5h-2.5v5z m-20-27.5h2.5s2.5-1.1 2.5-2.5 1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5 1.3 2.5 2.5 2.5h2.5s2.5 1.1 2.5 2.5h-20c0-1.5 1.1-2.5 2.5-2.5z m-2.5 20h5v-2.5h-5v2.5z m17.5-5v-5l-10 7.5 10 7.5v-5h12.5v-5h-12.5z m-17.5 10h7.5v-2.5h-7.5v2.5z m12.5-17.5h-12.5v2.5h12.5v-2.5z m-7.5 5h-5v2.5h5v-2.5z"}))))}}])})(l().PureComponent),Ps=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,Pt);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("g",null,l().createElement("path",{d:"m28.6 25q0-0.5-0.4-1l-4-4 4-4q0.4-0.5 0.4-1 0-0.6-0.4-1.1l-2-2q-0.4-0.4-1-0.4-0.6 0-1 0.4l-4.1 4.1-4-4.1q-0.4-0.4-1-0.4-0.6 0-1 0.4l-2 2q-0.5 0.5-0.5 1.1 0 0.5 0.5 1l4 4-4 4q-0.5 0.5-0.5 1 0 0.7 0.5 1.1l2 2q0.4 0.4 1 0.4 0.6 0 1-0.4l4-4.1 4.1 4.1q0.4 0.4 1 0.4 0.6 0 1-0.4l2-2q0.4-0.4 0.4-1z m8.7-5q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}])})(l().PureComponent),An=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,Bs);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("g",null,l().createElement("path",{d:"m30.1 21.4v-2.8q0-0.6-0.4-1t-1-0.5h-5.7v-5.7q0-0.6-0.4-1t-1-0.4h-2.9q-0.6 0-1 0.4t-0.4 1v5.7h-5.7q-0.6 0-1 0.5t-0.5 1v2.8q0 0.6 0.5 1t1 0.5h5.7v5.7q0 0.5 0.4 1t1 0.4h2.9q0.6 0 1-0.4t0.4-1v-5.7h5.7q0.6 0 1-0.5t0.4-1z m7.2-1.4q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}])})(l().PureComponent),Lr=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,ds);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("g",null,l().createElement("path",{d:"m31.6 21.6h-10v10h-3.2v-10h-10v-3.2h10v-10h3.2v10h10v3.2z"}))))}}])})(l().PureComponent),Mn=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,bn);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("g",null,l().createElement("path",{d:"m19.8 26.4l2.6-2.6-3.4-3.4-2.6 2.6v1.3h2.2v2.1h1.2z m9.8-16q-0.3-0.4-0.7 0l-7.8 7.8q-0.4 0.4 0 0.7t0.7 0l7.8-7.8q0.4-0.4 0-0.7z m1.8 13.2v4.3q0 2.6-1.9 4.5t-4.5 1.9h-18.6q-2.6 0-4.5-1.9t-1.9-4.5v-18.6q0-2.7 1.9-4.6t4.5-1.8h18.6q1.4 0 2.6 0.5 0.3 0.2 0.4 0.5 0.1 0.4-0.2 0.7l-1.1 1.1q-0.3 0.3-0.7 0.1-0.5-0.1-1-0.1h-18.6q-1.4 0-2.5 1.1t-1 2.5v18.6q0 1.4 1 2.5t2.5 1h18.6q1.5 0 2.5-1t1.1-2.5v-2.9q0-0.2 0.2-0.4l1.4-1.5q0.3-0.3 0.8-0.1t0.4 0.6z m-2.1-16.5l6.4 6.5-15 15h-6.4v-6.5z m9.9 3l-2.1 2-6.4-6.4 2.1-2q0.6-0.7 1.5-0.7t1.5 0.7l3.4 3.4q0.6 0.6 0.6 1.5t-0.6 1.5z"}))))}}])})(l().PureComponent),Fs=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.style,$=N(E,Cn);return l().createElement("span",$,l().createElement("svg",Object.assign({},ut(A),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),l().createElement("g",null,l().createElement("path",{d:"m31.7 16.4q0-0.6-0.4-1l-2.1-2.1q-0.4-0.4-1-0.4t-1 0.4l-9.1 9.1-5-5q-0.5-0.4-1-0.4t-1 0.4l-2.1 2q-0.4 0.4-0.4 1 0 0.6 0.4 1l8.1 8.1q0.4 0.4 1 0.4 0.6 0 1-0.4l12.2-12.1q0.4-0.4 0.4-1z m5.6 3.6q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}])})(l().PureComponent);function ut(R){return R||(R={}),{style:c(c({verticalAlign:"middle"},R),{},{color:R.color?R.color:"#000000",height:"1em",width:"1em"})}}var Rr=(function(R){function x(E){var A;return f(this,x),(A=e(this,x,[E])).copiedTimer=null,A.copyToClipboardFallback=function($){var q=document.createElement("textarea");q.value=$,document.body.appendChild(q),q.select(),document.execCommand("copy"),document.body.removeChild(q)},A.handleCopy=function(){var $=A.props,q=$.clickCallback,K=$.src,U=$.namespace,X=JSON.stringify(A.clipboardValue(K),null,"  ");navigator.clipboard?navigator.clipboard.writeText(X).catch((function(){A.copyToClipboardFallback(X)})):A.copyToClipboardFallback(X),A.copiedTimer=setTimeout((function(){A.setState({copied:!1})}),5500),A.setState({copied:!0},(function(){typeof q=="function"&&q({src:K,namespace:U,name:U[U.length-1]})}))},A.getClippyIcon=function(){var $=A.props.theme;return A.state.copied?l().createElement("span",null,l().createElement(Mr,Object.assign({className:"copy-icon"},oe($,"copy-icon"))),l().createElement("span",oe($,"copy-icon-copied"),"")):l().createElement(Mr,Object.assign({className:"copy-icon"},oe($,"copy-icon")))},A.clipboardValue=function($){switch(T($)){case"function":case"regexp":return $.toString();default:return $}},A.state={copied:!1},A}return i(x,R),S(x,[{key:"componentWillUnmount",value:function(){this.copiedTimer&&(clearTimeout(this.copiedTimer),this.copiedTimer=null)}},{key:"render",value:function(){var E=this.props,A=(E.src,E.theme),$=E.hidden,q=E.rowHovered,K=oe(A,"copy-to-clipboard").style,U="inline";return $&&(U="none"),l().createElement("span",{className:"copy-to-clipboard-container",title:"Copy to clipboard",style:{verticalAlign:"top",display:q?"inline-block":"none"}},l().createElement("span",{style:c(c({},K),{},{display:U}),onClick:this.handleCopy},this.getClippyIcon()))}}])})(l().PureComponent);const Ln=(function(R){function x(E){var A;return f(this,x),(A=e(this,x,[E])).getEditIcon=function(){var $=A.props,q=$.variable,K=$.theme;return l().createElement("div",{className:"click-to-edit",style:{verticalAlign:"top",display:A.state.hovered?"inline-block":"none"}},l().createElement(Mn,Object.assign({className:"click-to-edit-icon"},oe(K,"editVarIcon"),{onClick:function(){A.prepopInput(q)}})))},A.prepopInput=function($){if(A.props.onEdit!==!1){var q=(function(U,X){var re;switch(T(U,X)){case"undefined":re="undefined";break;case"nan":re="NaN";break;case"string":re=U;break;case"bigNumber":case"date":case"function":case"regexp":re=U.toString();break;default:try{re=JSON.stringify(U,null,"  ")}catch{re=""}}return re})($.value,A.props.bigNumber),K=Qe(q,A.props.bigNumber);A.setState({editMode:!0,editValue:q,parsedInput:{type:K.type,value:K.value}})}},A.getRemoveIcon=function(){var $=A.props,q=$.variable,K=$.namespace,U=$.theme,X=$.rjvId;return l().createElement("div",{className:"click-to-remove",style:{verticalAlign:"top",display:A.state.hovered?"inline-block":"none"}},l().createElement(Ps,Object.assign({className:"click-to-remove-icon"},oe(U,"removeVarIcon"),{onClick:function(){te.dispatch({name:"VARIABLE_REMOVED",rjvId:X,data:{name:q.name,namespace:K,existing_value:q.value,variable_removed:!0}})}})))},A.getValue=function($,q){var K=!q&&$.type,U=A.props;switch(K){case!1:return A.getEditInput();case"string":return l().createElement(rt,Object.assign({value:$.value},U));case"integer":return l().createElement(Pe,Object.assign({value:$.value},U));case"float":return l().createElement($e,Object.assign({value:$.value},U));case"boolean":return l().createElement(Rt,Object.assign({value:$.value},U));case"function":return l().createElement(_e,Object.assign({value:$.value},U));case"null":return l().createElement(ye,U);case"nan":return l().createElement(we,U);case"undefined":return l().createElement(it,U);case"date":return l().createElement(Tt,Object.assign({value:$.value},U));case"regexp":return l().createElement(We,Object.assign({value:$.value},U));case"bigNumber":return l().createElement(Je,Object.assign({value:$.value},U));default:return l().createElement("div",{className:"object-value"},JSON.stringify($.value))}},A.getEditInput=function(){var $=A.props,q=$.keyModifier,K=$.selectOnFocus,U=$.theme,X=A.state.editValue;return l().createElement("div",null,l().createElement(Xe,Object.assign({type:"text",ref:function(re){re&&re[K?"select":"focus"]()},value:X,className:"variable-editor",onChange:function(re){var ue=re.target.value,de=Qe(ue,A.props.bigNumber);A.setState({editValue:ue,parsedInput:{type:de.type,value:de.value}})},onKeyDown:function(re){switch(re.key){case"Escape":A.setState({editMode:!1,editValue:""});break;case"Enter":q(re,"submit")&&A.submitEdit(!0)}re.stopPropagation()},placeholder:"update this value",minRows:2},oe(U,"edit-input"))),l().createElement("div",oe(U,"edit-icon-container"),l().createElement(Ps,Object.assign({className:"edit-cancel"},oe(U,"cancel-icon"),{onClick:function(re){re&&re.stopPropagation(),A.setState({editMode:!1,editValue:""})}})),l().createElement(Fs,Object.assign({className:"edit-check string-value"},oe(U,"check-icon"),{onClick:function(re){re&&re.stopPropagation(),A.submitEdit()}})),l().createElement("div",null,A.showDetected())))},A.submitEdit=function($){var q=A.props,K=q.variable,U=q.namespace,X=q.rjvId,re=q.bigNumber,ue=A.state,de=ue.editValue,ve=ue.parsedInput,fe=de;$&&ve.type&&(fe=ve.value,re&&ve.type==="bigNumber"&&(fe=new re(fe))),A.setState({editMode:!1}),te.dispatch({name:"VARIABLE_UPDATED",rjvId:X,data:{name:K.name,namespace:U,existing_value:K.value,new_value:fe,variable_removed:!1}})},A.showDetected=function(){var $=A.props,q=$.theme,K=($.variable,$.namespace,$.rjvId,A.state.parsedInput),U=(K.type,K.value,A.getDetectedInput());if(U)return l().createElement("div",null,l().createElement("div",oe(q,"detected-row"),U,l().createElement(Fs,{className:"edit-check detected",style:c({verticalAlign:"top",paddingLeft:"3px"},oe(q,"check-icon").style),onClick:function(X){X&&X.stopPropagation(),A.submitEdit(!0)}})))},A.getDetectedInput=function(){var $=A.state.parsedInput,q=$.type,K=$.value,U=A.props,X=U.theme;if(q!==!1)switch(q.toLowerCase()){case"object":return l().createElement("span",null,l().createElement("span",{style:c(c({},oe(X,"brace").style),{},{cursor:"default"})},"{"),l().createElement("span",{style:c(c({},oe(X,"ellipsis").style),{},{cursor:"default"})},"..."),l().createElement("span",{style:c(c({},oe(X,"brace").style),{},{cursor:"default"})},"}"));case"array":return l().createElement("span",null,l().createElement("span",{style:c(c({},oe(X,"brace").style),{},{cursor:"default"})},"["),l().createElement("span",{style:c(c({},oe(X,"ellipsis").style),{},{cursor:"default"})},"..."),l().createElement("span",{style:c(c({},oe(X,"brace").style),{},{cursor:"default"})},"]"));case"string":return l().createElement(rt,Object.assign({value:K},U));case"integer":return l().createElement(Pe,Object.assign({value:K},U));case"float":return l().createElement($e,Object.assign({value:K},U));case"boolean":return l().createElement(Rt,Object.assign({value:K},U));case"function":return l().createElement(_e,Object.assign({value:K},U));case"null":return l().createElement(ye,U);case"nan":return l().createElement(we,U);case"undefined":return l().createElement(it,U);case"date":return l().createElement(Tt,Object.assign({value:new Date(K)},U));case"bignumber":return l().createElement(Je,Object.assign({value:K},U))}},A.state={editMode:!1,editValue:"",hovered:!1,renameKey:!1,parsedInput:{type:!1,value:null}},A}return i(x,R),S(x,[{key:"render",value:function(){var E=this,A=this.props,$=A.variable,q=A.singleIndent,K=A.type,U=A.theme,X=A.namespace,re=A.indentWidth,ue=A.enableClipboard,de=A.onEdit,ve=A.onDelete,fe=A.onSelect,ke=A.displayArrayKey,Ae=A.quotesOnKeys,Se=A.keyModifier,Le=A.showComma,lt=A.isLast,Be=this.state.editMode;return l().createElement("div",Object.assign({},oe(U,"objectKeyVal",{paddingLeft:re*q}),{onMouseEnter:function(){return E.setState(c(c({},E.state),{},{hovered:!0}))},onMouseLeave:function(){return E.setState(c(c({},E.state),{},{hovered:!1}))},className:"variable-row",key:$.name}),K=="array"?ke?l().createElement("span",Object.assign({},oe(U,"array-key"),{key:$.name+"_"+X}),$.name,l().createElement("div",oe(U,"colon"),":")):null:l().createElement("span",null,l().createElement("span",Object.assign({},oe(U,"object-name"),{className:"object-key",key:$.name+"_"+X}),!!Ae&&l().createElement("span",{style:{verticalAlign:"top"}},'"'),l().createElement("span",{style:{display:"inline-block"}},z($.name)),!!Ae&&l().createElement("span",{style:{verticalAlign:"top"}},'"')),l().createElement("span",oe(U,"colon"),":")),l().createElement("div",Object.assign({className:"variable-value",onClick:fe===!1&&de===!1?null:function(Et){var tt=Ue(X);Se(Et,"edit")&&de!==!1?E.prepopInput($):fe!==!1&&(tt.shift(),fe(c(c({},$),{},{namespace:tt})))}},oe(U,"variableValue",{cursor:fe===!1?"default":"pointer"})),this.getValue($,Be)),Le&&!lt&&l().createElement("span",oe(U,"comma"),","),ue?l().createElement(Rr,{rowHovered:this.state.hovered,hidden:Be,src:$.value,clickCallback:ue,theme:U,namespace:[].concat(Ue(X),[$.name])}):null,de!==!1&&Be==0?this.getEditIcon():null,ve!==!1&&Be==0?this.getRemoveIcon():null)}}])})(l().PureComponent);var Tr=(function(R){function x(){var E;f(this,x);for(var A=arguments.length,$=new Array(A),q=0;q<A;q++)$[q]=arguments[q];return(E=e(this,x,[].concat($))).getObjectSize=function(){var K=E.props,U=K.size,X=K.theme;if(K.displayObjectSize)return l().createElement("span",Object.assign({className:"object-size"},oe(X,"object-size")),U," item",U===1?"":"s")},E.getAddAttribute=function(K){var U=E.props,X=U.theme,re=U.namespace,ue=U.name,de=U.src,ve=U.rjvId,fe=U.depth;return l().createElement("span",{className:"click-to-add",style:{verticalAlign:"top",display:K?"inline-block":"none"}},l().createElement(An,Object.assign({className:"click-to-add-icon"},oe(X,"addVarIcon"),{onClick:function(){var ke={name:fe>0?ue:null,namespace:re.splice(0,re.length-1),existing_value:de,variable_removed:!1,key_name:null};T(de)==="object"?te.dispatch({name:"ADD_VARIABLE_KEY_REQUEST",rjvId:ve,data:ke}):te.dispatch({name:"VARIABLE_ADDED",rjvId:ve,data:c(c({},ke),{},{new_value:[].concat(Ue(de),[null])})})}})))},E.getRemoveObject=function(K){var U=E.props,X=U.theme,re=(U.hover,U.namespace),ue=U.name,de=U.src,ve=U.rjvId;if(re.length!==1)return l().createElement("span",{className:"click-to-remove",style:{display:K?"inline-block":"none"}},l().createElement(Ps,Object.assign({className:"click-to-remove-icon"},oe(X,"removeVarIcon"),{onClick:function(){te.dispatch({name:"VARIABLE_REMOVED",rjvId:ve,data:{name:ue,namespace:re.splice(0,re.length-1),existing_value:de,variable_removed:!0}})}})))},E.render=function(){var K=E.props,U=K.theme,X=K.onDelete,re=K.onAdd,ue=K.enableClipboard,de=K.src,ve=K.namespace,fe=K.rowHovered;return l().createElement("div",Object.assign({},oe(U,"object-meta-data"),{className:"object-meta-data",onClick:function(ke){ke.stopPropagation()}}),E.getObjectSize(),ue?l().createElement(Rr,{rowHovered:fe,clickCallback:ue,src:de,theme:U,namespace:ve}):null,re!==!1?E.getAddAttribute(fe):null,X!==!1?E.getRemoveObject(fe):null)},E}return i(x,R),S(x)})(l().PureComponent);function Or(R){var x=R.parent_type,E=R.namespace,A=R.quotesOnKeys,$=R.theme,q=R.jsvRoot,K=R.name,U=R.displayArrayKey,X=R.name?R.name:"";return!q||K!==!1&&K!==null?x=="array"?U?l().createElement("span",Object.assign({},oe($,"array-key"),{key:E}),l().createElement("span",{className:"array-key"},X),l().createElement("span",oe($,"colon"),":")):l().createElement("span",null):l().createElement("span",Object.assign({},oe($,"object-name"),{key:E}),l().createElement("span",{className:"object-key"},A&&l().createElement("span",{style:{verticalAlign:"top"}},'"'),l().createElement("span",null,X),A&&l().createElement("span",{style:{verticalAlign:"top"}},'"')),l().createElement("span",oe($,"colon"),":")):l().createElement("span",null)}function Dr(R){var x=R.theme;switch(R.iconStyle){case"triangle":return l().createElement(kn,Object.assign({},oe(x,"expanded-icon"),{className:"expanded-icon"}));case"square":return l().createElement(wn,Object.assign({},oe(x,"expanded-icon"),{className:"expanded-icon"}));default:return l().createElement(Sn,Object.assign({},oe(x,"expanded-icon"),{className:"expanded-icon"}))}}function Ir(R){var x=R.theme;switch(R.iconStyle){case"triangle":return l().createElement(En,Object.assign({},oe(x,"collapsed-icon"),{className:"collapsed-icon"}));case"square":return l().createElement(xn,Object.assign({},oe(x,"collapsed-icon"),{className:"collapsed-icon"}));default:return l().createElement(yn,Object.assign({},oe(x,"collapsed-icon"),{className:"collapsed-icon"}))}}var Rn=["src","groupArraysAfterLength","depth","name","theme","jsvRoot","namespace","parent_type"],jr=(function(R){function x(E){var A;return f(this,x),(A=e(this,x,[E])).toggleCollapsed=function($){var q=[];for(var K in A.state.expanded)q.push(A.state.expanded[K]);q[$]=!q[$],A.setState({expanded:q})},A.state={expanded:[]},A}return i(x,R),S(x,[{key:"getExpandedIcon",value:function(E){var A=this.props,$=A.theme,q=A.iconStyle;return this.state.expanded[E]?l().createElement(Dr,{theme:$,iconStyle:q}):l().createElement(Ir,{theme:$,iconStyle:q})}},{key:"render",value:function(){var E=this,A=this.props,$=A.src,q=A.groupArraysAfterLength,K=(A.depth,A.name),U=A.theme,X=A.jsvRoot,re=A.namespace,ue=(A.parent_type,N(A,Rn)),de=0,ve=5*this.props.indentWidth;X||(de=5*this.props.indentWidth);var fe=q,ke=Math.ceil($.length/fe);return l().createElement("div",Object.assign({className:"object-key-val"},oe(U,X?"jsv-root":"objectKeyVal",{paddingLeft:de})),l().createElement(Or,this.props),l().createElement("span",null,l().createElement(Tr,Object.assign({size:$.length},this.props))),Ue(Array(ke)).map((function(Ae,Se){return l().createElement("div",Object.assign({key:Se,className:"object-key-val array-group"},oe(U,"objectKeyVal",{marginLeft:6,paddingLeft:ve})),l().createElement("span",oe(U,"brace-row"),l().createElement("div",Object.assign({className:"icon-container"},oe(U,"icon-container"),{onClick:function(Le){E.toggleCollapsed(Se)}}),E.getExpandedIcon(Se)),E.state.expanded[Se]?l().createElement(fs,Object.assign({key:K+Se,depth:0,name:!1,collapsed:!1,groupArraysAfterLength:fe,index_offset:Se*fe,src:$.slice(Se*fe,Se*fe+fe),namespace:re,type:"array",parent_type:"array_group",theme:U,showComma:E.props.showComma,isLast:Se===ke-1},ue)):l().createElement("span",Object.assign({},oe(U,"brace"),{onClick:function(Le){E.toggleCollapsed(Se)},className:"array-group-brace"}),"[",l().createElement("div",Object.assign({},oe(U,"array-group-meta-data"),{className:"array-group-meta-data"}),l().createElement("span",Object.assign({className:"object-size"},oe(U,"object-size")),Se*fe," - ",Se*fe+fe>$.length?$.length:Se*fe+fe)),"]")))})))}}])})(l().PureComponent),Tn=["depth","src","namespace","name","type","parent_type","theme","jsvRoot","iconStyle","showComma","isLast"],Hs=(function(R){function x(E){var A;f(this,x),(A=e(this,x,[E])).toggleCollapsed=function(){A.setState({expanded:!A.state.expanded},(function(){ne.set(A.props.rjvId,A.props.namespace,"expanded",A.state.expanded)}))},A.getObjectContent=function(q,K,U){return l().createElement("div",{className:"pushed-content object-container"},l().createElement("div",Object.assign({className:"object-content"},oe(A.props.theme,"pushed-content")),A.renderObjectContents(K,U)))},A.getEllipsis=function(){return A.state.size===0?null:l().createElement("div",Object.assign({},oe(A.props.theme,"ellipsis"),{className:"node-ellipsis",onClick:A.toggleCollapsed}),"...")},A.getObjectMetaData=function(q){var K=A.props,U=(K.rjvId,K.theme,A.state),X=U.size,re=U.hovered;return l().createElement(Tr,Object.assign({rowHovered:re,size:X},A.props))},A.renderObjectContents=function(q,K){var U,X=A.props,re=X.depth,ue=X.parent_type,de=X.index_offset,ve=X.groupArraysAfterLength,fe=X.namespace,ke=X.showComma,Ae=A.state.object_type,Se=[],Le=Object.keys(q||{});return A.props.sortKeys&&Ae!=="array"&&(Le=Le.sort()),Le.forEach((function(lt,Be){U=new On(lt,q[lt],K.bigNumber);var Et=Be===Le.length-1;if(ue==="array_group"&&de&&(U.name=parseInt(U.name)+de),Object.prototype.hasOwnProperty.call(q,lt))if(U.type==="object")Se.push(l().createElement(fs,Object.assign({key:U.name,depth:re+1,name:U.name,src:U.value,namespace:fe.concat(U.name),parent_type:Ae,isLast:Et,showComma:ke},K)));else if(U.type==="array"){var tt=fs;ve&&U.value.length>ve&&(tt=jr),Se.push(l().createElement(tt,Object.assign({key:U.name,depth:re+1,name:U.name,src:U.value,namespace:fe.concat(U.name),type:"array",parent_type:Ae,isLast:Et,showComma:ke},K)))}else Se.push(l().createElement(Ln,Object.assign({key:U.name+"_"+fe,variable:U,singleIndent:5,namespace:fe,type:A.props.type,isLast:Et,showComma:ke},K)))})),Se};var $=x.getState(E);return A.state=c(c({},$),{},{prevProps:{}}),A}return i(x,R),S(x,[{key:"getBraceStart",value:function(E,A){var $=this,q=this.props,K=(q.src,q.theme),U=q.iconStyle;if(q.parent_type==="array_group")return l().createElement("span",null,l().createElement("span",oe(K,"brace"),E==="array"?"[":"{"));var X=A?Dr:Ir;return l().createElement("span",null,l().createElement("span",Object.assign({onClick:function(re){$.toggleCollapsed()}},oe(K,"brace-row")),l().createElement("div",Object.assign({className:"icon-container"},oe(K,"icon-container")),l().createElement(X,{theme:K,iconStyle:U})),l().createElement(Or,this.props),l().createElement("span",oe(K,"brace"),E==="array"?"[":"{")))}},{key:"render",value:function(){var E=this,A=this.props,$=A.depth,q=A.src,K=(A.namespace,A.name,A.type,A.parent_type),U=A.theme,X=A.jsvRoot,re=A.iconStyle,ue=A.showComma,de=A.isLast,ve=N(A,Tn),fe=this.state,ke=fe.object_type,Ae=fe.expanded,Se={};return X||K==="array_group"?K==="array_group"&&(Se.borderLeft=0,Se.display="inline"):Se.paddingLeft=5*this.props.indentWidth,l().createElement("div",Object.assign({className:"object-key-val",onMouseEnter:function(){return E.setState(c(c({},E.state),{},{hovered:!0}))},onMouseLeave:function(){return E.setState(c(c({},E.state),{},{hovered:!1}))}},oe(U,X?"jsv-root":"objectKeyVal",Se)),this.getBraceStart(ke,Ae),Ae?this.getObjectContent($,q,c({theme:U,iconStyle:re},ve)):this.getEllipsis(),l().createElement("span",{className:"brace-row"},l().createElement("span",{style:c(c({},oe(U,"brace").style),{},{paddingLeft:Ae?"3px":"0px"})},ke==="array"?"]":"}")),ue&&!de&&!X&&l().createElement("span",oe(U,"comma"),","),this.getObjectMetaData(q))}}],[{key:"getDerivedStateFromProps",value:function(E,A){var $=A.prevProps;return E.src!==$.src||E.collapsed!==$.collapsed||E.name!==$.name||E.namespace!==$.namespace||E.rjvId!==$.rjvId?c(c({},x.getState(E)),{},{prevProps:E}):null}}])})(l().PureComponent);Hs.getState=function(R){var x=Object.keys(R.src).length,E=(R.collapsed===!1||R.collapsed!==!0&&R.collapsed>R.depth)&&(!R.shouldCollapse||R.shouldCollapse({name:R.name,src:R.src,type:T(R.src),namespace:R.namespace})===!1)&&x!==0;return{expanded:ne.get(R.rjvId,R.namespace,"expanded",E),object_type:R.type==="array"?"array":"object",parent_type:R.type==="array"?"array":"object",size:x,hovered:!1}};var On=S((function R(x,E,A){f(this,R),this.name=x,this.value=E,this.type=T(E,A)}));M(Hs);const fs=Hs;var Dn=(function(R){function x(){var E;f(this,x);for(var A=arguments.length,$=new Array(A),q=0;q<A;q++)$[q]=arguments[q];return(E=e(this,x,[].concat($))).render=function(){var K,U,X,re,ue=E.props,de=[ue.name],ve=fs;return typeof ue.name!="object"||Array.isArray(ue.name)||(de=[((K=ue.name)===null||K===void 0?void 0:K.displayName)||((U=ue.name)===null||U===void 0?void 0:U.name)||((X=ue.name)===null||X===void 0||(re=X.type)===null||re===void 0?void 0:re.name)||"Anonymous"]),Array.isArray(ue.src)&&ue.groupArraysAfterLength&&ue.src.length>ue.groupArraysAfterLength&&(ve=jr),l().createElement("div",{className:"pretty-json-container object-container"},l().createElement("div",{className:"object-content"},l().createElement(ve,Object.assign({namespace:de,depth:0,jsvRoot:!0},ue))))},E}return i(x,R),S(x)})(l().PureComponent),In=(function(R){function x(E){var A;return f(this,x),(A=e(this,x,[E])).closeModal=function(){te.dispatch({rjvId:A.props.rjvId,name:"RESET"})},A.submit=function(){A.props.submit(A.state.input)},A.state={input:E.input?E.input:""},A}return i(x,R),S(x,[{key:"render",value:function(){var E=this,A=this.props,$=A.theme,q=A.rjvId,K=A.isValid,U=this.state.input,X=K(U);return l().createElement("div",Object.assign({className:"key-modal-request"},oe($,"key-modal-request"),{onClick:this.closeModal}),l().createElement("div",Object.assign({},oe($,"key-modal"),{onClick:function(re){re.stopPropagation()}}),l().createElement("div",oe($,"key-modal-label"),"Key Name:"),l().createElement("div",{style:{position:"relative"}},l().createElement("input",Object.assign({},oe($,"key-modal-input"),{className:"key-modal-input",ref:function(re){return re&&re.focus()},spellCheck:!1,value:U,placeholder:"...",onChange:function(re){E.setState({input:re.target.value})},onKeyPress:function(re){X&&re.key==="Enter"?E.submit():re.key==="Escape"&&E.closeModal()}})),X?l().createElement(Fs,Object.assign({},oe($,"key-modal-submit"),{className:"key-modal-submit",onClick:function(re){return E.submit()}})):null),l().createElement("span",oe($,"key-modal-cancel"),l().createElement(Lr,Object.assign({},oe($,"key-modal-cancel-icon"),{className:"key-modal-cancel",onClick:function(){te.dispatch({rjvId:q,name:"RESET"})}})))))}}])})(l().PureComponent),jn=(function(R){function x(){var E;f(this,x);for(var A=arguments.length,$=new Array(A),q=0;q<A;q++)$[q]=arguments[q];return(E=e(this,x,[].concat($))).isValid=function(K){var U=E.props.rjvId,X=ne.get(U,"action","new-key-request");return K!=""&&Object.keys(X.existing_value).indexOf(K)===-1},E.submit=function(K){var U=E.props.rjvId,X=ne.get(U,"action","new-key-request");X.new_value=c({},X.existing_value),X.new_value[K]=E.props.defaultValue,te.dispatch({name:"VARIABLE_ADDED",rjvId:U,data:X})},E}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.active,$=E.theme,q=E.rjvId;return A?l().createElement(In,{rjvId:q,theme:$,isValid:this.isValid,submit:this.submit}):null}}])})(l().PureComponent),Nn=(function(R){function x(){return f(this,x),e(this,x,arguments)}return i(x,R),S(x,[{key:"render",value:function(){var E=this.props,A=E.message,$=E.active,q=E.theme,K=E.rjvId;return $?l().createElement("div",Object.assign({className:"validation-failure"},oe(q,"validation-failure"),{onClick:function(){te.dispatch({rjvId:K,name:"RESET"})}}),l().createElement("span",oe(q,"validation-failure-label"),A),l().createElement(Lr,oe(q,"validation-failure-clear"))):null}}])})(l().PureComponent),ps=(function(R){function x(E){var A;return f(this,x),(A=e(this,x,[E])).rjvId=Date.now().toString()+Math.random().toString(36).slice(2),A.getListeners=function(){return{reset:A.resetState,"variable-update":A.updateSrc,"add-key-request":A.addKeyRequest}},A.updateSrc=function(){var $,q=ne.get(A.rjvId,"action","variable-update"),K=q.name,U=q.namespace,X=q.new_value,re=q.existing_value,ue=q.updated_src,de=q.type,ve=A.props,fe=ve.onEdit,ke=ve.onDelete,Ae=ve.onAdd,Se={existing_src:A.state.src,new_value:X,updated_src:ue,name:K,namespace:U,existing_value:re};switch(de){case"variable-added":$=Ae(Se);break;case"variable-edited":$=fe(Se);break;case"variable-removed":$=ke(Se)}$!==!1?(ne.set(A.rjvId,"global","src",ue),A.setState({src:ue})):A.setState({validationFailure:!0})},A.addKeyRequest=function(){A.setState({addKeyRequest:!0})},A.resetState=function(){A.setState({validationFailure:!1,addKeyRequest:!1})},A.state={addKeyRequest:!1,editKeyRequest:!1,validationFailure:!1,src:x.defaultProps.src,name:x.defaultProps.name,theme:x.defaultProps.theme,validationMessage:x.defaultProps.validationMessage,prevSrc:x.defaultProps.src,prevName:x.defaultProps.name,prevTheme:x.defaultProps.theme},A}return i(x,R),S(x,[{key:"componentDidMount",value:function(){ne.set(this.rjvId,"global","src",this.state.src);var E=this.getListeners();for(var A in E)ne.on(A+"-"+this.rjvId,E[A]);this.setState({addKeyRequest:!1,editKeyRequest:!1})}},{key:"componentDidUpdate",value:function(E,A){A.addKeyRequest!==!1&&this.setState({addKeyRequest:!1}),A.editKeyRequest!==!1&&this.setState({editKeyRequest:!1}),E.src!==this.state.src&&ne.set(this.rjvId,"global","src",this.state.src)}},{key:"componentWillUnmount",value:function(){var E=this.getListeners();for(var A in E)ne.removeListener(A+"-"+this.rjvId,E[A])}},{key:"render",value:function(){var E=this.state,A=E.validationFailure,$=E.validationMessage,q=E.addKeyRequest,K=E.theme,U=E.src,X=E.name,re=this.props,ue=re.style,de=re.defaultValue;return l().createElement("div",{className:"react-json-view",style:c(c({},oe(K,"app-container").style),ue)},l().createElement(Nn,{message:$,active:A,theme:K,rjvId:this.rjvId}),l().createElement(Dn,Object.assign({},this.props,{src:U,name:X,theme:K,type:T(U),rjvId:this.rjvId})),l().createElement(jn,{active:q,theme:K,rjvId:this.rjvId,defaultValue:de}))}}],[{key:"getDerivedStateFromProps",value:function(E,A){if(E.src!==A.prevSrc||E.name!==A.prevName||E.theme!==A.prevTheme){var $={src:E.src,name:E.name,theme:E.theme,validationMessage:E.validationMessage,prevSrc:E.src,prevName:E.name,prevTheme:E.theme};return x.validateState($)}return null}}])})(l().PureComponent);ps.defaultProps={src:{},name:"root",theme:"rjv-default",collapsed:!1,collapseStringsAfterLength:!1,shouldCollapse:!1,sortKeys:!1,quotesOnKeys:!0,groupArraysAfterLength:100,indentWidth:4,enableClipboard:!0,escapeStrings:!0,displayObjectSize:!0,displayDataTypes:!0,onEdit:!1,onDelete:!1,onAdd:!1,onSelect:!1,iconStyle:"triangle",style:{},validationMessage:"Validation Error",defaultValue:null,displayArrayKey:!0,selectOnFocus:!1,keyModifier:function(R){return R.metaKey||R.ctrlKey},bigNumber:null,showComma:!0},ps.validateState=function(R){var x={};return T(R.theme)!=="object"||(function(E){var A=["base00","base01","base02","base03","base04","base05","base06","base07","base08","base09","base0A","base0B","base0C","base0D","base0E","base0F"];if(T(E)==="object"){for(var $=0;$<A.length;$++)if(!(A[$]in E))return!1;return!0}return!1})(R.theme)||(console.error("react-json-view error:","theme prop must be a theme name or valid base-16 theme object.",'defaulting to "rjv-default" theme'),x.theme="rjv-default"),T(R.src)!=="object"&&T(R.src)!=="array"&&(console.error("react-json-view error:","src property must be a valid json object"),x.name="ERROR",x.src={message:"src property must be a valid json object"}),c(c({},R),x)},M(ps);const Bn=ps})(),I})()))})(ws)),ws.exports}var ic=rc();const or=Hn(ic);function nc({parameters:s}){const{t:p}=ge();return h.jsxs("div",{className:"mt-2",children:[h.jsx(Te.Text,{className:"text-sm font-semibold text-gray-300",children:p("SYSTEM_MESSAGE_MODAL$PARAMETERS")}),h.jsx("div",{className:"text-sm mt-2 p-3 bg-gray-900 rounded-md overflow-auto text-gray-300 max-h-[400px] shadow-inner",children:h.jsx(or,{name:!1,src:s,theme:er})})]})}function oc({title:s,isExpanded:p,onClick:C,className:w}){return h.jsxs("button",{type:"button",onClick:C,className:`w-full py-3 px-2 text-left flex items-center justify-between hover:bg-gray-700 transition-colors ${w||""}`,children:[h.jsx("div",{className:"flex items-center",children:h.jsx(Te.Text,{className:"font-bold text-gray-100",children:s})}),h.jsx(Te.Text,{className:"text-gray-300",children:p?h.jsx(Ki,{size:18}):h.jsx(qi,{size:18})})]})}function ac({tool:s,index:p,isExpanded:C,onToggle:w}){const k=s,j=k.function||k,I=j.name||k.type==="function"&&k.function?.name||"",o=j.description||k.type==="function"&&k.function?.description||"",n=j.parameters||k.type==="function"&&k.function?.parameters||null;return h.jsxs("div",{className:"rounded-md overflow-hidden",children:[h.jsx(oc,{title:String(I),isExpanded:C,onClick:()=>w(p)}),C&&h.jsxs("div",{className:"px-2 pb-3 pt-1",children:[h.jsx("div",{className:"mt-2 mb-3",children:h.jsx(Te.Text,{className:"text-sm whitespace-pre-wrap text-gray-300 leading-relaxed",children:String(o)})}),n&&h.jsx(nc,{parameters:n})]})]})}function lc({tools:s,expandedTools:p,onToggleTool:C}){return h.jsx("div",{className:"p-2 space-y-3",children:s.map((w,k)=>h.jsx(ac,{tool:w,index:k,isExpanded:p[k]||!1,onToggle:C},k))})}function cc(){const{t:s}=ge();return h.jsx("div",{className:"flex items-center justify-center h-full p-4",children:h.jsx(Te.Text,{className:"text-gray-400",children:s("SYSTEM_MESSAGE_MODAL$NO_TOOLS")})})}function hc({activeTab:s,systemMessage:p,expandedTools:C,onToggleTool:w}){return s==="system"?h.jsx(tc,{content:p.content}):s==="tools"?p.tools&&p.tools.length>0?h.jsx(lc,{tools:p.tools,expandedTools:C,onToggleTool:w}):h.jsx(cc,{}):null}function nn({isOpen:s,onClose:p,systemMessage:C}){const[w,k]=H.useState("system"),[j,I]=H.useState({});if(!C)return null;const o=n=>{I(u=>({...u,[n]:!u[n]}))};return s&&h.jsx(Yt,{onClose:p,children:h.jsxs(Vt,{width:"medium",className:"max-h-[80vh] flex flex-col items-start",children:[h.jsx(Ql,{agentClass:C.agent_class,openhandsVersion:C.openhands_version}),h.jsxs("div",{className:"w-full",children:[h.jsx(ec,{activeTab:w,onTabChange:k,hasTools:!!(C.tools&&C.tools.length>0)}),h.jsx("div",{className:"max-h-[51vh] overflow-auto rounded-md custom-scrollbar-always",children:h.jsx(hc,{activeTab:w,systemMessage:C,expandedTools:j,onToggleTool:o})})]})]})})}const uc=()=>{const{conversationId:s}=mt(),{curAgentState:p}=Mt();return Zt({queryKey:["conversation",s,"microagents"],queryFn:async()=>{if(!s)throw new Error("No conversation ID provided");return(await st.getMicroagents(s)).microagents},enabled:!!s&&p!==Ce.LOADING&&p!==Ce.INIT,staleTime:1e3*60*5,gcTime:1e3*60*15})};function dc({isAgentReady:s,isLoading:p,isRefetching:C,onRefresh:w}){const{t:k}=ge();return h.jsx("div",{className:"flex flex-col gap-6 w-full",children:h.jsxs("div",{className:"flex items-center justify-between w-full",children:[h.jsx(cs,{title:k(Z.MICROAGENTS_MODAL$TITLE)}),s&&h.jsxs(It,{testId:"refresh-microagents",type:"button",variant:"primary",className:"flex items-center gap-2",onClick:w,isDisabled:p||C,children:[h.jsx(ol,{size:16,className:`${C?"animate-spin":""}`}),k(Z.BUTTON$REFRESH)]})]})})}function fc(){return h.jsx("div",{className:"flex justify-center items-center py-8",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary"})})}function pc({isError:s}){const{t:p}=ge();return h.jsx("div",{className:"flex items-center justify-center h-full p-4",children:h.jsx(Te.Text,{className:"text-gray-400",children:p(s?Z.MICROAGENTS_MODAL$FETCH_ERROR:Z.CONVERSATION$NO_MICROAGENTS)})})}function _c({triggers:s}){const{t:p}=ge();return!s||s.length===0?null:h.jsxs("div",{className:"mt-2 mb-3",children:[h.jsx(Te.Text,{className:"text-sm font-semibold text-gray-300 mb-2",children:p(Z.MICROAGENTS_MODAL$TRIGGERS)}),h.jsx("div",{className:"flex flex-wrap gap-1",children:s.map(C=>h.jsx(Te.Text,{className:"px-2 py-1 text-xs rounded-full bg-blue-900",children:C},C))})]})}const mc=yr("whitespace-pre-wrap",{variants:{size:{default:"text-sm",small:"text-xs"},font:{default:"",mono:"font-mono"},lineHeight:{default:"",relaxed:"leading-relaxed"},background:{default:"",dark:"bg-gray-900"},textColor:{default:"",light:"text-gray-300"},padding:{default:"",medium:"p-3",large:"px-5"},borderRadius:{default:"",medium:"rounded-md"},shadow:{default:"",inner:"shadow-inner"},maxHeight:{default:"",small:"max-h-[400px]",large:"max-h-[60vh]"},overflow:{default:"",auto:"overflow-auto"}},defaultVariants:{size:"default",font:"default",lineHeight:"default",background:"default",textColor:"default",padding:"default",borderRadius:"default",shadow:"default",maxHeight:"default",overflow:"default"}});function gc({size:s,font:p,lineHeight:C,background:w,textColor:k,padding:j,borderRadius:I,shadow:o,maxHeight:n,overflow:u,className:m,testId:c,children:f}){return h.jsx("pre",{"data-testid":c,className:Ee(mc({size:s,font:p,lineHeight:C,background:w,textColor:k,padding:j,borderRadius:I,shadow:o,maxHeight:n,overflow:u}),m),children:f})}function vc({content:s}){const{t:p}=ge();return h.jsxs("div",{className:"mt-2",children:[h.jsx(Te.Text,{className:"text-sm font-semibold text-gray-300 mb-2",children:p(Z.MICROAGENTS_MODAL$CONTENT)}),h.jsx(gc,{size:"default",font:"mono",lineHeight:"relaxed",background:"dark",textColor:"light",padding:"medium",borderRadius:"medium",shadow:"inner",maxHeight:"small",overflow:"auto",className:"mt-2",children:s||p(Z.MICROAGENTS_MODAL$NO_CONTENT)})]})}function bc({agent:s,isExpanded:p,onToggle:C}){return h.jsxs("div",{className:"rounded-md overflow-hidden",children:[h.jsxs("button",{type:"button",onClick:()=>C(s.name),className:"w-full py-3 px-2 text-left flex items-center justify-between hover:bg-gray-700 transition-colors",children:[h.jsx("div",{className:"flex items-center",children:h.jsx(Te.Text,{className:"font-bold text-gray-100",children:s.name})}),h.jsxs("div",{className:"flex items-center",children:[h.jsx(Te.Text,{className:"px-2 py-1 text-xs rounded-full bg-gray-800 mr-2",children:s.type==="repo"?"Repository":"Knowledge"}),h.jsx(Te.Text,{className:"text-gray-300",children:p?h.jsx(Ki,{size:18}):h.jsx(qi,{size:18})})]})]}),p&&h.jsxs("div",{className:"px-2 pb-3 pt-1",children:[h.jsx(_c,{triggers:s.triggers}),h.jsx(vc,{content:s.content})]})]})}function on({onClose:s}){const{t:p}=ge(),{curAgentState:C}=Mt(),[w,k]=H.useState({}),{data:j,isLoading:I,isError:o,refetch:n,isRefetching:u}=uc(),m=f=>{k(v=>({...v,[f]:!v[f]}))},c=![Ce.LOADING,Ce.INIT].includes(C);return h.jsx(Yt,{onClose:s,children:h.jsxs(Vt,{width:"medium",className:"max-h-[80vh] flex flex-col items-start",testID:"microagents-modal",children:[h.jsx(dc,{isAgentReady:c,isLoading:I,isRefetching:u,onRefresh:n}),c&&h.jsx(Te.Text,{className:"text-sm text-gray-400",children:p(Z.MICROAGENTS_MODAL$WARNING)}),h.jsxs("div",{className:"w-full h-[60vh] overflow-auto rounded-md custom-scrollbar-always",children:[!c&&h.jsx("div",{className:"w-full h-full flex items-center text-center justify-center text-2xl text-tertiary-light",children:h.jsx(Te.Text,{children:p(Z.DIFF_VIEWER$WAITING_FOR_RUNTIME)})}),I&&h.jsx(fc,{}),!I&&c&&(o||!j||j.length===0)&&h.jsx(pc,{isError:o}),!I&&c&&j&&j.length>0&&h.jsx("div",{className:"p-2 space-y-3",children:j.map(f=>{const v=w[f.name]||!1;return h.jsx(bc,{agent:f,isExpanded:v,onToggle:m},f.name)})})]})]})})}function Cc(){const{t:s}=ge(),{conversationId:p}=ls(),{data:C}=_t(),[w,k]=pe.useState(!1),{handleShowAgentTools:j,handleShowMicroagents:I,systemModalVisible:o,setSystemModalVisible:n,microagentsModalVisible:u,setMicroagentsModalVisible:m,systemMessage:c}=rn({conversationId:p,conversationStatus:C?.status,showOptions:!0,onContextMenuToggle:k}),f=v=>{v.preventDefault(),v.stopPropagation(),k(!w)};return h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex items-center gap-1 cursor-pointer",onClick:f,children:[h.jsx(Rl,{width:18,height:18,color:"#959CB2"}),h.jsx("span",{className:"text-sm font-normal leading-5 text-white",children:s(Z.MICROAGENTS_MODAL$TOOLS)})]}),w&&h.jsx(ql,{onClose:()=>k(!1),onShowMicroagents:I,onShowAgentTools:j}),h.jsx(nn,{isOpen:o,onClose:()=>n(!1),systemMessage:c?c.args:null}),u&&h.jsx(on,{onClose:()=>m(!1)})]})}function Sc({conversationStatus:s,disabled:p,handleStop:C,handleResumeAgent:w,onStop:k}){return h.jsxs("div",{className:"w-full flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Cc,{}),h.jsx(bl,{conversationStatus:s})]}),h.jsx(Ll,{className:"ml-2 md:ml-3",handleStop:()=>C(k),handleResumeAgent:w,disabled:p})]})}function yc({chatContainerRef:s,isDragOver:p,disabled:C,showButton:w,buttonClassName:k,conversationStatus:j,chatInputRef:I,handleFileIconClick:o,handleSubmit:n,handleStop:u,handleResumeAgent:m,onDragOver:c,onDragLeave:f,onDrop:v,onInput:S,onPaste:g,onKeyDown:a,onFocus:t,onBlur:e,onStop:r}){return h.jsxs("div",{ref:s,className:"bg-[#25272D] box-border content-stretch flex flex-col items-start justify-center p-4 pt-3 relative rounded-[15px] w-full",onDragOver:i=>c(i,C),onDragLeave:i=>f(i,C),onDrop:i=>v(i,C),children:[p&&h.jsx(Ga,{}),h.jsx(ll,{}),h.jsx(fl,{chatInputRef:I,disabled:C,showButton:w,buttonClassName:k,handleFileIconClick:o,handleSubmit:n,onInput:S,onPaste:g,onKeyDown:a,onFocus:t,onBlur:e}),h.jsx(Sc,{conversationStatus:j,disabled:C,handleStop:u,handleResumeAgent:m,onStop:r})]})}function wc({fileInputRef:s,onChange:p}){return h.jsx("input",{type:"file",ref:s,multiple:!0,accept:"*/*",style:{display:"none"},onChange:p,"data-testid":"upload-image-input"})}function xc({disabled:s=!1,showButton:p=!0,conversationStatus:C=null,onSubmit:w,onStop:k,onFocus:j,onBlur:I,onFilesPaste:o,className:n="",buttonClassName:u=""}){const{submittedMessage:m,clearAllFiles:c,setShouldHideSuggestions:f,setSubmittedMessage:v}=gt(),g=s||C==="STOPPED";H.useEffect(()=>{!m||s||(w(m),v(null))},[m,s,w,v]);const{chatInputRef:a,messageToSend:t,checkIsContentEmpty:e,clearEmptyContentHandler:r}=Ra(),{fileInputRef:i,chatContainerRef:_,isDragOver:l,handleFileIconClick:b,handleFileInputChange:d,handleDragOver:y,handleDragLeave:M,handleDrop:D}=Ta(o),{gripRef:N,isGripVisible:T,handleTopEdgeClick:z,smartResize:J,handleGripMouseDown:ie,handleGripTouchStart:F,increaseHeightForEmptyContent:ee,resetManualResize:L}=Ua(a,t),{handleSubmit:B,handleResumeAgent:P,handleStop:W}=Va(a,i,J,w,L),{handleInput:Q,handlePaste:ae,handleKeyDown:he,handleBlur:me,handleFocus:V}=Wa(a,J,ee,e,r,j,I);return H.useEffect(()=>()=>{f(!1),c()},[f,c]),h.jsxs("div",{className:`w-full ${n}`,children:[h.jsx(wc,{fileInputRef:i,onChange:d}),h.jsxs("div",{className:"relative w-full",children:[h.jsx(za,{gripRef:N,isGripVisible:T,handleTopEdgeClick:z,handleGripMouseDown:ie,handleGripTouchStart:F}),h.jsx(yc,{chatContainerRef:_,isDragOver:l,disabled:g,showButton:p,buttonClassName:u,conversationStatus:C,chatInputRef:a,handleFileIconClick:b,handleSubmit:B,handleStop:W,handleResumeAgent:P,onDragOver:y,onDragLeave:M,onDrop:D,onInput:Q,onPaste:ae,onKeyDown:O=>he(O,g,B),onFocus:V,onBlur:me,onStop:k})]})]})}const Ec=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M2.25 1.5H9V3H3V21H21V15H22.5V21.75L21.75 22.5H2.25L1.5 21.75V2.25L2.25 1.5Z",fill:"currentColor"}),H.createElement("path",{d:"M22.5 2.25V12H21V4.0605L10.8645 14.1975L9.80402 13.1355L19.9395 3H12V1.5H21.75L22.5 2.25Z",fill:"currentColor"}));function an({className:s}){return h.jsx("div",{className:Ee("w-3 h-3 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 absolute right-0 top-1/2 -translate-y-1/2 h-full w-10.5 pr-2.5 justify-end git-external-link-icon",s),children:h.jsx(Ec,{width:12,height:12,color:"white"})})}function kc({selectedRepository:s,gitProvider:p}){const{t:C}=ge(),w=s&&p,k=w?go(p,s):void 0,j=w?s:C(Z.COMMON$NO_REPO_CONNECTED);return h.jsxs("a",{href:w?k:void 0,target:"_blank",rel:"noopener noreferrer",className:Ee("group flex flex-row items-center justify-between gap-2 pl-2.5 pr-2.5 py-1 rounded-[100px] flex-1 truncate relative",w?"border border-[#525252] bg-transparent hover:border-[#454545] cursor-pointer":"border border-[rgba(71,74,84,0.50)] bg-transparent cursor-not-allowed min-w-[170px]"),children:[h.jsx("div",{className:"w-3 h-3 flex items-center justify-center flex-shrink-0",children:w?h.jsx(ho,{gitProvider:p,className:"w-3 h-3 inline-flex"}):h.jsx(So,{width:12,height:12,color:"white"})}),h.jsx("div",{className:"font-normal text-white text-sm leading-5 truncate flex-1 min-w-0",title:j,children:j}),w&&h.jsx(an,{})]})}function Ac({selectedBranch:s,selectedRepository:p,gitProvider:C}){const{t:w}=ge(),k=s&&p&&C,j=k?vo(C,p,s):void 0,I=k?s:w(Z.COMMON$NO_BRANCH);return h.jsxs("a",{href:k?j:void 0,target:"_blank",rel:"noopener noreferrer",className:Ee("group flex flex-row items-center justify-between gap-2 pl-2.5 pr-2.5 py-1 rounded-[100px] w-fit flex-shrink-0 max-w-[200px] truncate relative",k?"border border-[#525252] bg-transparent hover:border-[#454545] cursor-pointer":"border border-[rgba(71,74,84,0.50)] bg-transparent cursor-not-allowed min-w-[108px]"),children:[h.jsx("div",{className:"w-3 h-3 flex items-center justify-center flex-shrink-0",children:h.jsx(wr,{width:12,height:12,color:"white"})}),h.jsx("div",{className:"font-normal text-white text-sm leading-5 truncate",title:I,children:I}),k&&h.jsx(an,{})]})}function Mc({onSuggestionsClick:s}){const{t:p}=ge(),{data:C}=_t(),{providers:w}=Jt(),k=w.length>0,j=C?.selected_repository,I=k&&j,o=()=>{Wt.capture("pull_button_clicked"),s(Di())};return h.jsxs("button",{type:"button",onClick:o,disabled:!I,className:Ee("flex flex-row gap-1 items-center justify-center px-0.5 py-1 rounded-[100px] w-[76px] min-w-[76px]",I?"bg-[#25272D] hover:bg-[#454545] cursor-pointer":"bg-[rgba(71,74,84,0.50)] cursor-not-allowed"),children:[h.jsx("div",{className:"w-3 h-3 flex items-center justify-center",children:h.jsx(tn,{width:12,height:12,color:"white"})}),h.jsx("div",{className:"font-normal text-white text-sm leading-5 max-w-[76px] truncate",title:p(Z.COMMON$PULL),children:p(Z.COMMON$PULL)})]})}function Lc({onSuggestionsClick:s,hasRepository:p,currentGitProvider:C}){const{t:w}=ge(),{providers:k}=Jt(),I=k.length>0&&p,o=()=>{Wt.capture("push_button_clicked"),s(Ii(C))};return h.jsxs("button",{type:"button",onClick:o,disabled:!I,className:Ee("flex flex-row gap-1 items-center justify-center px-2 py-1 rounded-[100px] w-[77px] min-w-[77px]",I?"bg-[#25272D] hover:bg-[#454545] cursor-pointer":"bg-[rgba(71,74,84,0.50)] cursor-not-allowed"),children:[h.jsx("div",{className:"w-3 h-3 flex items-center justify-center",children:h.jsx(en,{width:12,height:12,color:"white"})}),h.jsx("div",{className:"font-normal text-white text-sm leading-5 max-w-[77px] truncate",title:w(Z.COMMON$PUSH),children:w(Z.COMMON$PUSH)})]})}function Rc({onSuggestionsClick:s,hasRepository:p,currentGitProvider:C}){const{t:w}=ge(),{providers:k}=Jt(),I=k.length>0&&p,o=()=>{Wt.capture("create_pr_button_clicked"),s(ji(C))};return h.jsxs("button",{type:"button",onClick:o,disabled:!I,className:Ee("flex flex-row gap-1 items-center justify-center px-2 py-1 rounded-[100px] w-[126px] min-w-[126px] h-7",I?"bg-[#25272D] hover:bg-[#454545] cursor-pointer":"bg-[rgba(71,74,84,0.50)] cursor-not-allowed"),children:[h.jsx("div",{className:"w-3 h-3 flex items-center justify-center",children:h.jsx(sn,{width:12,height:12,color:"white"})}),h.jsx("div",{className:"font-normal text-white text-sm leading-5 max-w-[126px] truncate",title:w(Z.COMMON$PULL_REQUEST),children:w(Z.COMMON$PULL_REQUEST)})]})}function rs({children:s,tooltipMessage:p,testId:C,shouldShowTooltip:w}){return w?h.jsx(Ti,{tooltip:p,ariaLabel:p,testId:C,placement:"top",className:"hover:opacity-100",tooltipClassName:"bg-white text-black",showArrow:!0,children:s}):s}function Tc({onSuggestionsClick:s}){const{t:p}=ge(),{data:C}=_t(),w=C?.selected_repository,k=C?.git_provider,j=C?.selected_branch,I=!!w;return h.jsx("div",{className:"flex flex-row items-center",children:h.jsxs("div",{className:"flex flex-row gap-2.5 items-center overflow-x-auto flex-wrap md:flex-nowrap relative scrollbar-hide",children:[h.jsx(rs,{tooltipMessage:p(Z.COMMON$GIT_TOOLS_DISABLED_CONTENT),testId:"git-control-bar-repo-button-tooltip",shouldShowTooltip:!I,children:h.jsx(kc,{selectedRepository:w,gitProvider:k})}),h.jsx(rs,{tooltipMessage:p(Z.COMMON$GIT_TOOLS_DISABLED_CONTENT),testId:"git-control-bar-branch-button-tooltip",shouldShowTooltip:!I,children:h.jsx(Ac,{selectedBranch:j,selectedRepository:w,gitProvider:k})}),I?h.jsxs(h.Fragment,{children:[h.jsx(rs,{tooltipMessage:p(Z.COMMON$GIT_TOOLS_DISABLED_CONTENT),testId:"git-control-bar-pull-button-tooltip",shouldShowTooltip:!I,children:h.jsx(Mc,{onSuggestionsClick:s})}),h.jsx(rs,{tooltipMessage:p(Z.COMMON$GIT_TOOLS_DISABLED_CONTENT),testId:"git-control-bar-push-button-tooltip",shouldShowTooltip:!I,children:h.jsx(Lc,{onSuggestionsClick:s,hasRepository:I,currentGitProvider:k})}),h.jsx(rs,{tooltipMessage:p(Z.COMMON$GIT_TOOLS_DISABLED_CONTENT),testId:"git-control-bar-pr-button-tooltip",shouldShowTooltip:!I,children:h.jsx(Rc,{onSuggestionsClick:s,hasRepository:I,currentGitProvider:k})})]}):null]})})}const Oc=async s=>new Promise((p,C)=>{const w=new FileReader;w.onload=()=>{p()},w.onerror=()=>{C(new Error(`Failed to read file: ${s.name}`))},w.onabort=()=>{C(new Error(`File reading was aborted: ${s.name}`))},w.readAsArrayBuffer(s)}),Dc=async s=>new Promise((p,C)=>{const w=new FileReader;w.onload=()=>{p()},w.onerror=()=>{C(new Error(`Failed to read image: ${s.name}`))},w.onabort=()=>{C(new Error(`Image reading was aborted: ${s.name}`))},w.readAsDataURL(s)}),Ic=async s=>{const p=await Promise.allSettled(s.map(async k=>(await Oc(k),k))),C=[],w=[];return p.forEach((k,j)=>{k.status==="fulfilled"?C.push(k.value):w.push({file:s[j],error:k.reason})}),{successful:C,failed:w}},jc=async s=>{const p=await Promise.allSettled(s.map(async k=>(await Dc(k),k))),C=[],w=[];return p.forEach((k,j)=>{k.status==="fulfilled"?C.push(k.value):w.push({file:s[j],error:k.reason})}),{successful:C,failed:w}};function Nc({onSubmit:s,onStop:p}){const{images:C,files:w,addImages:k,addFiles:j,clearAllFiles:I,addFileLoading:o,removeFileLoading:n,addImageLoading:u,removeImageLoading:m}=gt(),{curAgentState:c}=Mt(),{data:f}=_t(),v=b=>{const d=Wi(b,[...C,...w]);if(!d.isValid)return pt(`Error: ${d.errorMessage}`),null;const y=b.filter(D=>!Zr(D)),M=b.filter(D=>Zr(D));return{validFiles:y,validImages:M}},S=(b,d)=>{b.forEach(y=>o(y.name)),d.forEach(y=>u(y.name))},g=b=>{b.successful.length>0&&(j(b.successful),b.successful.forEach(d=>n(d.name)))},a=b=>{b.successful.length>0&&(k(b.successful),b.successful.forEach(d=>m(d.name)))},t=(b,d)=>{b.failed.forEach(({file:y,error:M})=>{n(y.name),pt(`Failed to process file ${y.name}: ${M.message}`)}),d.failed.forEach(({file:y,error:M})=>{m(y.name),pt(`Failed to process image ${y.name}: ${M.message}`)})},e=(b,d)=>{b.forEach(y=>n(y.name)),d.forEach(y=>m(y.name))},r=async b=>{const d=v(b);if(!d)return;const{validFiles:y,validImages:M}=d;S(y,M);try{const[D,N]=await Promise.all([Ic(y),jc(M)]);g(D),a(N),t(D,N)}catch{e(y,M),pt("An unexpected error occurred while processing files")}},i=b=>{s(b,C,w),I()},_=b=>{i(b)},l=c===Ce.LOADING||c===Ce.AWAITING_USER_CONFIRMATION;return h.jsxs("div",{"data-testid":"interactive-chat-box",children:[h.jsx(xc,{disabled:l,onSubmit:i,onStop:p,onFilesPaste:r,conversationStatus:f?.status||null}),h.jsx("div",{className:"mt-4",children:h.jsx(Tc,{onSuggestionsClick:_})})]})}const Bc=()=>{const{conversationId:s}=mt();return $t({mutationFn:({feedback:p})=>st.submitFeedback(s,p),onError:p=>{pt(p.message)},retry:2,retryDelay:500})},Pc="1.0",Fc="https://www.all-hands.dev/share";function Hc({onClose:s,polarity:p}){const{t:C}=ge(),w=()=>{Fr(C(Z.FEEDBACK$PASSWORD_COPIED_MESSAGE),{icon:"",position:"bottom-right"})},k=u=>{navigator.clipboard.writeText(u),w()},j=(u,m,c)=>{Fr(h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsx("span",{children:u}),h.jsx("a",{"data-testid":"toast-share-url",className:"text-blue-500 underline",onClick:()=>k(c),href:m,target:"_blank",rel:"noreferrer",children:C(Z.FEEDBACK$GO_TO_FEEDBACK)}),h.jsxs("span",{onClick:()=>k(c),className:"cursor-pointer",children:[C(Z.FEEDBACK$PASSWORD),": ",c," ",h.jsxs("span",{className:"text-gray-500",children:["(",C(Z.FEEDBACK$COPY_LABEL),")"]})]})]}),{duration:1e4})},{mutate:I,isPending:o}=Bc(),n=async u=>{u?.preventDefault();const m=new FormData(u.currentTarget),c=m.get("email")?.toString()||"",f=m.get("permissions")?.toString()||"private";I({feedback:{version:Pc,email:c,polarity:p,permissions:f,trajectory:[],token:""}},{onSuccess:S=>{const{message:g,feedback_id:a,password:t}=S.body,e=`${Fc}?share_id=${a}`;j(g,e,t),s()}})};return h.jsxs("form",{onSubmit:n,className:"flex flex-col gap-6 w-full",children:[h.jsxs("label",{className:"flex flex-col gap-2",children:[h.jsx("span",{className:"text-xs text-neutral-400",children:C(Z.FEEDBACK$EMAIL_LABEL)}),h.jsx("input",{required:!0,name:"email",type:"email",placeholder:C(Z.FEEDBACK$EMAIL_PLACEHOLDER),className:"bg-[#27272A] px-3 py-[10px] rounded-sm"})]}),h.jsxs("div",{className:"flex gap-4 text-neutral-400",children:[h.jsxs("label",{className:"flex gap-2 cursor-pointer",children:[h.jsx("input",{name:"permissions",value:"private",type:"radio",defaultChecked:!0}),C(Z.FEEDBACK$PRIVATE_LABEL)]}),h.jsxs("label",{className:"flex gap-2 cursor-pointer",children:[h.jsx("input",{name:"permissions",value:"public",type:"radio"}),C(Z.FEEDBACK$PUBLIC_LABEL)]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(It,{type:"submit",variant:"primary",className:"grow",isDisabled:o,children:C(o?Z.FEEDBACK$SUBMITTING_LABEL:Z.FEEDBACK$SHARE_LABEL)}),h.jsx(It,{type:"button",variant:"secondary",className:"grow",onClick:s,isDisabled:o,children:C(Z.FEEDBACK$CANCEL_LABEL)})]}),o&&h.jsx("p",{className:"text-sm text-center text-neutral-400",children:C(Z.FEEDBACK$SUBMITTING_MESSAGE)})]})}function $c({onClose:s,isOpen:p,polarity:C}){const{t:w}=ge();return p?h.jsx(Yt,{onClose:s,children:h.jsxs(Vt,{className:"border border-tertiary",children:[h.jsx(cs,{title:w(Z.FEEDBACK$TITLE)}),h.jsx(xr,{description:w(Z.FEEDBACK$DESCRIPTION)}),h.jsx(Hc,{onClose:s,polarity:C})]})}):null}function ln(s){const[p,C]=H.useState(!0),[w,k]=H.useState(!0),j=H.useRef(0),I=H.useCallback(u=>u.scrollTop+u.clientHeight>=u.scrollHeight-20,[]),o=H.useCallback(u=>{const m=I(u);k(m);const c=u.scrollTop,f=c<j.current;j.current=c,f&&C(!1),m&&C(!0)},[I]),n=H.useCallback(()=>{const u=s.current;u&&requestAnimationFrame(()=>{C(!0),k(!0),u.scrollTo({top:u.scrollHeight,behavior:"smooth"})})},[s]);return H.useEffect(()=>{if(p){const u=s.current;u&&requestAnimationFrame(()=>{u.scrollTo({top:u.scrollHeight,behavior:"smooth"})})}}),{scrollRef:s,autoScroll:p,setAutoScroll:C,scrollDomToBottom:n,hitBottom:w,setHitBottom:k,onChatBodyScroll:o}}function Uc(){return h.jsxs("div",{className:"flex items-center space-x-1.5 bg-tertiary px-3 py-1.5 rounded-full",children:[h.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-[bounce_0.5s_infinite] translate-y-[1px]",style:{animationDelay:"0ms"}}),h.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-[bounce_0.5s_infinite] translate-y-[1px]",style:{animationDelay:"75ms"}}),h.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-[bounce_0.5s_infinite] translate-y-[1px]",style:{animationDelay:"150ms"}})]})}const Wc=s=>{const p=jt(),{conversationId:C}=mt(),{data:w}=Rs();return Zt({queryKey:[...qt(C),s],queryFn:()=>s?p.getQueryData(qt(C))?.[s.toString()]??{exists:!1}:{exists:!1},enabled:!!s&&!!C&&w?.APP_MODE==="saas",staleTime:1e3*60*5,gcTime:1e3*60*15})},cn=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",...s},H.createElement("path",{d:"M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"})),hn=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",...s},H.createElement("path",{d:"M201.4 137.4c12.5-12.5 32.8-12.5 45.3 0l160 160c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L224 205.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l160-160z"}));function Vc({errorId:s,defaultMessage:p}){const{t:C}=ge(),[w,k]=pe.useState(!1),I=!!s&&dt.exists(s)?s:"CHAT_INTERFACE$AGENT_ERROR_MESSAGE";return h.jsxs("div",{className:"flex flex-col gap-2 border-l-2 pl-2 my-2 py-2 border-danger text-sm w-full",children:[h.jsxs("div",{className:"font-bold text-danger",children:[C(I),h.jsx("button",{type:"button",onClick:()=>k(o=>!o),className:"cursor-pointer text-left",children:w?h.jsx(hn,{className:"h-4 w-4 ml-2 inline fill-danger"}):h.jsx(cn,{className:"h-4 w-4 ml-2 inline fill-danger"})})]}),w&&h.jsx(cr,{components:{code:pr,ul:fr,ol:dr},remarkPlugins:[hr,ur],children:p})]})}var qe=(s=>(s.WAITING="waiting",s.CREATING="creating",s.COMPLETED="completed",s.ERROR="error",s))(qe||{});function zc({status:s,conversationId:p,prUrl:C}){const{t:w}=ge(),k=()=>{switch(s){case qe.WAITING:return w("MICROAGENT$STATUS_WAITING");case qe.CREATING:return w("MICROAGENT$STATUS_CREATING");case qe.COMPLETED:return w(C?"MICROAGENT$VIEW_YOUR_PR":"MICROAGENT$STATUS_COMPLETED");case qe.ERROR:return w("MICROAGENT$STATUS_ERROR");default:return""}},j=()=>{switch(s){case qe.WAITING:return h.jsx(sr,{size:"sm"});case qe.CREATING:return h.jsx(sr,{size:"sm"});case qe.COMPLETED:return h.jsx(Js,{status:"success"});case qe.ERROR:return h.jsx(Js,{status:"error"});default:return null}},I=k(),o=!!p,n=!!C,u=()=>n?h.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",className:"underline",children:I}):o?h.jsx("a",{href:`/conversations/${p}`,target:"_blank",rel:"noopener noreferrer",className:"underline",children:I}):h.jsx(Te.Text,{className:"underline",children:I});return h.jsxs("div",{className:"flex items-center gap-2 mt-2 p-2 text-sm",children:[j(),u()]})}function as({microagentStatus:s,microagentConversationId:p,microagentPRUrl:C,actions:w}){return!s||!w?null:h.jsx(zc,{status:s,conversationId:p,prUrl:C})}const Kc=()=>{const{conversationId:s}=mt(),p=jt();return $t({mutationFn:({rating:C,eventId:w,reason:k})=>st.submitConversationFeedback(s,C,w,k),onMutate:async({rating:C,eventId:w,reason:k})=>{if(!w)return{previousFeedback:null};const j=qt(s);await p.cancelQueries({queryKey:j});const I=p.getQueryData(j);return p.setQueryData(j,(o={})=>{const n={...o};return n[w.toString()]={exists:!0,rating:C,reason:k,metadata:{source:"likert-scale"}},n}),{previousFeedback:I}},onError:(C,{eventId:w},k)=>{k?.previousFeedback&&w&&p.setQueryData(qt(s),k.previousFeedback),console.error(C)},onSettled:(C,w,{eventId:k})=>{k&&p.invalidateQueries({queryKey:qt(s)})}})},un=H.createContext(void 0);function qc({children:s,value:p}){const C=ln(pe.useRef(null)),w=p||C;return h.jsx(un.Provider,{value:w,children:s})}const ai=1e4;function Gc({eventId:s,initiallySubmitted:p=!1,initialRating:C,initialReason:w}){const{t:k}=ge(),[j,I]=H.useState(C||null),[o,n]=H.useState(w||null),[u,m]=H.useState(!1),[c,f]=H.useState(null),[v,S]=H.useState(p),[g,a]=H.useState(0),t=H.useContext(un),e=[k(Z.FEEDBACK$REASON_MISUNDERSTOOD_INSTRUCTION),k(Z.FEEDBACK$REASON_FORGOT_CONTEXT),k(Z.FEEDBACK$REASON_UNNECESSARY_CHANGES),k(Z.FEEDBACK$REASON_SHOULD_ASK_FIRST),k(Z.FEEDBACK$REASON_DIDNT_FINISH_JOB),k(Z.FEEDBACK$REASON_OTHER)],r=t?.scrollDomToBottom,i=t?.autoScroll,{mutate:_}=Kc();H.useEffect(()=>{S(p)},[p]),H.useEffect(()=>{C&&I(C)},[C]),H.useEffect(()=>{w&&n(w)},[w]);const l=(M,D)=>{_({rating:M,eventId:s,reason:D},{onSuccess:()=>{n(D||null),m(!1),S(!0)}})},b=M=>{if(!v)if(I(M),M<=3){m(!0),a(Math.ceil(ai/1e3));const D=setTimeout(()=>{l(M)},ai);f(D),r&&i&&setTimeout(()=>{r()},100)}else m(!1),l(M)},d=M=>{j&&c&&!v&&(clearTimeout(c),a(0),l(j,M))};H.useEffect(()=>{if(g>0&&u&&!v){const M=setTimeout(()=>{a(g-1)},1e3);return()=>clearTimeout(M)}return()=>{}},[g,u,v]),H.useEffect(()=>()=>{c&&clearTimeout(c)},[c]),H.useEffect(()=>{r&&i&&!v&&setTimeout(()=>{r()},100)},[r,i,v]),H.useEffect(()=>{r&&i&&u&&setTimeout(()=>{r()},100)},[r,i,u]);const y=M=>v?j&&j>=M?"text-yellow-400 cursor-not-allowed":"text-gray-300 opacity-50 cursor-not-allowed":j&&j>=M?"text-yellow-400":"text-gray-300";return h.jsxs("div",{className:"mt-3 flex flex-col gap-1",children:[h.jsx("div",{className:"text-sm text-gray-500 mb-1",children:k(v?Z.FEEDBACK$THANK_YOU_FOR_FEEDBACK:Z.FEEDBACK$RATE_AGENT_PERFORMANCE)}),h.jsx("div",{className:"flex flex-col gap-1",children:h.jsxs("span",{className:"flex gap-2 items-center flex-wrap",children:[[1,2,3,4,5].map(M=>h.jsx("button",{type:"button",onClick:()=>b(M),disabled:v,className:Ee("oh-star text-xl transition-all",y(M),!v&&"hover:text-yellow-400 [&:has(~.oh-star:hover)]:text-yellow-400"),"aria-label":`Rate ${M} stars`,children:h.jsx(zn,{})},M)),v&&o&&j&&j<=3&&h.jsx("span",{className:"text-sm text-gray-500 italic",children:o})]})}),u&&!v&&h.jsxs("div",{className:"mt-1 flex flex-col gap-1",children:[h.jsx("div",{className:"text-xs text-gray-500 mb-1",children:k(Z.FEEDBACK$SELECT_REASON)}),g>0&&h.jsx("div",{className:"text-xs text-gray-400 mb-1 italic",children:k(Z.FEEDBACK$SELECT_REASON_COUNTDOWN,{countdown:g})}),h.jsx("div",{className:"flex flex-col gap-0.5",children:e.map(M=>h.jsx("button",{type:"button",onClick:()=>d(M),className:"text-sm text-left py-1 px-2 rounded hover:bg-gray-700 transition-colors",children:M},M))})]})]})}function kr({event:s,isLastMessage:p,isInLast10Actions:C,config:w,isCheckingFeedback:k,feedbackData:j}){return w?.APP_MODE!=="saas"||k||!(_r(s)?C:p)?null:h.jsx(Gc,{eventId:s.id,initiallySubmitted:j.exists,initialRating:j.rating,initialReason:j.reason})}function Zc({event:s,microagentStatus:p,microagentConversationId:C,microagentPRUrl:w,actions:k,isLastMessage:j,isInLast10Actions:I,config:o,isCheckingFeedback:n,feedbackData:u}){return _r(s)?h.jsxs("div",{children:[h.jsx(Vc,{errorId:s.extras.error_id,defaultMessage:s.message}),h.jsx(as,{microagentStatus:p,microagentConversationId:C,microagentPRUrl:w,actions:k}),h.jsx(kr,{event:s,isLastMessage:j,isInLast10Actions:I,config:o,isCheckingFeedback:n,feedbackData:u})]}):null}const Jc=s=>H.createElement("svg",{width:15,height:15,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M11.6938 4.50616C11.6357 4.44758 11.5666 4.40109 11.4904 4.36936C11.4142 4.33763 11.3325 4.32129 11.25 4.32129C11.1675 4.32129 11.0858 4.33763 11.0097 4.36936C10.9335 4.40109 10.8644 4.44758 10.8063 4.50616L6.15003 9.16866L4.19378 7.20616C4.13345 7.14789 4.06224 7.10207 3.98421 7.07132C3.90617 7.04056 3.82284 7.02548 3.73898 7.02693C3.65512 7.02838 3.57236 7.04634 3.49544 7.07977C3.41851 7.1132 3.34893 7.16146 3.29065 7.22179C3.23238 7.28211 3.18656 7.35333 3.15581 7.43136C3.12505 7.5094 3.10997 7.59272 3.11142 7.67659C3.11287 7.76045 3.13083 7.84321 3.16426 7.92013C3.1977 7.99705 3.24595 8.06664 3.30628 8.12491L5.70628 10.5249C5.76438 10.5835 5.83351 10.63 5.90967 10.6617C5.98583 10.6935 6.06752 10.7098 6.15003 10.7098C6.23254 10.7098 6.31423 10.6935 6.39039 10.6617C6.46655 10.63 6.53568 10.5835 6.59378 10.5249L11.6938 5.42491C11.7572 5.36639 11.8078 5.29535 11.8425 5.21629C11.8771 5.13723 11.895 5.05185 11.895 4.96554C11.895 4.87922 11.8771 4.79385 11.8425 4.71478C11.8078 4.63572 11.7572 4.56469 11.6938 4.50616Z",fill:"white"})),Yc=s=>H.createElement("svg",{width:15,height:15,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{d:"M1.25 2.5C1.25 1.80964 1.80964 1.25 2.5 1.25H8.75C9.44036 1.25 10 1.80964 10 2.5V5H12.5C13.1904 5 13.75 5.55964 13.75 6.25V12.5C13.75 13.1904 13.1904 13.75 12.5 13.75H6.25C5.55964 13.75 5 13.1904 5 12.5V10H2.5C1.80964 10 1.25 9.44036 1.25 8.75V2.5ZM6.25 10V12.5H12.5V6.25H10V8.75C10 9.44036 9.44036 10 8.75 10H6.25ZM8.75 8.75V2.5L2.5 2.5V8.75H8.75Z",fill:"white"}));function Xc({isHidden:s,isDisabled:p,onClick:C,mode:w}){const{t:k}=ge();return h.jsxs("button",{hidden:s,disabled:p,"data-testid":"copy-to-clipboard",type:"button",onClick:C,"aria-label":k(w==="copy"?Z.BUTTON$COPY:Z.BUTTON$COPIED),className:"button-base p-1 cursor-pointer",children:[w==="copy"&&h.jsx(Yc,{width:15,height:15}),w==="copied"&&h.jsx(Jc,{width:15,height:15})]})}function Qt({type:s,message:p,children:C,actions:w}){const[k,j]=pe.useState(!1),[I,o]=pe.useState(!1),n=async()=>{await navigator.clipboard.writeText(p),o(!0)};return pe.useEffect(()=>{let u;return I&&(u=setTimeout(()=>{o(!1)},2e3)),()=>{clearTimeout(u)}},[I]),h.jsxs("article",{"data-testid":`${s}-message`,onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),className:Ee("rounded-xl relative w-fit max-w-full last:mb-4","flex flex-col gap-2",s==="user"&&" p-4 bg-tertiary self-end",s==="agent"&&"mt-6 w-full max-w-full bg-transparent"),children:[h.jsxs("div",{className:Ee("absolute -top-2.5 -right-2.5",k?"flex":"hidden","items-center gap-1"),children:[w?.map((u,m)=>u.tooltip?h.jsx(Ti,{tooltip:u.tooltip,ariaLabel:u.tooltip,placement:"top",children:h.jsx("button",{type:"button",onClick:u.onClick,className:"button-base p-1 cursor-pointer","aria-label":`Action ${m+1}`,children:u.icon})},m):h.jsx("button",{type:"button",onClick:u.onClick,className:"button-base p-1 cursor-pointer","aria-label":`Action ${m+1}`,children:u.icon},m)),h.jsx(Xc,{isHidden:!k,isDisabled:I,onClick:n,mode:I?"copied":"copy"})]}),h.jsx("div",{className:"text-sm",style:{whiteSpace:"normal",wordBreak:"break-word"},children:h.jsx(cr,{components:{code:pr,ul:fr,ol:dr,a:qn,p:Kn},remarkPlugins:[hr,ur],children:p})}),C]})}function Qc({width:s=20,height:p=20,active:C}){return h.jsx("svg",{width:s,height:p,viewBox:`0 0 ${s} ${p}`,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.204 15.0037L6.65511 9.99993L11.204 4.99617L12.1289 5.83701L8.34444 9.99993L12.1289 14.1628L11.204 15.0037Z",fill:C?"#D4D4D4":"#525252"})})}function eh({width:s=20,height:p=20,active:C}){return h.jsx("svg",{width:s,height:p,viewBox:`0 0 ${s} ${p}`,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:h.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.79602 4.99634L13.3449 10.0001L8.79602 15.0038L7.87109 14.163L11.6556 10.0001L7.87109 5.83718L8.79602 4.99634Z",fill:C?"#D4D4D4":"#525252"})})}function dn({onClick:s,className:p}){return h.jsx("button",{type:"button",onClick:s,className:Ee("bg-neutral-400 rounded-full w-5 h-5 flex items-center justify-center cursor-pointer",p),children:h.jsx(Ni,{width:18,height:18})})}function th({src:s,size:p="small"}){return h.jsx("img",{role:"img",alt:"",src:s,className:Ee("rounded-sm object-cover",p==="small"&&"w-[62px] h-[62px]",p==="large"&&"w-[100px] h-[100px]")})}function sh({src:s,onRemove:p,size:C="small"}){return h.jsxs("div",{"data-testid":"image-preview",className:"relative w-fit shrink-0 py-1",children:[h.jsx(th,{src:s,size:C}),p&&h.jsx(dn,{onClick:p,className:"absolute right-[3px] top-[3px] cursor-pointer"})]})}function rh({size:s="small",images:p,onRemove:C}){const w=pe.useRef(null),[k,j]=pe.useState(!1),[I,o]=pe.useState(!0),[n,u]=pe.useState(!1);pe.useEffect(()=>{const c=w.current;if(c){const f=c.scrollWidth>c.clientWidth;j(f)}},[p]);const m=c=>{const f=c.currentTarget;o(f.scrollLeft===0),u(f.scrollLeft+f.clientWidth===f.scrollWidth)};return h.jsxs("div",{"data-testid":"image-carousel",className:"relative",children:[k&&h.jsx("div",{className:"absolute right-full transform top-1/2 -translate-y-1/2",children:h.jsx(Qc,{active:!I})}),h.jsx("div",{ref:w,onScroll:m,className:Ee("flex overflow-x-auto",s==="small"&&"gap-2",s==="large"&&"gap-4"),children:p.map((c,f)=>h.jsx(sh,{size:s,src:c,onRemove:C?()=>C?.(f):void 0},f))}),k&&h.jsx("div",{className:"absolute left-full transform top-1/2 -translate-y-1/2",children:h.jsx(eh,{active:!n})})]})}function ih({filename:s,onRemove:p}){return h.jsxs("div",{"data-testid":"file-item",className:"flex flex-row gap-x-1 items-center justify-start py-1",children:[h.jsx(Gn,{className:"h-4 w-4"}),h.jsx("code",{className:"text-sm flex-1 text-white truncate",children:s}),p&&h.jsx(dn,{onClick:p})]})}function nh({files:s,onRemove:p}){return h.jsx("div",{"data-testid":"file-list",className:Ee("flex flex-col gap-y-1.5 justify-start"),children:s.map((C,w)=>h.jsx(ih,{filename:C,onRemove:p?()=>p?.(w):void 0},w))})}function li({type:s,onClick:p}){const{t:C}=ge(),w=s==="confirm",k=C(w?Z.ACTION$CONFIRM:Z.ACTION$REJECT),j=C(w?Z.CHAT_INTERFACE$USER_CONFIRMED:Z.CHAT_INTERFACE$USER_REJECTED),I=w?`${C(Z.CHAT_INTERFACE$INPUT_CONTINUE_MESSAGE)} `:`${C(Z.BUTTON$CANCEL)} `;return h.jsx(Cr,{content:j,closeDelay:100,children:h.jsx("button",{"data-testid":`action-${s}-button`,type:"button","aria-label":k,className:Ee("rounded px-2 h-6.5 text-sm font-medium leading-5 cursor-pointer hover:opacity-80",s==="confirm"?"bg-tertiary text-white":"bg-white text-[#0D0F11]"),onClick:p,children:I})})}function oh({className:s,content:p,icon:C,severity:w,title:k}){return w==="high"?h.jsxs("div",{className:Ee("flex items-center gap-3.5 bg-[#4A0709] border border-[#FF0006] text-red-400 rounded-xl px-3.5 h-13 text-sm text-white",s),children:[C&&h.jsx("span",{className:"",children:C}),h.jsx("span",{className:"font-bold",children:k}),h.jsx("span",{className:"font-normal",children:p})]}):null}const ah=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M12 14C11.4477 14 11 13.5523 11 13V10C11 9.44772 11.4477 9 12 9C12.5523 9 13 9.44772 13 10V13C13 13.5523 12.5523 14 12 14Z",fill:"currentColor"}),H.createElement("path",{d:"M10.5 16.5C10.5 15.6716 11.1716 15 12 15C12.8284 15 13.5 15.6716 13.5 16.5C13.5 17.3284 12.8284 18 12 18C11.1716 18 10.5 17.3284 10.5 16.5Z",fill:"currentColor"}),H.createElement("path",{d:"M10.2301 3.2156C10.98 1.79093 13.02 1.79092 13.7698 3.2156L22.1135 19.0685C22.8144 20.4003 21.8486 22 20.3436 22H3.65635C2.15133 22 1.18556 20.4003 1.88651 19.0685L10.2301 3.2156ZM20.3436 20L12 4.1471L3.65635 20L20.3436 20Z",fill:"currentColor"})),ci=vr(s=>({submittedEventIds:[],addSubmittedEventId:p=>s(C=>({submittedEventIds:[...C.submittedEventIds,p]})),removeSubmittedEventId:p=>s(C=>({submittedEventIds:C.submittedEventIds.filter(w=>w!==p)}))}));function js(){const s=ci(m=>m.submittedEventIds),p=ci(m=>m.addSubmittedEventId),{t:C}=ge(),{send:w}=As(),j=Ms(m=>m.events).filter(xs).filter(Es).slice().reverse().find(m=>!Nt(m)||m.source!=="agent"?!1:m.args?.confirmation_state==="awaiting_confirmation"),I=H.useCallback(m=>{j&&(p(j.id),w(yi(m)))},[w,p]);if(H.useEffect(()=>{if(!j)return;const m=v=>{v.shiftKey&&v.metaKey&&v.key==="Backspace"&&(v.preventDefault(),I(Ce.USER_REJECTED))},c=v=>{v.metaKey&&v.key==="Enter"&&(v.preventDefault(),I(Ce.USER_CONFIRMED))},f=v=>{m(v),c(v)};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[j,I]),!j||s.includes(j.id))return null;const{args:o}=j,n=o?.security_risk,u=typeof n=="string"?n.toLowerCase()==="high":Number(n)===is.HIGH;return h.jsxs("div",{className:"flex flex-col gap-2 pt-4",children:[u&&h.jsx(oh,{content:C(Z.CHAT_INTERFACE$HIGH_RISK_WARNING),icon:h.jsx(ah,{width:16,height:16,color:"#fff"}),severity:"high",title:C(Z.COMMON$HIGH_RISK)}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("p",{className:"text-sm font-normal text-white",children:C(Z.CHAT_INTERFACE$USER_ASK_CONFIRMATION)}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(li,{type:"reject",onClick:()=>I(Ce.USER_REJECTED)}),h.jsx(li,{type:"confirm",onClick:()=>I(Ce.USER_CONFIRMED)})]})]})]})}const lh=s=>{const p=mr(s)?s.args.content:s.message;if(!s.args.file_urls||s.args.file_urls.length===0)return p;const C=dt.t("CHAT_INTERFACE$AUGMENTED_PROMPT_FILES_TITLE");return p.split(C)[0]};function ch({event:s,shouldShowConfirmationButtons:p,microagentStatus:C,microagentConversationId:w,microagentPRUrl:k,actions:j,isLastMessage:I,isInLast10Actions:o,config:n,isCheckingFeedback:u,feedbackData:m}){if(!mr(s)&&!Ys(s))return null;const c=lh(s);return h.jsxs(h.Fragment,{children:[h.jsxs(Qt,{type:s.source,message:c,actions:j,children:[s.args.image_urls&&s.args.image_urls.length>0&&h.jsx(rh,{size:"small",images:s.args.image_urls}),s.args.file_urls&&s.args.file_urls.length>0&&h.jsx(nh,{files:s.args.file_urls}),p&&h.jsx(js,{})]}),h.jsx(as,{microagentStatus:C,microagentConversationId:w,microagentPRUrl:k,actions:j}),Ys(s)&&s.action==="message"&&h.jsx(kr,{event:s,isLastMessage:I,isInLast10Actions:o,config:n,isCheckingFeedback:u,feedbackData:m})]})}const hh=s=>{const p=document.createElement("textarea");return p.innerHTML=s,p.value};function hi(s){const{children:p}=s,C=w=>{try{return hh(w)}catch(k){return wi.error(String(k)),w}};if(Array.isArray(p)){const w=p.map(k=>typeof k=="string"?C(k):k);return h.jsx("strong",{className:"font-mono",children:w})}return typeof p=="string"?h.jsx("strong",{className:"font-mono",children:C(p)}):h.jsx("strong",{className:"font-mono",children:p})}const uh=s=>{const p=document.createElement("textarea");return p.innerHTML=s,p.value},dh=s=>s?s.endsWith("/")||s.endsWith("\\")?!0:!(s.split(/[/\\]/).pop()||"").includes("."):!1,fh=s=>{if(!s)return"";const p=s.split(/[/\\]/),C=p[p.length-1];return dh(s)&&!C.endsWith("/")?`${C}/`:C};function ui(s){const{children:p}=s,C=w=>{try{const k=uh(w),j=fh(k);return h.jsx("span",{className:"font-mono",title:k,children:j})}catch(k){return wi.error(String(k)),h.jsx("span",{className:"font-mono",children:w})}};if(Array.isArray(p)){const w=p.map(k=>typeof k=="string"?C(k):k);return h.jsx("strong",{className:"font-mono",children:w})}return typeof p=="string"?h.jsx("strong",{children:C(p)}):h.jsx("strong",{className:"font-mono",children:p})}const Gt=1e3,fn=s=>`\`\`\`json
${JSON.stringify(s,null,2)}
\`\`\``,pn=s=>{switch(s){case is.LOW:return dt.t("SECURITY$LOW_RISK");case is.MEDIUM:return dt.t("SECURITY$MEDIUM_RISK");case is.HIGH:return dt.t("SECURITY$HIGH_RISK");case is.UNKNOWN:default:return dt.t("SECURITY$UNKNOWN_RISK")}},ph=s=>{let{content:p}=s.args;return p.length>Gt&&(p=`${s.args.content.slice(0,Gt)}...`),`${s.args.path}
${p}`},_h=s=>{let p=`Command:
\`${s.args.command}\``;return s.args.confirmation_state==="awaiting_confirmation"&&(p+=`

${pn(s.args.security_risk)}`),p},mh=s=>{let p=`\`\`\`
${s.args.code}
\`\`\``;return s.args.confirmation_state==="awaiting_confirmation"&&(p+=`

${pn(s.args.security_risk)}`),p},gh=s=>`Browsing ${s.args.url}`,vh=s=>`**Action:**

\`\`\`python
${s.args.browser_actions}
\`\`\``,bh=s=>{const p=s.args.name||"",C=s.args.arguments||{};let w=`**MCP Tool Call:** ${p}

`;return s.args.thought&&(w+=`

**Thought:**
${s.args.thought}`),w+=`

**Arguments:**
\`\`\`json
${JSON.stringify(C,null,2)}
\`\`\``,w},Ch=s=>s.args.thought,Sh=s=>s.args.final_thought.trim(),yh=s=>{let p=`**Command:** \`${s.args.command}\``;return s.args.command==="plan"&&s.args.task_list&&s.args.task_list.length>0?(p+=`

**Task List (${s.args.task_list.length} ${s.args.task_list.length===1?"item":"items"}):**
`,s.args.task_list.forEach((C,w)=>{const k={todo:"",in_progress:"",done:""}[C.status]||"";p+=`
${w+1}. ${k} **[${C.status.toUpperCase().replace("_"," ")}]** ${C.title}`,p+=`
   *ID: ${C.id}*`,C.notes&&(p+=`
   *Notes: ${C.notes}*`)})):s.args.command==="plan"&&(p+=`

**Task List:** Empty`),p},wh=()=>"",xh=s=>{switch(s.action){case"read":case"edit":return wh();case"write":return ph(s);case"run":return _h(s);case"run_ipython":return mh(s);case"browse":return gh(s);case"browse_interactive":return vh(s);case"call_tool_mcp":return bh(s);case"think":return Ch(s);case"finish":return Sh(s);case"task_tracking":return yh(s);default:return fn(s)}},Ns=s=>{const p=s.content.length>0,C=s.content.toLowerCase().includes("error:");switch(s.observation){case"run":{const w=s.extras.metadata.exit_code;return w===-1?"timeout":w===0?"success":"error"}case"run_ipython":case"read":case"edit":case"mcp":return!p||C?"error":"success";default:return"success"}},Eh=s=>`\`\`\`
${s.content}
\`\`\``,kh=s=>{let{content:p}=s;return p.length>Gt&&(p=`${p.slice(0,Gt)}...`),`Output:
\`\`\`sh
${p.trim()||dt.t("OBSERVATION$COMMAND_NO_OUTPUT")}
\`\`\``},Ah=(s,p)=>p?`\`\`\`diff
${s.extras.diff}
\`\`\``:s.content,Mh=s=>{let p=`**URL:** ${s.extras.url}
`;return s.extras.error&&(p+=`

**Error:**
${s.extras.error}
`),p+=`

**Output:**
${s.content}`,p.length>Gt&&(p=`${p.slice(0,Gt)}...(truncated)`),p},Lh=s=>{let p="";if(s.extras.recall_type==="workspace_context"){if(s.extras.repo_name&&(p+=`

**Repository:** ${s.extras.repo_name}`),s.extras.repo_directory&&(p+=`

**Directory:** ${s.extras.repo_directory}`),s.extras.date&&(p+=`

**Date:** ${s.extras.date}`),s.extras.runtime_hosts&&Object.keys(s.extras.runtime_hosts).length>0){p+=`

**Available Hosts**`;for(const[C,w]of Object.entries(s.extras.runtime_hosts))p+=`

- ${C} (port ${w})`}s.extras.repo_instructions&&(p+=`

**Repository Instructions:**

${s.extras.repo_instructions}`),s.extras.conversation_instructions&&(p+=`

**Conversation Instructions:**

${s.extras.conversation_instructions}`),s.extras.additional_agent_instructions&&(p+=`

**Additional Instructions:**

${s.extras.additional_agent_instructions}`)}if(s.extras.microagent_knowledge&&s.extras.microagent_knowledge.length>0){p+=`

**Triggered Microagent Knowledge:**`;for(const C of s.extras.microagent_knowledge)p+=`

- **${C.name}** (triggered by keyword: ${C.trigger})

${C.content}`}if(s.extras.custom_secrets_descriptions&&Object.keys(s.extras.custom_secrets_descriptions).length>0){p+=`

**Custom Secrets**`;for(const[C,w]of Object.entries(s.extras.custom_secrets_descriptions))p+=`

- $${C}: ${w}`}return p},Rh=s=>{const{command:p,task_list:C}=s.extras;let w=`**Command:** \`${p}\``;return p==="plan"&&C.length>0?(w+=`

**Task List (${C.length} ${C.length===1?"item":"items"}):**
`,C.forEach((k,j)=>{const I={todo:"",in_progress:"",done:""}[k.status]||"";w+=`
${j+1}. ${I} **[${k.status.toUpperCase().replace("_"," ")}]** ${k.title}`,w+=`
   *ID: ${k.id}*`,k.notes&&(w+=`
   *Notes: ${k.notes}*`)})):p==="plan"&&(w+=`

**Task List:** Empty`),s.content&&s.content.trim()&&(w+=`

**Result:** ${s.content.trim()}`),w},Th=s=>{switch(s.observation){case"read":return Eh(s);case"edit":return Ah(s,Ns(s)==="success");case"run_ipython":case"run":return kh(s);case"browse":return Mh(s);case"recall":return Lh(s);case"task_tracking":return Rh(s);default:return fn(s)}},di=s=>typeof s.path=="string",fi=s=>typeof s.command=="string",pi=(s,p)=>s?s.length>p?`${s.substring(0,p)}...`:s:"",ks=s=>{let p="",C="";if(Nt(s)){const w=`ACTION_MESSAGE$${s.action.toUpperCase()}`;dt.exists(w)?p=h.jsx(rr,{i18nKey:w,values:{path:di(s.args)&&s.args.path,command:fi(s.args)&&pi(s.args.command,80),mcp_tool_name:s.action==="call_tool_mcp"&&s.args.name},components:{path:h.jsx(ui,{}),cmd:h.jsx(hi,{})}}):p=s.action.toUpperCase(),C=xh(s)}if(Ls(s)){const w=`OBSERVATION_MESSAGE$${s.observation.toUpperCase()}`;dt.exists(w)?p=h.jsx(rr,{i18nKey:w,values:{path:di(s.extras)&&s.extras.path,command:fi(s.extras)&&pi(s.extras.command,80),mcp_tool_name:s.observation==="mcp"&&s.extras.name},components:{path:h.jsx(ui,{}),cmd:h.jsx(hi,{})}}):p=s.observation.toUpperCase(),C=Th(s)}return{title:p??dt.t("EVENT$UNKNOWN_EVENT"),details:C??dt.t("EVENT$UNKNOWN_EVENT")}};function Oh({event:s,microagentStatus:p,microagentConversationId:C,microagentPRUrl:w,actions:k,isLastMessage:j,isInLast10Actions:I,config:o,isCheckingFeedback:n,feedbackData:u}){return gr(s)?h.jsxs(h.Fragment,{children:[h.jsx(Qt,{type:"agent",message:ks(s).details,actions:k}),h.jsx(as,{microagentStatus:p,microagentConversationId:C,microagentPRUrl:w,actions:k}),h.jsx(kr,{event:s,isLastMessage:j,isInLast10Actions:I,config:o,isCheckingFeedback:n,feedbackData:u})]}):null}function Dh({event:s}){return xi(s)?h.jsx("div",{children:h.jsx(Qt,{type:"agent",message:s.content})}):null}function Ar({title:s,details:p,success:C,initiallyExpanded:w=!1}){const[k,j]=pe.useState(w);return h.jsxs("div",{className:"flex flex-col gap-2 border-l-2 pl-2 my-2 py-2 border-neutral-300 text-sm w-full",children:[h.jsxs("div",{className:"flex items-center justify-between font-bold text-neutral-300",children:[h.jsxs("div",{children:[s,p&&h.jsx("button",{type:"button",onClick:()=>j(I=>!I),className:"cursor-pointer text-left",children:k?h.jsx(hn,{className:"h-4 w-4 ml-2 inline fill-neutral-300"}):h.jsx(cn,{className:"h-4 w-4 ml-2 inline fill-neutral-300"})})]}),C&&h.jsx(Js,{status:C})]}),k&&(typeof p=="string"?h.jsx(cr,{components:{code:pr,ul:fr,ol:dr},remarkPlugins:[hr,ur],children:p}):p)]})}function Ih({event:s}){const{t:p}=ge();let C;try{C=JSON.parse(s.content)}catch{C=s.content}const w=s.extras.arguments&&Object.keys(s.extras.arguments).length>0;return h.jsxs("div",{className:"flex flex-col gap-4",children:[w&&h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsx("h3",{className:"text-sm font-semibold text-gray-300",children:p("MCP_OBSERVATION$ARGUMENTS")})}),h.jsx("div",{className:"p-3 bg-gray-900 rounded-md overflow-auto text-gray-300 max-h-[200px] shadow-inner",children:h.jsx(or,{name:!1,src:s.extras.arguments,theme:er,collapsed:1,displayDataTypes:!1})})]}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsx("h3",{className:"text-sm font-semibold text-gray-300",children:p("MCP_OBSERVATION$OUTPUT")})}),h.jsx("div",{className:"p-3 bg-gray-900 rounded-md overflow-auto text-gray-300 max-h-[300px] shadow-inner",children:typeof C=="object"&&C!==null?h.jsx(or,{name:!1,src:C,theme:er,collapsed:1,displayDataTypes:!1}):h.jsx("pre",{className:"whitespace-pre-wrap",children:s.content.trim()||p("OBSERVATION$MCP_NO_OUTPUT")})})]})]})}function jh({event:s,shouldShowConfirmationButtons:p}){return Ei(s)?h.jsxs("div",{children:[h.jsx(Ar,{title:ks(s).title,details:h.jsx(Ih,{event:s}),success:Ns(s)}),p&&h.jsx(js,{})]}):null}function Nh({status:s}){return h.jsx("span",{className:"text-lg",children:bo(s)})}function Bh({status:s}){return h.jsx("span",{className:`text-xs px-2 py-1 rounded uppercase font-semibold ${Co(s)}`,children:s.replace("_"," ")})}function Ph({task:s,index:p}){const{t:C}=ge();return h.jsx("div",{className:"border-l-2 border-gray-600 pl-3",children:h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(Nh,{status:s.status}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsxs(Te.Text,{className:"text-sm text-gray-400",children:[p+1,"."]}),h.jsx(Bh,{status:s.status})]}),h.jsx("h4",{className:"font-medium text-white mb-1",children:s.title}),h.jsxs(Te.Text,{className:"text-xs text-gray-400 mb-1",children:[C("TASK_TRACKING_OBSERVATION$TASK_ID"),": ",s.id]}),s.notes&&h.jsxs(Te.Text,{className:"text-sm text-gray-300 italic",children:[C("TASK_TRACKING_OBSERVATION$TASK_NOTES"),": ",s.notes]})]})]})})}function Fh({taskList:s}){const{t:p}=ge();return h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs(Te.H3,{children:[p("TASK_TRACKING_OBSERVATION$TASK_LIST")," (",s.length," ",s.length===1?"item":"items",")"]})}),h.jsx("div",{className:"p-3 bg-gray-900 rounded-md overflow-auto text-gray-300 max-h-[400px] shadow-inner",children:h.jsx("div",{className:"space-y-3",children:s.map((C,w)=>h.jsx(Ph,{task:C,index:w},C.id))})})]})}function Hh({content:s}){const{t:p}=ge();return h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsx(Te.H3,{children:p("TASK_TRACKING_OBSERVATION$RESULT")})}),h.jsx("div",{className:"p-3 bg-gray-900 rounded-md overflow-auto text-gray-300 shadow-inner",children:h.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:s.trim()})})]})}function $h({event:s}){const{command:p,task_list:C}=s.extras,w=p==="plan"&&C.length>0;return h.jsxs("div",{className:"flex flex-col gap-4",children:[w&&h.jsx(Fh,{taskList:C}),s.content&&s.content.trim()&&h.jsx(Hh,{content:s.content})]})}function Uh({event:s,shouldShowConfirmationButtons:p}){const{t:C}=ge();if(!ki(s))return null;const{command:w}=s.extras;let k,j=!1;return w==="plan"?(k=C("OBSERVATION_MESSAGE$TASK_TRACKING_PLAN"),j=!0):(k=C("OBSERVATION_MESSAGE$TASK_TRACKING_VIEW"),j=!1),h.jsxs("div",{children:[h.jsx(Ar,{title:k,details:h.jsx($h,{event:s}),success:Ns(s),initiallyExpanded:j}),p&&h.jsx(js,{})]})}const Wh=s=>"thought"in s&&!!s.thought;function Vh({event:s,microagentStatus:p,microagentConversationId:C,microagentPRUrl:w,actions:k}){return Nt(s)?Wh(s.args)&&s.action!=="think"?h.jsxs("div",{children:[h.jsx(Qt,{type:"agent",message:s.args.thought,actions:k}),h.jsx(as,{microagentStatus:p,microagentConversationId:C,microagentPRUrl:w,actions:k})]}):h.jsx(as,{microagentStatus:p,microagentConversationId:C,microagentPRUrl:w,actions:k}):null}const zh=s=>"thought"in s&&!!s.thought;function Kh({event:s,shouldShowConfirmationButtons:p}){return h.jsxs("div",{children:[Nt(s)&&zh(s.args)&&s.action!=="think"&&h.jsx(Qt,{type:"agent",message:s.args.thought}),h.jsx(Ar,{title:ks(s).title,details:ks(s).details,success:Ls(s)?Ns(s):void 0}),p&&h.jsx(js,{})]})}function qh({event:s,hasObservationPair:p,isAwaitingUserConfirmation:C,isLastMessage:w,microagentStatus:k,microagentConversationId:j,microagentPRUrl:I,actions:o,isInLast10Actions:n}){const u=w&&s.source==="agent"&&C,{data:m}=Rs(),{data:c={exists:!1},isLoading:f}=Wc(s.id),v={microagentStatus:k,microagentConversationId:j,microagentPRUrl:I,actions:o,isLastMessage:w,isInLast10Actions:n,config:m,isCheckingFeedback:f,feedbackData:c};return _r(s)?h.jsx(Zc,{event:s,...v}):p&&Nt(s)?h.jsx(Vh,{event:s,microagentStatus:k,microagentConversationId:j,microagentPRUrl:I,actions:o}):gr(s)?h.jsx(Oh,{event:s,...v}):mr(s)||Ys(s)?h.jsx(ch,{event:s,shouldShowConfirmationButtons:u,...v}):xi(s)?h.jsx(Dh,{event:s}):Ei(s)?h.jsx(jh,{event:s,shouldShowConfirmationButtons:u}):ki(s)?h.jsx(Uh,{event:s,shouldShowConfirmationButtons:u}):h.jsx(Kh,{event:s,shouldShowConfirmationButtons:u})}const Gh=s=>{const{conversationId:p}=mt();return Zt({queryKey:["memory","prompt",p,s],queryFn:()=>st.getMicroagentPrompt(p,s),enabled:!!p,staleTime:1e3*60*5,gcTime:1e3*60*15})};function Zh(){const{t:s}=ge();return h.jsxs(Vt,{children:[h.jsx("h2",{className:"font-bold text-[20px] leading-6 -tracking-[0.01em] flex items-center gap-2",children:s("MICROAGENT$ADD_TO_MICROAGENT")}),h.jsx(sr,{size:"lg"}),h.jsx(Te.Text,{children:s("MICROAGENT$WAIT_FOR_RUNTIME")})]})}function Jh(){const{t:s}=ge();return h.jsx("textarea",{required:!0,disabled:!0,defaultValue:"",placeholder:s("MICROAGENT$LOADING_PROMPT"),rows:6,className:Ee("bg-tertiary border border-[#717888] w-full rounded p-2 placeholder:italic placeholder:text-tertiary-alt resize-none","disabled:bg-[#2D2F36] disabled:border-[#2D2F36] disabled:cursor-not-allowed")})}const Yh=s=>{const{conversationId:p}=mt();return Zt({queryKey:["files","microagents",p,s],queryFn:()=>st.getFiles(p,s),enabled:!!p,select:C=>C.map(w=>w.replace(s,""))})};function Xh({onClose:s,onLaunch:p,eventId:C,isLoading:w,selectedRepo:k}){const{t:j}=ge(),{runtimeActive:I}=Zn(),{data:o,isLoading:n}=Gh(C),{data:u,isLoading:m}=Yh(`${k}/.openhands/microagents`),[c,f]=pe.useState([]),v=g=>{const a=g.get("query-input")?.toString(),t=g.get("target-input")?.toString();a&&t&&p(a,t,c)},S=g=>{g.preventDefault();const a=new FormData(g.currentTarget);v(a)};return h.jsxs(Yt,{onClose:s,children:[!I&&h.jsx(Zh,{}),I&&h.jsxs(Vt,{className:"items-start w-[728px]",children:[h.jsxs("div",{className:"flex items-center justify-between w-full",children:[h.jsxs("h2",{className:"font-bold text-[20px] leading-6 -tracking-[0.01em] flex items-center gap-2",children:[j("MICROAGENT$ADD_TO_MICROAGENT"),h.jsx("a",{href:"https://docs.all-hands.dev/usage/prompting/microagents-overview#microagents-overview",target:"_blank",rel:"noopener noreferrer",children:h.jsx(Hr,{className:"text-primary"})})]}),h.jsx("button",{type:"button",onClick:s,children:h.jsx(Ni,{})})]}),h.jsx(Te.Text,{className:"text-sm text-[#A3A3A3] font-normal leading-5",children:j("MICROAGENT$DEFINITION")}),h.jsxs("form",{"data-testid":"launch-microagent-modal",onSubmit:S,className:"flex flex-col gap-6 w-full",children:[h.jsxs("label",{htmlFor:"query-input",className:"flex flex-col gap-2.5 w-full text-sm",children:[j("MICROAGENT$WHAT_TO_REMEMBER"),n&&h.jsx(Jh,{}),!n&&h.jsx("textarea",{required:!0,"data-testid":"query-input",name:"query-input",defaultValue:o,placeholder:j("MICROAGENT$DESCRIBE_WHAT_TO_ADD"),rows:6,className:Ee("bg-tertiary border border-[#717888] w-full rounded p-2 placeholder:italic placeholder:text-tertiary-alt resize-none","disabled:bg-[#2D2F36] disabled:border-[#2D2F36] disabled:cursor-not-allowed")})]}),h.jsx(Ro,{testId:"target-input",name:"target-input",label:j("MICROAGENT$WHERE_TO_PUT"),placeholder:j("MICROAGENT$SELECT_FILE_OR_CUSTOM"),required:!0,allowsCustomValue:!0,isLoading:m,items:u?.map(g=>({key:g,label:g}))||[]}),h.jsxs("label",{htmlFor:"trigger-input",className:"flex flex-col gap-2.5 w-full text-sm",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[j("MICROAGENT$ADD_TRIGGERS"),h.jsx("a",{href:"https://docs.all-hands.dev/usage/prompting/microagents-keyword",target:"_blank",rel:"noopener noreferrer",children:h.jsx(Hr,{className:"text-primary"})})]}),h.jsx(Jn,{name:"trigger-input",value:c,placeholder:j("MICROAGENT$TYPE_TRIGGER_SPACE"),onChange:f})]}),h.jsxs("div",{className:"flex items-center justify-end gap-2",children:[h.jsx(It,{type:"button",variant:"secondary",onClick:s,children:j("MICROAGENT$CANCEL")}),h.jsx(It,{type:"submit",variant:"primary",isDisabled:w||n||m,children:j("MICROAGENT$LAUNCH")})]})]})]})]})}const Qh=s=>H.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 22.3 18.66",...s},H.createElement("defs",null,H.createElement("style",null,`
      .st0 {
        stroke-miterlimit: 10;
      }

      .st0, .st1 {
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-width: 2px;
      }

      .st1 {
        stroke-linejoin: round;
      }
    `)),H.createElement("path",{className:"st1",d:"M15.15,12.54h3.26c1.58,0,2.93-1.29,2.9-2.88-.03-1.53-1.28-2.77-2.82-2.77-.04,0-.08,0-.11,0,.13-.44.16-.92.04-1.43-.27-1.17-1.27-2.05-2.46-2.17-.74-.07-1.43.14-1.97.55,0,0,0-.02,0-.03,0-1.56-1.26-2.82-2.82-2.82s-2.82,1.26-2.82,2.82c0,0,0,.02,0,.03-.54-.4-1.23-.62-1.97-.55-1.19.12-2.19,1-2.46,2.17-.12.5-.09.99.04,1.43-.04,0-.08,0-.11,0-1.56,0-2.82,1.26-2.82,2.82s1.26,2.82,2.82,2.82l1.29.03c.41,0,.74.34.74.75v1.85c0,1.38,1.12,2.5,2.5,2.5h.29c1.44,0,2.6-1.17,2.6-2.6V6.49"}),H.createElement("polyline",{className:"st0",points:"7.97 9.74 11.22 6.49 14.47 9.74"})),eu=s=>typeof s=="object"&&s!==null&&"error"in s&&s.error===!0,tu=s=>Xs(s)&&Ai(s)&&s.extras.agent_state===Ce.ERROR,_n=pe.memo(({messages:s,isAwaitingUserConfirmation:p})=>{const{createConversationAndSubscribe:C,isPending:w,unsubscribeFromConversation:k}=Yn(),{getOptimisticUserMessage:j}=br(),{conversationId:I}=mt(),{data:o}=Xn(I),n=j(),[u,m]=pe.useState(null),[c,f]=pe.useState(!1),[v,S]=pe.useState([]),{t:g}=ge(),a=pe.useCallback(l=>Nt(l)?!!s.some(b=>Ls(b)&&b.cause===l.id):!1,[s]),t=pe.useCallback(l=>v.find(d=>d.eventId===l)?.status||null,[v]),e=pe.useCallback(l=>v.find(d=>d.eventId===l)?.conversationId||void 0,[v]),r=pe.useCallback(l=>v.find(d=>d.eventId===l)?.prUrl||void 0,[v]),i=pe.useCallback((l,b)=>{if(eu(l)||tu(l))S(d=>d.map(y=>y.conversationId===b?{...y,status:qe.ERROR}:y));else if(Xs(l)&&Ai(l))(l.extras.agent_state===Ce.FINISHED||l.extras.agent_state===Ce.AWAITING_USER_INPUT)&&(S(d=>d.map(y=>y.conversationId===b?{...y,status:qe.COMPLETED}:y)),k(b));else if(Xs(l)&&gr(l)){const d=Qn(l.args.final_thought||"");d&&S(y=>y.map(M=>M.conversationId===b?{...M,status:qe.COMPLETED,prUrl:d}:M)),k(b)}else S(d=>d.find(M=>M.conversationId===b)?.status===qe.WAITING?d.map(M=>M.conversationId===b?{...M,status:qe.CREATING}:M):d)},[S,k]),_=(l,b,d)=>{const y=`Target file: ${b}

Description: ${l}

Triggers: ${d.join(", ")}`;!o||!o.selected_repository||!o.selected_branch||!o.git_provider||!u||C({query:l,conversationInstructions:y,repository:{name:o.selected_repository,branch:o.selected_branch,gitProvider:o.git_provider},onSuccessCallback:M=>{f(!1),S(D=>[...D.filter(N=>N.eventId!==u),{eventId:u,conversationId:M,status:qe.WAITING}])},onEventCallback:(M,D)=>{i(M,D)}})};return h.jsxs(h.Fragment,{children:[s.map((l,b)=>h.jsx(qh,{event:l,hasObservationPair:a(l),isAwaitingUserConfirmation:p,isLastMessage:s.length-1===b,microagentStatus:t(l.id),microagentConversationId:e(l.id),microagentPRUrl:r(l.id),actions:o?.selected_repository?[{icon:h.jsx(Qh,{className:"w-[14px] h-[14px] text-white"}),onClick:()=>{m(l.id),f(!0)},tooltip:g("MICROAGENT$ADD_TO_MEMORY")}]:void 0,isInLast10Actions:s.length-1-b<10},b)),n&&h.jsx(Qt,{type:"user",message:n}),o?.selected_repository&&c&&u&&yo.createPortal(h.jsx(Xh,{onClose:()=>f(!1),onLaunch:_,selectedRepo:o.selected_repository.split("/").pop()||"",eventId:u,isLoading:w}),document.getElementById("modal-portal-exit")||document.body)]})},(s,p)=>s.messages.length===p.messages.length);_n.displayName="Messages";function su(s){return null}const _i={files:[],initialPrompt:null,selectedRepository:null,selectedRepositoryProvider:null,replayJson:null},ru=vr(s=>({..._i,addFile:p=>s(C=>({files:[...C.files,p]})),removeFile:p=>s(C=>({files:C.files.filter((w,k)=>k!==p)})),clearFiles:()=>s(()=>({files:[]})),setInitialPrompt:p=>s(()=>({initialPrompt:p})),clearInitialPrompt:()=>s(()=>({initialPrompt:null})),setSelectedRepository:p=>s(()=>({selectedRepository:p})),clearSelectedRepository:()=>s(()=>({selectedRepository:null})),setSelectedRepositoryProvider:p=>s(()=>({selectedRepositoryProvider:p})),setReplayJson:p=>s(()=>({replayJson:p})),reset:()=>s(()=>_i)})),iu=s=>H.createElement("svg",{width:12,height:17,viewBox:"0 0 12 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.5304 6.46978L10.4697 7.53044L6.75006 3.81077L6.75006 17.0001H5.25006L5.25006 3.81077L1.53039 7.53044L0.469727 6.46978L6.00006 0.939453L11.5304 6.46978Z",fill:"white"}));function nu({onClick:s}){return h.jsx("button",{type:"button",onClick:s,"data-testid":"scroll-to-bottom",className:"button-base p-1 hover:bg-neutral-500 rotate-180 cursor-pointer",children:h.jsx(iu,{width:15,height:15})})}function ou({message:s}){return h.jsx("div",{className:"w-full rounded-lg p-2 text-black border border-red-800 bg-red-500",children:dt.exists(s)?h.jsx(rr,{i18nKey:s,components:{a:h.jsx($n,{className:"underline font-bold cursor-pointer",to:"/settings/billing",children:"link"})}}):s})}const mi=["system","agent_state_changed","change_agent_state"],au=["recall"],lu=["think"],cu=s=>Nt(s)?eo(s)&&s.source==="user"?!1:!mi.concat(au).includes(s.action):Ls(s)?to(s)&&s.source==="user"?!1:!mi.concat(lu).includes(s.observation):!0,hu=s=>s.some(p=>Nt(p)&&p.source==="user"),uu=()=>$t({mutationKey:["upload-files"],mutationFn:s=>st.uploadFiles(s.conversationId,s.files),onSuccess:async()=>{},meta:{disableToast:!0}}),du=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 3.25C9.92893 3.25 8.25 4.92893 8.25 7V10H7C6.44772 10 6 10.4477 6 11V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V11C18 10.4477 17.5523 10 17 10H15.75V7C15.75 4.92893 14.0711 3.25 12 3.25ZM14.25 10V7C14.25 5.75736 13.2426 4.75 12 4.75C10.7574 4.75 9.75 5.75736 9.75 7V10H14.25Z",fill:"currentColor"}));function fu(){const{t:s}=ge(),{data:p}=Do();return p?.CONFIRMATION_MODE?h.jsx(Cr,{content:s(Z.COMMON$CONFIRMATION_MODE_ENABLED),closeDelay:100,className:"bg-white text-black hover:bg-transparent",children:h.jsx("div",{className:"flex items-center justify-center w-[26px] h-[26px] rounded-lg bg-[#25272D]",children:h.jsx(du,{width:15,height:15})})}):null}function pu(s,p){return s?"github":p?"replay":"direct"}function mn(){const{setMessageToSend:s}=gt(),{errorMessage:p}=Mi(),{send:C,isLoadingMessages:w}=As(),k=Ms(F=>F.events),{setOptimisticUserMessage:j,getOptimisticUserMessage:I}=br(),{t:o}=ge(),n=pe.useRef(null),{scrollDomToBottom:u,onChatBodyScroll:m,hitBottom:c,autoScroll:f,setAutoScroll:v,setHitBottom:S}=ln(n),{data:g}=Rs(),{curAgentState:a}=Mt(),[t,e]=pe.useState("positive"),[r,i]=pe.useState(!1),{selectedRepository:_,replayJson:l}=ru(),b=ls(),{mutateAsync:d}=uu(),y=I(),M=k.filter(xs).filter(Es).filter(cu),D=pe.useMemo(()=>k.filter(xs).filter(Es).some(F=>Nt(F)&&F.source==="agent"&&F.action!=="system"),[k]),N=async(F,ee,L)=>{const B=[...ee],P=[...L];M.length===0?Wt.capture("initial_query_submitted",{entry_point:pu(_!==null,l!==null),query_character_length:F.length,replay_json_size:l?.length}):Wt.capture("user_message_sent",{session_message_count:M.length,current_message_length:F.length});const W=[...B,...P],Q=Wi(W);if(!Q.isValid){pt(`Error: ${Q.errorMessage}`);return}const ae=B.map(le=>Ca(le)),he=await Promise.all(ae),me=new Date().toISOString(),{skipped_files:V,uploaded_files:O}=P.length>0?await d({conversationId:b.conversationId,files:P}):{skipped_files:[],uploaded_files:[]};V.forEach(le=>pt(le.reason));const Y=`${o("CHAT_INTERFACE$AUGMENTED_PROMPT_FILES_TITLE")}: ${O.join(`

`)}`,se=O.length>0?`${F}

${Y}`:F;C(xa(se,he,O,me)),j(F),s("")},T=()=>{Wt.capture("stop_button_clicked"),C(yi(Ce.STOPPED))},z=async F=>{i(!0),e(F)},J={scrollRef:n,autoScroll:f,setAutoScroll:v,scrollDomToBottom:u,hitBottom:c,setHitBottom:S,onChatBodyScroll:m},ie=hu(M);return h.jsx(qc,{value:J,children:h.jsxs("div",{className:"h-full flex flex-col justify-between pr-0 md:pr-4 relative",children:[!D&&!y&&!ie&&h.jsx(su,{onSuggestionsClick:F=>s(F)}),h.jsxs("div",{ref:n,onScroll:F=>m(F.currentTarget),className:"custom-scrollbar-always flex flex-col grow overflow-y-auto overflow-x-hidden px-4 pt-4 gap-2 fast-smooth-scroll",children:[w&&h.jsx("div",{className:"flex justify-center",children:h.jsx(Oo,{size:"small"})}),!w&&ie&&h.jsx(_n,{messages:M,isAwaitingUserConfirmation:a===Ce.AWAITING_USER_CONFIRMATION})]}),h.jsxs("div",{className:"flex flex-col gap-[6px]",children:[h.jsxs("div",{className:"flex justify-between relative",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(fu,{}),M.length>0&&h.jsx(wa,{onPositiveFeedback:()=>z("positive"),onNegativeFeedback:()=>z("negative"),isSaasMode:g?.APP_MODE==="saas"})]}),h.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 bottom-0",children:a===Ce.RUNNING&&h.jsx(Uc,{})}),!c&&h.jsx(nu,{onClick:u})]}),p&&h.jsx(ou,{message:p}),h.jsx(Nc,{onSubmit:N,onStop:T})]}),g?.APP_MODE!=="saas"&&h.jsx($c,{isOpen:r,onClose:()=>i(!1),polarity:t})]})})}function _u(){const{t:s}=ge();return h.jsxs("div",{className:"bg-[#25272D] border border-[#525252] rounded-xl flex flex-col items-center justify-center h-full w-full",children:[h.jsx(Is,{className:"animate-spin w-16 h-16",color:"white"}),h.jsx("span",{className:"text-2xl font-normal leading-5 text-white p-4",children:s(Z.HOME$LOADING)})]})}function mu({isActive:s,children:p}){return h.jsx("div",{className:Ee("absolute inset-0",s?"block":"hidden"),children:p})}function gu({children:s}){return h.jsx("div",{className:"bg-[#25272D] border border-[#525252] rounded-xl flex flex-col h-full w-full",children:s})}function vu({children:s}){return h.jsx("div",{className:"overflow-hidden flex-grow rounded-b-xl h-full w-full relative",children:s})}function bu({title:s}){return h.jsx("div",{className:"flex flex-row items-center justify-between border-b border-[#474A54] py-2 px-3",children:h.jsx("span",{className:"text-xs font-medium text-white",children:s})})}var qs={exports:{}},gi;function Cu(){return gi||(gi=1,(function(s,p){(function(C,w){s.exports=w()})(self,(()=>(()=>{var C={};return(()=>{var w=C;Object.defineProperty(w,"__esModule",{value:!0}),w.FitAddon=void 0,w.FitAddon=class{activate(k){this._terminal=k}dispose(){}fit(){const k=this.proposeDimensions();if(!k||!this._terminal||isNaN(k.cols)||isNaN(k.rows))return;const j=this._terminal._core;this._terminal.rows===k.rows&&this._terminal.cols===k.cols||(j._renderService.clear(),this._terminal.resize(k.cols,k.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const k=this._terminal._core,j=k._renderService.dimensions;if(j.css.cell.width===0||j.css.cell.height===0)return;const I=this._terminal.options.scrollback===0?0:k.viewport.scrollBarWidth,o=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(o.getPropertyValue("height")),u=Math.max(0,parseInt(o.getPropertyValue("width"))),m=window.getComputedStyle(this._terminal.element),c=n-(parseInt(m.getPropertyValue("padding-top"))+parseInt(m.getPropertyValue("padding-bottom"))),f=u-(parseInt(m.getPropertyValue("padding-right"))+parseInt(m.getPropertyValue("padding-left")))-I;return{cols:Math.max(2,Math.floor(f/j.css.cell.width)),rows:Math.max(1,Math.floor(c/j.css.cell.height))}}}})(),C})()))})(qs)),qs.exports}var Su=Cu(),Gs={exports:{}},vi;function yu(){return vi||(vi=1,(function(s,p){(function(C,w){s.exports=w()})(globalThis,(()=>(()=>{var C={4567:function(I,o,n){var u=this&&this.__decorate||function(e,r,i,_){var l,b=arguments.length,d=b<3?r:_===null?_=Object.getOwnPropertyDescriptor(r,i):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(e,r,i,_);else for(var y=e.length-1;y>=0;y--)(l=e[y])&&(d=(b<3?l(d):b>3?l(r,i,d):l(r,i))||d);return b>3&&d&&Object.defineProperty(r,i,d),d},m=this&&this.__param||function(e,r){return function(i,_){r(i,_,e)}};Object.defineProperty(o,"__esModule",{value:!0}),o.AccessibilityManager=void 0;const c=n(9042),f=n(9924),v=n(844),S=n(4725),g=n(2585),a=n(3656);let t=o.AccessibilityManager=class extends v.Disposable{constructor(e,r,i,_){super(),this._terminal=e,this._coreBrowserService=i,this._renderService=_,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let l=0;l<this._terminal.rows;l++)this._rowElements[l]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[l]);if(this._topBoundaryFocusListener=l=>this._handleBoundaryFocus(l,0),this._bottomBoundaryFocusListener=l=>this._handleBoundaryFocus(l,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new f.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize((l=>this._handleResize(l.rows)))),this.register(this._terminal.onRender((l=>this._refreshRows(l.start,l.end)))),this.register(this._terminal.onScroll((()=>this._refreshRows()))),this.register(this._terminal.onA11yChar((l=>this._handleChar(l)))),this.register(this._terminal.onLineFeed((()=>this._handleChar(`
`)))),this.register(this._terminal.onA11yTab((l=>this._handleTab(l)))),this.register(this._terminal.onKey((l=>this._handleKey(l.key)))),this.register(this._terminal.onBlur((()=>this._clearLiveRegion()))),this.register(this._renderService.onDimensionsChange((()=>this._refreshRowsDimensions()))),this.register((0,a.addDisposableDomListener)(document,"selectionchange",(()=>this._handleSelectionChange()))),this.register(this._coreBrowserService.onDprChange((()=>this._refreshRowsDimensions()))),this._refreshRows(),this.register((0,v.toDisposable)((()=>{this._accessibilityContainer.remove(),this._rowElements.length=0})))}_handleTab(e){for(let r=0;r<e;r++)this._handleChar(" ")}_handleChar(e){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,e===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=c.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(e){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(e)||this._charsToConsume.push(e)}_refreshRows(e,r){this._liveRegionDebouncer.refresh(e,r,this._terminal.rows)}_renderRows(e,r){const i=this._terminal.buffer,_=i.lines.length.toString();for(let l=e;l<=r;l++){const b=i.lines.get(i.ydisp+l),d=[],y=b?.translateToString(!0,void 0,void 0,d)||"",M=(i.ydisp+l+1).toString(),D=this._rowElements[l];D&&(y.length===0?(D.innerText="",this._rowColumns.set(D,[0,1])):(D.textContent=y,this._rowColumns.set(D,d)),D.setAttribute("aria-posinset",M),D.setAttribute("aria-setsize",_))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(e,r){const i=e.target,_=this._rowElements[r===0?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")===(r===0?"1":`${this._terminal.buffer.lines.length}`)||e.relatedTarget!==_)return;let l,b;if(r===0?(l=i,b=this._rowElements.pop(),this._rowContainer.removeChild(b)):(l=this._rowElements.shift(),b=i,this._rowContainer.removeChild(l)),l.removeEventListener("focus",this._topBoundaryFocusListener),b.removeEventListener("focus",this._bottomBoundaryFocusListener),r===0){const d=this._createAccessibilityTreeNode();this._rowElements.unshift(d),this._rowContainer.insertAdjacentElement("afterbegin",d)}else{const d=this._createAccessibilityTreeNode();this._rowElements.push(d),this._rowContainer.appendChild(d)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(r===0?-1:1),this._rowElements[r===0?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;const e=document.getSelection();if(!e)return;if(e.isCollapsed)return void(this._rowContainer.contains(e.anchorNode)&&this._terminal.clearSelection());if(!e.anchorNode||!e.focusNode)return void console.error("anchorNode and/or focusNode are null");let r={node:e.anchorNode,offset:e.anchorOffset},i={node:e.focusNode,offset:e.focusOffset};if((r.node.compareDocumentPosition(i.node)&Node.DOCUMENT_POSITION_PRECEDING||r.node===i.node&&r.offset>i.offset)&&([r,i]=[i,r]),r.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(r={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(r.node))return;const _=this._rowElements.slice(-1)[0];if(i.node.compareDocumentPosition(_)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(i={node:_,offset:_.textContent?.length??0}),!this._rowContainer.contains(i.node))return;const l=({node:y,offset:M})=>{const D=y instanceof Text?y.parentNode:y;let N=parseInt(D?.getAttribute("aria-posinset"),10)-1;if(isNaN(N))return console.warn("row is invalid. Race condition?"),null;const T=this._rowColumns.get(D);if(!T)return console.warn("columns is null. Race condition?"),null;let z=M<T.length?T[M]:T.slice(-1)[0]+1;return z>=this._terminal.cols&&(++N,z=0),{row:N,column:z}},b=l(r),d=l(i);if(b&&d){if(b.row>d.row||b.row===d.row&&b.column>=d.column)throw new Error("invalid range");this._terminal.select(b.column,b.row,(d.row-b.row)*this._terminal.cols-b.column+d.column)}}_handleResize(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let r=this._rowContainer.children.length;r<this._terminal.rows;r++)this._rowElements[r]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[r]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const e=this._coreBrowserService.mainDocument.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}}_refreshRowDimensions(e){e.style.height=`${this._renderService.dimensions.css.cell.height}px`}};o.AccessibilityManager=t=u([m(1,g.IInstantiationService),m(2,S.ICoreBrowserService),m(3,S.IRenderService)],t)},3614:(I,o)=>{function n(f){return f.replace(/\r?\n/g,"\r")}function u(f,v){return v?"\x1B[200~"+f+"\x1B[201~":f}function m(f,v,S,g){f=u(f=n(f),S.decPrivateModes.bracketedPasteMode&&g.rawOptions.ignoreBracketedPasteMode!==!0),S.triggerDataEvent(f,!0),v.value=""}function c(f,v,S){const g=S.getBoundingClientRect(),a=f.clientX-g.left-10,t=f.clientY-g.top-10;v.style.width="20px",v.style.height="20px",v.style.left=`${a}px`,v.style.top=`${t}px`,v.style.zIndex="1000",v.focus()}Object.defineProperty(o,"__esModule",{value:!0}),o.rightClickHandler=o.moveTextAreaUnderMouseCursor=o.paste=o.handlePasteEvent=o.copyHandler=o.bracketTextForPaste=o.prepareTextForTerminal=void 0,o.prepareTextForTerminal=n,o.bracketTextForPaste=u,o.copyHandler=function(f,v){f.clipboardData&&f.clipboardData.setData("text/plain",v.selectionText),f.preventDefault()},o.handlePasteEvent=function(f,v,S,g){f.stopPropagation(),f.clipboardData&&m(f.clipboardData.getData("text/plain"),v,S,g)},o.paste=m,o.moveTextAreaUnderMouseCursor=c,o.rightClickHandler=function(f,v,S,g,a){c(f,v,S),a&&g.rightClickSelect(f),v.value=g.selectionText,v.select()}},7239:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorContrastCache=void 0;const u=n(1505);o.ColorContrastCache=class{constructor(){this._color=new u.TwoKeyMap,this._css=new u.TwoKeyMap}setCss(m,c,f){this._css.set(m,c,f)}getCss(m,c){return this._css.get(m,c)}setColor(m,c,f){this._color.set(m,c,f)}getColor(m,c){return this._color.get(m,c)}clear(){this._color.clear(),this._css.clear()}}},3656:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.addDisposableDomListener=void 0,o.addDisposableDomListener=function(n,u,m,c){n.addEventListener(u,m,c);let f=!1;return{dispose:()=>{f||(f=!0,n.removeEventListener(u,m,c))}}}},3551:function(I,o,n){var u=this&&this.__decorate||function(t,e,r,i){var _,l=arguments.length,b=l<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(t,e,r,i);else for(var d=t.length-1;d>=0;d--)(_=t[d])&&(b=(l<3?_(b):l>3?_(e,r,b):_(e,r))||b);return l>3&&b&&Object.defineProperty(e,r,b),b},m=this&&this.__param||function(t,e){return function(r,i){e(r,i,t)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Linkifier=void 0;const c=n(3656),f=n(8460),v=n(844),S=n(2585),g=n(4725);let a=o.Linkifier=class extends v.Disposable{get currentLink(){return this._currentLink}constructor(t,e,r,i,_){super(),this._element=t,this._mouseService=e,this._renderService=r,this._bufferService=i,this._linkProviderService=_,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new f.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new f.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,v.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,v.toDisposable)((()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()}))),this.register(this._bufferService.onResize((()=>{this._clearCurrentLink(),this._wasResized=!0}))),this.register((0,c.addDisposableDomListener)(this._element,"mouseleave",(()=>{this._isMouseOut=!0,this._clearCurrentLink()}))),this.register((0,c.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(t){this._lastMouseEvent=t;const e=this._positionFromMouseEvent(t,this._element,this._mouseService);if(!e)return;this._isMouseOut=!1;const r=t.composedPath();for(let i=0;i<r.length;i++){const _=r[i];if(_.classList.contains("xterm"))break;if(_.classList.contains("xterm-hover"))return}this._lastBufferCell&&e.x===this._lastBufferCell.x&&e.y===this._lastBufferCell.y||(this._handleHover(e),this._lastBufferCell=e)}_handleHover(t){if(this._activeLine!==t.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(t,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,t)||(this._clearCurrentLink(),this._askForLink(t,!0))}_askForLink(t,e){this._activeProviderReplies&&e||(this._activeProviderReplies?.forEach((i=>{i?.forEach((_=>{_.link.dispose&&_.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=t.y);let r=!1;for(const[i,_]of this._linkProviderService.linkProviders.entries())e?this._activeProviderReplies?.get(i)&&(r=this._checkLinkProviderResult(i,t,r)):_.provideLinks(t.y,(l=>{if(this._isMouseOut)return;const b=l?.map((d=>({link:d})));this._activeProviderReplies?.set(i,b),r=this._checkLinkProviderResult(i,t,r),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(t.y,this._activeProviderReplies)}))}_removeIntersectingLinks(t,e){const r=new Set;for(let i=0;i<e.size;i++){const _=e.get(i);if(_)for(let l=0;l<_.length;l++){const b=_[l],d=b.link.range.start.y<t?0:b.link.range.start.x,y=b.link.range.end.y>t?this._bufferService.cols:b.link.range.end.x;for(let M=d;M<=y;M++){if(r.has(M)){_.splice(l--,1);break}r.add(M)}}}}_checkLinkProviderResult(t,e,r){if(!this._activeProviderReplies)return r;const i=this._activeProviderReplies.get(t);let _=!1;for(let l=0;l<t;l++)this._activeProviderReplies.has(l)&&!this._activeProviderReplies.get(l)||(_=!0);if(!_&&i){const l=i.find((b=>this._linkAtPosition(b.link,e)));l&&(r=!0,this._handleNewLink(l))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!r)for(let l=0;l<this._activeProviderReplies.size;l++){const b=this._activeProviderReplies.get(l)?.find((d=>this._linkAtPosition(d.link,e)));if(b){r=!0,this._handleNewLink(b);break}}return r}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(t){if(!this._currentLink)return;const e=this._positionFromMouseEvent(t,this._element,this._mouseService);e&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,e)&&this._currentLink.link.activate(t,this._currentLink.link.text)}_clearCurrentLink(t,e){this._currentLink&&this._lastMouseEvent&&(!t||!e||this._currentLink.link.range.start.y>=t&&this._currentLink.link.range.end.y<=e)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,v.disposeArray)(this._linkCacheDisposables))}_handleNewLink(t){if(!this._lastMouseEvent)return;const e=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);e&&this._linkAtPosition(t.link,e)&&(this._currentLink=t,this._currentLink.state={decorations:{underline:t.link.decorations===void 0||t.link.decorations.underline,pointerCursor:t.link.decorations===void 0||t.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,t.link,this._lastMouseEvent),t.link.decorations={},Object.defineProperties(t.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:r=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==r&&(this._currentLink.state.decorations.pointerCursor=r,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",r))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:r=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==r&&(this._currentLink.state.decorations.underline=r,this._currentLink.state.isHovered&&this._fireUnderlineEvent(t.link,r))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((r=>{if(!this._currentLink)return;const i=r.start===0?0:r.start+1+this._bufferService.buffer.ydisp,_=this._bufferService.buffer.ydisp+1+r.end;if(this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=_&&(this._clearCurrentLink(i,_),this._lastMouseEvent)){const l=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);l&&this._askForLink(l,!1)}}))))}_linkHover(t,e,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(e,!0),this._currentLink.state.decorations.pointerCursor&&t.classList.add("xterm-cursor-pointer")),e.hover&&e.hover(r,e.text)}_fireUnderlineEvent(t,e){const r=t.range,i=this._bufferService.buffer.ydisp,_=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-i-1,r.end.x,r.end.y-i-1,void 0);(e?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(_)}_linkLeave(t,e,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(e,!1),this._currentLink.state.decorations.pointerCursor&&t.classList.remove("xterm-cursor-pointer")),e.leave&&e.leave(r,e.text)}_linkAtPosition(t,e){const r=t.range.start.y*this._bufferService.cols+t.range.start.x,i=t.range.end.y*this._bufferService.cols+t.range.end.x,_=e.y*this._bufferService.cols+e.x;return r<=_&&_<=i}_positionFromMouseEvent(t,e,r){const i=r.getCoords(t,e,this._bufferService.cols,this._bufferService.rows);if(i)return{x:i[0],y:i[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(t,e,r,i,_){return{x1:t,y1:e,x2:r,y2:i,cols:this._bufferService.cols,fg:_}}};o.Linkifier=a=u([m(1,g.IMouseService),m(2,g.IRenderService),m(3,S.IBufferService),m(4,g.ILinkProviderService)],a)},9042:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.tooMuchOutput=o.promptLabel=void 0,o.promptLabel="Terminal input",o.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(I,o,n){var u=this&&this.__decorate||function(g,a,t,e){var r,i=arguments.length,_=i<3?a:e===null?e=Object.getOwnPropertyDescriptor(a,t):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(g,a,t,e);else for(var l=g.length-1;l>=0;l--)(r=g[l])&&(_=(i<3?r(_):i>3?r(a,t,_):r(a,t))||_);return i>3&&_&&Object.defineProperty(a,t,_),_},m=this&&this.__param||function(g,a){return function(t,e){a(t,e,g)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkProvider=void 0;const c=n(511),f=n(2585);let v=o.OscLinkProvider=class{constructor(g,a,t){this._bufferService=g,this._optionsService=a,this._oscLinkService=t}provideLinks(g,a){const t=this._bufferService.buffer.lines.get(g-1);if(!t)return void a(void 0);const e=[],r=this._optionsService.rawOptions.linkHandler,i=new c.CellData,_=t.getTrimmedLength();let l=-1,b=-1,d=!1;for(let y=0;y<_;y++)if(b!==-1||t.hasContent(y)){if(t.loadCell(y,i),i.hasExtendedAttrs()&&i.extended.urlId){if(b===-1){b=y,l=i.extended.urlId;continue}d=i.extended.urlId!==l}else b!==-1&&(d=!0);if(d||b!==-1&&y===_-1){const M=this._oscLinkService.getLinkData(l)?.uri;if(M){const D={start:{x:b+1,y:g},end:{x:y+(d||y!==_-1?0:1),y:g}};let N=!1;if(!r?.allowNonHttpProtocols)try{const T=new URL(M);["http:","https:"].includes(T.protocol)||(N=!0)}catch{N=!0}N||e.push({text:M,range:D,activate:(T,z)=>r?r.activate(T,z,D):S(0,z),hover:(T,z)=>r?.hover?.(T,z,D),leave:(T,z)=>r?.leave?.(T,z,D)})}d=!1,i.hasExtendedAttrs()&&i.extended.urlId?(b=y,l=i.extended.urlId):(b=-1,l=-1)}}a(e)}};function S(g,a){if(confirm(`Do you want to navigate to ${a}?

WARNING: This link could potentially be dangerous`)){const t=window.open();if(t){try{t.opener=null}catch{}t.location.href=a}else console.warn("Opening link blocked as opener could not be cleared")}}o.OscLinkProvider=v=u([m(0,f.IBufferService),m(1,f.IOptionsService),m(2,f.IOscLinkService)],v)},6193:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.RenderDebouncer=void 0,o.RenderDebouncer=class{constructor(n,u){this._renderCallback=n,this._coreBrowserService=u,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(n){return this._refreshCallbacks.push(n),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh()))),this._animationFrame}refresh(n,u,m){this._rowCount=m,n=n!==void 0?n:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const n=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,u),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const n of this._refreshCallbacks)n(0);this._refreshCallbacks=[]}}},3236:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;const u=n(3614),m=n(3656),c=n(3551),f=n(9042),v=n(3730),S=n(1680),g=n(3107),a=n(5744),t=n(2950),e=n(1296),r=n(428),i=n(4269),_=n(5114),l=n(8934),b=n(3230),d=n(9312),y=n(4725),M=n(6731),D=n(8055),N=n(8969),T=n(8460),z=n(844),J=n(6114),ie=n(8437),F=n(2584),ee=n(7399),L=n(5941),B=n(9074),P=n(2585),W=n(5435),Q=n(4567),ae=n(779);class he extends N.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(V={}){super(V),this.browser=J,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new z.MutableDisposable),this._onCursorMove=this.register(new T.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new T.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new T.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new T.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new T.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new T.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new T.EventEmitter),this._onBlur=this.register(new T.EventEmitter),this._onA11yCharEmitter=this.register(new T.EventEmitter),this._onA11yTabEmitter=this.register(new T.EventEmitter),this._onWillOpen=this.register(new T.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(B.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(ae.LinkProviderService),this._instantiationService.setService(y.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(v.OscLinkProvider)),this.register(this._inputHandler.onRequestBell((()=>this._onBell.fire()))),this.register(this._inputHandler.onRequestRefreshRows(((O,Y)=>this.refresh(O,Y)))),this.register(this._inputHandler.onRequestSendFocus((()=>this._reportFocus()))),this.register(this._inputHandler.onRequestReset((()=>this.reset()))),this.register(this._inputHandler.onRequestWindowsOptionsReport((O=>this._reportWindowsOptions(O)))),this.register(this._inputHandler.onColor((O=>this._handleColorEvent(O)))),this.register((0,T.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,T.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,T.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,T.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize((O=>this._afterResize(O.cols,O.rows)))),this.register((0,z.toDisposable)((()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)})))}_handleColorEvent(V){if(this._themeService)for(const O of V){let Y,se="";switch(O.index){case 256:Y="foreground",se="10";break;case 257:Y="background",se="11";break;case 258:Y="cursor",se="12";break;default:Y="ansi",se="4;"+O.index}switch(O.type){case 0:const le=D.color.toColorRGB(Y==="ansi"?this._themeService.colors.ansi[O.index]:this._themeService.colors[Y]);this.coreService.triggerDataEvent(`${F.C0.ESC}]${se};${(0,L.toRgbString)(le)}${F.C1_ESCAPED.ST}`);break;case 1:if(Y==="ansi")this._themeService.modifyColors((ce=>ce.ansi[O.index]=D.channels.toColor(...O.color)));else{const ce=Y;this._themeService.modifyColors((xe=>xe[ce]=D.channels.toColor(...O.color)))}break;case 2:this._themeService.restoreColor(O.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(V){V?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Q.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(V){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(F.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const V=this.buffer.ybase+this.buffer.y,O=this.buffer.lines.get(V);if(!O)return;const Y=Math.min(this.buffer.x,this.cols-1),se=this._renderService.dimensions.css.cell.height,le=O.getWidth(Y),ce=this._renderService.dimensions.css.cell.width*le,xe=this.buffer.y*this._renderService.dimensions.css.cell.height,Re=Y*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Re+"px",this.textarea.style.top=xe+"px",this.textarea.style.width=ce+"px",this.textarea.style.height=se+"px",this.textarea.style.lineHeight=se+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,m.addDisposableDomListener)(this.element,"copy",(O=>{this.hasSelection()&&(0,u.copyHandler)(O,this._selectionService)})));const V=O=>(0,u.handlePasteEvent)(O,this.textarea,this.coreService,this.optionsService);this.register((0,m.addDisposableDomListener)(this.textarea,"paste",V)),this.register((0,m.addDisposableDomListener)(this.element,"paste",V)),J.isFirefox?this.register((0,m.addDisposableDomListener)(this.element,"mousedown",(O=>{O.button===2&&(0,u.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))):this.register((0,m.addDisposableDomListener)(this.element,"contextmenu",(O=>{(0,u.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))),J.isLinux&&this.register((0,m.addDisposableDomListener)(this.element,"auxclick",(O=>{O.button===1&&(0,u.moveTextAreaUnderMouseCursor)(O,this.textarea,this.screenElement)})))}_bindKeys(){this.register((0,m.addDisposableDomListener)(this.textarea,"keyup",(V=>this._keyUp(V)),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keydown",(V=>this._keyDown(V)),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keypress",(V=>this._keyPress(V)),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionstart",(()=>this._compositionHelper.compositionstart()))),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionupdate",(V=>this._compositionHelper.compositionupdate(V)))),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionend",(()=>this._compositionHelper.compositionend()))),this.register((0,m.addDisposableDomListener)(this.textarea,"input",(V=>this._inputEvent(V)),!0)),this.register(this.onRender((()=>this._compositionHelper.updateCompositionElements())))}open(V){if(!V)throw new Error("Terminal requires a parent element.");if(V.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=V.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),V.appendChild(this.element);const O=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),O.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,m.addDisposableDomListener)(this.screenElement,"mousemove",(Y=>this.updateCursorStyle(Y)))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),O.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",f.promptLabel),J.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(_.CoreBrowserService,this.textarea,V.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(y.ICoreBrowserService,this._coreBrowserService),this.register((0,m.addDisposableDomListener)(this.textarea,"focus",(Y=>this._handleTextAreaFocus(Y)))),this.register((0,m.addDisposableDomListener)(this.textarea,"blur",(()=>this._handleTextAreaBlur()))),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(r.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(y.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(M.ThemeService),this._instantiationService.setService(y.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(i.CharacterJoinerService),this._instantiationService.setService(y.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(b.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(y.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((Y=>this._onRender.fire(Y)))),this.onResize((Y=>this._renderService.resize(Y.cols,Y.rows))),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(t.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(l.MouseService),this._instantiationService.setService(y.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(c.Linkifier,this.screenElement)),this.element.appendChild(O);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(S.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines((Y=>this.scrollLines(Y.amount,Y.suppressScrollEvent,1))),this.register(this._inputHandler.onRequestSyncScrollBar((()=>this.viewport.syncScrollArea()))),this.register(this.viewport),this.register(this.onCursorMove((()=>{this._renderService.handleCursorMove(),this._syncTextArea()}))),this.register(this.onResize((()=>this._renderService.handleResize(this.cols,this.rows)))),this.register(this.onBlur((()=>this._renderService.handleBlur()))),this.register(this.onFocus((()=>this._renderService.handleFocus()))),this.register(this._renderService.onDimensionsChange((()=>this.viewport.syncScrollArea()))),this._selectionService=this.register(this._instantiationService.createInstance(d.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(y.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((Y=>this.scrollLines(Y.amount,Y.suppressScrollEvent)))),this.register(this._selectionService.onSelectionChange((()=>this._onSelectionChange.fire()))),this.register(this._selectionService.onRequestRedraw((Y=>this._renderService.handleSelectionChanged(Y.start,Y.end,Y.columnSelectMode)))),this.register(this._selectionService.onLinuxMouseSelection((Y=>{this.textarea.value=Y,this.textarea.focus(),this.textarea.select()}))),this.register(this._onScroll.event((Y=>{this.viewport.syncScrollArea(),this._selectionService.refresh()}))),this.register((0,m.addDisposableDomListener)(this._viewportElement,"scroll",(()=>this._selectionService.refresh()))),this.register(this._instantiationService.createInstance(g.BufferDecorationRenderer,this.screenElement)),this.register((0,m.addDisposableDomListener)(this.element,"mousedown",(Y=>this._selectionService.handleMouseDown(Y)))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Q.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",(Y=>this._handleScreenReaderModeOptionChange(Y)))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(a.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",(Y=>{!this._overviewRulerRenderer&&Y&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(a.OverviewRulerRenderer,this._viewportElement,this.screenElement)))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(e.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const V=this,O=this.element;function Y(ce){const xe=V._mouseService.getMouseReportCoords(ce,V.screenElement);if(!xe)return!1;let Re,Oe;switch(ce.overrideType||ce.type){case"mousemove":Oe=32,ce.buttons===void 0?(Re=3,ce.button!==void 0&&(Re=ce.button<3?ce.button:3)):Re=1&ce.buttons?0:4&ce.buttons?1:2&ce.buttons?2:3;break;case"mouseup":Oe=0,Re=ce.button<3?ce.button:3;break;case"mousedown":Oe=1,Re=ce.button<3?ce.button:3;break;case"wheel":if(V._customWheelEventHandler&&V._customWheelEventHandler(ce)===!1||V.viewport.getLinesScrolled(ce)===0)return!1;Oe=ce.deltaY<0?0:1,Re=4;break;default:return!1}return!(Oe===void 0||Re===void 0||Re>4)&&V.coreMouseService.triggerMouseEvent({col:xe.col,row:xe.row,x:xe.x,y:xe.y,button:Re,action:Oe,ctrl:ce.ctrlKey,alt:ce.altKey,shift:ce.shiftKey})}const se={mouseup:null,wheel:null,mousedrag:null,mousemove:null},le={mouseup:ce=>(Y(ce),ce.buttons||(this._document.removeEventListener("mouseup",se.mouseup),se.mousedrag&&this._document.removeEventListener("mousemove",se.mousedrag)),this.cancel(ce)),wheel:ce=>(Y(ce),this.cancel(ce,!0)),mousedrag:ce=>{ce.buttons&&Y(ce)},mousemove:ce=>{ce.buttons||Y(ce)}};this.register(this.coreMouseService.onProtocolChange((ce=>{ce?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(ce)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&ce?se.mousemove||(O.addEventListener("mousemove",le.mousemove),se.mousemove=le.mousemove):(O.removeEventListener("mousemove",se.mousemove),se.mousemove=null),16&ce?se.wheel||(O.addEventListener("wheel",le.wheel,{passive:!1}),se.wheel=le.wheel):(O.removeEventListener("wheel",se.wheel),se.wheel=null),2&ce?se.mouseup||(se.mouseup=le.mouseup):(this._document.removeEventListener("mouseup",se.mouseup),se.mouseup=null),4&ce?se.mousedrag||(se.mousedrag=le.mousedrag):(this._document.removeEventListener("mousemove",se.mousedrag),se.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,m.addDisposableDomListener)(O,"mousedown",(ce=>{if(ce.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(ce))return Y(ce),se.mouseup&&this._document.addEventListener("mouseup",se.mouseup),se.mousedrag&&this._document.addEventListener("mousemove",se.mousedrag),this.cancel(ce)}))),this.register((0,m.addDisposableDomListener)(O,"wheel",(ce=>{if(!se.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(ce)===!1)return!1;if(!this.buffer.hasScrollback){const xe=this.viewport.getLinesScrolled(ce);if(xe===0)return;const Re=F.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(ce.deltaY<0?"A":"B");let Oe="";for(let He=0;He<Math.abs(xe);He++)Oe+=Re;return this.coreService.triggerDataEvent(Oe,!0),this.cancel(ce,!0)}return this.viewport.handleWheel(ce)?this.cancel(ce):void 0}}),{passive:!1})),this.register((0,m.addDisposableDomListener)(O,"touchstart",(ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(ce),this.cancel(ce)}),{passive:!0})),this.register((0,m.addDisposableDomListener)(O,"touchmove",(ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(ce)?void 0:this.cancel(ce)}),{passive:!1}))}refresh(V,O){this._renderService?.refreshRows(V,O)}updateCursorStyle(V){this._selectionService?.shouldColumnSelect(V)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(V,O,Y=0){Y===1?(super.scrollLines(V,O,Y),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(V)}paste(V){(0,u.paste)(V,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(V){this._customKeyEventHandler=V}attachCustomWheelEventHandler(V){this._customWheelEventHandler=V}registerLinkProvider(V){return this._linkProviderService.registerLinkProvider(V)}registerCharacterJoiner(V){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const O=this._characterJoinerService.register(V);return this.refresh(0,this.rows-1),O}deregisterCharacterJoiner(V){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(V)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(V){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+V)}registerDecoration(V){return this._decorationService.registerDecoration(V)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(V,O,Y){this._selectionService.setSelection(V,O,Y)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(V,O){this._selectionService?.selectLines(V,O)}_keyDown(V){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(V)===!1)return!1;const O=this.browser.isMac&&this.options.macOptionIsMeta&&V.altKey;if(!O&&!this._compositionHelper.keydown(V))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;O||V.key!=="Dead"&&V.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const Y=(0,ee.evaluateKeyboardEvent)(V,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(V),Y.type===3||Y.type===2){const se=this.rows-1;return this.scrollLines(Y.type===2?-se:se),this.cancel(V,!0)}return Y.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,V)||(Y.cancel&&this.cancel(V,!0),!Y.key||!!(V.key&&!V.ctrlKey&&!V.altKey&&!V.metaKey&&V.key.length===1&&V.key.charCodeAt(0)>=65&&V.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(Y.key!==F.C0.ETX&&Y.key!==F.C0.CR||(this.textarea.value=""),this._onKey.fire({key:Y.key,domEvent:V}),this._showCursor(),this.coreService.triggerDataEvent(Y.key,!0),!this.optionsService.rawOptions.screenReaderMode||V.altKey||V.ctrlKey?this.cancel(V,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(V,O){const Y=V.isMac&&!this.options.macOptionIsMeta&&O.altKey&&!O.ctrlKey&&!O.metaKey||V.isWindows&&O.altKey&&O.ctrlKey&&!O.metaKey||V.isWindows&&O.getModifierState("AltGraph");return O.type==="keypress"?Y:Y&&(!O.keyCode||O.keyCode>47)}_keyUp(V){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(V)===!1||((function(O){return O.keyCode===16||O.keyCode===17||O.keyCode===18})(V)||this.focus(),this.updateCursorStyle(V),this._keyPressHandled=!1)}_keyPress(V){let O;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(V)===!1)return!1;if(this.cancel(V),V.charCode)O=V.charCode;else if(V.which===null||V.which===void 0)O=V.keyCode;else{if(V.which===0||V.charCode===0)return!1;O=V.which}return!(!O||(V.altKey||V.ctrlKey||V.metaKey)&&!this._isThirdLevelShift(this.browser,V)||(O=String.fromCharCode(O),this._onKey.fire({key:O,domEvent:V}),this._showCursor(),this.coreService.triggerDataEvent(O,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(V){if(V.data&&V.inputType==="insertText"&&(!V.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const O=V.data;return this.coreService.triggerDataEvent(O,!0),this.cancel(V),!0}return!1}resize(V,O){V!==this.cols||O!==this.rows?super.resize(V,O):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(V,O){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let V=1;V<this.rows;V++)this.buffer.lines.push(this.buffer.getBlankLine(ie.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const V=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=V,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(F.C0.ESC+"[I"):this.coreService.triggerDataEvent(F.C0.ESC+"[O")}_reportWindowsOptions(V){if(this._renderService)switch(V){case W.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const O=this._renderService.dimensions.css.canvas.width.toFixed(0),Y=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[4;${Y};${O}t`);break;case W.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const se=this._renderService.dimensions.css.cell.width.toFixed(0),le=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${F.C0.ESC}[6;${le};${se}t`)}}cancel(V,O){if(this.options.cancelEvents||O)return V.preventDefault(),V.stopPropagation(),!1}}o.Terminal=he},9924:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TimeBasedDebouncer=void 0,o.TimeBasedDebouncer=class{constructor(n,u=1e3){this._renderCallback=n,this._debounceThresholdMS=u,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(n,u,m){this._rowCount=m,n=n!==void 0?n:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u;const c=Date.now();if(c-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=c,this._innerRefresh();else if(!this._additionalRefreshRequested){const f=c-this._lastRefreshMs,v=this._debounceThresholdMS-f;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0}),v)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const n=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,u)}}},1680:function(I,o,n){var u=this&&this.__decorate||function(t,e,r,i){var _,l=arguments.length,b=l<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(t,e,r,i);else for(var d=t.length-1;d>=0;d--)(_=t[d])&&(b=(l<3?_(b):l>3?_(e,r,b):_(e,r))||b);return l>3&&b&&Object.defineProperty(e,r,b),b},m=this&&this.__param||function(t,e){return function(r,i){e(r,i,t)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Viewport=void 0;const c=n(3656),f=n(4725),v=n(8460),S=n(844),g=n(2585);let a=o.Viewport=class extends S.Disposable{constructor(t,e,r,i,_,l,b,d){super(),this._viewportElement=t,this._scrollArea=e,this._bufferService=r,this._optionsService=i,this._charSizeService=_,this._renderService=l,this._coreBrowserService=b,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((y=>this._activeBuffer=y.activeBuffer))),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange((y=>this._renderDimensions=y))),this._handleThemeChange(d.colors),this.register(d.onChangeColors((y=>this._handleThemeChange(y)))),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.syncScrollArea()))),setTimeout((()=>this.syncScrollArea()))}_handleThemeChange(t){this._viewportElement.style.backgroundColor=t.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame((()=>this.syncScrollArea()))}_refresh(t){if(t)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null}syncScrollArea(t=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(t);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(t)}_handleScroll(t){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const e=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:e,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const t=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(t*(this._smoothScrollState.target-this._smoothScrollState.origin)),t<1?this._coreBrowserService.window.requestAnimationFrame((()=>this._smoothScroll())):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(t,e){const r=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(e<0&&this._viewportElement.scrollTop!==0||e>0&&r<this._lastRecordedBufferHeight)||(t.cancelable&&t.preventDefault(),!1)}handleWheel(t){const e=this._getPixelsScrolled(t);return e!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+e:this._smoothScrollState.target+=e,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=e,this._bubbleScroll(t,e))}scrollLines(t){if(t!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const e=t*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+e,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:t,suppressScrollEvent:!1})}_getPixelsScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let e=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_LINE?e*=this._currentRowHeight:t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(e*=this._currentRowHeight*this._bufferService.rows),e}getBufferElements(t,e){let r,i="";const _=[],l=e??this._bufferService.buffer.lines.length,b=this._bufferService.buffer.lines;for(let d=t;d<l;d++){const y=b.get(d);if(!y)continue;const M=b.get(d+1)?.isWrapped;if(i+=y.translateToString(!M),!M||d===b.length-1){const D=document.createElement("div");D.textContent=i,_.push(D),i.length>0&&(r=D),i=""}}return{bufferElements:_,cursorElement:r}}getLinesScrolled(t){if(t.deltaY===0||t.shiftKey)return 0;let e=this._applyScrollModifier(t.deltaY,t);return t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(e/=this._currentRowHeight+0,this._wheelPartialScroll+=e,e=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(e*=this._bufferService.rows),e}_applyScrollModifier(t,e){const r=this._optionsService.rawOptions.fastScrollModifier;return r==="alt"&&e.altKey||r==="ctrl"&&e.ctrlKey||r==="shift"&&e.shiftKey?t*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:t*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(t){this._lastTouchY=t.touches[0].pageY}handleTouchMove(t){const e=this._lastTouchY-t.touches[0].pageY;return this._lastTouchY=t.touches[0].pageY,e!==0&&(this._viewportElement.scrollTop+=e,this._bubbleScroll(t,e))}};o.Viewport=a=u([m(2,g.IBufferService),m(3,g.IOptionsService),m(4,f.ICharSizeService),m(5,f.IRenderService),m(6,f.ICoreBrowserService),m(7,f.IThemeService)],a)},3107:function(I,o,n){var u=this&&this.__decorate||function(g,a,t,e){var r,i=arguments.length,_=i<3?a:e===null?e=Object.getOwnPropertyDescriptor(a,t):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(g,a,t,e);else for(var l=g.length-1;l>=0;l--)(r=g[l])&&(_=(i<3?r(_):i>3?r(a,t,_):r(a,t))||_);return i>3&&_&&Object.defineProperty(a,t,_),_},m=this&&this.__param||function(g,a){return function(t,e){a(t,e,g)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferDecorationRenderer=void 0;const c=n(4725),f=n(844),v=n(2585);let S=o.BufferDecorationRenderer=class extends f.Disposable{constructor(g,a,t,e,r){super(),this._screenElement=g,this._bufferService=a,this._coreBrowserService=t,this._decorationService=e,this._renderService=r,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange((()=>this._doRefreshDecorations()))),this.register(this._renderService.onDimensionsChange((()=>{this._dimensionsChanged=!0,this._queueRefresh()}))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt}))),this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh()))),this.register(this._decorationService.onDecorationRemoved((i=>this._removeDecoration(i)))),this.register((0,f.toDisposable)((()=>{this._container.remove(),this._decorationElements.clear()})))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback((()=>{this._doRefreshDecorations(),this._animationFrame=void 0})))}_doRefreshDecorations(){for(const g of this._decorationService.decorations)this._renderDecoration(g);this._dimensionsChanged=!1}_renderDecoration(g){this._refreshStyle(g),this._dimensionsChanged&&this._refreshXPosition(g)}_createElement(g){const a=this._coreBrowserService.mainDocument.createElement("div");a.classList.add("xterm-decoration"),a.classList.toggle("xterm-decoration-top-layer",g?.options?.layer==="top"),a.style.width=`${Math.round((g.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,a.style.height=(g.options.height||1)*this._renderService.dimensions.css.cell.height+"px",a.style.top=(g.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",a.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const t=g.options.x??0;return t&&t>this._bufferService.cols&&(a.style.display="none"),this._refreshXPosition(g,a),a}_refreshStyle(g){const a=g.marker.line-this._bufferService.buffers.active.ydisp;if(a<0||a>=this._bufferService.rows)g.element&&(g.element.style.display="none",g.onRenderEmitter.fire(g.element));else{let t=this._decorationElements.get(g);t||(t=this._createElement(g),g.element=t,this._decorationElements.set(g,t),this._container.appendChild(t),g.onDispose((()=>{this._decorationElements.delete(g),t.remove()}))),t.style.top=a*this._renderService.dimensions.css.cell.height+"px",t.style.display=this._altBufferIsActive?"none":"block",g.onRenderEmitter.fire(t)}}_refreshXPosition(g,a=g.element){if(!a)return;const t=g.options.x??0;(g.options.anchor||"left")==="right"?a.style.right=t?t*this._renderService.dimensions.css.cell.width+"px":"":a.style.left=t?t*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(g){this._decorationElements.get(g)?.remove(),this._decorationElements.delete(g),g.dispose()}};o.BufferDecorationRenderer=S=u([m(1,v.IBufferService),m(2,c.ICoreBrowserService),m(3,v.IDecorationService),m(4,c.IRenderService)],S)},5871:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorZoneStore=void 0,o.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(n){if(n.options.overviewRulerOptions){for(const u of this._zones)if(u.color===n.options.overviewRulerOptions.color&&u.position===n.options.overviewRulerOptions.position){if(this._lineIntersectsZone(u,n.marker.line))return;if(this._lineAdjacentToZone(u,n.marker.line,n.options.overviewRulerOptions.position))return void this._addLineToZone(u,n.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=n.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=n.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=n.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=n.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:n.options.overviewRulerOptions.color,position:n.options.overviewRulerOptions.position,startBufferLine:n.marker.line,endBufferLine:n.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(n){this._linePadding=n}_lineIntersectsZone(n,u){return u>=n.startBufferLine&&u<=n.endBufferLine}_lineAdjacentToZone(n,u,m){return u>=n.startBufferLine-this._linePadding[m||"full"]&&u<=n.endBufferLine+this._linePadding[m||"full"]}_addLineToZone(n,u){n.startBufferLine=Math.min(n.startBufferLine,u),n.endBufferLine=Math.max(n.endBufferLine,u)}}},5744:function(I,o,n){var u=this&&this.__decorate||function(r,i,_,l){var b,d=arguments.length,y=d<3?i:l===null?l=Object.getOwnPropertyDescriptor(i,_):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(r,i,_,l);else for(var M=r.length-1;M>=0;M--)(b=r[M])&&(y=(d<3?b(y):d>3?b(i,_,y):b(i,_))||y);return d>3&&y&&Object.defineProperty(i,_,y),y},m=this&&this.__param||function(r,i){return function(_,l){i(_,l,r)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OverviewRulerRenderer=void 0;const c=n(5871),f=n(4725),v=n(844),S=n(2585),g={full:0,left:0,center:0,right:0},a={full:0,left:0,center:0,right:0},t={full:0,left:0,center:0,right:0};let e=o.OverviewRulerRenderer=class extends v.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(r,i,_,l,b,d,y){super(),this._viewportElement=r,this._screenElement=i,this._bufferService=_,this._decorationService=l,this._renderService=b,this._optionsService=d,this._coreBrowserService=y,this._colorZoneStore=new c.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const M=this._canvas.getContext("2d");if(!M)throw new Error("Ctx cannot be null");this._ctx=M,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)((()=>{this._canvas?.remove()})))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh(void 0,!0)))),this.register(this._decorationService.onDecorationRemoved((()=>this._queueRefresh(void 0,!0))))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender((()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)}))),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",(()=>this._queueRefresh(!0)))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh(!0)))),this._queueRefresh(!0)}_refreshDrawConstants(){const r=Math.floor(this._canvas.width/3),i=Math.ceil(this._canvas.width/3);a.full=this._canvas.width,a.left=r,a.center=i,a.right=r,this._refreshDrawHeightConstants(),t.full=0,t.left=0,t.center=a.left,t.right=a.left+a.center}_refreshDrawHeightConstants(){g.full=Math.round(2*this._coreBrowserService.dpr);const r=this._canvas.height/this._bufferService.buffer.lines.length,i=Math.round(Math.max(Math.min(r,12),6)*this._coreBrowserService.dpr);g.left=i,g.center=i,g.right=i}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*g.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const i of this._decorationService.decorations)this._colorZoneStore.addDecoration(i);this._ctx.lineWidth=1;const r=this._colorZoneStore.zones;for(const i of r)i.position!=="full"&&this._renderColorZone(i);for(const i of r)i.position==="full"&&this._renderColorZone(i);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(r){this._ctx.fillStyle=r.color,this._ctx.fillRect(t[r.position||"full"],Math.round((this._canvas.height-1)*(r.startBufferLine/this._bufferService.buffers.active.lines.length)-g[r.position||"full"]/2),a[r.position||"full"],Math.round((this._canvas.height-1)*((r.endBufferLine-r.startBufferLine)/this._bufferService.buffers.active.lines.length)+g[r.position||"full"]))}_queueRefresh(r,i){this._shouldUpdateDimensions=r||this._shouldUpdateDimensions,this._shouldUpdateAnchor=i||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>{this._refreshDecorations(),this._animationFrame=void 0})))}};o.OverviewRulerRenderer=e=u([m(2,S.IBufferService),m(3,S.IDecorationService),m(4,f.IRenderService),m(5,S.IOptionsService),m(6,f.ICoreBrowserService)],e)},2950:function(I,o,n){var u=this&&this.__decorate||function(g,a,t,e){var r,i=arguments.length,_=i<3?a:e===null?e=Object.getOwnPropertyDescriptor(a,t):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(g,a,t,e);else for(var l=g.length-1;l>=0;l--)(r=g[l])&&(_=(i<3?r(_):i>3?r(a,t,_):r(a,t))||_);return i>3&&_&&Object.defineProperty(a,t,_),_},m=this&&this.__param||function(g,a){return function(t,e){a(t,e,g)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CompositionHelper=void 0;const c=n(4725),f=n(2585),v=n(2584);let S=o.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(g,a,t,e,r,i){this._textarea=g,this._compositionView=a,this._bufferService=t,this._optionsService=e,this._coreService=r,this._renderService=i,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(g){this._compositionView.textContent=g.data,this.updateCompositionElements(),setTimeout((()=>{this._compositionPosition.end=this._textarea.value.length}),0)}compositionend(){this._finalizeComposition(!0)}keydown(g){if(this._isComposing||this._isSendingComposition){if(g.keyCode===229||g.keyCode===16||g.keyCode===17||g.keyCode===18)return!1;this._finalizeComposition(!1)}return g.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(g){if(this._compositionView.classList.remove("active"),this._isComposing=!1,g){const a={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((()=>{if(this._isSendingComposition){let t;this._isSendingComposition=!1,a.start+=this._dataAlreadySent.length,t=this._isComposing?this._textarea.value.substring(a.start,a.end):this._textarea.value.substring(a.start),t.length>0&&this._coreService.triggerDataEvent(t,!0)}}),0)}else{this._isSendingComposition=!1;const a=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(a,!0)}}_handleAnyTextareaChanges(){const g=this._textarea.value;setTimeout((()=>{if(!this._isComposing){const a=this._textarea.value,t=a.replace(g,"");this._dataAlreadySent=t,a.length>g.length?this._coreService.triggerDataEvent(t,!0):a.length<g.length?this._coreService.triggerDataEvent(`${v.C0.DEL}`,!0):a.length===g.length&&a!==g&&this._coreService.triggerDataEvent(a,!0)}}),0)}updateCompositionElements(g){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const a=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),t=this._renderService.dimensions.css.cell.height,e=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,r=a*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=r+"px",this._compositionView.style.top=e+"px",this._compositionView.style.height=t+"px",this._compositionView.style.lineHeight=t+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const i=this._compositionView.getBoundingClientRect();this._textarea.style.left=r+"px",this._textarea.style.top=e+"px",this._textarea.style.width=Math.max(i.width,1)+"px",this._textarea.style.height=Math.max(i.height,1)+"px",this._textarea.style.lineHeight=i.height+"px"}g||setTimeout((()=>this.updateCompositionElements(!0)),0)}}};o.CompositionHelper=S=u([m(2,f.IBufferService),m(3,f.IOptionsService),m(4,f.ICoreService),m(5,c.IRenderService)],S)},9806:(I,o)=>{function n(u,m,c){const f=c.getBoundingClientRect(),v=u.getComputedStyle(c),S=parseInt(v.getPropertyValue("padding-left")),g=parseInt(v.getPropertyValue("padding-top"));return[m.clientX-f.left-S,m.clientY-f.top-g]}Object.defineProperty(o,"__esModule",{value:!0}),o.getCoords=o.getCoordsRelativeToElement=void 0,o.getCoordsRelativeToElement=n,o.getCoords=function(u,m,c,f,v,S,g,a,t){if(!S)return;const e=n(u,m,c);return e?(e[0]=Math.ceil((e[0]+(t?g/2:0))/g),e[1]=Math.ceil(e[1]/a),e[0]=Math.min(Math.max(e[0],1),f+(t?1:0)),e[1]=Math.min(Math.max(e[1],1),v),e):void 0}},9504:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.moveToCellSequence=void 0;const u=n(2584);function m(a,t,e,r){const i=a-c(a,e),_=t-c(t,e),l=Math.abs(i-_)-(function(b,d,y){let M=0;const D=b-c(b,y),N=d-c(d,y);for(let T=0;T<Math.abs(D-N);T++){const z=f(b,d)==="A"?-1:1;y.buffer.lines.get(D+z*T)?.isWrapped&&M++}return M})(a,t,e);return g(l,S(f(a,t),r))}function c(a,t){let e=0,r=t.buffer.lines.get(a),i=r?.isWrapped;for(;i&&a>=0&&a<t.rows;)e++,r=t.buffer.lines.get(--a),i=r?.isWrapped;return e}function f(a,t){return a>t?"A":"B"}function v(a,t,e,r,i,_){let l=a,b=t,d="";for(;l!==e||b!==r;)l+=i?1:-1,i&&l>_.cols-1?(d+=_.buffer.translateBufferLineToString(b,!1,a,l),l=0,a=0,b++):!i&&l<0&&(d+=_.buffer.translateBufferLineToString(b,!1,0,a+1),l=_.cols-1,a=l,b--);return d+_.buffer.translateBufferLineToString(b,!1,a,l)}function S(a,t){const e=t?"O":"[";return u.C0.ESC+e+a}function g(a,t){a=Math.floor(a);let e="";for(let r=0;r<a;r++)e+=t;return e}o.moveToCellSequence=function(a,t,e,r){const i=e.buffer.x,_=e.buffer.y;if(!e.buffer.hasScrollback)return(function(d,y,M,D,N,T){return m(y,D,N,T).length===0?"":g(v(d,y,d,y-c(y,N),!1,N).length,S("D",T))})(i,_,0,t,e,r)+m(_,t,e,r)+(function(d,y,M,D,N,T){let z;z=m(y,D,N,T).length>0?D-c(D,N):y;const J=D,ie=(function(F,ee,L,B,P,W){let Q;return Q=m(L,B,P,W).length>0?B-c(B,P):ee,F<L&&Q<=B||F>=L&&Q<B?"C":"D"})(d,y,M,D,N,T);return g(v(d,z,M,J,ie==="C",N).length,S(ie,T))})(i,_,a,t,e,r);let l;if(_===t)return l=i>a?"D":"C",g(Math.abs(i-a),S(l,r));l=_>t?"D":"C";const b=Math.abs(_-t);return g((function(d,y){return y.cols-d})(_>t?a:i,e)+(b-1)*e.cols+1+((_>t?i:a)-1),S(l,r))}},1296:function(I,o,n){var u=this&&this.__decorate||function(T,z,J,ie){var F,ee=arguments.length,L=ee<3?z:ie===null?ie=Object.getOwnPropertyDescriptor(z,J):ie;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(T,z,J,ie);else for(var B=T.length-1;B>=0;B--)(F=T[B])&&(L=(ee<3?F(L):ee>3?F(z,J,L):F(z,J))||L);return ee>3&&L&&Object.defineProperty(z,J,L),L},m=this&&this.__param||function(T,z){return function(J,ie){z(J,ie,T)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRenderer=void 0;const c=n(3787),f=n(2550),v=n(2223),S=n(6171),g=n(6052),a=n(4725),t=n(8055),e=n(8460),r=n(844),i=n(2585),_="xterm-dom-renderer-owner-",l="xterm-rows",b="xterm-fg-",d="xterm-bg-",y="xterm-focus",M="xterm-selection";let D=1,N=o.DomRenderer=class extends r.Disposable{constructor(T,z,J,ie,F,ee,L,B,P,W,Q,ae,he){super(),this._terminal=T,this._document=z,this._element=J,this._screenElement=ie,this._viewportElement=F,this._helperContainer=ee,this._linkifier2=L,this._charSizeService=P,this._optionsService=W,this._bufferService=Q,this._coreBrowserService=ae,this._themeService=he,this._terminalClass=D++,this._rowElements=[],this._selectionRenderModel=(0,g.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new e.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(l),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(M),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,S.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._themeService.onChangeColors((me=>this._injectCss(me)))),this._injectCss(this._themeService.colors),this._rowFactory=B.createInstance(c.DomRendererRowFactory,document),this._element.classList.add(_+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline((me=>this._handleLinkHover(me)))),this.register(this._linkifier2.onHideLinkUnderline((me=>this._handleLinkLeave(me)))),this.register((0,r.toDisposable)((()=>{this._element.classList.remove(_+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))),this._widthCache=new f.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const T=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*T,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*T),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/T),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/T),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const J of this._rowElements)J.style.width=`${this.dimensions.css.canvas.width}px`,J.style.height=`${this.dimensions.css.cell.height}px`,J.style.lineHeight=`${this.dimensions.css.cell.height}px`,J.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const z=`${this._terminalSelector} .${l} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=z,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(T){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let z=`${this._terminalSelector} .${l} { color: ${T.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;z+=`${this._terminalSelector} .${l} .xterm-dim { color: ${t.color.multiplyOpacity(T.foreground,.5).css};}`,z+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const J=`blink_underline_${this._terminalClass}`,ie=`blink_bar_${this._terminalClass}`,F=`blink_block_${this._terminalClass}`;z+=`@keyframes ${J} { 50% {  border-bottom-style: hidden; }}`,z+=`@keyframes ${ie} { 50% {  box-shadow: none; }}`,z+=`@keyframes ${F} { 0% {  background-color: ${T.cursor.css};  color: ${T.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${T.cursor.css}; }}`,z+=`${this._terminalSelector} .${l}.${y} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${J} 1s step-end infinite;}${this._terminalSelector} .${l}.${y} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${ie} 1s step-end infinite;}${this._terminalSelector} .${l}.${y} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${F} 1s step-end infinite;}${this._terminalSelector} .${l} .xterm-cursor.xterm-cursor-block { background-color: ${T.cursor.css}; color: ${T.cursorAccent.css};}${this._terminalSelector} .${l} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${T.cursor.css} !important; color: ${T.cursorAccent.css} !important;}${this._terminalSelector} .${l} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${T.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${l} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${T.cursor.css} inset;}${this._terminalSelector} .${l} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${T.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,z+=`${this._terminalSelector} .${M} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${M} div { position: absolute; background-color: ${T.selectionBackgroundOpaque.css};}${this._terminalSelector} .${M} div { position: absolute; background-color: ${T.selectionInactiveBackgroundOpaque.css};}`;for(const[ee,L]of T.ansi.entries())z+=`${this._terminalSelector} .${b}${ee} { color: ${L.css}; }${this._terminalSelector} .${b}${ee}.xterm-dim { color: ${t.color.multiplyOpacity(L,.5).css}; }${this._terminalSelector} .${d}${ee} { background-color: ${L.css}; }`;z+=`${this._terminalSelector} .${b}${v.INVERTED_DEFAULT_COLOR} { color: ${t.color.opaque(T.background).css}; }${this._terminalSelector} .${b}${v.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${t.color.multiplyOpacity(t.color.opaque(T.background),.5).css}; }${this._terminalSelector} .${d}${v.INVERTED_DEFAULT_COLOR} { background-color: ${T.foreground.css}; }`,this._themeStyleElement.textContent=z}_setDefaultSpacing(){const T=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${T}px`,this._rowFactory.defaultSpacing=T}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(T,z){for(let J=this._rowElements.length;J<=z;J++){const ie=this._document.createElement("div");this._rowContainer.appendChild(ie),this._rowElements.push(ie)}for(;this._rowElements.length>z;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(T,z){this._refreshRowElements(T,z),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(y),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(y),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(T,z,J){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(T,z,J),this.renderRows(0,this._bufferService.rows-1),!T||!z)return;this._selectionRenderModel.update(this._terminal,T,z,J);const ie=this._selectionRenderModel.viewportStartRow,F=this._selectionRenderModel.viewportEndRow,ee=this._selectionRenderModel.viewportCappedStartRow,L=this._selectionRenderModel.viewportCappedEndRow;if(ee>=this._bufferService.rows||L<0)return;const B=this._document.createDocumentFragment();if(J){const P=T[0]>z[0];B.appendChild(this._createSelectionElement(ee,P?z[0]:T[0],P?T[0]:z[0],L-ee+1))}else{const P=ie===ee?T[0]:0,W=ee===F?z[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(ee,P,W));const Q=L-ee-1;if(B.appendChild(this._createSelectionElement(ee+1,0,this._bufferService.cols,Q)),ee!==L){const ae=F===L?z[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(L,0,ae))}}this._selectionContainer.appendChild(B)}_createSelectionElement(T,z,J,ie=1){const F=this._document.createElement("div"),ee=z*this.dimensions.css.cell.width;let L=this.dimensions.css.cell.width*(J-z);return ee+L>this.dimensions.css.canvas.width&&(L=this.dimensions.css.canvas.width-ee),F.style.height=ie*this.dimensions.css.cell.height+"px",F.style.top=T*this.dimensions.css.cell.height+"px",F.style.left=`${ee}px`,F.style.width=`${L}px`,F}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const T of this._rowElements)T.replaceChildren()}renderRows(T,z){const J=this._bufferService.buffer,ie=J.ybase+J.y,F=Math.min(J.x,this._bufferService.cols-1),ee=this._optionsService.rawOptions.cursorBlink,L=this._optionsService.rawOptions.cursorStyle,B=this._optionsService.rawOptions.cursorInactiveStyle;for(let P=T;P<=z;P++){const W=P+J.ydisp,Q=this._rowElements[P],ae=J.lines.get(W);if(!Q||!ae)break;Q.replaceChildren(...this._rowFactory.createRow(ae,W,W===ie,L,B,F,ee,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${_}${this._terminalClass}`}_handleLinkHover(T){this._setCellUnderline(T.x1,T.x2,T.y1,T.y2,T.cols,!0)}_handleLinkLeave(T){this._setCellUnderline(T.x1,T.x2,T.y1,T.y2,T.cols,!1)}_setCellUnderline(T,z,J,ie,F,ee){J<0&&(T=0),ie<0&&(z=0);const L=this._bufferService.rows-1;J=Math.max(Math.min(J,L),0),ie=Math.max(Math.min(ie,L),0),F=Math.min(F,this._bufferService.cols);const B=this._bufferService.buffer,P=B.ybase+B.y,W=Math.min(B.x,F-1),Q=this._optionsService.rawOptions.cursorBlink,ae=this._optionsService.rawOptions.cursorStyle,he=this._optionsService.rawOptions.cursorInactiveStyle;for(let me=J;me<=ie;++me){const V=me+B.ydisp,O=this._rowElements[me],Y=B.lines.get(V);if(!O||!Y)break;O.replaceChildren(...this._rowFactory.createRow(Y,V,V===P,ae,he,W,Q,this.dimensions.css.cell.width,this._widthCache,ee?me===J?T:0:-1,ee?(me===ie?z:F)-1:-1))}}};o.DomRenderer=N=u([m(7,i.IInstantiationService),m(8,a.ICharSizeService),m(9,i.IOptionsService),m(10,i.IBufferService),m(11,a.ICoreBrowserService),m(12,a.IThemeService)],N)},3787:function(I,o,n){var u=this&&this.__decorate||function(l,b,d,y){var M,D=arguments.length,N=D<3?b:y===null?y=Object.getOwnPropertyDescriptor(b,d):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(l,b,d,y);else for(var T=l.length-1;T>=0;T--)(M=l[T])&&(N=(D<3?M(N):D>3?M(b,d,N):M(b,d))||N);return D>3&&N&&Object.defineProperty(b,d,N),N},m=this&&this.__param||function(l,b){return function(d,y){b(d,y,l)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRendererRowFactory=void 0;const c=n(2223),f=n(643),v=n(511),S=n(2585),g=n(8055),a=n(4725),t=n(4269),e=n(6171),r=n(3734);let i=o.DomRendererRowFactory=class{constructor(l,b,d,y,M,D,N){this._document=l,this._characterJoinerService=b,this._optionsService=d,this._coreBrowserService=y,this._coreService=M,this._decorationService=D,this._themeService=N,this._workCell=new v.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(l,b,d){this._selectionStart=l,this._selectionEnd=b,this._columnSelectMode=d}createRow(l,b,d,y,M,D,N,T,z,J,ie){const F=[],ee=this._characterJoinerService.getJoinedCharacters(b),L=this._themeService.colors;let B,P=l.getNoBgTrimmedLength();d&&P<D+1&&(P=D+1);let W=0,Q="",ae=0,he=0,me=0,V=!1,O=0,Y=!1,se=0;const le=[],ce=J!==-1&&ie!==-1;for(let xe=0;xe<P;xe++){l.loadCell(xe,this._workCell);let Re=this._workCell.getWidth();if(Re===0)continue;let Oe=!1,He=xe,be=this._workCell;if(ee.length>0&&xe===ee[0][0]){Oe=!0;const ye=ee.shift();be=new t.JoinedCellData(this._workCell,l.translateToString(!0,ye[0],ye[1]),ye[1]-ye[0]),He=ye[1]-1,Re=be.getWidth()}const Lt=this._isCellInSelection(xe,b),oe=d&&xe===D,Ge=ce&&xe>=J&&xe<=ie;let Rt=!1;this._decorationService.forEachDecorationAtCell(xe,b,void 0,(ye=>{Rt=!0}));let Tt=be.getChars()||f.WHITESPACE_CELL_CHAR;if(Tt===" "&&(be.isUnderline()||be.isOverline())&&(Tt=""),se=Re*T-z.get(Tt,be.isBold(),be.isItalic()),B){if(W&&(Lt&&Y||!Lt&&!Y&&be.bg===ae)&&(Lt&&Y&&L.selectionForeground||be.fg===he)&&be.extended.ext===me&&Ge===V&&se===O&&!oe&&!Oe&&!Rt){be.isInvisible()?Q+=f.WHITESPACE_CELL_CHAR:Q+=Tt,W++;continue}W&&(B.textContent=Q),B=this._document.createElement("span"),W=0,Q=""}else B=this._document.createElement("span");if(ae=be.bg,he=be.fg,me=be.extended.ext,V=Ge,O=se,Y=Lt,Oe&&D>=xe&&D<=He&&(D=xe),!this._coreService.isCursorHidden&&oe&&this._coreService.isCursorInitialized){if(le.push("xterm-cursor"),this._coreBrowserService.isFocused)N&&le.push("xterm-cursor-blink"),le.push(y==="bar"?"xterm-cursor-bar":y==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(M)switch(M){case"outline":le.push("xterm-cursor-outline");break;case"block":le.push("xterm-cursor-block");break;case"bar":le.push("xterm-cursor-bar");break;case"underline":le.push("xterm-cursor-underline")}}if(be.isBold()&&le.push("xterm-bold"),be.isItalic()&&le.push("xterm-italic"),be.isDim()&&le.push("xterm-dim"),Q=be.isInvisible()?f.WHITESPACE_CELL_CHAR:be.getChars()||f.WHITESPACE_CELL_CHAR,be.isUnderline()&&(le.push(`xterm-underline-${be.extended.underlineStyle}`),Q===" "&&(Q=""),!be.isUnderlineColorDefault()))if(be.isUnderlineColorRGB())B.style.textDecorationColor=`rgb(${r.AttributeData.toColorRGB(be.getUnderlineColor()).join(",")})`;else{let ye=be.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&be.isBold()&&ye<8&&(ye+=8),B.style.textDecorationColor=L.ansi[ye].css}be.isOverline()&&(le.push("xterm-overline"),Q===" "&&(Q="")),be.isStrikethrough()&&le.push("xterm-strikethrough"),Ge&&(B.style.textDecoration="underline");let $e=be.getFgColor(),Ue=be.getFgColorMode(),Ze=be.getBgColor(),vt=be.getBgColorMode();const te=!!be.isInverse();if(te){const ye=$e;$e=Ze,Ze=ye;const Pe=Ue;Ue=vt,vt=Pe}let G,ne,_e,we=!1;switch(this._decorationService.forEachDecorationAtCell(xe,b,void 0,(ye=>{ye.options.layer!=="top"&&we||(ye.backgroundColorRGB&&(vt=50331648,Ze=ye.backgroundColorRGB.rgba>>8&16777215,G=ye.backgroundColorRGB),ye.foregroundColorRGB&&(Ue=50331648,$e=ye.foregroundColorRGB.rgba>>8&16777215,ne=ye.foregroundColorRGB),we=ye.options.layer==="top")})),!we&&Lt&&(G=this._coreBrowserService.isFocused?L.selectionBackgroundOpaque:L.selectionInactiveBackgroundOpaque,Ze=G.rgba>>8&16777215,vt=50331648,we=!0,L.selectionForeground&&(Ue=50331648,$e=L.selectionForeground.rgba>>8&16777215,ne=L.selectionForeground)),we&&le.push("xterm-decoration-top"),vt){case 16777216:case 33554432:_e=L.ansi[Ze],le.push(`xterm-bg-${Ze}`);break;case 50331648:_e=g.channels.toColor(Ze>>16,Ze>>8&255,255&Ze),this._addStyle(B,`background-color:#${_((Ze>>>0).toString(16),"0",6)}`);break;default:te?(_e=L.foreground,le.push(`xterm-bg-${c.INVERTED_DEFAULT_COLOR}`)):_e=L.background}switch(G||be.isDim()&&(G=g.color.multiplyOpacity(_e,.5)),Ue){case 16777216:case 33554432:be.isBold()&&$e<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&($e+=8),this._applyMinimumContrast(B,_e,L.ansi[$e],be,G,void 0)||le.push(`xterm-fg-${$e}`);break;case 50331648:const ye=g.channels.toColor($e>>16&255,$e>>8&255,255&$e);this._applyMinimumContrast(B,_e,ye,be,G,ne)||this._addStyle(B,`color:#${_($e.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(B,_e,L.foreground,be,G,ne)||te&&le.push(`xterm-fg-${c.INVERTED_DEFAULT_COLOR}`)}le.length&&(B.className=le.join(" "),le.length=0),oe||Oe||Rt?B.textContent=Q:W++,se!==this.defaultSpacing&&(B.style.letterSpacing=`${se}px`),F.push(B),xe=He}return B&&W&&(B.textContent=Q),F}_applyMinimumContrast(l,b,d,y,M,D){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,e.treatGlyphAsBackgroundColor)(y.getCode()))return!1;const N=this._getContrastCache(y);let T;if(M||D||(T=N.getColor(b.rgba,d.rgba)),T===void 0){const z=this._optionsService.rawOptions.minimumContrastRatio/(y.isDim()?2:1);T=g.color.ensureContrastRatio(M||b,D||d,z),N.setColor((M||b).rgba,(D||d).rgba,T??null)}return!!T&&(this._addStyle(l,`color:${T.css}`),!0)}_getContrastCache(l){return l.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(l,b){l.setAttribute("style",`${l.getAttribute("style")||""}${b};`)}_isCellInSelection(l,b){const d=this._selectionStart,y=this._selectionEnd;return!(!d||!y)&&(this._columnSelectMode?d[0]<=y[0]?l>=d[0]&&b>=d[1]&&l<y[0]&&b<=y[1]:l<d[0]&&b>=d[1]&&l>=y[0]&&b<=y[1]:b>d[1]&&b<y[1]||d[1]===y[1]&&b===d[1]&&l>=d[0]&&l<y[0]||d[1]<y[1]&&b===y[1]&&l<y[0]||d[1]<y[1]&&b===d[1]&&l>=d[0])}};function _(l,b,d){for(;l.length<d;)l=b+l;return l}o.DomRendererRowFactory=i=u([m(1,a.ICharacterJoinerService),m(2,S.IOptionsService),m(3,a.ICoreBrowserService),m(4,S.ICoreService),m(5,S.IDecorationService),m(6,a.IThemeService)],i)},2550:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WidthCache=void 0,o.WidthCache=class{constructor(n,u){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=n.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const m=n.createElement("span");m.classList.add("xterm-char-measure-element");const c=n.createElement("span");c.classList.add("xterm-char-measure-element"),c.style.fontWeight="bold";const f=n.createElement("span");f.classList.add("xterm-char-measure-element"),f.style.fontStyle="italic";const v=n.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontWeight="bold",v.style.fontStyle="italic",this._measureElements=[m,c,f,v],this._container.appendChild(m),this._container.appendChild(c),this._container.appendChild(f),this._container.appendChild(v),u.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(n,u,m,c){n===this._font&&u===this._fontSize&&m===this._weight&&c===this._weightBold||(this._font=n,this._fontSize=u,this._weight=m,this._weightBold=c,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${m}`,this._measureElements[1].style.fontWeight=`${c}`,this._measureElements[2].style.fontWeight=`${m}`,this._measureElements[3].style.fontWeight=`${c}`,this.clear())}get(n,u,m){let c=0;if(!u&&!m&&n.length===1&&(c=n.charCodeAt(0))<256){if(this._flat[c]!==-9999)return this._flat[c];const S=this._measure(n,0);return S>0&&(this._flat[c]=S),S}let f=n;u&&(f+="B"),m&&(f+="I");let v=this._holey.get(f);if(v===void 0){let S=0;u&&(S|=1),m&&(S|=2),v=this._measure(n,S),v>0&&this._holey.set(f,v)}return v}_measure(n,u){const m=this._measureElements[u];return m.textContent=n.repeat(32),m.offsetWidth/32}}},2223:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TEXT_BASELINE=o.DIM_OPACITY=o.INVERTED_DEFAULT_COLOR=void 0;const u=n(6114);o.INVERTED_DEFAULT_COLOR=257,o.DIM_OPACITY=.5,o.TEXT_BASELINE=u.isFirefox||u.isLegacyEdge?"bottom":"ideographic"},6171:(I,o)=>{function n(m){return 57508<=m&&m<=57558}function u(m){return m>=128512&&m<=128591||m>=127744&&m<=128511||m>=128640&&m<=128767||m>=9728&&m<=9983||m>=9984&&m<=10175||m>=65024&&m<=65039||m>=129280&&m<=129535||m>=127462&&m<=127487}Object.defineProperty(o,"__esModule",{value:!0}),o.computeNextVariantOffset=o.createRenderDimensions=o.treatGlyphAsBackgroundColor=o.allowRescaling=o.isEmoji=o.isRestrictedPowerlineGlyph=o.isPowerlineGlyph=o.throwIfFalsy=void 0,o.throwIfFalsy=function(m){if(!m)throw new Error("value must not be falsy");return m},o.isPowerlineGlyph=n,o.isRestrictedPowerlineGlyph=function(m){return 57520<=m&&m<=57527},o.isEmoji=u,o.allowRescaling=function(m,c,f,v){return c===1&&f>Math.ceil(1.5*v)&&m!==void 0&&m>255&&!u(m)&&!n(m)&&!(function(S){return 57344<=S&&S<=63743})(m)},o.treatGlyphAsBackgroundColor=function(m){return n(m)||(function(c){return 9472<=c&&c<=9631})(m)},o.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},o.computeNextVariantOffset=function(m,c,f=0){return(m-(2*Math.round(c)-f))%(2*Math.round(c))}},6052:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createSelectionRenderModel=void 0;class n{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(m,c,f,v=!1){if(this.selectionStart=c,this.selectionEnd=f,!c||!f||c[0]===f[0]&&c[1]===f[1])return void this.clear();const S=m.buffers.active.ydisp,g=c[1]-S,a=f[1]-S,t=Math.max(g,0),e=Math.min(a,m.rows-1);t>=m.rows||e<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=v,this.viewportStartRow=g,this.viewportEndRow=a,this.viewportCappedStartRow=t,this.viewportCappedEndRow=e,this.startCol=c[0],this.endCol=f[0])}isCellSelected(m,c,f){return!!this.hasSelection&&(f-=m.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?c>=this.startCol&&f>=this.viewportCappedStartRow&&c<this.endCol&&f<=this.viewportCappedEndRow:c<this.startCol&&f>=this.viewportCappedStartRow&&c>=this.endCol&&f<=this.viewportCappedEndRow:f>this.viewportStartRow&&f<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&f===this.viewportStartRow&&c>=this.startCol&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&f===this.viewportEndRow&&c<this.endCol||this.viewportStartRow<this.viewportEndRow&&f===this.viewportStartRow&&c>=this.startCol)}}o.createSelectionRenderModel=function(){return new n}},456:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionModel=void 0,o.SelectionModel=class{constructor(n){this._bufferService=n,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?n%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)-1]:[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[n,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[Math.max(n,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const n=this.selectionStart,u=this.selectionEnd;return!(!n||!u)&&(n[1]>u[1]||n[1]===u[1]&&n[0]>u[0])}handleTrim(n){return this.selectionStart&&(this.selectionStart[1]-=n),this.selectionEnd&&(this.selectionEnd[1]-=n),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(I,o,n){var u=this&&this.__decorate||function(e,r,i,_){var l,b=arguments.length,d=b<3?r:_===null?_=Object.getOwnPropertyDescriptor(r,i):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(e,r,i,_);else for(var y=e.length-1;y>=0;y--)(l=e[y])&&(d=(b<3?l(d):b>3?l(r,i,d):l(r,i))||d);return b>3&&d&&Object.defineProperty(r,i,d),d},m=this&&this.__param||function(e,r){return function(i,_){r(i,_,e)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharSizeService=void 0;const c=n(2585),f=n(8460),v=n(844);let S=o.CharSizeService=class extends v.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(e,r,i){super(),this._optionsService=i,this.width=0,this.height=0,this._onCharSizeChange=this.register(new f.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new t(this._optionsService))}catch{this._measureStrategy=this.register(new a(e,r,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],(()=>this.measure())))}measure(){const e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};o.CharSizeService=S=u([m(2,c.IOptionsService)],S);class g extends v.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(r,i){r!==void 0&&r>0&&i!==void 0&&i>0&&(this._result.width=r,this._result.height=i)}}class a extends g{constructor(r,i,_){super(),this._document=r,this._parentElement=i,this._optionsService=_,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class t extends g{constructor(r){super(),this._optionsService=r,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const i=this._ctx.measureText("W");if(!("width"in i&&"fontBoundingBoxAscent"in i&&"fontBoundingBoxDescent"in i))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const r=this._ctx.measureText("W");return this._validateAndSet(r.width,r.fontBoundingBoxAscent+r.fontBoundingBoxDescent),this._result}}},4269:function(I,o,n){var u=this&&this.__decorate||function(t,e,r,i){var _,l=arguments.length,b=l<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(t,e,r,i);else for(var d=t.length-1;d>=0;d--)(_=t[d])&&(b=(l<3?_(b):l>3?_(e,r,b):_(e,r))||b);return l>3&&b&&Object.defineProperty(e,r,b),b},m=this&&this.__param||function(t,e){return function(r,i){e(r,i,t)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharacterJoinerService=o.JoinedCellData=void 0;const c=n(3734),f=n(643),v=n(511),S=n(2585);class g extends c.AttributeData{constructor(e,r,i){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=r,this._width=i}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.JoinedCellData=g;let a=o.CharacterJoinerService=class gn{constructor(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new v.CellData}register(e){const r={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(r),r.id}deregister(e){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===e)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(e){if(this._characterJoiners.length===0)return[];const r=this._bufferService.buffer.lines.get(e);if(!r||r.length===0)return[];const i=[],_=r.translateToString(!0);let l=0,b=0,d=0,y=r.getFg(0),M=r.getBg(0);for(let D=0;D<r.getTrimmedLength();D++)if(r.loadCell(D,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==M){if(D-l>1){const N=this._getJoinedRanges(_,d,b,r,l);for(let T=0;T<N.length;T++)i.push(N[T])}l=D,d=b,y=this._workCell.fg,M=this._workCell.bg}b+=this._workCell.getChars().length||f.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-l>1){const D=this._getJoinedRanges(_,d,b,r,l);for(let N=0;N<D.length;N++)i.push(D[N])}return i}_getJoinedRanges(e,r,i,_,l){const b=e.substring(r,i);let d=[];try{d=this._characterJoiners[0].handler(b)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{const M=this._characterJoiners[y].handler(b);for(let D=0;D<M.length;D++)gn._mergeRanges(d,M[D])}catch(M){console.error(M)}return this._stringRangesToCellRanges(d,_,l),d}_stringRangesToCellRanges(e,r,i){let _=0,l=!1,b=0,d=e[_];if(d){for(let y=i;y<this._bufferService.cols;y++){const M=r.getWidth(y),D=r.getString(y).length||f.WHITESPACE_CELL_CHAR.length;if(M!==0){if(!l&&d[0]<=b&&(d[0]=y,l=!0),d[1]<=b){if(d[1]=y,d=e[++_],!d)break;d[0]<=b?(d[0]=y,l=!0):l=!1}b+=D}}d&&(d[1]=this._bufferService.cols)}}static _mergeRanges(e,r){let i=!1;for(let _=0;_<e.length;_++){const l=e[_];if(i){if(r[1]<=l[0])return e[_-1][1]=r[1],e;if(r[1]<=l[1])return e[_-1][1]=Math.max(r[1],l[1]),e.splice(_,1),e;e.splice(_,1),_--}else{if(r[1]<=l[0])return e.splice(_,0,r),e;if(r[1]<=l[1])return l[0]=Math.min(r[0],l[0]),e;r[0]<l[1]&&(l[0]=Math.min(r[0],l[0]),i=!0)}}return i?e[e.length-1][1]=r[1]:e.push(r),e}};o.CharacterJoinerService=a=u([m(0,S.IBufferService)],a)},5114:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreBrowserService=void 0;const u=n(844),m=n(8460),c=n(3656);class f extends u.Disposable{constructor(g,a,t){super(),this._textarea=g,this._window=a,this.mainDocument=t,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new v(this._window),this._onDprChange=this.register(new m.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new m.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange((e=>this._screenDprMonitor.setWindow(e)))),this.register((0,m.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",(()=>this._isFocused=!0)),this._textarea.addEventListener("blur",(()=>this._isFocused=!1))}get window(){return this._window}set window(g){this._window!==g&&(this._window=g,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask((()=>this._cachedIsFocused=void 0))),this._cachedIsFocused}}o.CoreBrowserService=f;class v extends u.Disposable{constructor(g){super(),this._parentWindow=g,this._windowResizeListener=this.register(new u.MutableDisposable),this._onDprChange=this.register(new m.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,u.toDisposable)((()=>this.clearListener())))}setWindow(g){this._parentWindow=g,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,c.addDisposableDomListener)(this._parentWindow,"resize",(()=>this._setDprAndFireIfDiffers()))}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.LinkProviderService=void 0;const u=n(844);class m extends u.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,u.toDisposable)((()=>this.linkProviders.length=0)))}registerLinkProvider(f){return this.linkProviders.push(f),{dispose:()=>{const v=this.linkProviders.indexOf(f);v!==-1&&this.linkProviders.splice(v,1)}}}}o.LinkProviderService=m},8934:function(I,o,n){var u=this&&this.__decorate||function(S,g,a,t){var e,r=arguments.length,i=r<3?g:t===null?t=Object.getOwnPropertyDescriptor(g,a):t;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(S,g,a,t);else for(var _=S.length-1;_>=0;_--)(e=S[_])&&(i=(r<3?e(i):r>3?e(g,a,i):e(g,a))||i);return r>3&&i&&Object.defineProperty(g,a,i),i},m=this&&this.__param||function(S,g){return function(a,t){g(a,t,S)}};Object.defineProperty(o,"__esModule",{value:!0}),o.MouseService=void 0;const c=n(4725),f=n(9806);let v=o.MouseService=class{constructor(S,g){this._renderService=S,this._charSizeService=g}getCoords(S,g,a,t,e){return(0,f.getCoords)(window,S,g,a,t,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,e)}getMouseReportCoords(S,g){const a=(0,f.getCoordsRelativeToElement)(window,S,g);if(this._charSizeService.hasValidSize)return a[0]=Math.min(Math.max(a[0],0),this._renderService.dimensions.css.canvas.width-1),a[1]=Math.min(Math.max(a[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(a[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(a[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(a[0]),y:Math.floor(a[1])}}};o.MouseService=v=u([m(0,c.IRenderService),m(1,c.ICharSizeService)],v)},3230:function(I,o,n){var u=this&&this.__decorate||function(e,r,i,_){var l,b=arguments.length,d=b<3?r:_===null?_=Object.getOwnPropertyDescriptor(r,i):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(e,r,i,_);else for(var y=e.length-1;y>=0;y--)(l=e[y])&&(d=(b<3?l(d):b>3?l(r,i,d):l(r,i))||d);return b>3&&d&&Object.defineProperty(r,i,d),d},m=this&&this.__param||function(e,r){return function(i,_){r(i,_,e)}};Object.defineProperty(o,"__esModule",{value:!0}),o.RenderService=void 0;const c=n(6193),f=n(4725),v=n(8460),S=n(844),g=n(7226),a=n(2585);let t=o.RenderService=class extends S.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(e,r,i,_,l,b,d,y){super(),this._rowCount=e,this._charSizeService=_,this._renderer=this.register(new S.MutableDisposable),this._pausedResizeTask=new g.DebouncedIdleTask,this._observerDisposable=this.register(new S.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new v.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new v.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new v.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new v.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new c.RenderDebouncer(((M,D)=>this._renderRows(M,D)),d),this.register(this._renderDebouncer),this.register(d.onDprChange((()=>this.handleDevicePixelRatioChange()))),this.register(b.onResize((()=>this._fullRefresh()))),this.register(b.buffers.onBufferActivate((()=>this._renderer.value?.clear()))),this.register(i.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._charSizeService.onCharSizeChange((()=>this.handleCharSizeChanged()))),this.register(l.onDecorationRegistered((()=>this._fullRefresh()))),this.register(l.onDecorationRemoved((()=>this._fullRefresh()))),this.register(i.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],(()=>{this.clear(),this.handleResize(b.cols,b.rows),this._fullRefresh()}))),this.register(i.onMultipleOptionChange(["cursorBlink","cursorStyle"],(()=>this.refreshRows(b.buffer.y,b.buffer.y,!0)))),this.register(y.onChangeColors((()=>this._fullRefresh()))),this._registerIntersectionObserver(d.window,r),this.register(d.onWindowChange((M=>this._registerIntersectionObserver(M,r))))}_registerIntersectionObserver(e,r){if("IntersectionObserver"in e){const i=new e.IntersectionObserver((_=>this._handleIntersectionChange(_[_.length-1])),{threshold:0});i.observe(r),this._observerDisposable.value=(0,S.toDisposable)((()=>i.disconnect()))}}_handleIntersectionChange(e){this._isPaused=e.isIntersecting===void 0?e.intersectionRatio===0:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,r,i=!1){this._isPaused?this._needsFullRefresh=!0:(i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,r,this._rowCount))}_renderRows(e,r){this._renderer.value&&(e=Math.min(e,this._rowCount-1),r=Math.min(r,this._rowCount-1),this._renderer.value.renderRows(e,r),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:r}),this._onRender.fire({start:e,end:r}),this._isNextRenderRedrawOnly=!0)}resize(e,r){this._rowCount=r,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(e){this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw((r=>this.refreshRows(r.start,r.end,!0))),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,r){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set((()=>this._renderer.value?.handleResize(e,r))):this._renderer.value.handleResize(e,r),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(e,r,i){this._selectionState.start=e,this._selectionState.end=r,this._selectionState.columnSelectMode=i,this._renderer.value?.handleSelectionChanged(e,r,i)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};o.RenderService=t=u([m(2,a.IOptionsService),m(3,f.ICharSizeService),m(4,a.IDecorationService),m(5,a.IBufferService),m(6,f.ICoreBrowserService),m(7,f.IThemeService)],t)},9312:function(I,o,n){var u=this&&this.__decorate||function(d,y,M,D){var N,T=arguments.length,z=T<3?y:D===null?D=Object.getOwnPropertyDescriptor(y,M):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")z=Reflect.decorate(d,y,M,D);else for(var J=d.length-1;J>=0;J--)(N=d[J])&&(z=(T<3?N(z):T>3?N(y,M,z):N(y,M))||z);return T>3&&z&&Object.defineProperty(y,M,z),z},m=this&&this.__param||function(d,y){return function(M,D){y(M,D,d)}};Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionService=void 0;const c=n(9806),f=n(9504),v=n(456),S=n(4725),g=n(8460),a=n(844),t=n(6114),e=n(4841),r=n(511),i=n(2585),_="",l=new RegExp(_,"g");let b=o.SelectionService=class extends a.Disposable{constructor(d,y,M,D,N,T,z,J,ie){super(),this._element=d,this._screenElement=y,this._linkifier=M,this._bufferService=D,this._coreService=N,this._mouseService=T,this._optionsService=z,this._renderService=J,this._coreBrowserService=ie,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new r.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new g.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new g.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new g.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new g.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=F=>this._handleMouseMove(F),this._mouseUpListener=F=>this._handleMouseUp(F),this._coreService.onUserInput((()=>{this.hasSelection&&this.clearSelection()})),this._trimListener=this._bufferService.buffer.lines.onTrim((F=>this._handleTrim(F))),this.register(this._bufferService.buffers.onBufferActivate((F=>this._handleBufferActivate(F)))),this.enable(),this._model=new v.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,a.toDisposable)((()=>{this._removeMouseDownListeners()})))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const d=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!d||!y||d[0]===y[0]&&d[1]===y[1])}get selectionText(){const d=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!d||!y)return"";const M=this._bufferService.buffer,D=[];if(this._activeSelectionMode===3){if(d[0]===y[0])return"";const N=d[0]<y[0]?d[0]:y[0],T=d[0]<y[0]?y[0]:d[0];for(let z=d[1];z<=y[1];z++){const J=M.translateBufferLineToString(z,!0,N,T);D.push(J)}}else{const N=d[1]===y[1]?y[0]:void 0;D.push(M.translateBufferLineToString(d[1],!0,d[0],N));for(let T=d[1]+1;T<=y[1]-1;T++){const z=M.lines.get(T),J=M.translateBufferLineToString(T,!0);z?.isWrapped?D[D.length-1]+=J:D.push(J)}if(d[1]!==y[1]){const T=M.lines.get(y[1]),z=M.translateBufferLineToString(y[1],!0,0,y[0]);T&&T.isWrapped?D[D.length-1]+=z:D.push(z)}}return D.map((N=>N.replace(l," "))).join(t.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(d){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._refresh()))),t.isLinux&&d&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(d){const y=this._getMouseBufferCoords(d),M=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!!(M&&D&&y)&&this._areCoordsInSelection(y,M,D)}isCellInSelection(d,y){const M=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!(!M||!D)&&this._areCoordsInSelection([d,y],M,D)}_areCoordsInSelection(d,y,M){return d[1]>y[1]&&d[1]<M[1]||y[1]===M[1]&&d[1]===y[1]&&d[0]>=y[0]&&d[0]<M[0]||y[1]<M[1]&&d[1]===M[1]&&d[0]<M[0]||y[1]<M[1]&&d[1]===y[1]&&d[0]>=y[0]}_selectWordAtCursor(d,y){const M=this._linkifier.currentLink?.link?.range;if(M)return this._model.selectionStart=[M.start.x-1,M.start.y-1],this._model.selectionStartLength=(0,e.getRangeLength)(M,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const D=this._getMouseBufferCoords(d);return!!D&&(this._selectWordAt(D,y),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(d,y){this._model.clearSelection(),d=Math.max(d,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,d],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()}_handleTrim(d){this._model.handleTrim(d)&&this.refresh()}_getMouseBufferCoords(d){const y=this._mouseService.getCoords(d,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y}_getMouseEventScrollAmount(d){let y=(0,c.getCoordsRelativeToElement)(this._coreBrowserService.window,d,this._screenElement)[1];const M=this._renderService.dimensions.css.canvas.height;return y>=0&&y<=M?0:(y>M&&(y-=M),y=Math.min(Math.max(y,-50),50),y/=50,y/Math.abs(y)+Math.round(14*y))}shouldForceSelection(d){return t.isMac?d.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:d.shiftKey}handleMouseDown(d){if(this._mouseDownTimeStamp=d.timeStamp,(d.button!==2||!this.hasSelection)&&d.button===0){if(!this._enabled){if(!this.shouldForceSelection(d))return;d.stopPropagation()}d.preventDefault(),this._dragScrollAmount=0,this._enabled&&d.shiftKey?this._handleIncrementalClick(d):d.detail===1?this._handleSingleClick(d):d.detail===2?this._handleDoubleClick(d):d.detail===3&&this._handleTripleClick(d),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval((()=>this._dragScroll()),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(d){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(d))}_handleSingleClick(d){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(d)?3:0,this._model.selectionStart=this._getMouseBufferCoords(d),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&y.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(d){this._selectWordAtCursor(d,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(d){const y=this._getMouseBufferCoords(d);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))}shouldColumnSelect(d){return d.altKey&&!(t.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(d){if(d.stopImmediatePropagation(),!this._model.selectionStart)return;const y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(d),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(d),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const M=this._bufferService.buffer;if(this._model.selectionEnd[1]<M.lines.length){const D=M.lines.get(this._model.selectionEnd[1]);D&&D.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const d=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(d.ydisp+this._bufferService.rows,d.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=d.ydisp),this.refresh()}}_handleMouseUp(d){const y=d.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&d.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const M=this._mouseService.getCoords(d,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(M&&M[0]!==void 0&&M[1]!==void 0){const D=(0,f.moveToCellSequence)(M[0]-1,M[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(D,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const d=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,M=!(!d||!y||d[0]===y[0]&&d[1]===y[1]);M?d&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&d[0]===this._oldSelectionStart[0]&&d[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(d,y,M)):this._oldHasSelection&&this._fireOnSelectionChange(d,y,M)}_fireOnSelectionChange(d,y,M){this._oldSelectionStart=d,this._oldSelectionEnd=y,this._oldHasSelection=M,this._onSelectionChange.fire()}_handleBufferActivate(d){this.clearSelection(),this._trimListener.dispose(),this._trimListener=d.activeBuffer.lines.onTrim((y=>this._handleTrim(y)))}_convertViewportColToCharacterIndex(d,y){let M=y;for(let D=0;y>=D;D++){const N=d.loadCell(D,this._workCell).getChars().length;this._workCell.getWidth()===0?M--:N>1&&y!==D&&(M+=N-1)}return M}setSelection(d,y,M){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[d,y],this._model.selectionStartLength=M,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(d){this._isClickInSelection(d)||(this._selectWordAtCursor(d,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(d,y,M=!0,D=!0){if(d[0]>=this._bufferService.cols)return;const N=this._bufferService.buffer,T=N.lines.get(d[1]);if(!T)return;const z=N.translateBufferLineToString(d[1],!1);let J=this._convertViewportColToCharacterIndex(T,d[0]),ie=J;const F=d[0]-J;let ee=0,L=0,B=0,P=0;if(z.charAt(J)===" "){for(;J>0&&z.charAt(J-1)===" ";)J--;for(;ie<z.length&&z.charAt(ie+1)===" ";)ie++}else{let ae=d[0],he=d[0];T.getWidth(ae)===0&&(ee++,ae--),T.getWidth(he)===2&&(L++,he++);const me=T.getString(he).length;for(me>1&&(P+=me-1,ie+=me-1);ae>0&&J>0&&!this._isCharWordSeparator(T.loadCell(ae-1,this._workCell));){T.loadCell(ae-1,this._workCell);const V=this._workCell.getChars().length;this._workCell.getWidth()===0?(ee++,ae--):V>1&&(B+=V-1,J-=V-1),J--,ae--}for(;he<T.length&&ie+1<z.length&&!this._isCharWordSeparator(T.loadCell(he+1,this._workCell));){T.loadCell(he+1,this._workCell);const V=this._workCell.getChars().length;this._workCell.getWidth()===2?(L++,he++):V>1&&(P+=V-1,ie+=V-1),ie++,he++}}ie++;let W=J+F-ee+B,Q=Math.min(this._bufferService.cols,ie-J+ee+L-B-P);if(y||z.slice(J,ie).trim()!==""){if(M&&W===0&&T.getCodePoint(0)!==32){const ae=N.lines.get(d[1]-1);if(ae&&T.isWrapped&&ae.getCodePoint(this._bufferService.cols-1)!==32){const he=this._getWordAt([this._bufferService.cols-1,d[1]-1],!1,!0,!1);if(he){const me=this._bufferService.cols-he.start;W-=me,Q+=me}}}if(D&&W+Q===this._bufferService.cols&&T.getCodePoint(this._bufferService.cols-1)!==32){const ae=N.lines.get(d[1]+1);if(ae?.isWrapped&&ae.getCodePoint(0)!==32){const he=this._getWordAt([0,d[1]+1],!1,!1,!0);he&&(Q+=he.length)}}return{start:W,length:Q}}}_selectWordAt(d,y){const M=this._getWordAt(d,y);if(M){for(;M.start<0;)M.start+=this._bufferService.cols,d[1]--;this._model.selectionStart=[M.start,d[1]],this._model.selectionStartLength=M.length}}_selectToWordAt(d){const y=this._getWordAt(d,!0);if(y){let M=d[1];for(;y.start<0;)y.start+=this._bufferService.cols,M--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,M++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,M]}}_isCharWordSeparator(d){return d.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(d.getChars())>=0}_selectLineAt(d){const y=this._bufferService.buffer.getWrappedRangeForLine(d),M={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,e.getRangeLength)(M,this._bufferService.cols)}};o.SelectionService=b=u([m(3,i.IBufferService),m(4,i.ICoreService),m(5,S.IMouseService),m(6,i.IOptionsService),m(7,S.IRenderService),m(8,S.ICoreBrowserService)],b)},4725:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ILinkProviderService=o.IThemeService=o.ICharacterJoinerService=o.ISelectionService=o.IRenderService=o.IMouseService=o.ICoreBrowserService=o.ICharSizeService=void 0;const u=n(8343);o.ICharSizeService=(0,u.createDecorator)("CharSizeService"),o.ICoreBrowserService=(0,u.createDecorator)("CoreBrowserService"),o.IMouseService=(0,u.createDecorator)("MouseService"),o.IRenderService=(0,u.createDecorator)("RenderService"),o.ISelectionService=(0,u.createDecorator)("SelectionService"),o.ICharacterJoinerService=(0,u.createDecorator)("CharacterJoinerService"),o.IThemeService=(0,u.createDecorator)("ThemeService"),o.ILinkProviderService=(0,u.createDecorator)("LinkProviderService")},6731:function(I,o,n){var u=this&&this.__decorate||function(b,d,y,M){var D,N=arguments.length,T=N<3?d:M===null?M=Object.getOwnPropertyDescriptor(d,y):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(b,d,y,M);else for(var z=b.length-1;z>=0;z--)(D=b[z])&&(T=(N<3?D(T):N>3?D(d,y,T):D(d,y))||T);return N>3&&T&&Object.defineProperty(d,y,T),T},m=this&&this.__param||function(b,d){return function(y,M){d(y,M,b)}};Object.defineProperty(o,"__esModule",{value:!0}),o.ThemeService=o.DEFAULT_ANSI_COLORS=void 0;const c=n(7239),f=n(8055),v=n(8460),S=n(844),g=n(2585),a=f.css.toColor("#ffffff"),t=f.css.toColor("#000000"),e=f.css.toColor("#ffffff"),r=f.css.toColor("#000000"),i={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};o.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const b=[f.css.toColor("#2e3436"),f.css.toColor("#cc0000"),f.css.toColor("#4e9a06"),f.css.toColor("#c4a000"),f.css.toColor("#3465a4"),f.css.toColor("#75507b"),f.css.toColor("#06989a"),f.css.toColor("#d3d7cf"),f.css.toColor("#555753"),f.css.toColor("#ef2929"),f.css.toColor("#8ae234"),f.css.toColor("#fce94f"),f.css.toColor("#729fcf"),f.css.toColor("#ad7fa8"),f.css.toColor("#34e2e2"),f.css.toColor("#eeeeec")],d=[0,95,135,175,215,255];for(let y=0;y<216;y++){const M=d[y/36%6|0],D=d[y/6%6|0],N=d[y%6];b.push({css:f.channels.toCss(M,D,N),rgba:f.channels.toRgba(M,D,N)})}for(let y=0;y<24;y++){const M=8+10*y;b.push({css:f.channels.toCss(M,M,M),rgba:f.channels.toRgba(M,M,M)})}return b})());let _=o.ThemeService=class extends S.Disposable{get colors(){return this._colors}constructor(b){super(),this._optionsService=b,this._contrastCache=new c.ColorContrastCache,this._halfContrastCache=new c.ColorContrastCache,this._onChangeColors=this.register(new v.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:a,background:t,cursor:e,cursorAccent:r,selectionForeground:void 0,selectionBackgroundTransparent:i,selectionBackgroundOpaque:f.color.blend(t,i),selectionInactiveBackgroundTransparent:i,selectionInactiveBackgroundOpaque:f.color.blend(t,i),ansi:o.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",(()=>this._contrastCache.clear()))),this.register(this._optionsService.onSpecificOptionChange("theme",(()=>this._setTheme(this._optionsService.rawOptions.theme))))}_setTheme(b={}){const d=this._colors;if(d.foreground=l(b.foreground,a),d.background=l(b.background,t),d.cursor=l(b.cursor,e),d.cursorAccent=l(b.cursorAccent,r),d.selectionBackgroundTransparent=l(b.selectionBackground,i),d.selectionBackgroundOpaque=f.color.blend(d.background,d.selectionBackgroundTransparent),d.selectionInactiveBackgroundTransparent=l(b.selectionInactiveBackground,d.selectionBackgroundTransparent),d.selectionInactiveBackgroundOpaque=f.color.blend(d.background,d.selectionInactiveBackgroundTransparent),d.selectionForeground=b.selectionForeground?l(b.selectionForeground,f.NULL_COLOR):void 0,d.selectionForeground===f.NULL_COLOR&&(d.selectionForeground=void 0),f.color.isOpaque(d.selectionBackgroundTransparent)&&(d.selectionBackgroundTransparent=f.color.opacity(d.selectionBackgroundTransparent,.3)),f.color.isOpaque(d.selectionInactiveBackgroundTransparent)&&(d.selectionInactiveBackgroundTransparent=f.color.opacity(d.selectionInactiveBackgroundTransparent,.3)),d.ansi=o.DEFAULT_ANSI_COLORS.slice(),d.ansi[0]=l(b.black,o.DEFAULT_ANSI_COLORS[0]),d.ansi[1]=l(b.red,o.DEFAULT_ANSI_COLORS[1]),d.ansi[2]=l(b.green,o.DEFAULT_ANSI_COLORS[2]),d.ansi[3]=l(b.yellow,o.DEFAULT_ANSI_COLORS[3]),d.ansi[4]=l(b.blue,o.DEFAULT_ANSI_COLORS[4]),d.ansi[5]=l(b.magenta,o.DEFAULT_ANSI_COLORS[5]),d.ansi[6]=l(b.cyan,o.DEFAULT_ANSI_COLORS[6]),d.ansi[7]=l(b.white,o.DEFAULT_ANSI_COLORS[7]),d.ansi[8]=l(b.brightBlack,o.DEFAULT_ANSI_COLORS[8]),d.ansi[9]=l(b.brightRed,o.DEFAULT_ANSI_COLORS[9]),d.ansi[10]=l(b.brightGreen,o.DEFAULT_ANSI_COLORS[10]),d.ansi[11]=l(b.brightYellow,o.DEFAULT_ANSI_COLORS[11]),d.ansi[12]=l(b.brightBlue,o.DEFAULT_ANSI_COLORS[12]),d.ansi[13]=l(b.brightMagenta,o.DEFAULT_ANSI_COLORS[13]),d.ansi[14]=l(b.brightCyan,o.DEFAULT_ANSI_COLORS[14]),d.ansi[15]=l(b.brightWhite,o.DEFAULT_ANSI_COLORS[15]),b.extendedAnsi){const y=Math.min(d.ansi.length-16,b.extendedAnsi.length);for(let M=0;M<y;M++)d.ansi[M+16]=l(b.extendedAnsi[M],o.DEFAULT_ANSI_COLORS[M+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(b){this._restoreColor(b),this._onChangeColors.fire(this.colors)}_restoreColor(b){if(b!==void 0)switch(b){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[b]=this._restoreColors.ansi[b]}else for(let d=0;d<this._restoreColors.ansi.length;++d)this._colors.ansi[d]=this._restoreColors.ansi[d]}modifyColors(b){b(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function l(b,d){if(b!==void 0)try{return f.css.toColor(b)}catch{}return d}o.ThemeService=_=u([m(0,g.IOptionsService)],_)},6349:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CircularList=void 0;const u=n(8460),m=n(844);class c extends m.Disposable{constructor(v){super(),this._maxLength=v,this.onDeleteEmitter=this.register(new u.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new u.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new u.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(v){if(this._maxLength===v)return;const S=new Array(v);for(let g=0;g<Math.min(v,this.length);g++)S[g]=this._array[this._getCyclicIndex(g)];this._array=S,this._maxLength=v,this._startIndex=0}get length(){return this._length}set length(v){if(v>this._length)for(let S=this._length;S<v;S++)this._array[S]=void 0;this._length=v}get(v){return this._array[this._getCyclicIndex(v)]}set(v,S){this._array[this._getCyclicIndex(v)]=S}push(v){this._array[this._getCyclicIndex(this._length)]=v,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(v,S,...g){if(S){for(let a=v;a<this._length-S;a++)this._array[this._getCyclicIndex(a)]=this._array[this._getCyclicIndex(a+S)];this._length-=S,this.onDeleteEmitter.fire({index:v,amount:S})}for(let a=this._length-1;a>=v;a--)this._array[this._getCyclicIndex(a+g.length)]=this._array[this._getCyclicIndex(a)];for(let a=0;a<g.length;a++)this._array[this._getCyclicIndex(v+a)]=g[a];if(g.length&&this.onInsertEmitter.fire({index:v,amount:g.length}),this._length+g.length>this._maxLength){const a=this._length+g.length-this._maxLength;this._startIndex+=a,this._length=this._maxLength,this.onTrimEmitter.fire(a)}else this._length+=g.length}trimStart(v){v>this._length&&(v=this._length),this._startIndex+=v,this._length-=v,this.onTrimEmitter.fire(v)}shiftElements(v,S,g){if(!(S<=0)){if(v<0||v>=this._length)throw new Error("start argument out of range");if(v+g<0)throw new Error("Cannot shift elements in list beyond index 0");if(g>0){for(let t=S-1;t>=0;t--)this.set(v+t+g,this.get(v+t));const a=v+S+g-this._length;if(a>0)for(this._length+=a;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let a=0;a<S;a++)this.set(v+a+g,this.get(v+a))}}_getCyclicIndex(v){return(this._startIndex+v)%this._maxLength}}o.CircularList=c},1439:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.clone=void 0,o.clone=function n(u,m=5){if(typeof u!="object")return u;const c=Array.isArray(u)?[]:{};for(const f in u)c[f]=m<=1?u[f]:u[f]&&n(u[f],m-1);return c}},8055:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.contrastRatio=o.toPaddedHex=o.rgba=o.rgb=o.css=o.color=o.channels=o.NULL_COLOR=void 0;let n=0,u=0,m=0,c=0;var f,v,S,g,a;function t(r){const i=r.toString(16);return i.length<2?"0"+i:i}function e(r,i){return r<i?(i+.05)/(r+.05):(r+.05)/(i+.05)}o.NULL_COLOR={css:"#00000000",rgba:0},(function(r){r.toCss=function(i,_,l,b){return b!==void 0?`#${t(i)}${t(_)}${t(l)}${t(b)}`:`#${t(i)}${t(_)}${t(l)}`},r.toRgba=function(i,_,l,b=255){return(i<<24|_<<16|l<<8|b)>>>0},r.toColor=function(i,_,l,b){return{css:r.toCss(i,_,l,b),rgba:r.toRgba(i,_,l,b)}}})(f||(o.channels=f={})),(function(r){function i(_,l){return c=Math.round(255*l),[n,u,m]=a.toChannels(_.rgba),{css:f.toCss(n,u,m,c),rgba:f.toRgba(n,u,m,c)}}r.blend=function(_,l){if(c=(255&l.rgba)/255,c===1)return{css:l.css,rgba:l.rgba};const b=l.rgba>>24&255,d=l.rgba>>16&255,y=l.rgba>>8&255,M=_.rgba>>24&255,D=_.rgba>>16&255,N=_.rgba>>8&255;return n=M+Math.round((b-M)*c),u=D+Math.round((d-D)*c),m=N+Math.round((y-N)*c),{css:f.toCss(n,u,m),rgba:f.toRgba(n,u,m)}},r.isOpaque=function(_){return(255&_.rgba)==255},r.ensureContrastRatio=function(_,l,b){const d=a.ensureContrastRatio(_.rgba,l.rgba,b);if(d)return f.toColor(d>>24&255,d>>16&255,d>>8&255)},r.opaque=function(_){const l=(255|_.rgba)>>>0;return[n,u,m]=a.toChannels(l),{css:f.toCss(n,u,m),rgba:l}},r.opacity=i,r.multiplyOpacity=function(_,l){return c=255&_.rgba,i(_,c*l/255)},r.toColorRGB=function(_){return[_.rgba>>24&255,_.rgba>>16&255,_.rgba>>8&255]}})(v||(o.color=v={})),(function(r){let i,_;try{const l=document.createElement("canvas");l.width=1,l.height=1;const b=l.getContext("2d",{willReadFrequently:!0});b&&(i=b,i.globalCompositeOperation="copy",_=i.createLinearGradient(0,0,1,1))}catch{}r.toColor=function(l){if(l.match(/#[\da-f]{3,8}/i))switch(l.length){case 4:return n=parseInt(l.slice(1,2).repeat(2),16),u=parseInt(l.slice(2,3).repeat(2),16),m=parseInt(l.slice(3,4).repeat(2),16),f.toColor(n,u,m);case 5:return n=parseInt(l.slice(1,2).repeat(2),16),u=parseInt(l.slice(2,3).repeat(2),16),m=parseInt(l.slice(3,4).repeat(2),16),c=parseInt(l.slice(4,5).repeat(2),16),f.toColor(n,u,m,c);case 7:return{css:l,rgba:(parseInt(l.slice(1),16)<<8|255)>>>0};case 9:return{css:l,rgba:parseInt(l.slice(1),16)>>>0}}const b=l.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(b)return n=parseInt(b[1]),u=parseInt(b[2]),m=parseInt(b[3]),c=Math.round(255*(b[5]===void 0?1:parseFloat(b[5]))),f.toColor(n,u,m,c);if(!i||!_)throw new Error("css.toColor: Unsupported css format");if(i.fillStyle=_,i.fillStyle=l,typeof i.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(i.fillRect(0,0,1,1),[n,u,m,c]=i.getImageData(0,0,1,1).data,c!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:f.toRgba(n,u,m,c),css:l}}})(S||(o.css=S={})),(function(r){function i(_,l,b){const d=_/255,y=l/255,M=b/255;return .2126*(d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4))+.7152*(y<=.03928?y/12.92:Math.pow((y+.055)/1.055,2.4))+.0722*(M<=.03928?M/12.92:Math.pow((M+.055)/1.055,2.4))}r.relativeLuminance=function(_){return i(_>>16&255,_>>8&255,255&_)},r.relativeLuminance2=i})(g||(o.rgb=g={})),(function(r){function i(l,b,d){const y=l>>24&255,M=l>>16&255,D=l>>8&255;let N=b>>24&255,T=b>>16&255,z=b>>8&255,J=e(g.relativeLuminance2(N,T,z),g.relativeLuminance2(y,M,D));for(;J<d&&(N>0||T>0||z>0);)N-=Math.max(0,Math.ceil(.1*N)),T-=Math.max(0,Math.ceil(.1*T)),z-=Math.max(0,Math.ceil(.1*z)),J=e(g.relativeLuminance2(N,T,z),g.relativeLuminance2(y,M,D));return(N<<24|T<<16|z<<8|255)>>>0}function _(l,b,d){const y=l>>24&255,M=l>>16&255,D=l>>8&255;let N=b>>24&255,T=b>>16&255,z=b>>8&255,J=e(g.relativeLuminance2(N,T,z),g.relativeLuminance2(y,M,D));for(;J<d&&(N<255||T<255||z<255);)N=Math.min(255,N+Math.ceil(.1*(255-N))),T=Math.min(255,T+Math.ceil(.1*(255-T))),z=Math.min(255,z+Math.ceil(.1*(255-z))),J=e(g.relativeLuminance2(N,T,z),g.relativeLuminance2(y,M,D));return(N<<24|T<<16|z<<8|255)>>>0}r.blend=function(l,b){if(c=(255&b)/255,c===1)return b;const d=b>>24&255,y=b>>16&255,M=b>>8&255,D=l>>24&255,N=l>>16&255,T=l>>8&255;return n=D+Math.round((d-D)*c),u=N+Math.round((y-N)*c),m=T+Math.round((M-T)*c),f.toRgba(n,u,m)},r.ensureContrastRatio=function(l,b,d){const y=g.relativeLuminance(l>>8),M=g.relativeLuminance(b>>8);if(e(y,M)<d){if(M<y){const T=i(l,b,d),z=e(y,g.relativeLuminance(T>>8));if(z<d){const J=_(l,b,d);return z>e(y,g.relativeLuminance(J>>8))?T:J}return T}const D=_(l,b,d),N=e(y,g.relativeLuminance(D>>8));if(N<d){const T=i(l,b,d);return N>e(y,g.relativeLuminance(T>>8))?D:T}return D}},r.reduceLuminance=i,r.increaseLuminance=_,r.toChannels=function(l){return[l>>24&255,l>>16&255,l>>8&255,255&l]}})(a||(o.rgba=a={})),o.toPaddedHex=t,o.contrastRatio=e},8969:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreTerminal=void 0;const u=n(844),m=n(2585),c=n(4348),f=n(7866),v=n(744),S=n(7302),g=n(6975),a=n(8460),t=n(1753),e=n(1480),r=n(7994),i=n(9282),_=n(5435),l=n(5981),b=n(2660);let d=!1;class y extends u.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new a.EventEmitter),this._onScroll.event((D=>{this._onScrollApi?.fire(D.position)}))),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(D){for(const N in D)this.optionsService.options[N]=D[N]}constructor(D){super(),this._windowsWrappingHeuristics=this.register(new u.MutableDisposable),this._onBinary=this.register(new a.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new a.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new a.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new a.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new a.EventEmitter),this._instantiationService=new c.InstantiationService,this.optionsService=this.register(new S.OptionsService(D)),this._instantiationService.setService(m.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(v.BufferService)),this._instantiationService.setService(m.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(f.LogService)),this._instantiationService.setService(m.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(g.CoreService)),this._instantiationService.setService(m.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(t.CoreMouseService)),this._instantiationService.setService(m.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(e.UnicodeService)),this._instantiationService.setService(m.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(r.CharsetService),this._instantiationService.setService(m.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(b.OscLinkService),this._instantiationService.setService(m.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new _.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,a.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,a.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,a.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,a.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom((()=>this.scrollToBottom()))),this.register(this.coreService.onUserInput((()=>this._writeBuffer.handleUserInput()))),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],(()=>this._handleWindowsPtyOptionChange()))),this.register(this._bufferService.onScroll((N=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this.register(this._inputHandler.onScroll((N=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this._writeBuffer=this.register(new l.WriteBuffer(((N,T)=>this._inputHandler.parse(N,T)))),this.register((0,a.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(D,N){this._writeBuffer.write(D,N)}writeSync(D,N){this._logService.logLevel<=m.LogLevelEnum.WARN&&!d&&(this._logService.warn("writeSync is unreliable and will be removed soon."),d=!0),this._writeBuffer.writeSync(D,N)}input(D,N=!0){this.coreService.triggerDataEvent(D,N)}resize(D,N){isNaN(D)||isNaN(N)||(D=Math.max(D,v.MINIMUM_COLS),N=Math.max(N,v.MINIMUM_ROWS),this._bufferService.resize(D,N))}scroll(D,N=!1){this._bufferService.scroll(D,N)}scrollLines(D,N,T){this._bufferService.scrollLines(D,N,T)}scrollPages(D){this.scrollLines(D*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(D){const N=D-this._bufferService.buffer.ydisp;N!==0&&this.scrollLines(N)}registerEscHandler(D,N){return this._inputHandler.registerEscHandler(D,N)}registerDcsHandler(D,N){return this._inputHandler.registerDcsHandler(D,N)}registerCsiHandler(D,N){return this._inputHandler.registerCsiHandler(D,N)}registerOscHandler(D,N){return this._inputHandler.registerOscHandler(D,N)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let D=!1;const N=this.optionsService.rawOptions.windowsPty;N&&N.buildNumber!==void 0&&N.buildNumber!==void 0?D=N.backend==="conpty"&&N.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(D=!0),D?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const D=[];D.push(this.onLineFeed(i.updateWindowsModeWrappedState.bind(null,this._bufferService))),D.push(this.registerCsiHandler({final:"H"},(()=>((0,i.updateWindowsModeWrappedState)(this._bufferService),!1)))),this._windowsWrappingHeuristics.value=(0,u.toDisposable)((()=>{for(const N of D)N.dispose()}))}}}o.CoreTerminal=y},8460:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.runAndSubscribe=o.forwardEvent=o.EventEmitter=void 0,o.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let u=0;u<this._listeners.length;u++)if(this._listeners[u]===n)return void this._listeners.splice(u,1)}}})),this._event}fire(n,u){const m=[];for(let c=0;c<this._listeners.length;c++)m.push(this._listeners[c]);for(let c=0;c<m.length;c++)m[c].call(void 0,n,u)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},o.forwardEvent=function(n,u){return n((m=>u.fire(m)))},o.runAndSubscribe=function(n,u){return u(void 0),n((m=>u(m)))}},5435:function(I,o,n){var u=this&&this.__decorate||function(ee,L,B,P){var W,Q=arguments.length,ae=Q<3?L:P===null?P=Object.getOwnPropertyDescriptor(L,B):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ae=Reflect.decorate(ee,L,B,P);else for(var he=ee.length-1;he>=0;he--)(W=ee[he])&&(ae=(Q<3?W(ae):Q>3?W(L,B,ae):W(L,B))||ae);return Q>3&&ae&&Object.defineProperty(L,B,ae),ae},m=this&&this.__param||function(ee,L){return function(B,P){L(B,P,ee)}};Object.defineProperty(o,"__esModule",{value:!0}),o.InputHandler=o.WindowsOptionsReportType=void 0;const c=n(2584),f=n(7116),v=n(2015),S=n(844),g=n(482),a=n(8437),t=n(8460),e=n(643),r=n(511),i=n(3734),_=n(2585),l=n(1480),b=n(6242),d=n(6351),y=n(5941),M={"(":0,")":1,"*":2,"+":3,"-":1,".":2},D=131072;function N(ee,L){if(ee>24)return L.setWinLines||!1;switch(ee){case 1:return!!L.restoreWin;case 2:return!!L.minimizeWin;case 3:return!!L.setWinPosition;case 4:return!!L.setWinSizePixels;case 5:return!!L.raiseWin;case 6:return!!L.lowerWin;case 7:return!!L.refreshWin;case 8:return!!L.setWinSizeChars;case 9:return!!L.maximizeWin;case 10:return!!L.fullscreenWin;case 11:return!!L.getWinState;case 13:return!!L.getWinPosition;case 14:return!!L.getWinSizePixels;case 15:return!!L.getScreenSizePixels;case 16:return!!L.getCellSizePixels;case 18:return!!L.getWinSizeChars;case 19:return!!L.getScreenSizeChars;case 20:return!!L.getIconTitle;case 21:return!!L.getWinTitle;case 22:return!!L.pushTitle;case 23:return!!L.popTitle;case 24:return!!L.setWinLines}return!1}var T;(function(ee){ee[ee.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",ee[ee.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(T||(o.WindowsOptionsReportType=T={}));let z=0;class J extends S.Disposable{getAttrData(){return this._curAttrData}constructor(L,B,P,W,Q,ae,he,me,V=new v.EscapeSequenceParser){super(),this._bufferService=L,this._charsetService=B,this._coreService=P,this._logService=W,this._optionsService=Q,this._oscLinkService=ae,this._coreMouseService=he,this._unicodeService=me,this._parser=V,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new g.StringToUtf32,this._utf8Decoder=new g.Utf8ToUtf32,this._workCell=new r.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=a.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new t.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new t.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new t.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new t.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new t.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new t.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new t.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new t.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new t.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new t.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new t.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new t.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new t.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new ie(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((O=>this._activeBuffer=O.activeBuffer))),this._parser.setCsiHandlerFallback(((O,Y)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(O),params:Y.toArray()})})),this._parser.setEscHandlerFallback((O=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(O)})})),this._parser.setExecuteHandlerFallback((O=>{this._logService.debug("Unknown EXECUTE code: ",{code:O})})),this._parser.setOscHandlerFallback(((O,Y,se)=>{this._logService.debug("Unknown OSC code: ",{identifier:O,action:Y,data:se})})),this._parser.setDcsHandlerFallback(((O,Y,se)=>{Y==="HOOK"&&(se=se.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(O),action:Y,payload:se})})),this._parser.setPrintHandler(((O,Y,se)=>this.print(O,Y,se))),this._parser.registerCsiHandler({final:"@"},(O=>this.insertChars(O))),this._parser.registerCsiHandler({intermediates:" ",final:"@"},(O=>this.scrollLeft(O))),this._parser.registerCsiHandler({final:"A"},(O=>this.cursorUp(O))),this._parser.registerCsiHandler({intermediates:" ",final:"A"},(O=>this.scrollRight(O))),this._parser.registerCsiHandler({final:"B"},(O=>this.cursorDown(O))),this._parser.registerCsiHandler({final:"C"},(O=>this.cursorForward(O))),this._parser.registerCsiHandler({final:"D"},(O=>this.cursorBackward(O))),this._parser.registerCsiHandler({final:"E"},(O=>this.cursorNextLine(O))),this._parser.registerCsiHandler({final:"F"},(O=>this.cursorPrecedingLine(O))),this._parser.registerCsiHandler({final:"G"},(O=>this.cursorCharAbsolute(O))),this._parser.registerCsiHandler({final:"H"},(O=>this.cursorPosition(O))),this._parser.registerCsiHandler({final:"I"},(O=>this.cursorForwardTab(O))),this._parser.registerCsiHandler({final:"J"},(O=>this.eraseInDisplay(O,!1))),this._parser.registerCsiHandler({prefix:"?",final:"J"},(O=>this.eraseInDisplay(O,!0))),this._parser.registerCsiHandler({final:"K"},(O=>this.eraseInLine(O,!1))),this._parser.registerCsiHandler({prefix:"?",final:"K"},(O=>this.eraseInLine(O,!0))),this._parser.registerCsiHandler({final:"L"},(O=>this.insertLines(O))),this._parser.registerCsiHandler({final:"M"},(O=>this.deleteLines(O))),this._parser.registerCsiHandler({final:"P"},(O=>this.deleteChars(O))),this._parser.registerCsiHandler({final:"S"},(O=>this.scrollUp(O))),this._parser.registerCsiHandler({final:"T"},(O=>this.scrollDown(O))),this._parser.registerCsiHandler({final:"X"},(O=>this.eraseChars(O))),this._parser.registerCsiHandler({final:"Z"},(O=>this.cursorBackwardTab(O))),this._parser.registerCsiHandler({final:"`"},(O=>this.charPosAbsolute(O))),this._parser.registerCsiHandler({final:"a"},(O=>this.hPositionRelative(O))),this._parser.registerCsiHandler({final:"b"},(O=>this.repeatPrecedingCharacter(O))),this._parser.registerCsiHandler({final:"c"},(O=>this.sendDeviceAttributesPrimary(O))),this._parser.registerCsiHandler({prefix:">",final:"c"},(O=>this.sendDeviceAttributesSecondary(O))),this._parser.registerCsiHandler({final:"d"},(O=>this.linePosAbsolute(O))),this._parser.registerCsiHandler({final:"e"},(O=>this.vPositionRelative(O))),this._parser.registerCsiHandler({final:"f"},(O=>this.hVPosition(O))),this._parser.registerCsiHandler({final:"g"},(O=>this.tabClear(O))),this._parser.registerCsiHandler({final:"h"},(O=>this.setMode(O))),this._parser.registerCsiHandler({prefix:"?",final:"h"},(O=>this.setModePrivate(O))),this._parser.registerCsiHandler({final:"l"},(O=>this.resetMode(O))),this._parser.registerCsiHandler({prefix:"?",final:"l"},(O=>this.resetModePrivate(O))),this._parser.registerCsiHandler({final:"m"},(O=>this.charAttributes(O))),this._parser.registerCsiHandler({final:"n"},(O=>this.deviceStatus(O))),this._parser.registerCsiHandler({prefix:"?",final:"n"},(O=>this.deviceStatusPrivate(O))),this._parser.registerCsiHandler({intermediates:"!",final:"p"},(O=>this.softReset(O))),this._parser.registerCsiHandler({intermediates:" ",final:"q"},(O=>this.setCursorStyle(O))),this._parser.registerCsiHandler({final:"r"},(O=>this.setScrollRegion(O))),this._parser.registerCsiHandler({final:"s"},(O=>this.saveCursor(O))),this._parser.registerCsiHandler({final:"t"},(O=>this.windowOptions(O))),this._parser.registerCsiHandler({final:"u"},(O=>this.restoreCursor(O))),this._parser.registerCsiHandler({intermediates:"'",final:"}"},(O=>this.insertColumns(O))),this._parser.registerCsiHandler({intermediates:"'",final:"~"},(O=>this.deleteColumns(O))),this._parser.registerCsiHandler({intermediates:'"',final:"q"},(O=>this.selectProtected(O))),this._parser.registerCsiHandler({intermediates:"$",final:"p"},(O=>this.requestMode(O,!0))),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},(O=>this.requestMode(O,!1))),this._parser.setExecuteHandler(c.C0.BEL,(()=>this.bell())),this._parser.setExecuteHandler(c.C0.LF,(()=>this.lineFeed())),this._parser.setExecuteHandler(c.C0.VT,(()=>this.lineFeed())),this._parser.setExecuteHandler(c.C0.FF,(()=>this.lineFeed())),this._parser.setExecuteHandler(c.C0.CR,(()=>this.carriageReturn())),this._parser.setExecuteHandler(c.C0.BS,(()=>this.backspace())),this._parser.setExecuteHandler(c.C0.HT,(()=>this.tab())),this._parser.setExecuteHandler(c.C0.SO,(()=>this.shiftOut())),this._parser.setExecuteHandler(c.C0.SI,(()=>this.shiftIn())),this._parser.setExecuteHandler(c.C1.IND,(()=>this.index())),this._parser.setExecuteHandler(c.C1.NEL,(()=>this.nextLine())),this._parser.setExecuteHandler(c.C1.HTS,(()=>this.tabSet())),this._parser.registerOscHandler(0,new b.OscHandler((O=>(this.setTitle(O),this.setIconName(O),!0)))),this._parser.registerOscHandler(1,new b.OscHandler((O=>this.setIconName(O)))),this._parser.registerOscHandler(2,new b.OscHandler((O=>this.setTitle(O)))),this._parser.registerOscHandler(4,new b.OscHandler((O=>this.setOrReportIndexedColor(O)))),this._parser.registerOscHandler(8,new b.OscHandler((O=>this.setHyperlink(O)))),this._parser.registerOscHandler(10,new b.OscHandler((O=>this.setOrReportFgColor(O)))),this._parser.registerOscHandler(11,new b.OscHandler((O=>this.setOrReportBgColor(O)))),this._parser.registerOscHandler(12,new b.OscHandler((O=>this.setOrReportCursorColor(O)))),this._parser.registerOscHandler(104,new b.OscHandler((O=>this.restoreIndexedColor(O)))),this._parser.registerOscHandler(110,new b.OscHandler((O=>this.restoreFgColor(O)))),this._parser.registerOscHandler(111,new b.OscHandler((O=>this.restoreBgColor(O)))),this._parser.registerOscHandler(112,new b.OscHandler((O=>this.restoreCursorColor(O)))),this._parser.registerEscHandler({final:"7"},(()=>this.saveCursor())),this._parser.registerEscHandler({final:"8"},(()=>this.restoreCursor())),this._parser.registerEscHandler({final:"D"},(()=>this.index())),this._parser.registerEscHandler({final:"E"},(()=>this.nextLine())),this._parser.registerEscHandler({final:"H"},(()=>this.tabSet())),this._parser.registerEscHandler({final:"M"},(()=>this.reverseIndex())),this._parser.registerEscHandler({final:"="},(()=>this.keypadApplicationMode())),this._parser.registerEscHandler({final:">"},(()=>this.keypadNumericMode())),this._parser.registerEscHandler({final:"c"},(()=>this.fullReset())),this._parser.registerEscHandler({final:"n"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"o"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"|"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"}"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"~"},(()=>this.setgLevel(1))),this._parser.registerEscHandler({intermediates:"%",final:"@"},(()=>this.selectDefaultCharset())),this._parser.registerEscHandler({intermediates:"%",final:"G"},(()=>this.selectDefaultCharset()));for(const O in f.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:O},(()=>this.selectCharset("("+O))),this._parser.registerEscHandler({intermediates:")",final:O},(()=>this.selectCharset(")"+O))),this._parser.registerEscHandler({intermediates:"*",final:O},(()=>this.selectCharset("*"+O))),this._parser.registerEscHandler({intermediates:"+",final:O},(()=>this.selectCharset("+"+O))),this._parser.registerEscHandler({intermediates:"-",final:O},(()=>this.selectCharset("-"+O))),this._parser.registerEscHandler({intermediates:".",final:O},(()=>this.selectCharset("."+O))),this._parser.registerEscHandler({intermediates:"/",final:O},(()=>this.selectCharset("/"+O)));this._parser.registerEscHandler({intermediates:"#",final:"8"},(()=>this.screenAlignmentPattern())),this._parser.setErrorHandler((O=>(this._logService.error("Parsing error: ",O),O))),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new d.DcsHandler(((O,Y)=>this.requestStatusString(O,Y))))}_preserveStack(L,B,P,W){this._parseStack.paused=!0,this._parseStack.cursorStartX=L,this._parseStack.cursorStartY=B,this._parseStack.decodedLength=P,this._parseStack.position=W}_logSlowResolvingAsync(L){this._logService.logLevel<=_.LogLevelEnum.WARN&&Promise.race([L,new Promise(((B,P)=>setTimeout((()=>P("#SLOW_TIMEOUT")),5e3)))]).catch((B=>{if(B!=="#SLOW_TIMEOUT")throw B;console.warn("async parser handler taking longer than 5000 ms")}))}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(L,B){let P,W=this._activeBuffer.x,Q=this._activeBuffer.y,ae=0;const he=this._parseStack.paused;if(he){if(P=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,B))return this._logSlowResolvingAsync(P),P;W=this._parseStack.cursorStartX,Q=this._parseStack.cursorStartY,this._parseStack.paused=!1,L.length>D&&(ae=this._parseStack.position+D)}if(this._logService.logLevel<=_.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof L=="string"?` "${L}"`:` "${Array.prototype.map.call(L,(O=>String.fromCharCode(O))).join("")}"`),typeof L=="string"?L.split("").map((O=>O.charCodeAt(0))):L),this._parseBuffer.length<L.length&&this._parseBuffer.length<D&&(this._parseBuffer=new Uint32Array(Math.min(L.length,D))),he||this._dirtyRowTracker.clearRange(),L.length>D)for(let O=ae;O<L.length;O+=D){const Y=O+D<L.length?O+D:L.length,se=typeof L=="string"?this._stringDecoder.decode(L.substring(O,Y),this._parseBuffer):this._utf8Decoder.decode(L.subarray(O,Y),this._parseBuffer);if(P=this._parser.parse(this._parseBuffer,se))return this._preserveStack(W,Q,se,O),this._logSlowResolvingAsync(P),P}else if(!he){const O=typeof L=="string"?this._stringDecoder.decode(L,this._parseBuffer):this._utf8Decoder.decode(L,this._parseBuffer);if(P=this._parser.parse(this._parseBuffer,O))return this._preserveStack(W,Q,O,0),this._logSlowResolvingAsync(P),P}this._activeBuffer.x===W&&this._activeBuffer.y===Q||this._onCursorMove.fire();const me=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),V=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);V<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(V,this._bufferService.rows-1),Math.min(me,this._bufferService.rows-1))}print(L,B,P){let W,Q;const ae=this._charsetService.charset,he=this._optionsService.rawOptions.screenReaderMode,me=this._bufferService.cols,V=this._coreService.decPrivateModes.wraparound,O=this._coreService.modes.insertMode,Y=this._curAttrData;let se=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&P-B>0&&se.getWidth(this._activeBuffer.x-1)===2&&se.setCellFromCodepoint(this._activeBuffer.x-1,0,1,Y);let le=this._parser.precedingJoinState;for(let ce=B;ce<P;++ce){if(W=L[ce],W<127&&ae){const He=ae[String.fromCharCode(W)];He&&(W=He.charCodeAt(0))}const xe=this._unicodeService.charProperties(W,le);Q=l.UnicodeService.extractWidth(xe);const Re=l.UnicodeService.extractShouldJoin(xe),Oe=Re?l.UnicodeService.extractWidth(le):0;if(le=xe,he&&this._onA11yChar.fire((0,g.stringFromCodePoint)(W)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+Q-Oe>me){if(V){const He=se;let be=this._activeBuffer.x-Oe;for(this._activeBuffer.x=Oe,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),se=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),Oe>0&&se instanceof a.BufferLine&&se.copyCellsFrom(He,be,0,Oe,!1);be<me;)He.setCellFromCodepoint(be++,0,1,Y)}else if(this._activeBuffer.x=me-1,Q===2)continue}if(Re&&this._activeBuffer.x){const He=se.getWidth(this._activeBuffer.x-1)?1:2;se.addCodepointToCell(this._activeBuffer.x-He,W,Q);for(let be=Q-Oe;--be>=0;)se.setCellFromCodepoint(this._activeBuffer.x++,0,0,Y)}else if(O&&(se.insertCells(this._activeBuffer.x,Q-Oe,this._activeBuffer.getNullCell(Y)),se.getWidth(me-1)===2&&se.setCellFromCodepoint(me-1,e.NULL_CELL_CODE,e.NULL_CELL_WIDTH,Y)),se.setCellFromCodepoint(this._activeBuffer.x++,W,Q,Y),Q>0)for(;--Q;)se.setCellFromCodepoint(this._activeBuffer.x++,0,0,Y)}this._parser.precedingJoinState=le,this._activeBuffer.x<me&&P-B>0&&se.getWidth(this._activeBuffer.x)===0&&!se.hasContent(this._activeBuffer.x)&&se.setCellFromCodepoint(this._activeBuffer.x,0,1,Y),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(L,B){return L.final!=="t"||L.prefix||L.intermediates?this._parser.registerCsiHandler(L,B):this._parser.registerCsiHandler(L,(P=>!N(P.params[0],this._optionsService.rawOptions.windowOptions)||B(P)))}registerDcsHandler(L,B){return this._parser.registerDcsHandler(L,new d.DcsHandler(B))}registerEscHandler(L,B){return this._parser.registerEscHandler(L,B)}registerOscHandler(L,B){return this._parser.registerOscHandler(L,new b.OscHandler(B))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);L.hasWidth(this._activeBuffer.x)&&!L.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const L=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-L),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(L=this._bufferService.cols-1){this._activeBuffer.x=Math.min(L,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(L,B){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=L,this._activeBuffer.y=this._activeBuffer.scrollTop+B):(this._activeBuffer.x=L,this._activeBuffer.y=B),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(L,B){this._restrictCursor(),this._setCursor(this._activeBuffer.x+L,this._activeBuffer.y+B)}cursorUp(L){const B=this._activeBuffer.y-this._activeBuffer.scrollTop;return B>=0?this._moveCursor(0,-Math.min(B,L.params[0]||1)):this._moveCursor(0,-(L.params[0]||1)),!0}cursorDown(L){const B=this._activeBuffer.scrollBottom-this._activeBuffer.y;return B>=0?this._moveCursor(0,Math.min(B,L.params[0]||1)):this._moveCursor(0,L.params[0]||1),!0}cursorForward(L){return this._moveCursor(L.params[0]||1,0),!0}cursorBackward(L){return this._moveCursor(-(L.params[0]||1),0),!0}cursorNextLine(L){return this.cursorDown(L),this._activeBuffer.x=0,!0}cursorPrecedingLine(L){return this.cursorUp(L),this._activeBuffer.x=0,!0}cursorCharAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(L){return this._setCursor(L.length>=2?(L.params[1]||1)-1:0,(L.params[0]||1)-1),!0}charPosAbsolute(L){return this._setCursor((L.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(L){return this._moveCursor(L.params[0]||1,0),!0}linePosAbsolute(L){return this._setCursor(this._activeBuffer.x,(L.params[0]||1)-1),!0}vPositionRelative(L){return this._moveCursor(0,L.params[0]||1),!0}hVPosition(L){return this.cursorPosition(L),!0}tabClear(L){const B=L.params[0];return B===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:B===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(L){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=L.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(L){const B=L.params[0];return B===1&&(this._curAttrData.bg|=536870912),B!==2&&B!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(L,B,P,W=!1,Q=!1){const ae=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);ae.replaceCells(B,P,this._activeBuffer.getNullCell(this._eraseAttrData()),Q),W&&(ae.isWrapped=!1)}_resetBufferLine(L,B=!1){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+L);P&&(P.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),B),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+L),P.isWrapped=!1)}eraseInDisplay(L,B=!1){let P;switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:for(P=this._activeBuffer.y,this._dirtyRowTracker.markDirty(P),this._eraseInBufferLine(P++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);P<this._bufferService.rows;P++)this._resetBufferLine(P,B);this._dirtyRowTracker.markDirty(P);break;case 1:for(P=this._activeBuffer.y,this._dirtyRowTracker.markDirty(P),this._eraseInBufferLine(P,0,this._activeBuffer.x+1,!0,B),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(P+1).isWrapped=!1);P--;)this._resetBufferLine(P,B);this._dirtyRowTracker.markDirty(0);break;case 2:for(P=this._bufferService.rows,this._dirtyRowTracker.markDirty(P-1);P--;)this._resetBufferLine(P,B);this._dirtyRowTracker.markDirty(0);break;case 3:const W=this._activeBuffer.lines.length-this._bufferService.rows;W>0&&(this._activeBuffer.lines.trimStart(W),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-W,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-W,0),this._onScroll.fire(0))}return!0}eraseInLine(L,B=!1){switch(this._restrictCursor(this._bufferService.cols),L.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,B);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,B)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=this._activeBuffer.ybase+this._activeBuffer.y,W=this._bufferService.rows-1-this._activeBuffer.scrollBottom,Q=this._bufferService.rows-1+this._activeBuffer.ybase-W+1;for(;B--;)this._activeBuffer.lines.splice(Q-1,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(L){this._restrictCursor();let B=L.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const P=this._activeBuffer.ybase+this._activeBuffer.y;let W;for(W=this._bufferService.rows-1-this._activeBuffer.scrollBottom,W=this._bufferService.rows-1+this._activeBuffer.ybase-W;B--;)this._activeBuffer.lines.splice(P,1),this._activeBuffer.lines.splice(W,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.insertCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.deleteCells(this._activeBuffer.x,L.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(L){let B=L.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(a.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let P=this._activeBuffer.scrollTop;P<=this._activeBuffer.scrollBottom;++P){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+P);W.deleteCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData())),W.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let P=this._activeBuffer.scrollTop;P<=this._activeBuffer.scrollBottom;++P){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+P);W.insertCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData())),W.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let P=this._activeBuffer.scrollTop;P<=this._activeBuffer.scrollBottom;++P){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+P);W.insertCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData())),W.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(L){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=L.params[0]||1;for(let P=this._activeBuffer.scrollTop;P<=this._activeBuffer.scrollBottom;++P){const W=this._activeBuffer.lines.get(this._activeBuffer.ybase+P);W.deleteCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData())),W.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(L){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(L.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(L){const B=this._parser.precedingJoinState;if(!B)return!0;const P=L.params[0]||1,W=l.UnicodeService.extractWidth(B),Q=this._activeBuffer.x-W,ae=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(Q),he=new Uint32Array(ae.length*P);let me=0;for(let O=0;O<ae.length;){const Y=ae.codePointAt(O)||0;he[me++]=Y,O+=Y>65535?2:1}let V=me;for(let O=1;O<P;++O)he.copyWithin(V,0,me),V+=me;return this.print(he,0,V),!0}sendDeviceAttributesPrimary(L){return L.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(c.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(c.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(L){return L.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(c.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(c.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(L.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(c.C0.ESC+"[>83;40003;0c")),!0}_is(L){return(this._optionsService.rawOptions.termName+"").indexOf(L)===0}setMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,f.DEFAULT_CHARSET),this._charsetService.setgCharset(1,f.DEFAULT_CHARSET),this._charsetService.setgCharset(2,f.DEFAULT_CHARSET),this._charsetService.setgCharset(3,f.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(L){for(let B=0;B<L.length;B++)switch(L.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),L.params[B]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(L,B){const P=this._coreService.decPrivateModes,{activeProtocol:W,activeEncoding:Q}=this._coreMouseService,ae=this._coreService,{buffers:he,cols:me}=this._bufferService,{active:V,alt:O}=he,Y=this._optionsService.rawOptions,se=Re=>Re?1:2,le=L.params[0];return ce=le,xe=B?le===2?4:le===4?se(ae.modes.insertMode):le===12?3:le===20?se(Y.convertEol):0:le===1?se(P.applicationCursorKeys):le===3?Y.windowOptions.setWinLines?me===80?2:me===132?1:0:0:le===6?se(P.origin):le===7?se(P.wraparound):le===8?3:le===9?se(W==="X10"):le===12?se(Y.cursorBlink):le===25?se(!ae.isCursorHidden):le===45?se(P.reverseWraparound):le===66?se(P.applicationKeypad):le===67?4:le===1e3?se(W==="VT200"):le===1002?se(W==="DRAG"):le===1003?se(W==="ANY"):le===1004?se(P.sendFocus):le===1005?4:le===1006?se(Q==="SGR"):le===1015?4:le===1016?se(Q==="SGR_PIXELS"):le===1048?1:le===47||le===1047||le===1049?se(V===O):le===2004?se(P.bracketedPasteMode):0,ae.triggerDataEvent(`${c.C0.ESC}[${B?"":"?"}${ce};${xe}$y`),!0;var ce,xe}_updateAttrColor(L,B,P,W,Q){return B===2?(L|=50331648,L&=-16777216,L|=i.AttributeData.fromColorRGB([P,W,Q])):B===5&&(L&=-50331904,L|=33554432|255&P),L}_extractColor(L,B,P){const W=[0,0,-1,0,0,0];let Q=0,ae=0;do{if(W[ae+Q]=L.params[B+ae],L.hasSubParams(B+ae)){const he=L.getSubParams(B+ae);let me=0;do W[1]===5&&(Q=1),W[ae+me+1+Q]=he[me];while(++me<he.length&&me+ae+1+Q<W.length);break}if(W[1]===5&&ae+Q>=2||W[1]===2&&ae+Q>=5)break;W[1]&&(Q=1)}while(++ae+B<L.length&&ae+Q<W.length);for(let he=2;he<W.length;++he)W[he]===-1&&(W[he]=0);switch(W[0]){case 38:P.fg=this._updateAttrColor(P.fg,W[1],W[3],W[4],W[5]);break;case 48:P.bg=this._updateAttrColor(P.bg,W[1],W[3],W[4],W[5]);break;case 58:P.extended=P.extended.clone(),P.extended.underlineColor=this._updateAttrColor(P.extended.underlineColor,W[1],W[3],W[4],W[5])}return ae}_processUnderline(L,B){B.extended=B.extended.clone(),(!~L||L>5)&&(L=1),B.extended.underlineStyle=L,B.fg|=268435456,L===0&&(B.fg&=-268435457),B.updateExtended()}_processSGR0(L){L.fg=a.DEFAULT_ATTR_DATA.fg,L.bg=a.DEFAULT_ATTR_DATA.bg,L.extended=L.extended.clone(),L.extended.underlineStyle=0,L.extended.underlineColor&=-67108864,L.updateExtended()}charAttributes(L){if(L.length===1&&L.params[0]===0)return this._processSGR0(this._curAttrData),!0;const B=L.length;let P;const W=this._curAttrData;for(let Q=0;Q<B;Q++)P=L.params[Q],P>=30&&P<=37?(W.fg&=-50331904,W.fg|=16777216|P-30):P>=40&&P<=47?(W.bg&=-50331904,W.bg|=16777216|P-40):P>=90&&P<=97?(W.fg&=-50331904,W.fg|=16777224|P-90):P>=100&&P<=107?(W.bg&=-50331904,W.bg|=16777224|P-100):P===0?this._processSGR0(W):P===1?W.fg|=134217728:P===3?W.bg|=67108864:P===4?(W.fg|=268435456,this._processUnderline(L.hasSubParams(Q)?L.getSubParams(Q)[0]:1,W)):P===5?W.fg|=536870912:P===7?W.fg|=67108864:P===8?W.fg|=1073741824:P===9?W.fg|=2147483648:P===2?W.bg|=134217728:P===21?this._processUnderline(2,W):P===22?(W.fg&=-134217729,W.bg&=-134217729):P===23?W.bg&=-67108865:P===24?(W.fg&=-268435457,this._processUnderline(0,W)):P===25?W.fg&=-536870913:P===27?W.fg&=-67108865:P===28?W.fg&=-1073741825:P===29?W.fg&=2147483647:P===39?(W.fg&=-67108864,W.fg|=16777215&a.DEFAULT_ATTR_DATA.fg):P===49?(W.bg&=-67108864,W.bg|=16777215&a.DEFAULT_ATTR_DATA.bg):P===38||P===48||P===58?Q+=this._extractColor(L,Q,W):P===53?W.bg|=1073741824:P===55?W.bg&=-1073741825:P===59?(W.extended=W.extended.clone(),W.extended.underlineColor=-1,W.updateExtended()):P===100?(W.fg&=-67108864,W.fg|=16777215&a.DEFAULT_ATTR_DATA.fg,W.bg&=-67108864,W.bg|=16777215&a.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",P);return!0}deviceStatus(L){switch(L.params[0]){case 5:this._coreService.triggerDataEvent(`${c.C0.ESC}[0n`);break;case 6:const B=this._activeBuffer.y+1,P=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[${B};${P}R`)}return!0}deviceStatusPrivate(L){if(L.params[0]===6){const B=this._activeBuffer.y+1,P=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[?${B};${P}R`)}return!0}softReset(L){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(L){const B=L.params[0]||1;switch(B){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const P=B%2==1;return this._optionsService.options.cursorBlink=P,!0}setScrollRegion(L){const B=L.params[0]||1;let P;return(L.length<2||(P=L.params[1])>this._bufferService.rows||P===0)&&(P=this._bufferService.rows),P>B&&(this._activeBuffer.scrollTop=B-1,this._activeBuffer.scrollBottom=P-1,this._setCursor(0,0)),!0}windowOptions(L){if(!N(L.params[0],this._optionsService.rawOptions.windowOptions))return!0;const B=L.length>1?L.params[1]:0;switch(L.params[0]){case 14:B!==2&&this._onRequestWindowsOptionsReport.fire(T.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(T.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${c.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:B!==0&&B!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),B!==0&&B!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:B!==0&&B!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),B!==0&&B!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(L){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(L){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(L){return this._windowTitle=L,this._onTitleChange.fire(L),!0}setIconName(L){return this._iconName=L,!0}setOrReportIndexedColor(L){const B=[],P=L.split(";");for(;P.length>1;){const W=P.shift(),Q=P.shift();if(/^\d+$/.exec(W)){const ae=parseInt(W);if(F(ae))if(Q==="?")B.push({type:0,index:ae});else{const he=(0,y.parseColor)(Q);he&&B.push({type:1,index:ae,color:he})}}}return B.length&&this._onColor.fire(B),!0}setHyperlink(L){const B=L.split(";");return!(B.length<2)&&(B[1]?this._createHyperlink(B[0],B[1]):!B[0]&&this._finishHyperlink())}_createHyperlink(L,B){this._getCurrentLinkId()&&this._finishHyperlink();const P=L.split(":");let W;const Q=P.findIndex((ae=>ae.startsWith("id=")));return Q!==-1&&(W=P[Q].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:W,uri:B}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(L,B){const P=L.split(";");for(let W=0;W<P.length&&!(B>=this._specialColors.length);++W,++B)if(P[W]==="?")this._onColor.fire([{type:0,index:this._specialColors[B]}]);else{const Q=(0,y.parseColor)(P[W]);Q&&this._onColor.fire([{type:1,index:this._specialColors[B],color:Q}])}return!0}setOrReportFgColor(L){return this._setOrReportSpecialColor(L,0)}setOrReportBgColor(L){return this._setOrReportSpecialColor(L,1)}setOrReportCursorColor(L){return this._setOrReportSpecialColor(L,2)}restoreIndexedColor(L){if(!L)return this._onColor.fire([{type:2}]),!0;const B=[],P=L.split(";");for(let W=0;W<P.length;++W)if(/^\d+$/.exec(P[W])){const Q=parseInt(P[W]);F(Q)&&B.push({type:2,index:Q})}return B.length&&this._onColor.fire(B),!0}restoreFgColor(L){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(L){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(L){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,f.DEFAULT_CHARSET),!0}selectCharset(L){return L.length!==2?(this.selectDefaultCharset(),!0):(L[0]==="/"||this._charsetService.setgCharset(M[L[0]],f.CHARSETS[L[1]]||f.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const L=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,L,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=a.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(L){return this._charsetService.setgLevel(L),!0}screenAlignmentPattern(){const L=new r.CellData;L.content=4194373,L.fg=this._curAttrData.fg,L.bg=this._curAttrData.bg,this._setCursor(0,0);for(let B=0;B<this._bufferService.rows;++B){const P=this._activeBuffer.ybase+this._activeBuffer.y+B,W=this._activeBuffer.lines.get(P);W&&(W.fill(L),W.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(L,B){const P=this._bufferService.buffer,W=this._optionsService.rawOptions;return(Q=>(this._coreService.triggerDataEvent(`${c.C0.ESC}${Q}${c.C0.ESC}\\`),!0))(L==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:L==='"p'?'P1$r61;1"p':L==="r"?`P1$r${P.scrollTop+1};${P.scrollBottom+1}r`:L==="m"?"P1$r0m":L===" q"?`P1$r${{block:2,underline:4,bar:6}[W.cursorStyle]-(W.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(L,B){this._dirtyRowTracker.markRangeDirty(L,B)}}o.InputHandler=J;let ie=class{constructor(ee){this._bufferService=ee,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(ee){ee<this.start?this.start=ee:ee>this.end&&(this.end=ee)}markRangeDirty(ee,L){ee>L&&(z=ee,ee=L,L=z),ee<this.start&&(this.start=ee),L>this.end&&(this.end=L)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function F(ee){return 0<=ee&&ee<256}ie=u([m(0,_.IBufferService)],ie)},844:(I,o)=>{function n(u){for(const m of u)m.dispose();u.length=0}Object.defineProperty(o,"__esModule",{value:!0}),o.getDisposeArrayDisposable=o.disposeArray=o.toDisposable=o.MutableDisposable=o.Disposable=void 0,o.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const u of this._disposables)u.dispose();this._disposables.length=0}register(u){return this._disposables.push(u),u}unregister(u){const m=this._disposables.indexOf(u);m!==-1&&this._disposables.splice(m,1)}},o.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(u){this._isDisposed||u===this._value||(this._value?.dispose(),this._value=u)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},o.toDisposable=function(u){return{dispose:u}},o.disposeArray=n,o.getDisposeArrayDisposable=function(u){return{dispose:()=>n(u)}}},1505:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FourKeyMap=o.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(m,c,f){this._data[m]||(this._data[m]={}),this._data[m][c]=f}get(m,c){return this._data[m]?this._data[m][c]:void 0}clear(){this._data={}}}o.TwoKeyMap=n,o.FourKeyMap=class{constructor(){this._data=new n}set(u,m,c,f,v){this._data.get(u,m)||this._data.set(u,m,new n),this._data.get(u,m).set(c,f,v)}get(u,m,c,f){return this._data.get(u,m)?.get(c,f)}clear(){this._data.clear()}}},6114:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isChromeOS=o.isLinux=o.isWindows=o.isIphone=o.isIpad=o.isMac=o.getSafariVersion=o.isSafari=o.isLegacyEdge=o.isFirefox=o.isNode=void 0,o.isNode=typeof process<"u"&&"title"in process;const n=o.isNode?"node":navigator.userAgent,u=o.isNode?"node":navigator.platform;o.isFirefox=n.includes("Firefox"),o.isLegacyEdge=n.includes("Edge"),o.isSafari=/^((?!chrome|android).)*safari/i.test(n),o.getSafariVersion=function(){if(!o.isSafari)return 0;const m=n.match(/Version\/(\d+)/);return m===null||m.length<2?0:parseInt(m[1])},o.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(u),o.isIpad=u==="iPad",o.isIphone=u==="iPhone",o.isWindows=["Windows","Win16","Win32","WinCE"].includes(u),o.isLinux=u.indexOf("Linux")>=0,o.isChromeOS=/\bCrOS\b/.test(n)},6106:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SortedList=void 0;let n=0;o.SortedList=class{constructor(u){this._getKey=u,this._array=[]}clear(){this._array.length=0}insert(u){this._array.length!==0?(n=this._search(this._getKey(u)),this._array.splice(n,0,u)):this._array.push(u)}delete(u){if(this._array.length===0)return!1;const m=this._getKey(u);if(m===void 0||(n=this._search(m),n===-1)||this._getKey(this._array[n])!==m)return!1;do if(this._array[n]===u)return this._array.splice(n,1),!0;while(++n<this._array.length&&this._getKey(this._array[n])===m);return!1}*getKeyIterator(u){if(this._array.length!==0&&(n=this._search(u),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===u))do yield this._array[n];while(++n<this._array.length&&this._getKey(this._array[n])===u)}forEachByKey(u,m){if(this._array.length!==0&&(n=this._search(u),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===u))do m(this._array[n]);while(++n<this._array.length&&this._getKey(this._array[n])===u)}values(){return[...this._array].values()}_search(u){let m=0,c=this._array.length-1;for(;c>=m;){let f=m+c>>1;const v=this._getKey(this._array[f]);if(v>u)c=f-1;else{if(!(v<u)){for(;f>0&&this._getKey(this._array[f-1])===u;)f--;return f}m=f+1}}return m}}},7226:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DebouncedIdleTask=o.IdleTaskQueue=o.PriorityTaskQueue=void 0;const u=n(6114);class m{constructor(){this._tasks=[],this._i=0}enqueue(v){this._tasks.push(v),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(v){this._idleCallback=void 0;let S=0,g=0,a=v.timeRemaining(),t=0;for(;this._i<this._tasks.length;){if(S=Date.now(),this._tasks[this._i]()||this._i++,S=Math.max(1,Date.now()-S),g=Math.max(S,g),t=v.timeRemaining(),1.5*g>t)return a-S<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(a-S))}ms`),void this._start();a=t}this.clear()}}class c extends m{_requestCallback(v){return setTimeout((()=>v(this._createDeadline(16))))}_cancelCallback(v){clearTimeout(v)}_createDeadline(v){const S=Date.now()+v;return{timeRemaining:()=>Math.max(0,S-Date.now())}}}o.PriorityTaskQueue=c,o.IdleTaskQueue=!u.isNode&&"requestIdleCallback"in window?class extends m{_requestCallback(f){return requestIdleCallback(f)}_cancelCallback(f){cancelIdleCallback(f)}}:c,o.DebouncedIdleTask=class{constructor(){this._queue=new o.IdleTaskQueue}set(f){this._queue.clear(),this._queue.enqueue(f)}flush(){this._queue.flush()}}},9282:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.updateWindowsModeWrappedState=void 0;const u=n(643);o.updateWindowsModeWrappedState=function(m){const c=m.buffer.lines.get(m.buffer.ybase+m.buffer.y-1),f=c?.get(m.cols-1),v=m.buffer.lines.get(m.buffer.ybase+m.buffer.y);v&&f&&(v.isWrapped=f[u.CHAR_DATA_CODE_INDEX]!==u.NULL_CELL_CODE&&f[u.CHAR_DATA_CODE_INDEX]!==u.WHITESPACE_CELL_CODE)}},3734:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ExtendedAttrs=o.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new u}static toColorRGB(c){return[c>>>16&255,c>>>8&255,255&c]}static fromColorRGB(c){return(255&c[0])<<16|(255&c[1])<<8|255&c[2]}clone(){const c=new n;return c.fg=this.fg,c.bg=this.bg,c.extended=this.extended.clone(),c}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}o.AttributeData=n;class u{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(c){this._ext=c}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(c){this._ext&=-469762049,this._ext|=c<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(c){this._ext&=-67108864,this._ext|=67108863&c}get urlId(){return this._urlId}set urlId(c){this._urlId=c}get underlineVariantOffset(){const c=(3758096384&this._ext)>>29;return c<0?4294967288^c:c}set underlineVariantOffset(c){this._ext&=536870911,this._ext|=c<<29&3758096384}constructor(c=0,f=0){this._ext=0,this._urlId=0,this._ext=c,this._urlId=f}clone(){return new u(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}o.ExtendedAttrs=u},9092:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Buffer=o.MAX_BUFFER_SIZE=void 0;const u=n(6349),m=n(7226),c=n(3734),f=n(8437),v=n(4634),S=n(511),g=n(643),a=n(4863),t=n(7116);o.MAX_BUFFER_SIZE=4294967295,o.Buffer=class{constructor(e,r,i){this._hasScrollback=e,this._optionsService=r,this._bufferService=i,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=f.DEFAULT_ATTR_DATA.clone(),this.savedCharset=t.DEFAULT_CHARSET,this.markers=[],this._nullCell=S.CellData.fromCharData([0,g.NULL_CELL_CHAR,g.NULL_CELL_WIDTH,g.NULL_CELL_CODE]),this._whitespaceCell=S.CellData.fromCharData([0,g.WHITESPACE_CELL_CHAR,g.WHITESPACE_CELL_WIDTH,g.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new m.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell}getBlankLine(e,r){return new f.BufferLine(this._bufferService.cols,this.getNullCell(e),r)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;const r=e+this._optionsService.rawOptions.scrollback;return r>o.MAX_BUFFER_SIZE?o.MAX_BUFFER_SIZE:r}fillViewportRows(e){if(this.lines.length===0){e===void 0&&(e=f.DEFAULT_ATTR_DATA);let r=this._rows;for(;r--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,r){const i=this.getNullCell(f.DEFAULT_ATTR_DATA);let _=0;const l=this._getCorrectBufferLength(r);if(l>this.lines.maxLength&&(this.lines.maxLength=l),this.lines.length>0){if(this._cols<e)for(let d=0;d<this.lines.length;d++)_+=+this.lines.get(d).resize(e,i);let b=0;if(this._rows<r)for(let d=this._rows;d<r;d++)this.lines.length<r+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new f.BufferLine(e,i)):this.ybase>0&&this.lines.length<=this.ybase+this.y+b+1?(this.ybase--,b++,this.ydisp>0&&this.ydisp--):this.lines.push(new f.BufferLine(e,i)));else for(let d=this._rows;d>r;d--)this.lines.length>r+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(l<this.lines.maxLength){const d=this.lines.length-l;d>0&&(this.lines.trimStart(d),this.ybase=Math.max(this.ybase-d,0),this.ydisp=Math.max(this.ydisp-d,0),this.savedY=Math.max(this.savedY-d,0)),this.lines.maxLength=l}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,r-1),b&&(this.y+=b),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=r-1,this._isReflowEnabled&&(this._reflow(e,r),this._cols>e))for(let b=0;b<this.lines.length;b++)_+=+this.lines.get(b).resize(e,i);this._cols=e,this._rows=r,this._memoryCleanupQueue.clear(),_>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue((()=>this._batchedMemoryCleanup())))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let r=0;for(;this._memoryCleanupPosition<this.lines.length;)if(r+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),r>100)return!0;return e}get _isReflowEnabled(){const e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&e.backend==="conpty"&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,r){this._cols!==e&&(e>this._cols?this._reflowLarger(e,r):this._reflowSmaller(e,r))}_reflowLarger(e,r){const i=(0,v.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(f.DEFAULT_ATTR_DATA));if(i.length>0){const _=(0,v.reflowLargerCreateNewLayout)(this.lines,i);(0,v.reflowLargerApplyNewLayout)(this.lines,_.layout),this._reflowLargerAdjustViewport(e,r,_.countRemoved)}}_reflowLargerAdjustViewport(e,r,i){const _=this.getNullCell(f.DEFAULT_ATTR_DATA);let l=i;for(;l-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<r&&this.lines.push(new f.BufferLine(e,_))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)}_reflowSmaller(e,r){const i=this.getNullCell(f.DEFAULT_ATTR_DATA),_=[];let l=0;for(let b=this.lines.length-1;b>=0;b--){let d=this.lines.get(b);if(!d||!d.isWrapped&&d.getTrimmedLength()<=e)continue;const y=[d];for(;d.isWrapped&&b>0;)d=this.lines.get(--b),y.unshift(d);const M=this.ybase+this.y;if(M>=b&&M<b+y.length)continue;const D=y[y.length-1].getTrimmedLength(),N=(0,v.reflowSmallerGetNewLineLengths)(y,this._cols,e),T=N.length-y.length;let z;z=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+T):Math.max(0,this.lines.length-this.lines.maxLength+T);const J=[];for(let P=0;P<T;P++){const W=this.getBlankLine(f.DEFAULT_ATTR_DATA,!0);J.push(W)}J.length>0&&(_.push({start:b+y.length+l,newLines:J}),l+=J.length),y.push(...J);let ie=N.length-1,F=N[ie];F===0&&(ie--,F=N[ie]);let ee=y.length-T-1,L=D;for(;ee>=0;){const P=Math.min(L,F);if(y[ie]===void 0)break;if(y[ie].copyCellsFrom(y[ee],L-P,F-P,P,!0),F-=P,F===0&&(ie--,F=N[ie]),L-=P,L===0){ee--;const W=Math.max(ee,0);L=(0,v.getWrappedLineTrimmedLength)(y,W,this._cols)}}for(let P=0;P<y.length;P++)N[P]<e&&y[P].setCell(N[P],i);let B=T-z;for(;B-- >0;)this.ybase===0?this.y<r-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+l)-r&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+T,this.ybase+r-1)}if(_.length>0){const b=[],d=[];for(let ie=0;ie<this.lines.length;ie++)d.push(this.lines.get(ie));const y=this.lines.length;let M=y-1,D=0,N=_[D];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+l);let T=0;for(let ie=Math.min(this.lines.maxLength-1,y+l-1);ie>=0;ie--)if(N&&N.start>M+T){for(let F=N.newLines.length-1;F>=0;F--)this.lines.set(ie--,N.newLines[F]);ie++,b.push({index:M+1,amount:N.newLines.length}),T+=N.newLines.length,N=_[++D]}else this.lines.set(ie,d[M--]);let z=0;for(let ie=b.length-1;ie>=0;ie--)b[ie].index+=z,this.lines.onInsertEmitter.fire(b[ie]),z+=b[ie].amount;const J=Math.max(0,y+l-this.lines.maxLength);J>0&&this.lines.onTrimEmitter.fire(J)}}translateBufferLineToString(e,r,i=0,_){const l=this.lines.get(e);return l?l.translateToString(r,i,_):""}getWrappedRangeForLine(e){let r=e,i=e;for(;r>0&&this.lines.get(r).isWrapped;)r--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:r,last:i}}setupTabStops(e){for(e!=null?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(e==null&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(e==null&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].line===e&&(this.markers[r].dispose(),this.markers.splice(r--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1}addMarker(e){const r=new a.Marker(e);return this.markers.push(r),r.register(this.lines.onTrim((i=>{r.line-=i,r.line<0&&r.dispose()}))),r.register(this.lines.onInsert((i=>{r.line>=i.index&&(r.line+=i.amount)}))),r.register(this.lines.onDelete((i=>{r.line>=i.index&&r.line<i.index+i.amount&&r.dispose(),r.line>i.index&&(r.line-=i.amount)}))),r.register(r.onDispose((()=>this._removeMarker(r)))),r}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}}},8437:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLine=o.DEFAULT_ATTR_DATA=void 0;const u=n(3734),m=n(511),c=n(643),f=n(482);o.DEFAULT_ATTR_DATA=Object.freeze(new u.AttributeData);let v=0;class S{constructor(a,t,e=!1){this.isWrapped=e,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*a);const r=t||m.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]);for(let i=0;i<a;++i)this.setCell(i,r);this.length=a}get(a){const t=this._data[3*a+0],e=2097151&t;return[this._data[3*a+1],2097152&t?this._combined[a]:e?(0,f.stringFromCodePoint)(e):"",t>>22,2097152&t?this._combined[a].charCodeAt(this._combined[a].length-1):e]}set(a,t){this._data[3*a+1]=t[c.CHAR_DATA_ATTR_INDEX],t[c.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[a]=t[1],this._data[3*a+0]=2097152|a|t[c.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*a+0]=t[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[c.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(a){return this._data[3*a+0]>>22}hasWidth(a){return 12582912&this._data[3*a+0]}getFg(a){return this._data[3*a+1]}getBg(a){return this._data[3*a+2]}hasContent(a){return 4194303&this._data[3*a+0]}getCodePoint(a){const t=this._data[3*a+0];return 2097152&t?this._combined[a].charCodeAt(this._combined[a].length-1):2097151&t}isCombined(a){return 2097152&this._data[3*a+0]}getString(a){const t=this._data[3*a+0];return 2097152&t?this._combined[a]:2097151&t?(0,f.stringFromCodePoint)(2097151&t):""}isProtected(a){return 536870912&this._data[3*a+2]}loadCell(a,t){return v=3*a,t.content=this._data[v+0],t.fg=this._data[v+1],t.bg=this._data[v+2],2097152&t.content&&(t.combinedData=this._combined[a]),268435456&t.bg&&(t.extended=this._extendedAttrs[a]),t}setCell(a,t){2097152&t.content&&(this._combined[a]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[a]=t.extended),this._data[3*a+0]=t.content,this._data[3*a+1]=t.fg,this._data[3*a+2]=t.bg}setCellFromCodepoint(a,t,e,r){268435456&r.bg&&(this._extendedAttrs[a]=r.extended),this._data[3*a+0]=t|e<<22,this._data[3*a+1]=r.fg,this._data[3*a+2]=r.bg}addCodepointToCell(a,t,e){let r=this._data[3*a+0];2097152&r?this._combined[a]+=(0,f.stringFromCodePoint)(t):2097151&r?(this._combined[a]=(0,f.stringFromCodePoint)(2097151&r)+(0,f.stringFromCodePoint)(t),r&=-2097152,r|=2097152):r=t|4194304,e&&(r&=-12582913,r|=e<<22),this._data[3*a+0]=r}insertCells(a,t,e){if((a%=this.length)&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a-1,0,1,e),t<this.length-a){const r=new m.CellData;for(let i=this.length-a-t-1;i>=0;--i)this.setCell(a+t+i,this.loadCell(a+i,r));for(let i=0;i<t;++i)this.setCell(a+i,e)}else for(let r=a;r<this.length;++r)this.setCell(r,e);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,e)}deleteCells(a,t,e){if(a%=this.length,t<this.length-a){const r=new m.CellData;for(let i=0;i<this.length-a-t;++i)this.setCell(a+i,this.loadCell(a+t+i,r));for(let i=this.length-t;i<this.length;++i)this.setCell(i,e)}else for(let r=a;r<this.length;++r)this.setCell(r,e);a&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a-1,0,1,e),this.getWidth(a)!==0||this.hasContent(a)||this.setCellFromCodepoint(a,0,1,e)}replaceCells(a,t,e,r=!1){if(r)for(a&&this.getWidth(a-1)===2&&!this.isProtected(a-1)&&this.setCellFromCodepoint(a-1,0,1,e),t<this.length&&this.getWidth(t-1)===2&&!this.isProtected(t)&&this.setCellFromCodepoint(t,0,1,e);a<t&&a<this.length;)this.isProtected(a)||this.setCell(a,e),a++;else for(a&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a-1,0,1,e),t<this.length&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t,0,1,e);a<t&&a<this.length;)this.setCell(a++,e)}resize(a,t){if(a===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const e=3*a;if(a>this.length){if(this._data.buffer.byteLength>=4*e)this._data=new Uint32Array(this._data.buffer,0,e);else{const r=new Uint32Array(e);r.set(this._data),this._data=r}for(let r=this.length;r<a;++r)this.setCell(r,t)}else{this._data=this._data.subarray(0,e);const r=Object.keys(this._combined);for(let _=0;_<r.length;_++){const l=parseInt(r[_],10);l>=a&&delete this._combined[l]}const i=Object.keys(this._extendedAttrs);for(let _=0;_<i.length;_++){const l=parseInt(i[_],10);l>=a&&delete this._extendedAttrs[l]}}return this.length=a,4*e*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const a=new Uint32Array(this._data.length);return a.set(this._data),this._data=a,1}return 0}fill(a,t=!1){if(t)for(let e=0;e<this.length;++e)this.isProtected(e)||this.setCell(e,a);else{this._combined={},this._extendedAttrs={};for(let e=0;e<this.length;++e)this.setCell(e,a)}}copyFrom(a){this.length!==a.length?this._data=new Uint32Array(a._data):this._data.set(a._data),this.length=a.length,this._combined={};for(const t in a._combined)this._combined[t]=a._combined[t];this._extendedAttrs={};for(const t in a._extendedAttrs)this._extendedAttrs[t]=a._extendedAttrs[t];this.isWrapped=a.isWrapped}clone(){const a=new S(0);a._data=new Uint32Array(this._data),a.length=this.length;for(const t in this._combined)a._combined[t]=this._combined[t];for(const t in this._extendedAttrs)a._extendedAttrs[t]=this._extendedAttrs[t];return a.isWrapped=this.isWrapped,a}getTrimmedLength(){for(let a=this.length-1;a>=0;--a)if(4194303&this._data[3*a+0])return a+(this._data[3*a+0]>>22);return 0}getNoBgTrimmedLength(){for(let a=this.length-1;a>=0;--a)if(4194303&this._data[3*a+0]||50331648&this._data[3*a+2])return a+(this._data[3*a+0]>>22);return 0}copyCellsFrom(a,t,e,r,i){const _=a._data;if(i)for(let b=r-1;b>=0;b--){for(let d=0;d<3;d++)this._data[3*(e+b)+d]=_[3*(t+b)+d];268435456&_[3*(t+b)+2]&&(this._extendedAttrs[e+b]=a._extendedAttrs[t+b])}else for(let b=0;b<r;b++){for(let d=0;d<3;d++)this._data[3*(e+b)+d]=_[3*(t+b)+d];268435456&_[3*(t+b)+2]&&(this._extendedAttrs[e+b]=a._extendedAttrs[t+b])}const l=Object.keys(a._combined);for(let b=0;b<l.length;b++){const d=parseInt(l[b],10);d>=t&&(this._combined[d-t+e]=a._combined[d])}}translateToString(a,t,e,r){t=t??0,e=e??this.length,a&&(e=Math.min(e,this.getTrimmedLength())),r&&(r.length=0);let i="";for(;t<e;){const _=this._data[3*t+0],l=2097151&_,b=2097152&_?this._combined[t]:l?(0,f.stringFromCodePoint)(l):c.WHITESPACE_CELL_CHAR;if(i+=b,r)for(let d=0;d<b.length;++d)r.push(t);t+=_>>22||1}return r&&r.push(t),i}}o.BufferLine=S},4841:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getRangeLength=void 0,o.getRangeLength=function(n,u){if(n.start.y>n.end.y)throw new Error(`Buffer range end (${n.end.x}, ${n.end.y}) cannot be before start (${n.start.x}, ${n.start.y})`);return u*(n.end.y-n.start.y)+(n.end.x-n.start.x+1)}},4634:(I,o)=>{function n(u,m,c){if(m===u.length-1)return u[m].getTrimmedLength();const f=!u[m].hasContent(c-1)&&u[m].getWidth(c-1)===1,v=u[m+1].getWidth(0)===2;return f&&v?c-1:c}Object.defineProperty(o,"__esModule",{value:!0}),o.getWrappedLineTrimmedLength=o.reflowSmallerGetNewLineLengths=o.reflowLargerApplyNewLayout=o.reflowLargerCreateNewLayout=o.reflowLargerGetLinesToRemove=void 0,o.reflowLargerGetLinesToRemove=function(u,m,c,f,v){const S=[];for(let g=0;g<u.length-1;g++){let a=g,t=u.get(++a);if(!t.isWrapped)continue;const e=[u.get(g)];for(;a<u.length&&t.isWrapped;)e.push(t),t=u.get(++a);if(f>=g&&f<a){g+=e.length-1;continue}let r=0,i=n(e,r,m),_=1,l=0;for(;_<e.length;){const d=n(e,_,m),y=d-l,M=c-i,D=Math.min(y,M);e[r].copyCellsFrom(e[_],l,i,D,!1),i+=D,i===c&&(r++,i=0),l+=D,l===d&&(_++,l=0),i===0&&r!==0&&e[r-1].getWidth(c-1)===2&&(e[r].copyCellsFrom(e[r-1],c-1,i++,1,!1),e[r-1].setCell(c-1,v))}e[r].replaceCells(i,c,v);let b=0;for(let d=e.length-1;d>0&&(d>r||e[d].getTrimmedLength()===0);d--)b++;b>0&&(S.push(g+e.length-b),S.push(b)),g+=e.length-1}return S},o.reflowLargerCreateNewLayout=function(u,m){const c=[];let f=0,v=m[f],S=0;for(let g=0;g<u.length;g++)if(v===g){const a=m[++f];u.onDeleteEmitter.fire({index:g-S,amount:a}),g+=a-1,S+=a,v=m[++f]}else c.push(g);return{layout:c,countRemoved:S}},o.reflowLargerApplyNewLayout=function(u,m){const c=[];for(let f=0;f<m.length;f++)c.push(u.get(m[f]));for(let f=0;f<c.length;f++)u.set(f,c[f]);u.length=m.length},o.reflowSmallerGetNewLineLengths=function(u,m,c){const f=[],v=u.map(((t,e)=>n(u,e,m))).reduce(((t,e)=>t+e));let S=0,g=0,a=0;for(;a<v;){if(v-a<c){f.push(v-a);break}S+=c;const t=n(u,g,m);S>t&&(S-=t,g++);const e=u[g].getWidth(S-1)===2;e&&S--;const r=e?c-1:c;f.push(r),a+=r}return f},o.getWrappedLineTrimmedLength=n},5295:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferSet=void 0;const u=n(8460),m=n(844),c=n(9092);class f extends m.Disposable{constructor(S,g){super(),this._optionsService=S,this._bufferService=g,this._onBufferActivate=this.register(new u.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.resize(this._bufferService.cols,this._bufferService.rows)))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",(()=>this.setupTabStops())))}reset(){this._normal=new c.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(S){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(S),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(S,g){this._normal.resize(S,g),this._alt.resize(S,g),this.setupTabStops(S)}setupTabStops(S){this._normal.setupTabStops(S),this._alt.setupTabStops(S)}}o.BufferSet=f},511:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CellData=void 0;const u=n(482),m=n(643),c=n(3734);class f extends c.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new c.ExtendedAttrs,this.combinedData=""}static fromCharData(S){const g=new f;return g.setFromCharData(S),g}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,u.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(S){this.fg=S[m.CHAR_DATA_ATTR_INDEX],this.bg=0;let g=!1;if(S[m.CHAR_DATA_CHAR_INDEX].length>2)g=!0;else if(S[m.CHAR_DATA_CHAR_INDEX].length===2){const a=S[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=a&&a<=56319){const t=S[m.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=t&&t<=57343?this.content=1024*(a-55296)+t-56320+65536|S[m.CHAR_DATA_WIDTH_INDEX]<<22:g=!0}else g=!0}else this.content=S[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|S[m.CHAR_DATA_WIDTH_INDEX]<<22;g&&(this.combinedData=S[m.CHAR_DATA_CHAR_INDEX],this.content=2097152|S[m.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.CellData=f},643:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WHITESPACE_CELL_CODE=o.WHITESPACE_CELL_WIDTH=o.WHITESPACE_CELL_CHAR=o.NULL_CELL_CODE=o.NULL_CELL_WIDTH=o.NULL_CELL_CHAR=o.CHAR_DATA_CODE_INDEX=o.CHAR_DATA_WIDTH_INDEX=o.CHAR_DATA_CHAR_INDEX=o.CHAR_DATA_ATTR_INDEX=o.DEFAULT_EXT=o.DEFAULT_ATTR=o.DEFAULT_COLOR=void 0,o.DEFAULT_COLOR=0,o.DEFAULT_ATTR=256|o.DEFAULT_COLOR<<9,o.DEFAULT_EXT=0,o.CHAR_DATA_ATTR_INDEX=0,o.CHAR_DATA_CHAR_INDEX=1,o.CHAR_DATA_WIDTH_INDEX=2,o.CHAR_DATA_CODE_INDEX=3,o.NULL_CELL_CHAR="",o.NULL_CELL_WIDTH=1,o.NULL_CELL_CODE=0,o.WHITESPACE_CELL_CHAR=" ",o.WHITESPACE_CELL_WIDTH=1,o.WHITESPACE_CELL_CODE=32},4863:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Marker=void 0;const u=n(8460),m=n(844);class c{get id(){return this._id}constructor(v){this.line=v,this.isDisposed=!1,this._disposables=[],this._id=c._nextId++,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,m.disposeArray)(this._disposables),this._disposables.length=0)}register(v){return this._disposables.push(v),v}}o.Marker=c,c._nextId=1},7116:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DEFAULT_CHARSET=o.CHARSETS=void 0,o.CHARSETS={},o.DEFAULT_CHARSET=o.CHARSETS.B,o.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},o.CHARSETS.A={"#":""},o.CHARSETS.B=void 0,o.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},o.CHARSETS.C=o.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},o.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},o.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.E=o.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},o.CHARSETS.H=o.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},o.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(I,o)=>{var n,u,m;Object.defineProperty(o,"__esModule",{value:!0}),o.C1_ESCAPED=o.C1=o.C0=void 0,(function(c){c.NUL="\0",c.SOH="",c.STX="",c.ETX="",c.EOT="",c.ENQ="",c.ACK="",c.BEL="\x07",c.BS="\b",c.HT="	",c.LF=`
`,c.VT="\v",c.FF="\f",c.CR="\r",c.SO="",c.SI="",c.DLE="",c.DC1="",c.DC2="",c.DC3="",c.DC4="",c.NAK="",c.SYN="",c.ETB="",c.CAN="",c.EM="",c.SUB="",c.ESC="\x1B",c.FS="",c.GS="",c.RS="",c.US="",c.SP=" ",c.DEL=""})(n||(o.C0=n={})),(function(c){c.PAD="",c.HOP="",c.BPH="",c.NBH="",c.IND="",c.NEL="",c.SSA="",c.ESA="",c.HTS="",c.HTJ="",c.VTS="",c.PLD="",c.PLU="",c.RI="",c.SS2="",c.SS3="",c.DCS="",c.PU1="",c.PU2="",c.STS="",c.CCH="",c.MW="",c.SPA="",c.EPA="",c.SOS="",c.SGCI="",c.SCI="",c.CSI="",c.ST="",c.OSC="",c.PM="",c.APC=""})(u||(o.C1=u={})),(function(c){c.ST=`${n.ESC}\\`})(m||(o.C1_ESCAPED=m={}))},7399:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.evaluateKeyboardEvent=void 0;const u=n(2584),m={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};o.evaluateKeyboardEvent=function(c,f,v,S){const g={type:0,cancel:!1,key:void 0},a=(c.shiftKey?1:0)|(c.altKey?2:0)|(c.ctrlKey?4:0)|(c.metaKey?8:0);switch(c.keyCode){case 0:c.key==="UIKeyInputUpArrow"?g.key=f?u.C0.ESC+"OA":u.C0.ESC+"[A":c.key==="UIKeyInputLeftArrow"?g.key=f?u.C0.ESC+"OD":u.C0.ESC+"[D":c.key==="UIKeyInputRightArrow"?g.key=f?u.C0.ESC+"OC":u.C0.ESC+"[C":c.key==="UIKeyInputDownArrow"&&(g.key=f?u.C0.ESC+"OB":u.C0.ESC+"[B");break;case 8:g.key=c.ctrlKey?"\b":u.C0.DEL,c.altKey&&(g.key=u.C0.ESC+g.key);break;case 9:if(c.shiftKey){g.key=u.C0.ESC+"[Z";break}g.key=u.C0.HT,g.cancel=!0;break;case 13:g.key=c.altKey?u.C0.ESC+u.C0.CR:u.C0.CR,g.cancel=!0;break;case 27:g.key=u.C0.ESC,c.altKey&&(g.key=u.C0.ESC+u.C0.ESC),g.cancel=!0;break;case 37:if(c.metaKey)break;a?(g.key=u.C0.ESC+"[1;"+(a+1)+"D",g.key===u.C0.ESC+"[1;3D"&&(g.key=u.C0.ESC+(v?"b":"[1;5D"))):g.key=f?u.C0.ESC+"OD":u.C0.ESC+"[D";break;case 39:if(c.metaKey)break;a?(g.key=u.C0.ESC+"[1;"+(a+1)+"C",g.key===u.C0.ESC+"[1;3C"&&(g.key=u.C0.ESC+(v?"f":"[1;5C"))):g.key=f?u.C0.ESC+"OC":u.C0.ESC+"[C";break;case 38:if(c.metaKey)break;a?(g.key=u.C0.ESC+"[1;"+(a+1)+"A",v||g.key!==u.C0.ESC+"[1;3A"||(g.key=u.C0.ESC+"[1;5A")):g.key=f?u.C0.ESC+"OA":u.C0.ESC+"[A";break;case 40:if(c.metaKey)break;a?(g.key=u.C0.ESC+"[1;"+(a+1)+"B",v||g.key!==u.C0.ESC+"[1;3B"||(g.key=u.C0.ESC+"[1;5B")):g.key=f?u.C0.ESC+"OB":u.C0.ESC+"[B";break;case 45:c.shiftKey||c.ctrlKey||(g.key=u.C0.ESC+"[2~");break;case 46:g.key=a?u.C0.ESC+"[3;"+(a+1)+"~":u.C0.ESC+"[3~";break;case 36:g.key=a?u.C0.ESC+"[1;"+(a+1)+"H":f?u.C0.ESC+"OH":u.C0.ESC+"[H";break;case 35:g.key=a?u.C0.ESC+"[1;"+(a+1)+"F":f?u.C0.ESC+"OF":u.C0.ESC+"[F";break;case 33:c.shiftKey?g.type=2:c.ctrlKey?g.key=u.C0.ESC+"[5;"+(a+1)+"~":g.key=u.C0.ESC+"[5~";break;case 34:c.shiftKey?g.type=3:c.ctrlKey?g.key=u.C0.ESC+"[6;"+(a+1)+"~":g.key=u.C0.ESC+"[6~";break;case 112:g.key=a?u.C0.ESC+"[1;"+(a+1)+"P":u.C0.ESC+"OP";break;case 113:g.key=a?u.C0.ESC+"[1;"+(a+1)+"Q":u.C0.ESC+"OQ";break;case 114:g.key=a?u.C0.ESC+"[1;"+(a+1)+"R":u.C0.ESC+"OR";break;case 115:g.key=a?u.C0.ESC+"[1;"+(a+1)+"S":u.C0.ESC+"OS";break;case 116:g.key=a?u.C0.ESC+"[15;"+(a+1)+"~":u.C0.ESC+"[15~";break;case 117:g.key=a?u.C0.ESC+"[17;"+(a+1)+"~":u.C0.ESC+"[17~";break;case 118:g.key=a?u.C0.ESC+"[18;"+(a+1)+"~":u.C0.ESC+"[18~";break;case 119:g.key=a?u.C0.ESC+"[19;"+(a+1)+"~":u.C0.ESC+"[19~";break;case 120:g.key=a?u.C0.ESC+"[20;"+(a+1)+"~":u.C0.ESC+"[20~";break;case 121:g.key=a?u.C0.ESC+"[21;"+(a+1)+"~":u.C0.ESC+"[21~";break;case 122:g.key=a?u.C0.ESC+"[23;"+(a+1)+"~":u.C0.ESC+"[23~";break;case 123:g.key=a?u.C0.ESC+"[24;"+(a+1)+"~":u.C0.ESC+"[24~";break;default:if(!c.ctrlKey||c.shiftKey||c.altKey||c.metaKey)if(v&&!S||!c.altKey||c.metaKey)!v||c.altKey||c.ctrlKey||c.shiftKey||!c.metaKey?c.key&&!c.ctrlKey&&!c.altKey&&!c.metaKey&&c.keyCode>=48&&c.key.length===1?g.key=c.key:c.key&&c.ctrlKey&&(c.key==="_"&&(g.key=u.C0.US),c.key==="@"&&(g.key=u.C0.NUL)):c.keyCode===65&&(g.type=1);else{const t=m[c.keyCode],e=t?.[c.shiftKey?1:0];if(e)g.key=u.C0.ESC+e;else if(c.keyCode>=65&&c.keyCode<=90){const r=c.ctrlKey?c.keyCode-64:c.keyCode+32;let i=String.fromCharCode(r);c.shiftKey&&(i=i.toUpperCase()),g.key=u.C0.ESC+i}else if(c.keyCode===32)g.key=u.C0.ESC+(c.ctrlKey?u.C0.NUL:" ");else if(c.key==="Dead"&&c.code.startsWith("Key")){let r=c.code.slice(3,4);c.shiftKey||(r=r.toLowerCase()),g.key=u.C0.ESC+r,g.cancel=!0}}else c.keyCode>=65&&c.keyCode<=90?g.key=String.fromCharCode(c.keyCode-64):c.keyCode===32?g.key=u.C0.NUL:c.keyCode>=51&&c.keyCode<=55?g.key=String.fromCharCode(c.keyCode-51+27):c.keyCode===56?g.key=u.C0.DEL:c.keyCode===219?g.key=u.C0.ESC:c.keyCode===220?g.key=u.C0.FS:c.keyCode===221&&(g.key=u.C0.GS)}return g}},482:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Utf8ToUtf32=o.StringToUtf32=o.utf32ToString=o.stringFromCodePoint=void 0,o.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},o.utf32ToString=function(n,u=0,m=n.length){let c="";for(let f=u;f<m;++f){let v=n[f];v>65535?(v-=65536,c+=String.fromCharCode(55296+(v>>10))+String.fromCharCode(v%1024+56320)):c+=String.fromCharCode(v)}return c},o.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,u){const m=n.length;if(!m)return 0;let c=0,f=0;if(this._interim){const v=n.charCodeAt(f++);56320<=v&&v<=57343?u[c++]=1024*(this._interim-55296)+v-56320+65536:(u[c++]=this._interim,u[c++]=v),this._interim=0}for(let v=f;v<m;++v){const S=n.charCodeAt(v);if(55296<=S&&S<=56319){if(++v>=m)return this._interim=S,c;const g=n.charCodeAt(v);56320<=g&&g<=57343?u[c++]=1024*(S-55296)+g-56320+65536:(u[c++]=S,u[c++]=g)}else S!==65279&&(u[c++]=S)}return c}},o.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,u){const m=n.length;if(!m)return 0;let c,f,v,S,g=0,a=0,t=0;if(this.interim[0]){let i=!1,_=this.interim[0];_&=(224&_)==192?31:(240&_)==224?15:7;let l,b=0;for(;(l=63&this.interim[++b])&&b<4;)_<<=6,_|=l;const d=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=d-b;for(;t<y;){if(t>=m)return 0;if(l=n[t++],(192&l)!=128){t--,i=!0;break}this.interim[b++]=l,_<<=6,_|=63&l}i||(d===2?_<128?t--:u[g++]=_:d===3?_<2048||_>=55296&&_<=57343||_===65279||(u[g++]=_):_<65536||_>1114111||(u[g++]=_)),this.interim.fill(0)}const e=m-4;let r=t;for(;r<m;){for(;!(!(r<e)||128&(c=n[r])||128&(f=n[r+1])||128&(v=n[r+2])||128&(S=n[r+3]));)u[g++]=c,u[g++]=f,u[g++]=v,u[g++]=S,r+=4;if(c=n[r++],c<128)u[g++]=c;else if((224&c)==192){if(r>=m)return this.interim[0]=c,g;if(f=n[r++],(192&f)!=128){r--;continue}if(a=(31&c)<<6|63&f,a<128){r--;continue}u[g++]=a}else if((240&c)==224){if(r>=m)return this.interim[0]=c,g;if(f=n[r++],(192&f)!=128){r--;continue}if(r>=m)return this.interim[0]=c,this.interim[1]=f,g;if(v=n[r++],(192&v)!=128){r--;continue}if(a=(15&c)<<12|(63&f)<<6|63&v,a<2048||a>=55296&&a<=57343||a===65279)continue;u[g++]=a}else if((248&c)==240){if(r>=m)return this.interim[0]=c,g;if(f=n[r++],(192&f)!=128){r--;continue}if(r>=m)return this.interim[0]=c,this.interim[1]=f,g;if(v=n[r++],(192&v)!=128){r--;continue}if(r>=m)return this.interim[0]=c,this.interim[1]=f,this.interim[2]=v,g;if(S=n[r++],(192&S)!=128){r--;continue}if(a=(7&c)<<18|(63&f)<<12|(63&v)<<6|63&S,a<65536||a>1114111)continue;u[g++]=a}}return g}}},225:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeV6=void 0;const u=n(1480),m=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],c=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let f;o.UnicodeV6=class{constructor(){if(this.version="6",!f){f=new Uint8Array(65536),f.fill(1),f[0]=0,f.fill(0,1,32),f.fill(0,127,160),f.fill(2,4352,4448),f[9001]=2,f[9002]=2,f.fill(2,11904,42192),f[12351]=1,f.fill(2,44032,55204),f.fill(2,63744,64256),f.fill(2,65040,65050),f.fill(2,65072,65136),f.fill(2,65280,65377),f.fill(2,65504,65511);for(let v=0;v<m.length;++v)f.fill(0,m[v][0],m[v][1]+1)}}wcwidth(v){return v<32?0:v<127?1:v<65536?f[v]:(function(S,g){let a,t=0,e=g.length-1;if(S<g[0][0]||S>g[e][1])return!1;for(;e>=t;)if(a=t+e>>1,S>g[a][1])t=a+1;else{if(!(S<g[a][0]))return!0;e=a-1}return!1})(v,c)?0:v>=131072&&v<=196605||v>=196608&&v<=262141?2:1}charProperties(v,S){let g=this.wcwidth(v),a=g===0&&S!==0;if(a){const t=u.UnicodeService.extractWidth(S);t===0?a=!1:t>g&&(g=t)}return u.UnicodeService.createPropertyValue(0,g,a)}}},5981:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WriteBuffer=void 0;const u=n(8460),m=n(844);class c extends m.Disposable{constructor(v){super(),this._action=v,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new u.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(v,S){if(S!==void 0&&this._syncCalls>S)return void(this._syncCalls=0);if(this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let g;for(this._isSyncWriting=!0;g=this._writeBuffer.shift();){this._action(g);const a=this._callbacks.shift();a&&a()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(v,S){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(S),void this._innerWrite();setTimeout((()=>this._innerWrite()))}this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(S)}_innerWrite(v=0,S=!0){const g=v||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const a=this._writeBuffer[this._bufferOffset],t=this._action(a,S);if(t){const r=i=>Date.now()-g>=12?setTimeout((()=>this._innerWrite(0,i))):this._innerWrite(g,i);return void t.catch((i=>(queueMicrotask((()=>{throw i})),Promise.resolve(!1)))).then(r)}const e=this._callbacks[this._bufferOffset];if(e&&e(),this._bufferOffset++,this._pendingData-=a.length,Date.now()-g>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((()=>this._innerWrite()))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}o.WriteBuffer=c},5941:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toRgbString=o.parseColor=void 0;const n=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,u=/^[\da-f]+$/;function m(c,f){const v=c.toString(16),S=v.length<2?"0"+v:v;switch(f){case 4:return v[0];case 8:return S;case 12:return(S+S).slice(0,3);default:return S+S}}o.parseColor=function(c){if(!c)return;let f=c.toLowerCase();if(f.indexOf("rgb:")===0){f=f.slice(4);const v=n.exec(f);if(v){const S=v[1]?15:v[4]?255:v[7]?4095:65535;return[Math.round(parseInt(v[1]||v[4]||v[7]||v[10],16)/S*255),Math.round(parseInt(v[2]||v[5]||v[8]||v[11],16)/S*255),Math.round(parseInt(v[3]||v[6]||v[9]||v[12],16)/S*255)]}}else if(f.indexOf("#")===0&&(f=f.slice(1),u.exec(f)&&[3,6,9,12].includes(f.length))){const v=f.length/3,S=[0,0,0];for(let g=0;g<3;++g){const a=parseInt(f.slice(v*g,v*g+v),16);S[g]=v===1?a<<4:v===2?a:v===3?a>>4:a>>8}return S}},o.toRgbString=function(c,f=16){const[v,S,g]=c;return`rgb:${m(v,f)}/${m(S,f)}/${m(g,f)}`}},5770:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PAYLOAD_LIMIT=void 0,o.PAYLOAD_LIMIT=1e7},6351:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DcsHandler=o.DcsParser=void 0;const u=n(482),m=n(8742),c=n(5770),f=[];o.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=f,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=f}registerHandler(S,g){this._handlers[S]===void 0&&(this._handlers[S]=[]);const a=this._handlers[S];return a.push(g),{dispose:()=>{const t=a.indexOf(g);t!==-1&&a.splice(t,1)}}}clearHandler(S){this._handlers[S]&&delete this._handlers[S]}setHandlerFallback(S){this._handlerFb=S}reset(){if(this._active.length)for(let S=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;S>=0;--S)this._active[S].unhook(!1);this._stack.paused=!1,this._active=f,this._ident=0}hook(S,g){if(this.reset(),this._ident=S,this._active=this._handlers[S]||f,this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].hook(g);else this._handlerFb(this._ident,"HOOK",g)}put(S,g,a){if(this._active.length)for(let t=this._active.length-1;t>=0;t--)this._active[t].put(S,g,a);else this._handlerFb(this._ident,"PUT",(0,u.utf32ToString)(S,g,a))}unhook(S,g=!0){if(this._active.length){let a=!1,t=this._active.length-1,e=!1;if(this._stack.paused&&(t=this._stack.loopPosition-1,a=g,e=this._stack.fallThrough,this._stack.paused=!1),!e&&a===!1){for(;t>=0&&(a=this._active[t].unhook(S),a!==!0);t--)if(a instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=t,this._stack.fallThrough=!1,a;t--}for(;t>=0;t--)if(a=this._active[t].unhook(!1),a instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=t,this._stack.fallThrough=!0,a}else this._handlerFb(this._ident,"UNHOOK",S);this._active=f,this._ident=0}};const v=new m.Params;v.addParam(0),o.DcsHandler=class{constructor(S){this._handler=S,this._data="",this._params=v,this._hitLimit=!1}hook(S){this._params=S.length>1||S.params[0]?S.clone():v,this._data="",this._hitLimit=!1}put(S,g,a){this._hitLimit||(this._data+=(0,u.utf32ToString)(S,g,a),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(S){let g=!1;if(this._hitLimit)g=!1;else if(S&&(g=this._handler(this._data,this._params),g instanceof Promise))return g.then((a=>(this._params=v,this._data="",this._hitLimit=!1,a)));return this._params=v,this._data="",this._hitLimit=!1,g}}},2015:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.EscapeSequenceParser=o.VT500_TRANSITION_TABLE=o.TransitionTable=void 0;const u=n(844),m=n(8742),c=n(6242),f=n(6351);class v{constructor(t){this.table=new Uint8Array(t)}setDefault(t,e){this.table.fill(t<<4|e)}add(t,e,r,i){this.table[e<<8|t]=r<<4|i}addMany(t,e,r,i){for(let _=0;_<t.length;_++)this.table[e<<8|t[_]]=r<<4|i}}o.TransitionTable=v;const S=160;o.VT500_TRANSITION_TABLE=(function(){const a=new v(4095),t=Array.apply(null,Array(256)).map(((b,d)=>d)),e=(b,d)=>t.slice(b,d),r=e(32,127),i=e(0,24);i.push(25),i.push.apply(i,e(28,32));const _=e(0,14);let l;for(l in a.setDefault(1,0),a.addMany(r,0,2,0),_)a.addMany([24,26,153,154],l,3,0),a.addMany(e(128,144),l,3,0),a.addMany(e(144,152),l,3,0),a.add(156,l,0,0),a.add(27,l,11,1),a.add(157,l,4,8),a.addMany([152,158,159],l,0,7),a.add(155,l,11,3),a.add(144,l,11,9);return a.addMany(i,0,3,0),a.addMany(i,1,3,1),a.add(127,1,0,1),a.addMany(i,8,0,8),a.addMany(i,3,3,3),a.add(127,3,0,3),a.addMany(i,4,3,4),a.add(127,4,0,4),a.addMany(i,6,3,6),a.addMany(i,5,3,5),a.add(127,5,0,5),a.addMany(i,2,3,2),a.add(127,2,0,2),a.add(93,1,4,8),a.addMany(r,8,5,8),a.add(127,8,5,8),a.addMany([156,27,24,26,7],8,6,0),a.addMany(e(28,32),8,0,8),a.addMany([88,94,95],1,0,7),a.addMany(r,7,0,7),a.addMany(i,7,0,7),a.add(156,7,0,0),a.add(127,7,0,7),a.add(91,1,11,3),a.addMany(e(64,127),3,7,0),a.addMany(e(48,60),3,8,4),a.addMany([60,61,62,63],3,9,4),a.addMany(e(48,60),4,8,4),a.addMany(e(64,127),4,7,0),a.addMany([60,61,62,63],4,0,6),a.addMany(e(32,64),6,0,6),a.add(127,6,0,6),a.addMany(e(64,127),6,0,0),a.addMany(e(32,48),3,9,5),a.addMany(e(32,48),5,9,5),a.addMany(e(48,64),5,0,6),a.addMany(e(64,127),5,7,0),a.addMany(e(32,48),4,9,5),a.addMany(e(32,48),1,9,2),a.addMany(e(32,48),2,9,2),a.addMany(e(48,127),2,10,0),a.addMany(e(48,80),1,10,0),a.addMany(e(81,88),1,10,0),a.addMany([89,90,92],1,10,0),a.addMany(e(96,127),1,10,0),a.add(80,1,11,9),a.addMany(i,9,0,9),a.add(127,9,0,9),a.addMany(e(28,32),9,0,9),a.addMany(e(32,48),9,9,12),a.addMany(e(48,60),9,8,10),a.addMany([60,61,62,63],9,9,10),a.addMany(i,11,0,11),a.addMany(e(32,128),11,0,11),a.addMany(e(28,32),11,0,11),a.addMany(i,10,0,10),a.add(127,10,0,10),a.addMany(e(28,32),10,0,10),a.addMany(e(48,60),10,8,10),a.addMany([60,61,62,63],10,0,11),a.addMany(e(32,48),10,9,12),a.addMany(i,12,0,12),a.add(127,12,0,12),a.addMany(e(28,32),12,0,12),a.addMany(e(32,48),12,9,12),a.addMany(e(48,64),12,0,11),a.addMany(e(64,127),12,12,13),a.addMany(e(64,127),10,12,13),a.addMany(e(64,127),9,12,13),a.addMany(i,13,13,13),a.addMany(r,13,13,13),a.add(127,13,0,13),a.addMany([27,156,24,26],13,14,0),a.add(S,0,2,0),a.add(S,8,5,8),a.add(S,6,0,6),a.add(S,11,0,11),a.add(S,13,13,13),a})();class g extends u.Disposable{constructor(t=o.VT500_TRANSITION_TABLE){super(),this._transitions=t,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new m.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(e,r,i)=>{},this._executeHandlerFb=e=>{},this._csiHandlerFb=(e,r)=>{},this._escHandlerFb=e=>{},this._errorHandlerFb=e=>e,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,u.toDisposable)((()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)}))),this._oscParser=this.register(new c.OscParser),this._dcsParser=this.register(new f.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},(()=>!0))}_identifier(t,e=[64,126]){let r=0;if(t.prefix){if(t.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=t.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(t.intermediates){if(t.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let _=0;_<t.intermediates.length;++_){const l=t.intermediates.charCodeAt(_);if(32>l||l>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=l}}if(t.final.length!==1)throw new Error("final must be a single byte");const i=t.final.charCodeAt(0);if(e[0]>i||i>e[1])throw new Error(`final must be in range ${e[0]} .. ${e[1]}`);return r<<=8,r|=i,r}identToString(t){const e=[];for(;t;)e.push(String.fromCharCode(255&t)),t>>=8;return e.reverse().join("")}setPrintHandler(t){this._printHandler=t}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(t,e){const r=this._identifier(t,[48,126]);this._escHandlers[r]===void 0&&(this._escHandlers[r]=[]);const i=this._escHandlers[r];return i.push(e),{dispose:()=>{const _=i.indexOf(e);_!==-1&&i.splice(_,1)}}}clearEscHandler(t){this._escHandlers[this._identifier(t,[48,126])]&&delete this._escHandlers[this._identifier(t,[48,126])]}setEscHandlerFallback(t){this._escHandlerFb=t}setExecuteHandler(t,e){this._executeHandlers[t.charCodeAt(0)]=e}clearExecuteHandler(t){this._executeHandlers[t.charCodeAt(0)]&&delete this._executeHandlers[t.charCodeAt(0)]}setExecuteHandlerFallback(t){this._executeHandlerFb=t}registerCsiHandler(t,e){const r=this._identifier(t);this._csiHandlers[r]===void 0&&(this._csiHandlers[r]=[]);const i=this._csiHandlers[r];return i.push(e),{dispose:()=>{const _=i.indexOf(e);_!==-1&&i.splice(_,1)}}}clearCsiHandler(t){this._csiHandlers[this._identifier(t)]&&delete this._csiHandlers[this._identifier(t)]}setCsiHandlerFallback(t){this._csiHandlerFb=t}registerDcsHandler(t,e){return this._dcsParser.registerHandler(this._identifier(t),e)}clearDcsHandler(t){this._dcsParser.clearHandler(this._identifier(t))}setDcsHandlerFallback(t){this._dcsParser.setHandlerFallback(t)}registerOscHandler(t,e){return this._oscParser.registerHandler(t,e)}clearOscHandler(t){this._oscParser.clearHandler(t)}setOscHandlerFallback(t){this._oscParser.setHandlerFallback(t)}setErrorHandler(t){this._errorHandler=t}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(t,e,r,i,_){this._parseStack.state=t,this._parseStack.handlers=e,this._parseStack.handlerPos=r,this._parseStack.transition=i,this._parseStack.chunkPos=_}parse(t,e,r){let i,_=0,l=0,b=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,b=this._parseStack.chunkPos+1;else{if(r===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const d=this._parseStack.handlers;let y=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(r===!1&&y>-1){for(;y>=0&&(i=d[y](this._params),i!==!0);y--)if(i instanceof Promise)return this._parseStack.handlerPos=y,i}this._parseStack.handlers=[];break;case 4:if(r===!1&&y>-1){for(;y>=0&&(i=d[y](),i!==!0);y--)if(i instanceof Promise)return this._parseStack.handlerPos=y,i}this._parseStack.handlers=[];break;case 6:if(_=t[this._parseStack.chunkPos],i=this._dcsParser.unhook(_!==24&&_!==26,r),i)return i;_===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(_=t[this._parseStack.chunkPos],i=this._oscParser.end(_!==24&&_!==26,r),i)return i;_===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,b=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let d=b;d<e;++d){switch(_=t[d],l=this._transitions.table[this.currentState<<8|(_<160?_:S)],l>>4){case 2:for(let T=d+1;;++T){if(T>=e||(_=t[T])<32||_>126&&_<S){this._printHandler(t,d,T),d=T-1;break}if(++T>=e||(_=t[T])<32||_>126&&_<S){this._printHandler(t,d,T),d=T-1;break}if(++T>=e||(_=t[T])<32||_>126&&_<S){this._printHandler(t,d,T),d=T-1;break}if(++T>=e||(_=t[T])<32||_>126&&_<S){this._printHandler(t,d,T),d=T-1;break}}break;case 3:this._executeHandlers[_]?this._executeHandlers[_]():this._executeHandlerFb(_),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:d,code:_,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const y=this._csiHandlers[this._collect<<8|_];let M=y?y.length-1:-1;for(;M>=0&&(i=y[M](this._params),i!==!0);M--)if(i instanceof Promise)return this._preserveStack(3,y,M,l,d),i;M<0&&this._csiHandlerFb(this._collect<<8|_,this._params),this.precedingJoinState=0;break;case 8:do switch(_){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(_-48)}while(++d<e&&(_=t[d])>47&&_<60);d--;break;case 9:this._collect<<=8,this._collect|=_;break;case 10:const D=this._escHandlers[this._collect<<8|_];let N=D?D.length-1:-1;for(;N>=0&&(i=D[N](),i!==!0);N--)if(i instanceof Promise)return this._preserveStack(4,D,N,l,d),i;N<0&&this._escHandlerFb(this._collect<<8|_),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|_,this._params);break;case 13:for(let T=d+1;;++T)if(T>=e||(_=t[T])===24||_===26||_===27||_>127&&_<S){this._dcsParser.put(t,d,T),d=T-1;break}break;case 14:if(i=this._dcsParser.unhook(_!==24&&_!==26),i)return this._preserveStack(6,[],0,l,d),i;_===27&&(l|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let T=d+1;;T++)if(T>=e||(_=t[T])<32||_>127&&_<S){this._oscParser.put(t,d,T),d=T-1;break}break;case 6:if(i=this._oscParser.end(_!==24&&_!==26),i)return this._preserveStack(5,[],0,l,d),i;_===27&&(l|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&l}}}o.EscapeSequenceParser=g},6242:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OscHandler=o.OscParser=void 0;const u=n(5770),m=n(482),c=[];o.OscParser=class{constructor(){this._state=0,this._active=c,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(f,v){this._handlers[f]===void 0&&(this._handlers[f]=[]);const S=this._handlers[f];return S.push(v),{dispose:()=>{const g=S.indexOf(v);g!==-1&&S.splice(g,1)}}}clearHandler(f){this._handlers[f]&&delete this._handlers[f]}setHandlerFallback(f){this._handlerFb=f}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=c}reset(){if(this._state===2)for(let f=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;f>=0;--f)this._active[f].end(!1);this._stack.paused=!1,this._active=c,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||c,this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].start();else this._handlerFb(this._id,"START")}_put(f,v,S){if(this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].put(f,v,S);else this._handlerFb(this._id,"PUT",(0,m.utf32ToString)(f,v,S))}start(){this.reset(),this._state=1}put(f,v,S){if(this._state!==3){if(this._state===1)for(;v<S;){const g=f[v++];if(g===59){this._state=2,this._start();break}if(g<48||57<g)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+g-48}this._state===2&&S-v>0&&this._put(f,v,S)}}end(f,v=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let S=!1,g=this._active.length-1,a=!1;if(this._stack.paused&&(g=this._stack.loopPosition-1,S=v,a=this._stack.fallThrough,this._stack.paused=!1),!a&&S===!1){for(;g>=0&&(S=this._active[g].end(f),S!==!0);g--)if(S instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=g,this._stack.fallThrough=!1,S;g--}for(;g>=0;g--)if(S=this._active[g].end(!1),S instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=g,this._stack.fallThrough=!0,S}else this._handlerFb(this._id,"END",f);this._active=c,this._id=-1,this._state=0}}},o.OscHandler=class{constructor(f){this._handler=f,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(f,v,S){this._hitLimit||(this._data+=(0,m.utf32ToString)(f,v,S),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(f){let v=!1;if(this._hitLimit)v=!1;else if(f&&(v=this._handler(this._data),v instanceof Promise))return v.then((S=>(this._data="",this._hitLimit=!1,S)));return this._data="",this._hitLimit=!1,v}}},8742:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Params=void 0;const n=2147483647;class u{static fromArray(c){const f=new u;if(!c.length)return f;for(let v=Array.isArray(c[0])?1:0;v<c.length;++v){const S=c[v];if(Array.isArray(S))for(let g=0;g<S.length;++g)f.addSubParam(S[g]);else f.addParam(S)}return f}constructor(c=32,f=32){if(this.maxLength=c,this.maxSubParamsLength=f,f>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(c),this.length=0,this._subParams=new Int32Array(f),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(c),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const c=new u(this.maxLength,this.maxSubParamsLength);return c.params.set(this.params),c.length=this.length,c._subParams.set(this._subParams),c._subParamsLength=this._subParamsLength,c._subParamsIdx.set(this._subParamsIdx),c._rejectDigits=this._rejectDigits,c._rejectSubDigits=this._rejectSubDigits,c._digitIsSub=this._digitIsSub,c}toArray(){const c=[];for(let f=0;f<this.length;++f){c.push(this.params[f]);const v=this._subParamsIdx[f]>>8,S=255&this._subParamsIdx[f];S-v>0&&c.push(Array.prototype.slice.call(this._subParams,v,S))}return c}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(c){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=c>n?n:c}}addSubParam(c){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=c>n?n:c,this._subParamsIdx[this.length-1]++}}hasSubParams(c){return(255&this._subParamsIdx[c])-(this._subParamsIdx[c]>>8)>0}getSubParams(c){const f=this._subParamsIdx[c]>>8,v=255&this._subParamsIdx[c];return v-f>0?this._subParams.subarray(f,v):null}getSubParamsAll(){const c={};for(let f=0;f<this.length;++f){const v=this._subParamsIdx[f]>>8,S=255&this._subParamsIdx[f];S-v>0&&(c[f]=this._subParams.slice(v,S))}return c}addDigit(c){let f;if(this._rejectDigits||!(f=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const v=this._digitIsSub?this._subParams:this.params,S=v[f-1];v[f-1]=~S?Math.min(10*S+c,n):c}}o.Params=u},5741:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AddonManager=void 0,o.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let n=this._addons.length-1;n>=0;n--)this._addons[n].instance.dispose()}loadAddon(n,u){const m={instance:u,dispose:u.dispose,isDisposed:!1};this._addons.push(m),u.dispose=()=>this._wrappedAddonDispose(m),u.activate(n)}_wrappedAddonDispose(n){if(n.isDisposed)return;let u=-1;for(let m=0;m<this._addons.length;m++)if(this._addons[m]===n){u=m;break}if(u===-1)throw new Error("Could not dispose an addon that has not been loaded");n.isDisposed=!0,n.dispose.apply(n.instance),this._addons.splice(u,1)}}},8771:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferApiView=void 0;const u=n(3785),m=n(511);o.BufferApiView=class{constructor(c,f){this._buffer=c,this.type=f}init(c){return this._buffer=c,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(c){const f=this._buffer.lines.get(c);if(f)return new u.BufferLineApiView(f)}getNullCell(){return new m.CellData}}},3785:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLineApiView=void 0;const u=n(511);o.BufferLineApiView=class{constructor(m){this._line=m}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(m,c){if(!(m<0||m>=this._line.length))return c?(this._line.loadCell(m,c),c):this._line.loadCell(m,new u.CellData)}translateToString(m,c,f){return this._line.translateToString(m,c,f)}}},8285:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferNamespaceApi=void 0;const u=n(8771),m=n(8460),c=n(844);class f extends c.Disposable{constructor(S){super(),this._core=S,this._onBufferChange=this.register(new m.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new u.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new u.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((()=>this._onBufferChange.fire(this.active)))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}o.BufferNamespaceApi=f},7975:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ParserApi=void 0,o.ParserApi=class{constructor(n){this._core=n}registerCsiHandler(n,u){return this._core.registerCsiHandler(n,(m=>u(m.toArray())))}addCsiHandler(n,u){return this.registerCsiHandler(n,u)}registerDcsHandler(n,u){return this._core.registerDcsHandler(n,((m,c)=>u(m,c.toArray())))}addDcsHandler(n,u){return this.registerDcsHandler(n,u)}registerEscHandler(n,u){return this._core.registerEscHandler(n,u)}addEscHandler(n,u){return this.registerEscHandler(n,u)}registerOscHandler(n,u){return this._core.registerOscHandler(n,u)}addOscHandler(n,u){return this.registerOscHandler(n,u)}}},7090:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeApi=void 0,o.UnicodeApi=class{constructor(n){this._core=n}register(n){this._core.unicodeService.register(n)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(n){this._core.unicodeService.activeVersion=n}}},744:function(I,o,n){var u=this&&this.__decorate||function(a,t,e,r){var i,_=arguments.length,l=_<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,e):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,t,e,r);else for(var b=a.length-1;b>=0;b--)(i=a[b])&&(l=(_<3?i(l):_>3?i(t,e,l):i(t,e))||l);return _>3&&l&&Object.defineProperty(t,e,l),l},m=this&&this.__param||function(a,t){return function(e,r){t(e,r,a)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferService=o.MINIMUM_ROWS=o.MINIMUM_COLS=void 0;const c=n(8460),f=n(844),v=n(5295),S=n(2585);o.MINIMUM_COLS=2,o.MINIMUM_ROWS=1;let g=o.BufferService=class extends f.Disposable{get buffer(){return this.buffers.active}constructor(a){super(),this.isUserScrolling=!1,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new c.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(a.rawOptions.cols||0,o.MINIMUM_COLS),this.rows=Math.max(a.rawOptions.rows||0,o.MINIMUM_ROWS),this.buffers=this.register(new v.BufferSet(a,this))}resize(a,t){this.cols=a,this.rows=t,this.buffers.resize(a,t),this._onResize.fire({cols:a,rows:t})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(a,t=!1){const e=this.buffer;let r;r=this._cachedBlankLine,r&&r.length===this.cols&&r.getFg(0)===a.fg&&r.getBg(0)===a.bg||(r=e.getBlankLine(a,t),this._cachedBlankLine=r),r.isWrapped=t;const i=e.ybase+e.scrollTop,_=e.ybase+e.scrollBottom;if(e.scrollTop===0){const l=e.lines.isFull;_===e.lines.length-1?l?e.lines.recycle().copyFrom(r):e.lines.push(r.clone()):e.lines.splice(_+1,0,r.clone()),l?this.isUserScrolling&&(e.ydisp=Math.max(e.ydisp-1,0)):(e.ybase++,this.isUserScrolling||e.ydisp++)}else{const l=_-i+1;e.lines.shiftElements(i+1,l-1,-1),e.lines.set(_,r.clone())}this.isUserScrolling||(e.ydisp=e.ybase),this._onScroll.fire(e.ydisp)}scrollLines(a,t,e){const r=this.buffer;if(a<0){if(r.ydisp===0)return;this.isUserScrolling=!0}else a+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);const i=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+a,r.ybase),0),i!==r.ydisp&&(t||this._onScroll.fire(r.ydisp))}};o.BufferService=g=u([m(0,S.IOptionsService)],g)},7994:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CharsetService=void 0,o.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(n){this.glevel=n,this.charset=this._charsets[n]}setgCharset(n,u){this._charsets[n]=u,this.glevel===n&&(this.charset=u)}}},1753:function(I,o,n){var u=this&&this.__decorate||function(r,i,_,l){var b,d=arguments.length,y=d<3?i:l===null?l=Object.getOwnPropertyDescriptor(i,_):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(r,i,_,l);else for(var M=r.length-1;M>=0;M--)(b=r[M])&&(y=(d<3?b(y):d>3?b(i,_,y):b(i,_))||y);return d>3&&y&&Object.defineProperty(i,_,y),y},m=this&&this.__param||function(r,i){return function(_,l){i(_,l,r)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreMouseService=void 0;const c=n(2585),f=n(8460),v=n(844),S={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:r=>r.button!==4&&r.action===1&&(r.ctrl=!1,r.alt=!1,r.shift=!1,!0)},VT200:{events:19,restrict:r=>r.action!==32},DRAG:{events:23,restrict:r=>r.action!==32||r.button!==3},ANY:{events:31,restrict:r=>!0}};function g(r,i){let _=(r.ctrl?16:0)|(r.shift?4:0)|(r.alt?8:0);return r.button===4?(_|=64,_|=r.action):(_|=3&r.button,4&r.button&&(_|=64),8&r.button&&(_|=128),r.action===32?_|=32:r.action!==0||i||(_|=3)),_}const a=String.fromCharCode,t={DEFAULT:r=>{const i=[g(r,!1)+32,r.col+32,r.row+32];return i[0]>255||i[1]>255||i[2]>255?"":`\x1B[M${a(i[0])}${a(i[1])}${a(i[2])}`},SGR:r=>{const i=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${g(r,!0)};${r.col};${r.row}${i}`},SGR_PIXELS:r=>{const i=r.action===0&&r.button!==4?"m":"M";return`\x1B[<${g(r,!0)};${r.x};${r.y}${i}`}};let e=o.CoreMouseService=class extends v.Disposable{constructor(r,i){super(),this._bufferService=r,this._coreService=i,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new f.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const _ of Object.keys(S))this.addProtocol(_,S[_]);for(const _ of Object.keys(t))this.addEncoding(_,t[_]);this.reset()}addProtocol(r,i){this._protocols[r]=i}addEncoding(r,i){this._encodings[r]=i}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(r){if(!this._protocols[r])throw new Error(`unknown protocol "${r}"`);this._activeProtocol=r,this._onProtocolChange.fire(this._protocols[r].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(r){if(!this._encodings[r])throw new Error(`unknown encoding "${r}"`);this._activeEncoding=r}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(r){if(r.col<0||r.col>=this._bufferService.cols||r.row<0||r.row>=this._bufferService.rows||r.button===4&&r.action===32||r.button===3&&r.action!==32||r.button!==4&&(r.action===2||r.action===3)||(r.col++,r.row++,r.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,r,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(r))return!1;const i=this._encodings[this._activeEncoding](r);return i&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(i):this._coreService.triggerDataEvent(i,!0)),this._lastEvent=r,!0}explainEvents(r){return{down:!!(1&r),up:!!(2&r),drag:!!(4&r),move:!!(8&r),wheel:!!(16&r)}}_equalEvents(r,i,_){if(_){if(r.x!==i.x||r.y!==i.y)return!1}else if(r.col!==i.col||r.row!==i.row)return!1;return r.button===i.button&&r.action===i.action&&r.ctrl===i.ctrl&&r.alt===i.alt&&r.shift===i.shift}};o.CoreMouseService=e=u([m(0,c.IBufferService),m(1,c.ICoreService)],e)},6975:function(I,o,n){var u=this&&this.__decorate||function(e,r,i,_){var l,b=arguments.length,d=b<3?r:_===null?_=Object.getOwnPropertyDescriptor(r,i):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(e,r,i,_);else for(var y=e.length-1;y>=0;y--)(l=e[y])&&(d=(b<3?l(d):b>3?l(r,i,d):l(r,i))||d);return b>3&&d&&Object.defineProperty(r,i,d),d},m=this&&this.__param||function(e,r){return function(i,_){r(i,_,e)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreService=void 0;const c=n(1439),f=n(8460),v=n(844),S=n(2585),g=Object.freeze({insertMode:!1}),a=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let t=o.CoreService=class extends v.Disposable{constructor(e,r,i){super(),this._bufferService=e,this._logService=r,this._optionsService=i,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new f.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new f.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new f.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new f.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,c.clone)(g),this.decPrivateModes=(0,c.clone)(a)}reset(){this.modes=(0,c.clone)(g),this.decPrivateModes=(0,c.clone)(a)}triggerDataEvent(e,r=!1){if(this._optionsService.rawOptions.disableStdin)return;const i=this._bufferService.buffer;r&&this._optionsService.rawOptions.scrollOnUserInput&&i.ybase!==i.ydisp&&this._onRequestScrollToBottom.fire(),r&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`,(()=>e.split("").map((_=>_.charCodeAt(0))))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`,(()=>e.split("").map((r=>r.charCodeAt(0))))),this._onBinary.fire(e))}};o.CoreService=t=u([m(0,S.IBufferService),m(1,S.ILogService),m(2,S.IOptionsService)],t)},9074:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DecorationService=void 0;const u=n(8055),m=n(8460),c=n(844),f=n(6106);let v=0,S=0;class g extends c.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new f.SortedList((e=>e?.marker.line)),this._onDecorationRegistered=this.register(new m.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new m.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,c.toDisposable)((()=>this.reset())))}registerDecoration(e){if(e.marker.isDisposed)return;const r=new a(e);if(r){const i=r.marker.onDispose((()=>r.dispose()));r.onDispose((()=>{r&&(this._decorations.delete(r)&&this._onDecorationRemoved.fire(r),i.dispose())})),this._decorations.insert(r),this._onDecorationRegistered.fire(r)}return r}reset(){for(const e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,r,i){let _=0,l=0;for(const b of this._decorations.getKeyIterator(r))_=b.options.x??0,l=_+(b.options.width??1),e>=_&&e<l&&(!i||(b.options.layer??"bottom")===i)&&(yield b)}forEachDecorationAtCell(e,r,i,_){this._decorations.forEachByKey(r,(l=>{v=l.options.x??0,S=v+(l.options.width??1),e>=v&&e<S&&(!i||(l.options.layer??"bottom")===i)&&_(l)}))}}o.DecorationService=g;class a extends c.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=u.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=u.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(e){super(),this.options=e,this.onRenderEmitter=this.register(new m.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new m.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.InstantiationService=o.ServiceCollection=void 0;const u=n(2585),m=n(8343);class c{constructor(...v){this._entries=new Map;for(const[S,g]of v)this.set(S,g)}set(v,S){const g=this._entries.get(v);return this._entries.set(v,S),g}forEach(v){for(const[S,g]of this._entries.entries())v(S,g)}has(v){return this._entries.has(v)}get(v){return this._entries.get(v)}}o.ServiceCollection=c,o.InstantiationService=class{constructor(){this._services=new c,this._services.set(u.IInstantiationService,this)}setService(f,v){this._services.set(f,v)}getService(f){return this._services.get(f)}createInstance(f,...v){const S=(0,m.getServiceDependencies)(f).sort(((t,e)=>t.index-e.index)),g=[];for(const t of S){const e=this._services.get(t.id);if(!e)throw new Error(`[createInstance] ${f.name} depends on UNKNOWN service ${t.id}.`);g.push(e)}const a=S.length>0?S[0].index:v.length;if(v.length!==a)throw new Error(`[createInstance] First service dependency of ${f.name} at position ${a+1} conflicts with ${v.length} static arguments`);return new f(...v,...g)}}},7866:function(I,o,n){var u=this&&this.__decorate||function(a,t,e,r){var i,_=arguments.length,l=_<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,e):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,t,e,r);else for(var b=a.length-1;b>=0;b--)(i=a[b])&&(l=(_<3?i(l):_>3?i(t,e,l):i(t,e))||l);return _>3&&l&&Object.defineProperty(t,e,l),l},m=this&&this.__param||function(a,t){return function(e,r){t(e,r,a)}};Object.defineProperty(o,"__esModule",{value:!0}),o.traceCall=o.setTraceLogger=o.LogService=void 0;const c=n(844),f=n(2585),v={trace:f.LogLevelEnum.TRACE,debug:f.LogLevelEnum.DEBUG,info:f.LogLevelEnum.INFO,warn:f.LogLevelEnum.WARN,error:f.LogLevelEnum.ERROR,off:f.LogLevelEnum.OFF};let S,g=o.LogService=class extends c.Disposable{get logLevel(){return this._logLevel}constructor(a){super(),this._optionsService=a,this._logLevel=f.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",(()=>this._updateLogLevel()))),S=this}_updateLogLevel(){this._logLevel=v[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(a){for(let t=0;t<a.length;t++)typeof a[t]=="function"&&(a[t]=a[t]())}_log(a,t,e){this._evalLazyOptionalParams(e),a.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+t,...e)}trace(a,...t){this._logLevel<=f.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,a,t)}debug(a,...t){this._logLevel<=f.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,a,t)}info(a,...t){this._logLevel<=f.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,a,t)}warn(a,...t){this._logLevel<=f.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,a,t)}error(a,...t){this._logLevel<=f.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,a,t)}};o.LogService=g=u([m(0,f.IOptionsService)],g),o.setTraceLogger=function(a){S=a},o.traceCall=function(a,t,e){if(typeof e.value!="function")throw new Error("not supported");const r=e.value;e.value=function(...i){if(S.logLevel!==f.LogLevelEnum.TRACE)return r.apply(this,i);S.trace(`GlyphRenderer#${r.name}(${i.map((l=>JSON.stringify(l))).join(", ")})`);const _=r.apply(this,i);return S.trace(`GlyphRenderer#${r.name} return`,_),_}}},7302:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OptionsService=o.DEFAULT_OPTIONS=void 0;const u=n(8460),m=n(844),c=n(6114);o.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:c.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const f=["normal","bold","100","200","300","400","500","600","700","800","900"];class v extends m.Disposable{constructor(g){super(),this._onOptionChange=this.register(new u.EventEmitter),this.onOptionChange=this._onOptionChange.event;const a={...o.DEFAULT_OPTIONS};for(const t in g)if(t in a)try{const e=g[t];a[t]=this._sanitizeAndValidateOption(t,e)}catch(e){console.error(e)}this.rawOptions=a,this.options={...a},this._setupOptions(),this.register((0,m.toDisposable)((()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null})))}onSpecificOptionChange(g,a){return this.onOptionChange((t=>{t===g&&a(this.rawOptions[g])}))}onMultipleOptionChange(g,a){return this.onOptionChange((t=>{g.indexOf(t)!==-1&&a()}))}_setupOptions(){const g=t=>{if(!(t in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${t}"`);return this.rawOptions[t]},a=(t,e)=>{if(!(t in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${t}"`);e=this._sanitizeAndValidateOption(t,e),this.rawOptions[t]!==e&&(this.rawOptions[t]=e,this._onOptionChange.fire(t))};for(const t in this.rawOptions){const e={get:g.bind(this,t),set:a.bind(this,t)};Object.defineProperty(this.options,t,e)}}_sanitizeAndValidateOption(g,a){switch(g){case"cursorStyle":if(a||(a=o.DEFAULT_OPTIONS[g]),!(function(t){return t==="block"||t==="underline"||t==="bar"})(a))throw new Error(`"${a}" is not a valid value for ${g}`);break;case"wordSeparator":a||(a=o.DEFAULT_OPTIONS[g]);break;case"fontWeight":case"fontWeightBold":if(typeof a=="number"&&1<=a&&a<=1e3)break;a=f.includes(a)?a:o.DEFAULT_OPTIONS[g];break;case"cursorWidth":a=Math.floor(a);case"lineHeight":case"tabStopWidth":if(a<1)throw new Error(`${g} cannot be less than 1, value: ${a}`);break;case"minimumContrastRatio":a=Math.max(1,Math.min(21,Math.round(10*a)/10));break;case"scrollback":if((a=Math.min(a,4294967295))<0)throw new Error(`${g} cannot be less than 0, value: ${a}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(a<=0)throw new Error(`${g} cannot be less than or equal to 0, value: ${a}`);break;case"rows":case"cols":if(!a&&a!==0)throw new Error(`${g} must be numeric, value: ${a}`);break;case"windowsPty":a=a??{}}return a}}o.OptionsService=v},2660:function(I,o,n){var u=this&&this.__decorate||function(v,S,g,a){var t,e=arguments.length,r=e<3?S:a===null?a=Object.getOwnPropertyDescriptor(S,g):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(v,S,g,a);else for(var i=v.length-1;i>=0;i--)(t=v[i])&&(r=(e<3?t(r):e>3?t(S,g,r):t(S,g))||r);return e>3&&r&&Object.defineProperty(S,g,r),r},m=this&&this.__param||function(v,S){return function(g,a){S(g,a,v)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkService=void 0;const c=n(2585);let f=o.OscLinkService=class{constructor(v){this._bufferService=v,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(v){const S=this._bufferService.buffer;if(v.id===void 0){const i=S.addMarker(S.ybase+S.y),_={data:v,id:this._nextId++,lines:[i]};return i.onDispose((()=>this._removeMarkerFromLink(_,i))),this._dataByLinkId.set(_.id,_),_.id}const g=v,a=this._getEntryIdKey(g),t=this._entriesWithId.get(a);if(t)return this.addLineToLink(t.id,S.ybase+S.y),t.id;const e=S.addMarker(S.ybase+S.y),r={id:this._nextId++,key:this._getEntryIdKey(g),data:g,lines:[e]};return e.onDispose((()=>this._removeMarkerFromLink(r,e))),this._entriesWithId.set(r.key,r),this._dataByLinkId.set(r.id,r),r.id}addLineToLink(v,S){const g=this._dataByLinkId.get(v);if(g&&g.lines.every((a=>a.line!==S))){const a=this._bufferService.buffer.addMarker(S);g.lines.push(a),a.onDispose((()=>this._removeMarkerFromLink(g,a)))}}getLinkData(v){return this._dataByLinkId.get(v)?.data}_getEntryIdKey(v){return`${v.id};;${v.uri}`}_removeMarkerFromLink(v,S){const g=v.lines.indexOf(S);g!==-1&&(v.lines.splice(g,1),v.lines.length===0&&(v.data.id!==void 0&&this._entriesWithId.delete(v.key),this._dataByLinkId.delete(v.id)))}};o.OscLinkService=f=u([m(0,c.IBufferService)],f)},8343:(I,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createDecorator=o.getServiceDependencies=o.serviceRegistry=void 0;const n="di$target",u="di$dependencies";o.serviceRegistry=new Map,o.getServiceDependencies=function(m){return m[u]||[]},o.createDecorator=function(m){if(o.serviceRegistry.has(m))return o.serviceRegistry.get(m);const c=function(f,v,S){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(g,a,t){a[n]===a?a[u].push({id:g,index:t}):(a[u]=[{id:g,index:t}],a[n]=a)})(c,f,S)};return c.toString=()=>m,o.serviceRegistry.set(m,c),c}},2585:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.IDecorationService=o.IUnicodeService=o.IOscLinkService=o.IOptionsService=o.ILogService=o.LogLevelEnum=o.IInstantiationService=o.ICharsetService=o.ICoreService=o.ICoreMouseService=o.IBufferService=void 0;const u=n(8343);var m;o.IBufferService=(0,u.createDecorator)("BufferService"),o.ICoreMouseService=(0,u.createDecorator)("CoreMouseService"),o.ICoreService=(0,u.createDecorator)("CoreService"),o.ICharsetService=(0,u.createDecorator)("CharsetService"),o.IInstantiationService=(0,u.createDecorator)("InstantiationService"),(function(c){c[c.TRACE=0]="TRACE",c[c.DEBUG=1]="DEBUG",c[c.INFO=2]="INFO",c[c.WARN=3]="WARN",c[c.ERROR=4]="ERROR",c[c.OFF=5]="OFF"})(m||(o.LogLevelEnum=m={})),o.ILogService=(0,u.createDecorator)("LogService"),o.IOptionsService=(0,u.createDecorator)("OptionsService"),o.IOscLinkService=(0,u.createDecorator)("OscLinkService"),o.IUnicodeService=(0,u.createDecorator)("UnicodeService"),o.IDecorationService=(0,u.createDecorator)("DecorationService")},1480:(I,o,n)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeService=void 0;const u=n(8460),m=n(225);class c{static extractShouldJoin(v){return(1&v)!=0}static extractWidth(v){return v>>1&3}static extractCharKind(v){return v>>3}static createPropertyValue(v,S,g=!1){return(16777215&v)<<3|(3&S)<<1|(g?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new u.EventEmitter,this.onChange=this._onChange.event;const v=new m.UnicodeV6;this.register(v),this._active=v.version,this._activeProvider=v}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(v){if(!this._providers[v])throw new Error(`unknown Unicode version "${v}"`);this._active=v,this._activeProvider=this._providers[v],this._onChange.fire(v)}register(v){this._providers[v.version]=v}wcwidth(v){return this._activeProvider.wcwidth(v)}getStringCellWidth(v){let S=0,g=0;const a=v.length;for(let t=0;t<a;++t){let e=v.charCodeAt(t);if(55296<=e&&e<=56319){if(++t>=a)return S+this.wcwidth(e);const _=v.charCodeAt(t);56320<=_&&_<=57343?e=1024*(e-55296)+_-56320+65536:S+=this.wcwidth(_)}const r=this.charProperties(e,g);let i=c.extractWidth(r);c.extractShouldJoin(r)&&(i-=c.extractWidth(g)),S+=i,g=r}return S}charProperties(v,S){return this._activeProvider.charProperties(v,S)}}o.UnicodeService=c}},w={};function k(I){var o=w[I];if(o!==void 0)return o.exports;var n=w[I]={exports:{}};return C[I].call(n.exports,n,n.exports,k),n.exports}var j={};return(()=>{var I=j;Object.defineProperty(I,"__esModule",{value:!0}),I.Terminal=void 0;const o=k(9042),n=k(3236),u=k(844),m=k(5741),c=k(8285),f=k(7975),v=k(7090),S=["cols","rows"];class g extends u.Disposable{constructor(t){super(),this._core=this.register(new n.Terminal(t)),this._addonManager=this.register(new m.AddonManager),this._publicOptions={...this._core.options};const e=i=>this._core.options[i],r=(i,_)=>{this._checkReadonlyOptions(i),this._core.options[i]=_};for(const i in this._core.options){const _={get:e.bind(this,i),set:r.bind(this,i)};Object.defineProperty(this._publicOptions,i,_)}}_checkReadonlyOptions(t){if(S.includes(t))throw new Error(`Option "${t}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new f.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new v.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new c.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const t=this._core.coreService.decPrivateModes;let e="none";switch(this._core.coreMouseService.activeProtocol){case"X10":e="x10";break;case"VT200":e="vt200";break;case"DRAG":e="drag";break;case"ANY":e="any"}return{applicationCursorKeysMode:t.applicationCursorKeys,applicationKeypadMode:t.applicationKeypad,bracketedPasteMode:t.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:e,originMode:t.origin,reverseWraparoundMode:t.reverseWraparound,sendFocusMode:t.sendFocus,wraparoundMode:t.wraparound}}get options(){return this._publicOptions}set options(t){for(const e in t)this._publicOptions[e]=t[e]}blur(){this._core.blur()}focus(){this._core.focus()}input(t,e=!0){this._core.input(t,e)}resize(t,e){this._verifyIntegers(t,e),this._core.resize(t,e)}open(t){this._core.open(t)}attachCustomKeyEventHandler(t){this._core.attachCustomKeyEventHandler(t)}attachCustomWheelEventHandler(t){this._core.attachCustomWheelEventHandler(t)}registerLinkProvider(t){return this._core.registerLinkProvider(t)}registerCharacterJoiner(t){return this._checkProposedApi(),this._core.registerCharacterJoiner(t)}deregisterCharacterJoiner(t){this._checkProposedApi(),this._core.deregisterCharacterJoiner(t)}registerMarker(t=0){return this._verifyIntegers(t),this._core.registerMarker(t)}registerDecoration(t){return this._checkProposedApi(),this._verifyPositiveIntegers(t.x??0,t.width??0,t.height??0),this._core.registerDecoration(t)}hasSelection(){return this._core.hasSelection()}select(t,e,r){this._verifyIntegers(t,e,r),this._core.select(t,e,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(t,e){this._verifyIntegers(t,e),this._core.selectLines(t,e)}dispose(){super.dispose()}scrollLines(t){this._verifyIntegers(t),this._core.scrollLines(t)}scrollPages(t){this._verifyIntegers(t),this._core.scrollPages(t)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(t){this._verifyIntegers(t),this._core.scrollToLine(t)}clear(){this._core.clear()}write(t,e){this._core.write(t,e)}writeln(t,e){this._core.write(t),this._core.write(`\r
`,e)}paste(t){this._core.paste(t)}refresh(t,e){this._verifyIntegers(t,e),this._core.refresh(t,e)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(t){this._addonManager.loadAddon(this,t)}static get strings(){return o}_verifyIntegers(...t){for(const e of t)if(e===1/0||isNaN(e)||e%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...t){for(const e of t)if(e&&(e===1/0||isNaN(e)||e%1!=0||e<0))throw new Error("This API only accepts positive integers")}}I.Terminal=g})(),j})()))})(Gs)),Gs.exports}var wu=yu();function xu(s,p=!1){return{action:Ci.RUN,args:{command:s,hidden:p}}}const Eu=s=>{const p=/(.*)\[Python Interpreter: (.*)\]/s,C=s.match(p);return C?C[1]?.trim()||"":s},bi=(s,p,C=!1)=>{const{content:w,type:k}=s;k==="input"&&C||p.writeln(Eu(w.replaceAll(`
`,`\r
`).trim()))},ku={current:0},Au=()=>{const{send:s}=As(),{curAgentState:p}=Mt(),C=Li(a=>a.commands),w=pe.useRef(null),k=pe.useRef(null),j=pe.useRef(null),I=ku,o=pe.useRef(null),n=lr.includes(p),u=()=>new wu.Terminal({fontFamily:"Menlo, Monaco, 'Courier New', monospace",fontSize:14,scrollback:1e3,scrollSensitivity:1,fastScrollModifier:"alt",fastScrollSensitivity:5,allowTransparency:!0,theme:{background:"transparent"}}),m=()=>{w.current&&(k.current&&w.current.loadAddon(k.current),j.current&&w.current.open(j.current))},c=a=>{const t=new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"})});navigator.clipboard.write([t])},f=a=>{navigator.clipboard.readText().then(a)},v=(a,t)=>{if(a.type==="keydown"&&(a.ctrlKey||a.metaKey)&&(a.code==="KeyV"&&f(r=>{w.current?.write(r),t(r)}),a.code==="KeyC")){const r=w.current?.getSelection();r&&c(r)}return!0},S=a=>{w.current?.write(`\r
`),s(xu(a))},g=a=>(w.current?.write("\b \b"),a.slice(0,-1));return pe.useEffect(()=>{if(w.current=u(),k.current=new Su.FitAddon,j.current){if(m(),C.length>0){for(let a=0;a<C.length;a+=1)C[a].type==="input"&&w.current.write("$ "),bi(C[a],w.current,!1);I.current=C.length}w.current.write("$ ")}return()=>{w.current?.dispose()}},[]),pe.useEffect(()=>{if(w.current&&C.length>0&&I.current<C.length){let a="";for(let t=I.current;t<C.length;t+=1)a=C[t].type,bi(C[t],w.current,!0);I.current=C.length,a==="output"&&w.current.write("$ ")}},[C,n]),pe.useEffect(()=>{let a=null;return a=new ResizeObserver(()=>{k.current?.fit()}),j.current&&a.observe(j.current),()=>{a?.disconnect()}},[]),pe.useEffect(()=>{if(w.current){o.current&&(o.current.dispose(),o.current=null);let a="";n?o.current=w.current.onKey(t=>{t.domEvent.preventDefault(),t.domEvent.stopPropagation()}):(o.current=w.current.onKey(({key:t,domEvent:e})=>{if(e.key==="Enter")S(a),a="";else if(e.key==="Backspace")a.length>0&&(a=g(a));else{if(t.charCodeAt(0)===22)return;a+=t,w.current?.write(t)}}),w.current.attachCustomKeyEventHandler(t=>v(t,e=>{a+=e})))}return()=>{o.current&&(o.current.dispose(),o.current=null)}},[n]),j};function Mu({className:s,testId:p}){const{t:C}=ge();return h.jsx("div",{"data-testid":p,className:Ee("w-full h-full flex items-center text-center justify-center text-2xl text-tertiary-light",s),children:C("DIFF_VIEWER$WAITING_FOR_RUNTIME")})}function Lu(){const{curAgentState:s}=Mt(),p=lr.includes(s),C=Au();return h.jsxs("div",{className:"h-full flex flex-col rounded-xl",children:[p&&h.jsx(Mu,{className:"pt-16"}),h.jsx("div",{className:"flex-1 min-h-0 p-4",children:h.jsx("div",{ref:C,className:Ee("w-full h-full",p?"p-0 w-0 h-0 opacity-0 overflow-hidden":"")})})]})}const Ru=H.lazy(()=>Xt(()=>import("./changes-tab-DH5okyKh.js"),__vite__mapDeps([7,3,8,4,5,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,6,30,31,32,2,33,34,35,36,37,38,39,40,41,42,43,44,45]))),Tu=H.lazy(()=>Xt(()=>import("./browser-tab-DVyPwqaf.js"),__vite__mapDeps([46,3,15,10,28,8,17,16,18,13,14,4,5,19,20,21,22,11,23,24,25,9,26,27,29,6]))),Ou=H.lazy(()=>Xt(()=>import("./jupyter-tab-Cmu-ipGC.js"),__vite__mapDeps([47,3,17,10,16,18,13,14,15,4,5,8,19,20,21,22,11,23,24,25,9,26,27,28,29,6,30,31,32,2,33,34,35,36,37,38,39,40,41,42,43,44,45]))),Du=H.lazy(()=>Xt(()=>import("./served-tab-3shvPpXw.js"),__vite__mapDeps([48,3,8,17,10,16,18,13,14,15,4,5,19,20,21,22,11,23,24,25,9,26,27,28,29,6,49,30,31,32,2,33,34,35,36,37,38,39,40,41,42,43,44,45]))),Iu=H.lazy(()=>Xt(()=>import("./vscode-tab-BEdFrplA.js"),__vite__mapDeps([50,3,15,10,17,16,18,13,14,4,5,8,19,20,21,22,11,23,24,25,9,26,27,28,29,6,30,31,32,2,33,34,35,36,37,38,39,40,41,42,43,44,45])));function vn(){const{selectedTab:s,shouldShownAgentLoading:p}=gt(),{t:C}=ge(),w=s==="editor",k=s==="browser",j=s==="jupyter",I=s==="served",o=s==="vscode",n=s==="terminal",u=[{key:"editor",component:Ru,isActive:w},{key:"browser",component:Tu,isActive:k},{key:"jupyter",component:Ou,isActive:j},{key:"served",component:Du,isActive:I},{key:"vscode",component:Iu,isActive:o},{key:"terminal",component:Lu,isActive:n}],m=H.useMemo(()=>w?C(Z.COMMON$CHANGES):k?C(Z.COMMON$BROWSER):j?C(Z.COMMON$JUPYTER):I?C(Z.COMMON$APP):o?C(Z.COMMON$CODE):n?C(Z.COMMON$TERMINAL):"",[w,k,j,I,o,n]);return p?h.jsx(_u,{}):h.jsxs(gu,{children:[h.jsx(bu,{title:m}),h.jsx(vu,{children:u.map(({key:c,component:f,isActive:v})=>h.jsx(mu,{isActive:v,children:h.jsx(f,{})},c))})]})}function ju(){return h.jsxs("div",{className:"relative flex-1 flex flex-col",children:[h.jsx("div",{className:"bg-base overflow-hidden flex-1",children:h.jsx(mn,{})}),h.jsx("div",{style:{display:"none"},children:h.jsx("div",{className:"h-full flex flex-col gap-3 pb-2 md:pb-0 pt-2",children:h.jsx(vn,{})})})]})}function Nu(){return h.jsx("div",{className:"flex justify-center w-full h-full",children:h.jsx("div",{className:"w-full transition-all duration-300 ease-in-out max-w-6xl",children:h.jsx(mn,{})})})}function Bu(){return h.jsx("div",{className:"h-full flex flex-col overflow-hidden",children:h.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[h.jsx("div",{className:"flex flex-col bg-base overflow-hidden flex-1",children:h.jsx(Nu,{})}),h.jsx("div",{style:{display:"none"},children:h.jsx("div",{className:"flex flex-col flex-1 gap-3 min-w-max h-full",children:h.jsx(vn,{})})})]})})}function Pu(){const{width:s}=Ri();return s&&s<=1024?h.jsx(ju,{}):h.jsx(Bu,{})}const Fu=()=>{const s=jt();return $t({mutationFn:p=>st.updateConversation(p.conversationId,{title:p.newTitle}),onMutate:async p=>{await s.cancelQueries({queryKey:["user","conversations"]});const C=s.getQueryData(["user","conversations"]);return s.setQueryData(["user","conversations"],w=>w?.map(k=>k.conversation_id===p.conversationId?{...k,title:p.newTitle}:k)),{previousConversations:C}},onError:(p,C,w)=>{w?.previousConversations&&s.setQueryData(["user","conversations"],w.previousConversations)},onSettled:(p,C,w)=>{s.invalidateQueries({queryKey:["user","conversations"]}),s.invalidateQueries({queryKey:["user","conversation",w.conversationId]})}})},Hu=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M14.25 19.5C14.25 20.7426 13.2426 21.75 12 21.75C10.7574 21.75 9.75 20.7426 9.75 19.5C9.75 18.2574 10.7574 17.25 12 17.25C13.2426 17.25 14.25 18.2574 14.25 19.5ZM14.25 12C14.25 13.2426 13.2426 14.25 12 14.25C10.7574 14.25 9.75 13.2426 9.75 12C9.75 10.7574 10.7574 9.75 12 9.75C13.2426 9.75 14.25 10.7574 14.25 12ZM14.25 4.5C14.25 5.74264 13.2426 6.75 12 6.75C10.7574 6.75 9.75 5.74264 9.75 4.5C9.75 3.25736 10.7574 2.25 12 2.25C13.2426 2.25 14.25 3.25736 14.25 4.5Z",fill:"currentColor"}));function $u({onClick:s,fill:p="#a3a3a3"}){return h.jsx("button",{"data-testid":"ellipsis-button",type:"button",onClick:s,className:"cursor-pointer",children:h.jsx(Hu,{width:24,height:24,color:p})})}const Uu=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M16.2929 2.29289C16.6834 1.90237 17.3166 1.90237 17.7071 2.29289L21.7071 6.29289C22.0976 6.68342 22.0976 7.31658 21.7071 7.70711L8.70711 20.7071C8.51957 20.8946 8.26522 21 8 21H4C3.44772 21 3 20.5523 3 20V16C3 15.7348 3.10536 15.4804 3.29289 15.2929L13.2927 5.2931L16.2929 2.29289ZM14 7.41421L5 16.4142V19H7.58579L16.5858 10L14 7.41421ZM18 8.58579L19.5858 7L17 4.41421L15.4142 6L18 8.58579Z",fill:"currentColor"})),Wu=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M20.92 15.62C20.8694 15.4988 20.7983 15.3872 20.71 15.29L17.71 12.29C17.5217 12.1017 17.2663 11.9959 17 11.9959C16.7337 11.9959 16.4783 12.1017 16.29 12.29C16.1017 12.4783 15.9959 12.7337 15.9959 13C15.9959 13.2663 16.1017 13.5217 16.29 13.71L17.59 15H12C11.7348 15 11.4804 15.1054 11.2929 15.2929C11.1054 15.4804 11 15.7348 11 16C11 16.2652 11.1054 16.5196 11.2929 16.7071C11.4804 16.8946 11.7348 17 12 17H17.59L16.29 18.29C16.1963 18.383 16.1219 18.4936 16.0711 18.6154C16.0203 18.7373 15.9942 18.868 15.9942 19C15.9942 19.132 16.0203 19.2627 16.0711 19.3846C16.1219 19.5064 16.1963 19.617 16.29 19.71C16.383 19.8037 16.4936 19.8781 16.6154 19.9289C16.7373 19.9797 16.868 20.0058 17 20.0058C17.132 20.0058 17.2627 19.9797 17.3846 19.9289C17.5064 19.8781 17.617 19.8037 17.71 19.71L20.71 16.71C20.8026 16.6161 20.8742 16.5036 20.92 16.38C21.02 16.1365 21.02 15.8635 20.92 15.62ZM14 20H6C5.73478 20 5.48043 19.8946 5.29289 19.7071C5.10536 19.5196 5 19.2652 5 19V5C5 4.73478 5.10536 4.48043 5.29289 4.29289C5.48043 4.10536 5.73478 4 6 4H11V7C11 7.79565 11.3161 8.55871 11.8787 9.12132C12.4413 9.68393 13.2044 10 14 10H18C18.1974 9.99901 18.3901 9.93961 18.5539 9.82928C18.7176 9.71895 18.845 9.56262 18.92 9.38C18.9966 9.19789 19.0175 8.99718 18.9801 8.80319C18.9428 8.6092 18.8488 8.43062 18.71 8.29L12.71 2.29C12.6273 2.21222 12.5328 2.14808 12.43 2.1H12.34L12.06 2H6C5.20435 2 4.44129 2.31607 3.87868 2.87868C3.31607 3.44129 3 4.20435 3 5V19C3 19.7956 3.31607 20.5587 3.87868 21.1213C4.44129 21.6839 5.20435 22 6 22H14C14.2652 22 14.5196 21.8946 14.7071 21.7071C14.8946 21.5196 15 21.2652 15 21C15 20.7348 14.8946 20.4804 14.7071 20.2929C14.5196 20.1054 14.2652 20 14 20ZM13 5.41L15.59 8H14C13.7348 8 13.4804 7.89464 13.2929 7.70711C13.1054 7.51957 13 7.26522 13 7V5.41Z",fill:"currentColor"})),Vu=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M12 2C12.5523 2 13 2.44772 13 3V13.5858L15.2929 11.2929C15.6834 10.9024 16.3166 10.9024 16.7071 11.2929C17.0976 11.6834 17.0976 12.3166 16.7071 12.7071L12.7071 16.7071C12.3166 17.0976 11.6834 17.0976 11.2929 16.7071L7.29289 12.7071C6.90237 12.3166 6.90237 11.6834 7.29289 11.2929C7.68342 10.9024 8.31658 10.9024 8.70711 11.2929L11 13.5858V3C11 2.44772 11.4477 2 12 2ZM5 17C5.55228 17 6 17.4477 6 18V20H18V18C18 17.4477 18.4477 17 19 17C19.5523 17 20 17.4477 20 18V20C20 21.1046 19.1046 22 18 22H6C4.89543 22 4 21.1046 4 20V18C4 17.4477 4.44772 17 5 17Z",fill:"currentColor"})),zu=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 7.5V9H3V7.5H21ZM3 10.5H21V18H3V10.5ZM21 6H3C2.60218 6 2.22064 6.15804 1.93934 6.43934C1.65804 6.72064 1.5 7.10218 1.5 7.5V18C1.5 18.3978 1.65804 18.7794 1.93934 19.0607C2.22064 19.342 2.60218 19.5 3 19.5H21C21.3978 19.5 21.7794 19.342 22.0607 19.0607C22.342 18.7794 22.5 18.3978 22.5 18V7.5C22.5 7.10218 22.342 6.72064 22.0607 6.43934C21.7794 6.15804 21.3978 6 21 6ZM16.5 15H19.5V16.5H16.5V15Z",fill:"currentColor"})),Ku=s=>H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",...s},H.createElement("path",{d:"M7 4C7 2.89543 7.89543 2 9 2H15C16.1046 2 17 2.89543 17 4V6H18.9897C18.9959 5.99994 19.0021 5.99994 19.0083 6H21C21.5523 6 22 6.44772 22 7C22 7.55228 21.5523 8 21 8H19.9311L19.0638 20.1425C18.989 21.1891 18.1182 22 17.0689 22H6.93112C5.88184 22 5.01096 21.1891 4.9362 20.1425L4.06888 8H3C2.44772 8 2 7.55228 2 7C2 6.44772 2.44772 6 3 6H4.99174C4.99795 5.99994 5.00414 5.99994 5.01032 6H7V4ZM9 6H15V4H9V6ZM6.07398 8L6.93112 20H17.0689L17.926 8H6.07398ZM10 10C10.5523 10 11 10.4477 11 11V17C11 17.5523 10.5523 18 10 18C9.44772 18 9 17.5523 9 17V11C9 10.4477 9.44772 10 10 10ZM14 10C14.5523 10 15 10.4477 15 11V17C15 17.5523 14.5523 18 14 18C13.4477 18 13 17.5523 13 17V11C13 10.4477 13.4477 10 14 10Z",fill:"currentColor"}));function Ft({icon:s,text:p,className:C}){return h.jsxs("div",{className:Ee("flex items-center gap-2 p-2 hover:bg-[#5C5D62] rounded",C),children:[s,p]})}const Ht=Ee("cursor-pointer p-0 h-auto hover:bg-transparent",je);function qu({onClose:s,onRename:p,onDelete:C,onStop:w,onDisplayCost:k,onShowAgentTools:j,onShowMicroagents:I,onExportConversation:o,onDownloadViaVSCode:n,position:u="bottom"}){const{width:m}=Ri(),{t:c}=ge(),f=Er(s),v=!!n,S=!!o,g=!!(j||I),a=!!k,t=!!(w||C),e=m&&m<=1024;return h.jsxs(us,{ref:f,testId:"conversation-name-context-menu",position:u,alignment:"left",className:e?"right-0 translate-x-[34%] left-auto":"",children:[p&&h.jsx(Fe,{testId:"rename-button",onClick:p,className:Ht,children:h.jsx(Ft,{icon:h.jsx(Uu,{width:16,height:16}),text:c(Z.BUTTON$RENAME),className:je})}),g&&h.jsx(ys,{testId:"separator-tools"}),I&&h.jsx(Fe,{testId:"show-microagents-button",onClick:I,className:Ht,children:h.jsx(Ft,{icon:h.jsx(Xi,{width:16,height:16}),text:c(Z.CONVERSATION$SHOW_MICROAGENTS),className:je})}),j&&h.jsx(Fe,{testId:"show-agent-tools-button",onClick:j,className:Ht,children:h.jsx(Ft,{icon:h.jsx(Qi,{width:16,height:16}),text:c(Z.BUTTON$SHOW_AGENT_TOOLS_AND_METADATA),className:je})}),(S||v)&&h.jsx(ys,{testId:"separator-export"}),o&&h.jsx(Fe,{testId:"export-conversation-button",onClick:o,className:Ht,children:h.jsx(Ft,{icon:h.jsx(Wu,{width:16,height:16}),text:c(Z.BUTTON$EXPORT_CONVERSATION),className:je})}),n&&h.jsx(Fe,{testId:"download-vscode-button",onClick:n,className:Ht,children:h.jsx(Ft,{icon:h.jsx(Vu,{width:16,height:16}),text:c(Z.BUTTON$DOWNLOAD_VIA_VSCODE),className:je})}),(a||t)&&h.jsx(ys,{testId:"separator-info-control"}),k&&h.jsx(Fe,{testId:"display-cost-button",onClick:k,className:Ht,children:h.jsx(Ft,{icon:h.jsx(zu,{width:16,height:16}),text:c(Z.BUTTON$DISPLAY_COST),className:je})}),w&&h.jsx(Fe,{testId:"stop-button",onClick:w,className:Ht,children:h.jsx(Ft,{icon:h.jsx(Gi,{width:16,height:16}),text:c(Z.COMMON$CLOSE_CONVERSATION_STOP_RUNTIME),className:je})}),C&&h.jsx(Fe,{testId:"delete-button",onClick:C,className:Ht,children:h.jsx(Ft,{icon:h.jsx(Ku,{width:16,height:16}),text:c(Z.COMMON$DELETE_CONVERSATION),className:je})})]})}function Gu({onConfirm:s,onCancel:p}){const{t:C}=ge();return h.jsx(Yt,{children:h.jsxs(Vt,{className:"items-start border border-tertiary",children:[h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx(cs,{title:C(Z.CONVERSATION$CONFIRM_DELETE)}),h.jsx(xr,{description:C(Z.CONVERSATION$DELETE_WARNING)})]}),h.jsxs("div",{className:"flex flex-col gap-2 w-full",onClick:w=>w.stopPropagation(),children:[h.jsx(It,{type:"button",variant:"primary",onClick:s,className:"w-full","data-testid":"confirm-button",children:C(Z.ACTION$CONFIRM_DELETE)}),h.jsx(It,{type:"button",variant:"secondary",onClick:p,className:"w-full","data-testid":"cancel-button",children:C(Z.BUTTON$CANCEL)})]})]})})}function Zu({onConfirm:s,onCancel:p}){const{t:C}=ge();return h.jsx(Yt,{children:h.jsxs(Vt,{className:"items-start border border-tertiary",children:[h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx(cs,{title:C(Z.CONVERSATION$CONFIRM_CLOSE_CONVERSATION)}),h.jsx(xr,{description:C(Z.CONVERSATION$CLOSE_CONVERSATION_WARNING)})]}),h.jsxs("div",{className:"flex flex-col gap-2 w-full",onClick:w=>w.stopPropagation(),children:[h.jsx(It,{type:"button",variant:"primary",onClick:s,className:"w-full","data-testid":"confirm-button",children:C(Z.ACTION$CONFIRM_CLOSE)}),h.jsx(It,{type:"button",variant:"secondary",onClick:p,className:"w-full","data-testid":"cancel-button",children:C(Z.BUTTON$CANCEL)})]})]})})}function Ju({actions:s,closeModal:p}){return h.jsx(h.Fragment,{children:s.map(({action:C,isDisabled:w,label:k,className:j,closeAfterAction:I})=>h.jsx(To,{type:"button",isDisabled:w,onPress:()=>{C(),I&&p()},className:j,children:k},k))})}function Yu({maintitle:s,subtitle:p=void 0}){return h.jsxs(h.Fragment,{children:[h.jsx("h3",{children:s}),p&&h.jsx("span",{className:"text-neutral-400 text-sm font-light",children:p})]})}function Xu({isOpen:s,onOpenChange:p,title:C,contentClassName:w="max-w-[30rem] p-[40px]",bodyClassName:k="px-0 py-[20px]",isDismissable:j=!0,subtitle:I=void 0,actions:o=[],children:n=null,testID:u}){return h.jsx(la,{"data-testid":u,isOpen:s,onOpenChange:p,isDismissable:j,backdrop:"blur",hideCloseButton:!0,size:"sm",className:"bg-base-secondary rounded-lg",children:h.jsx(ra,{className:w,children:m=>h.jsxs(h.Fragment,{children:[C&&h.jsx(na,{className:"flex flex-col p-0",children:h.jsx(Yu,{maintitle:C,subtitle:I})}),h.jsx(Zo,{className:k,children:n}),o&&o.length>0&&h.jsx(ia,{className:"flex-row flex justify-start p-0",children:h.jsx(Ju,{actions:o,closeModal:m})})]})})})}function Qu({currentCost:s,maxBudget:p}){const C=s/p*100,w=C>80;return h.jsx("div",{className:"w-full h-1.5 bg-neutral-700 rounded-full overflow-hidden mt-1",children:h.jsx("div",{className:`h-full transition-all duration-300 ${w?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(100,C)}%`}})})}function ed({currentCost:s,maxBudget:p}){const{t:C}=ge(),w=s/p*100;return h.jsx("div",{className:"flex justify-end",children:h.jsx("span",{className:"text-xs text-neutral-400",children:C(Z.CONVERSATION$BUDGET_USAGE_FORMAT,{currentCost:`$${s.toFixed(4)}`,maxBudget:`$${p.toFixed(4)}`,usagePercentage:w.toFixed(2),used:C(Z.CONVERSATION$USED)})})})}function td({cost:s,maxBudgetPerTask:p}){const{t:C}=ge();return s===null?null:h.jsx("div",{className:"border-b border-neutral-700",children:p!==null&&p>0?h.jsxs(h.Fragment,{children:[h.jsx(Qu,{currentCost:s,maxBudget:p}),h.jsx(ed,{currentCost:s,maxBudget:p})]}):h.jsx("span",{className:"text-xs text-neutral-400",children:C(Z.CONVERSATION$NO_BUDGET_LIMIT)})})}function sd({cost:s,maxBudgetPerTask:p}){const{t:C}=ge();return s===null?null:h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex justify-between items-center pb-2",children:[h.jsx("span",{className:"text-lg font-semibold",children:C(Z.CONVERSATION$TOTAL_COST)}),h.jsxs("span",{className:"font-semibold",children:["$",s.toFixed(4)]})]}),h.jsx(td,{cost:s,maxBudgetPerTask:p})]})}function Zs({label:s,value:p,labelClassName:C="",valueClassName:w="font-semibold"}){return h.jsxs("div",{className:"flex justify-between items-center border-b border-neutral-700 pb-2",children:[h.jsx("span",{className:C,children:s}),h.jsx("span",{className:w,children:p})]})}function rd({usage:s}){const{t:p}=ge();return h.jsxs(h.Fragment,{children:[h.jsx(Zs,{label:p(Z.CONVERSATION$INPUT),value:s.prompt_tokens.toLocaleString()}),h.jsxs("div",{className:"grid grid-cols-2 gap-2 pl-4 text-sm",children:[h.jsx("span",{className:"text-neutral-400",children:p(Z.CONVERSATION$CACHE_HIT)}),h.jsx("span",{className:"text-right",children:s.cache_read_tokens.toLocaleString()}),h.jsx("span",{className:"text-neutral-400",children:p(Z.CONVERSATION$CACHE_WRITE)}),h.jsx("span",{className:"text-right",children:s.cache_write_tokens.toLocaleString()})]}),h.jsx(Zs,{label:p(Z.CONVERSATION$OUTPUT),value:s.completion_tokens.toLocaleString()}),h.jsx(Zs,{label:p(Z.CONVERSATION$TOTAL),value:(s.prompt_tokens+s.completion_tokens).toLocaleString(),labelClassName:"font-semibold",valueClassName:"font-bold"})]})}function id({perTurnToken:s,contextWindow:p}){const{t:C}=ge(),w=s/p*100,k=Math.min(100,w);return h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsx("div",{className:"flex items-center justify-between",children:h.jsx("span",{className:"font-semibold",children:C(Z.CONVERSATION$CONTEXT_WINDOW)})}),h.jsx("div",{className:"w-full h-1.5 bg-neutral-700 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${k}%`}})}),h.jsx("div",{className:"flex justify-end",children:h.jsxs("span",{className:"text-xs text-neutral-400",children:[s.toLocaleString()," / ",p.toLocaleString()," (",w.toFixed(2),"% ",C(Z.CONVERSATION$USED),")"]})})]})}function nd(){const{t:s}=ge();return h.jsx("div",{className:"rounded-md p-4 text-center",children:h.jsx("p",{className:"text-neutral-400",children:s(Z.CONVERSATION$NO_METRICS)})})}function od({isOpen:s,onOpenChange:p}){const{t:C}=ge(),w=Si();return h.jsx(Xu,{isOpen:s,onOpenChange:p,title:C(Z.CONVERSATION$METRICS_INFO),testID:"metrics-modal",children:h.jsxs("div",{className:"space-y-4",children:[(w?.cost!==null||w?.usage!==null)&&h.jsx("div",{className:"rounded-md p-3",children:h.jsxs("div",{className:"grid gap-3",children:[h.jsx(sd,{cost:w?.cost??null,maxBudgetPerTask:w?.max_budget_per_task??null}),w?.usage!==null&&h.jsxs(h.Fragment,{children:[h.jsx(rd,{usage:w.usage}),h.jsx(id,{perTurnToken:w.usage.per_turn_token,contextWindow:w.usage.context_window})]})]})}),!w?.cost&&!w?.usage&&h.jsx(nd,{})]})})}function ad(){const{t:s}=ge(),{conversationId:p}=ls(),{data:C}=_t(),{mutate:w}=Fu(),[k,j]=pe.useState("view"),[I,o]=pe.useState(!1),n=pe.useRef(null),{handleDelete:u,handleStop:m,handleDownloadViaVSCode:c,handleDisplayCost:f,handleShowAgentTools:v,handleShowMicroagents:S,handleExportConversation:g,handleConfirmDelete:a,handleConfirmStop:t,metricsModalVisible:e,setMetricsModalVisible:r,systemModalVisible:i,setSystemModalVisible:_,microagentsModalVisible:l,setMicroagentsModalVisible:b,confirmDeleteModalVisible:d,setConfirmDeleteModalVisible:y,confirmStopModalVisible:M,setConfirmStopModalVisible:D,systemMessage:N,shouldShowStop:T,shouldShowDownload:z,shouldShowExport:J,shouldShowDisplayCost:ie,shouldShowAgentTools:F,shouldShowMicroagents:ee}=rn({conversationId:p,conversationStatus:C?.status,showOptions:!0,onContextMenuToggle:o}),L=()=>{j("edit")},B=()=>{if(n.current?.value&&p){const he=n.current.value.trim();he!==C?.title&&w({conversationId:p,newTitle:he},{onSuccess:()=>{uo(s(Z.CONVERSATION$TITLE_UPDATED))}})}else n.current&&(n.current.value=C?.title??"");j("view")},P=he=>{he.key==="Enter"&&he.currentTarget.blur()},W=he=>{k==="edit"&&(he.preventDefault(),he.stopPropagation())},Q=he=>{he.preventDefault(),he.stopPropagation(),o(!I)},ae=he=>{he.preventDefault(),he.stopPropagation(),j("edit"),o(!1)};return pe.useEffect(()=>{k==="edit"&&n.current?.focus()},[k]),C?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center gap-2 h-[22px] text-base font-normal text-left pl-0 lg:pl-3.5","data-testid":"conversation-name",children:[k==="edit"?h.jsx("input",{ref:n,"data-testid":"conversation-name-input",onClick:W,onBlur:B,onKeyUp:P,type:"text",defaultValue:C.title,className:"text-white leading-5 bg-transparent border-none outline-none text-base font-normal w-fit max-w-fit field-sizing-content"}):h.jsx("div",{className:"text-white leading-5 w-fit max-w-fit truncate","data-testid":"conversation-name-title",onDoubleClick:L,title:C.title,children:C.title}),k!=="edit"&&h.jsxs("div",{className:"relative flex items-center",children:[h.jsx($u,{fill:"#B1B9D3",onClick:Q}),I&&h.jsx(qu,{onClose:()=>o(!1),onRename:ae,onDelete:u,onStop:T?m:void 0,onDisplayCost:ie?f:void 0,onShowAgentTools:F?v:void 0,onShowMicroagents:ee?S:void 0,onExportConversation:J?g:void 0,onDownloadViaVSCode:z?c:void 0,position:"bottom"})]})]}),h.jsx(od,{isOpen:e,onOpenChange:r}),h.jsx(nn,{isOpen:i,onClose:()=>_(!1),systemMessage:N?N.args:null}),l&&h.jsx(on,{onClose:()=>b(!1)}),d&&h.jsx(Gu,{onConfirm:a,onCancel:()=>y(!1)}),M&&h.jsx(Zu,{onConfirm:t,onCancel:()=>D(!1)})]}):null}function ld(){return null}const cd=(s,p)=>{const[C,w]=pe.useState(!1),[k,j]=pe.useState(null),[I,o]=pe.useState([]),[n,u]=pe.useState(null),m=pe.useRef(null);pe.useEffect(()=>{let f=s;if(p?.queryParams){const S=new URLSearchParams(p.queryParams);f=`${s}?${S.toString()}`}const v=new WebSocket(f);return m.current=v,v.onopen=S=>{w(!0),u(null),p?.onOpen?.(S)},v.onmessage=S=>{j(S.data),o(g=>[...g,S.data]),p?.onMessage?.(S)},v.onclose=S=>{w(!1),S.code!==1e3&&(u(new Error(`WebSocket closed with code ${S.code}: ${S.reason||"Connection closed unexpectedly"}`)),p?.onError?.(S)),p?.onClose?.(S)},v.onerror=S=>{w(!1),p?.onError?.(S)},()=>{v.close()}},[s,p]);const c=pe.useCallback(f=>{m.current&&m.current.readyState===WebSocket.OPEN&&m.current.send(f)},[]);return{isConnected:C,lastMessage:k,messages:I,error:n,socket:m.current,sendMessage:c}},hd=s=>{const p=s.match(/^\/workspace\/[^/]+\/(.*)$/);return p?p[1]:s},ud=(s,p,C)=>{const{action:w}=s;if((w.kind==="StrReplaceEditorAction"||w.kind==="ExecuteBashAction")&&C.invalidateQueries({queryKey:["file_changes",p]},{cancelRefetch:!1}),w.kind==="StrReplaceEditorAction"&&w.path){const k=hd(w.path);C.invalidateQueries({queryKey:["file_diff",p,k]})}},dd=H.createContext(void 0);function fd({children:s,conversationId:p}){const[C,w]=H.useState("CONNECTING"),k=jt(),{addEvent:j}=Ms(),{setErrorMessage:I,removeErrorMessage:o}=Mi(),{removeOptimisticUserMessage:n}=br(),u=H.useCallback(v=>{try{const S=JSON.parse(v.data);so(S)&&(j(S),ro(S)&&I(S.error),io(S)&&n(),no(S)&&ud(S,p||"test-conversation-id",k))}catch(S){console.warn("Failed to parse WebSocket message as JSON:",S)}},[j,I,n,k]),m=H.useMemo(()=>({onOpen:()=>{w("OPEN"),o()},onClose:v=>{w("CLOSED"),v.code!==1e3&&I(`Connection lost: ${v.reason||"Unexpected disconnect"}`)},onError:()=>{w("CLOSED"),I("Failed to connect to server")},onMessage:u}),[u,I,o]),{socket:c}=cd("ws://localhost/events/socket",m);H.useEffect(()=>{c&&(()=>{switch(c.readyState){case WebSocket.CONNECTING:w("CONNECTING");break;case WebSocket.OPEN:w("OPEN");break;case WebSocket.CLOSING:w("CLOSING");break;case WebSocket.CLOSED:w("CLOSED");break;default:w("CLOSED");break}})()},[c]);const f=H.useMemo(()=>({connectionState:C}),[C]);return h.jsx(dd.Provider,{value:f,children:s})}function pd({children:s,conversationId:p,version:C}){if(C===0)return h.jsx(oo,{conversationId:p,children:s});if(C===1)return h.jsx(fd,{conversationId:p,children:s});throw new Error(`Unsupported WebSocket provider version: ${C}. Supported versions are 0 and 1.`)}function _d(){va();const{conversationId:s}=mt(),{data:p,isFetched:C,refetch:w}=_t(),{mutate:k}=Ji(),{data:j}=fo(),{providers:I}=Jt(),{resetConversationState:o}=gt(),n=ar(),u=Li(v=>v.clearTerminal),m=Mt(v=>v.setCurrentAgentState),c=ao(v=>v.clearJupyter),f=jt();return ga(),ba(),pe.useEffect(()=>{f.invalidateQueries({queryKey:["user","conversation",s]})},[s,f]),pe.useEffect(()=>{C&&!p&&j?(pt("This conversation does not exist, or you do not have permission to access it."),n("/")):p?.status==="STOPPED"&&k({conversationId:p.conversation_id,providers:I},{onError:v=>{pt(`Failed to start conversation: ${v.message}`),w()}})},[p?.conversation_id,p?.status,C,j,I]),pe.useEffect(()=>{u(),c(),o(),m(Ce.LOADING)},[s,u,m,o]),ca(()=>{u(),c(),o(),m(Ce.LOADING)}),h.jsx(pd,{version:0,conversationId:s,children:h.jsx(lo,{children:h.jsx(co,{children:h.jsxs("div",{"data-testid":"app-route",className:"p-3 md:p-0 flex flex-col h-full gap-3",children:[h.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4.5 pt-2 lg:pt-0",children:[h.jsx(ad,{}),h.jsx(ld,{})]}),h.jsx(Pu,{})]})})})})}function md(){return h.jsx(_d,{})}const Qd=Un(md);export{nu as S,Mu as W,ln as a,Qd as c,Gl as t,Ui as u};
