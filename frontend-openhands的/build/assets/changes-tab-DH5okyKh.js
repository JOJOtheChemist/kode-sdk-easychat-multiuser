import{r as s,R as w,p as d}from"./chunk-NISHYRIK-CKdEls7F.js";import{G as ie}from"./index-BDUzCKOA.js";import{c as re}from"./utils-BVnsmU2z.js";import{a as me}from"./use-config-DZPclKuv.js";import{G as ve}from"./git-service.api-C5gvVLyJ.js";import{b as be,a as Te,R as Pe}from"./parse-pr-url-DDbpIt54.js";import{r as se}from"./retrieve-axios-error-message-CYr77e_f.js";import{u as Ce}from"./conversation-WQiCKy8A.js";import{I as E}from"./declaration-B9eIPmUJ.js";import{u as ye}from"./useTranslation-DONB_giz.js";import"./bundle-mjs-0JNfDbnS.js";import"./open-hands-axios-BIuoB8bl.js";import"./option-service.api-CTPg1Fmy.js";import"./git-provider-icon-Db_Bl_5f.js";import"./brand-button-BQs8JWFf.js";import"./module-CWLbpm_7.js";import"./index-DWiKAxKp.js";import"./query-client-config-Dd99l1aU.js";import"./i18next-Lgj2Bm8L.js";import"./custom-toast-handlers-fYPNAJaC.js";import"./infiniteQueryBehavior-D7Qz1qlw.js";import"./use-user-providers-P0hmd5MI.js";import"./use-settings-B2QUSrrJ.js";import"./use-is-authed-Dg_tgDAm.js";import"./close-bbjPMB7Q.js";import"./chunk-MSDKUXDP-Cfu5rKGn.js";import"./chunk-TX3FPB7D-DZsJI2yo.js";import"./index-S5BalIfI.js";import"./tooltip-button-DdCqtqn-.js";import"./preload-helper-BXl3LOEh.js";import"./index-JAudiiL9.js";import"./index-CX-90vHk.js";import"./constants-DE11vt2u.js";import"./typography-dnvkoiv9.js";import"./repo-forked-BC1XV35P.js";import"./modal-backdrop-cp3dlfku.js";import"./modal-body-BthUSAn0.js";import"./base-modal-DLway4p0.js";import"./index-at5IPRPS.js";import"./Trans-CPaTqF-h.js";import"./settings-dropdown-input-CJWg5DfQ.js";import"./optional-tag-SXD2PjYq.js";import"./useSingleSelectListState-Dp1i9X5O.js";import"./loading-spinner-C-wnmolE.js";function ke(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ce(Object(r),!0).forEach(function(n){ke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ae(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Le(e,t){if(e==null)return{};var r=Ae(e,t),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ne(e,t){return De(e)||$e(e,t)||_e(e,t)||Fe()}function De(e){if(Array.isArray(e))return e}function $e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,o=void 0;try{for(var a=e[Symbol.iterator](),c;!(n=(c=a.next()).done)&&(r.push(c.value),!(t&&r.length===t));n=!0);}catch(f){i=!0,o=f}finally{try{!n&&a.return!=null&&a.return()}finally{if(i)throw o}}return r}}function _e(e,t){if(e){if(typeof e=="string")return le(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return le(e,t)}}function le(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?de(Object(r),!0).forEach(function(n){Ve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ue(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(i,o){return o(i)},n)}}function V(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(this,i):function(){for(var a=arguments.length,c=new Array(a),f=0;f<a;f++)c[f]=arguments[f];return t.apply(r,[].concat(i,c))}}}function K(e){return{}.toString.call(e).includes("Object")}function Ge(e){return!Object.keys(e).length}function G(e){return typeof e=="function"}function He(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function qe(e,t){return K(t)||T("changeType"),Object.keys(t).some(function(r){return!He(e,r)})&&T("changeField"),t}function Be(e){G(e)||T("selectorType")}function We(e){G(e)||K(e)||T("handlerType"),K(e)&&Object.values(e).some(function(t){return!G(t)})&&T("handlersType")}function ze(e){e||T("initialIsRequired"),K(e)||T("initialType"),Ge(e)&&T("initialContent")}function Ke(e,t){throw new Error(e[t]||e.default)}var Ze={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},T=V(Ke)(Ze),W={changes:qe,selector:Be,handler:We,initial:ze};function Ye(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};W.initial(e),W.handler(t);var r={current:e},n=V(Xe)(r,t),i=V(Je)(r),o=V(W.changes)(e),a=V(Qe)(r);function c(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(M){return M};return W.selector(h),h(r.current)}function f(h){Ue(n,i,o,a)(h)}return[c,f]}function Qe(e,t){return G(t)?t(e.current):t}function Je(e,t){return e.current=fe(fe({},e.current),t),t}function Xe(e,t,r){return G(t)?t(e.current):Object.keys(r).forEach(function(n){var i;return(i=t[n])===null||i===void 0?void 0:i.call(t,e.current[n])}),r}var et={create:Ye},tt={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function rt(e){return function t(){for(var r=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return i.length>=e.length?e.apply(this,i):function(){for(var a=arguments.length,c=new Array(a),f=0;f<a;f++)c[f]=arguments[f];return t.apply(r,[].concat(i,c))}}}function nt(e){return{}.toString.call(e).includes("Object")}function it(e){return e||pe("configIsRequired"),nt(e)||pe("configType"),e.urls?(ot(),{paths:{vs:e.urls.monacoBase}}):e}function ot(){console.warn(we.deprecation)}function at(e,t){throw new Error(e[t]||e.default)}var we={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},pe=rt(at)(we),st={config:it},ct=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(i){return r.reduceRight(function(o,a){return a(o)},i)}};function je(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],je(e[r],t[r]))}),ue(ue({},e),t)}var ut={type:"cancelation",msg:"operation is manually canceled"};function X(e){var t=!1,r=new Promise(function(n,i){e.then(function(o){return t?i(ut):n(o)}),e.catch(i)});return r.cancel=function(){return t=!0},r}var lt=et.create({config:tt,isInitialized:!1,resolve:null,reject:null,monaco:null}),Ee=Ne(lt,2),H=Ee[0],Z=Ee[1];function dt(e){var t=st.config(e),r=t.monaco,n=Le(t,["monaco"]);Z(function(i){return{config:je(i.config,n),monaco:r}})}function ft(){var e=H(function(t){var r=t.monaco,n=t.isInitialized,i=t.resolve;return{monaco:r,isInitialized:n,resolve:i}});if(!e.isInitialized){if(Z({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),X(ee);if(window.monaco&&window.monaco.editor)return Se(window.monaco),e.resolve(window.monaco),X(ee);ct(pt,gt)(mt)}return X(ee)}function pt(e){return document.body.appendChild(e)}function ht(e){var t=document.createElement("script");return e&&(t.src=e),t}function gt(e){var t=H(function(n){var i=n.config,o=n.reject;return{config:i,reject:o}}),r=ht("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function mt(){var e=H(function(r){var n=r.config,i=r.resolve,o=r.reject;return{config:n,resolve:i,reject:o}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){Se(r),e.resolve(r)},function(r){e.reject(r)})}function Se(e){H().monaco||Z({monaco:e})}function vt(){return H(function(e){var t=e.monaco;return t})}var ee=new Promise(function(e,t){return Z({resolve:e,reject:t})}),Oe={config:dt,init:ft,__getMonacoInstance:vt},bt={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},te=bt,yt={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},wt=yt;function jt({children:e}){return w.createElement("div",{style:wt.container},e)}var Et=jt,St=Et;function Ot({width:e,height:t,isEditorReady:r,loading:n,_ref:i,className:o,wrapperProps:a}){return w.createElement("section",{style:{...te.wrapper,width:e,height:t},...a},!r&&w.createElement(St,null,n),w.createElement("div",{ref:i,style:{...te.fullWidth,...!r&&te.hide},className:o}))}var Mt=Ot,Me=s.memo(Mt);function xt(e){s.useEffect(e,[])}var xe=xt;function It(e,t,r=!0){let n=s.useRef(!0);s.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var x=It;function U(){}function L(e,t,r,n){return Rt(e,n)||Tt(e,t,r,n)}function Rt(e,t){return e.editor.getModel(Ie(e,t))}function Tt(e,t,r,n){return e.editor.createModel(t,r,n?Ie(e,n):void 0)}function Ie(e,t){return e.Uri.parse(t)}function Pt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:i,originalModelPath:o,modifiedModelPath:a,keepCurrentOriginalModel:c=!1,keepCurrentModifiedModel:f=!1,theme:h="light",loading:M="Loading...",options:u={},height:N="100%",width:D="100%",className:P,wrapperProps:$={},beforeMount:_=U,onMount:C=U}){let[y,I]=s.useState(!1),[m,g]=s.useState(!0),b=s.useRef(null),v=s.useRef(null),k=s.useRef(null),S=s.useRef(C),l=s.useRef(_),A=s.useRef(!1);xe(()=>{let p=Oe.init();return p.then(j=>(v.current=j)&&g(!1)).catch(j=>j?.type!=="cancelation"&&console.error("Monaco initialization: error:",j)),()=>b.current?F():p.cancel()}),x(()=>{if(b.current&&v.current){let p=b.current.getOriginalEditor(),j=L(v.current,e||"",n||r||"text",o||"");j!==p.getModel()&&p.setModel(j)}},[o],y),x(()=>{if(b.current&&v.current){let p=b.current.getModifiedEditor(),j=L(v.current,t||"",i||r||"text",a||"");j!==p.getModel()&&p.setModel(j)}},[a],y),x(()=>{let p=b.current.getModifiedEditor();p.getOption(v.current.editor.EditorOption.readOnly)?p.setValue(t||""):t!==p.getValue()&&(p.executeEdits("",[{range:p.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),p.pushUndoStop())},[t],y),x(()=>{b.current?.getModel()?.original.setValue(e||"")},[e],y),x(()=>{let{original:p,modified:j}=b.current.getModel();v.current.editor.setModelLanguage(p,n||r||"text"),v.current.editor.setModelLanguage(j,i||r||"text")},[r,n,i],y),x(()=>{v.current?.editor.setTheme(h)},[h],y),x(()=>{b.current?.updateOptions(u)},[u],y);let q=s.useCallback(()=>{if(!v.current)return;l.current(v.current);let p=L(v.current,e||"",n||r||"text",o||""),j=L(v.current,t||"",i||r||"text",a||"");b.current?.setModel({original:p,modified:j})},[r,t,i,e,n,o,a]),B=s.useCallback(()=>{!A.current&&k.current&&(b.current=v.current.editor.createDiffEditor(k.current,{automaticLayout:!0,...u}),q(),v.current?.editor.setTheme(h),I(!0),A.current=!0)},[u,h,q]);s.useEffect(()=>{y&&S.current(b.current,v.current)},[y]),s.useEffect(()=>{!m&&!y&&B()},[m,y,B]);function F(){let p=b.current?.getModel();c||p?.original?.dispose(),f||p?.modified?.dispose(),b.current?.dispose()}return w.createElement(Me,{width:D,height:N,isEditorReady:y,loading:M,_ref:k,className:P,wrapperProps:$})}var Ct=Pt,kt=s.memo(Ct);function At(e){let t=s.useRef();return s.useEffect(()=>{t.current=e},[e]),t.current}var Lt=At,z=new Map;function Nt({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:i,path:o,theme:a="light",line:c,loading:f="Loading...",options:h={},overrideServices:M={},saveViewState:u=!0,keepCurrentModel:N=!1,width:D="100%",height:P="100%",className:$,wrapperProps:_={},beforeMount:C=U,onMount:y=U,onChange:I,onValidate:m=U}){let[g,b]=s.useState(!1),[v,k]=s.useState(!0),S=s.useRef(null),l=s.useRef(null),A=s.useRef(null),q=s.useRef(y),B=s.useRef(C),F=s.useRef(),p=s.useRef(n),j=Lt(o),oe=s.useRef(!1),Y=s.useRef(!1);xe(()=>{let O=Oe.init();return O.then(R=>(S.current=R)&&k(!1)).catch(R=>R?.type!=="cancelation"&&console.error("Monaco initialization: error:",R)),()=>l.current?Re():O.cancel()}),x(()=>{let O=L(S.current,e||n||"",t||i||"",o||r||"");O!==l.current?.getModel()&&(u&&z.set(j,l.current?.saveViewState()),l.current?.setModel(O),u&&l.current?.restoreViewState(z.get(o)))},[o],g),x(()=>{l.current?.updateOptions(h)},[h],g),x(()=>{!l.current||n===void 0||(l.current.getOption(S.current.editor.EditorOption.readOnly)?l.current.setValue(n):n!==l.current.getValue()&&(Y.current=!0,l.current.executeEdits("",[{range:l.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),l.current.pushUndoStop(),Y.current=!1))},[n],g),x(()=>{let O=l.current?.getModel();O&&i&&S.current?.editor.setModelLanguage(O,i)},[i],g),x(()=>{c!==void 0&&l.current?.revealLine(c)},[c],g),x(()=>{S.current?.editor.setTheme(a)},[a],g);let ae=s.useCallback(()=>{if(!(!A.current||!S.current)&&!oe.current){B.current(S.current);let O=o||r,R=L(S.current,n||e||"",t||i||"",O||"");l.current=S.current?.editor.create(A.current,{model:R,automaticLayout:!0,...h},M),u&&l.current.restoreViewState(z.get(O)),S.current.editor.setTheme(a),c!==void 0&&l.current.revealLine(c),b(!0),oe.current=!0}},[e,t,r,n,i,o,h,M,u,a,c]);s.useEffect(()=>{g&&q.current(l.current,S.current)},[g]),s.useEffect(()=>{!v&&!g&&ae()},[v,g,ae]),p.current=n,s.useEffect(()=>{g&&I&&(F.current?.dispose(),F.current=l.current?.onDidChangeModelContent(O=>{Y.current||I(l.current.getValue(),O)}))},[g,I]),s.useEffect(()=>{if(g){let O=S.current.editor.onDidChangeMarkers(R=>{let Q=l.current.getModel()?.uri;if(Q&&R.find(J=>J.path===Q.path)){let J=S.current.editor.getModelMarkers({resource:Q});m?.(J)}});return()=>{O?.dispose()}}return()=>{}},[g,m]);function Re(){F.current?.dispose(),N?u&&z.set(o,l.current.saveViewState()):l.current.getModel()?.dispose(),l.current.dispose()}return w.createElement(Me,{width:D,height:P,isEditorReady:g,loading:f,_ref:A,className:$,wrapperProps:_})}var Dt=Nt;s.memo(Dt);function $t(e){return ie({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"},child:[]},{tag:"path",attr:{d:"M9 10h6"},child:[]},{tag:"path",attr:{d:"M12 13V7"},child:[]},{tag:"path",attr:{d:"M9 17h6"},child:[]}]})(e)}function _t(e){return ie({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"},child:[]},{tag:"path",attr:{d:"M14 2v4a2 2 0 0 0 2 2h4"},child:[]},{tag:"path",attr:{d:"M9 15h6"},child:[]}]})(e)}function Ft(e){return ie({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"},child:[]},{tag:"path",attr:{d:"M14 2v4a2 2 0 0 0 2 2h4"},child:[]},{tag:"path",attr:{d:"M9 15h6"},child:[]},{tag:"path",attr:{d:"M12 18v-6"},child:[]}]})(e)}const Vt=e=>{switch(e.split(".").pop()?.toLowerCase()){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"py":return"python";case"html":return"html";case"css":return"css";case"json":return"json";case"md":return"markdown";case"yml":case"yaml":return"yaml";case"sh":case"bash":return"bash";case"dockerfile":return"dockerfile";case"rs":return"rust";case"go":return"go";case"java":return"java";case"cpp":case"cc":case"cxx":return"cpp";case"c":return"c";case"rb":return"ruby";case"php":return"php";case"sql":return"sql";default:return"text"}},Ut=e=>s.createElement("svg",{width:13,height:8,viewBox:"0 0 13 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.259766 6.17427L6.26425 0.715628L12.2688 6.17427L11.2597 7.28418L6.26425 2.74282L1.26878 7.28418L0.259766 6.17427Z",fill:"currentColor"})),Gt=e=>{const{conversationId:t}=be();return me({queryKey:["file_diff",t,e.filePath,e.type],queryFn:()=>ve.getGitChangeDiff(t,e.filePath),enabled:e.enabled,staleTime:1e3*60*5,gcTime:1e3*60*15})};function Ht({className:e}){return d.jsx("div",{className:"flex items-center justify-center",children:d.jsx("div",{className:re("animate-spin rounded-full border-4 border-gray-200 border-t-blue-500",e),role:"status","aria-label":"Loading"})})}const he={A:Ft,D:_t,M:$t,R:"Renamed",U:"Untracked"};function qt({path:e,type:t}){const[r,n]=w.useState(!0),[i,o]=w.useState(400),a=w.useRef(null),c=t==="A"||t==="U",f=t==="D",h=w.useMemo(()=>{if(t==="R"){const m=e.split(/\s+/).slice(1);return m[m.length-1]}return e},[e,t]),{data:M,isLoading:u,isSuccess:N,isRefetching:D}=Gt({filePath:h,type:t,enabled:!r}),P=w.useCallback(()=>{if(a.current){const m=a.current.getOriginalEditor(),g=a.current.getModifiedEditor();if(m&&g){const b=m.getContentHeight(),v=g.getContentHeight(),k=Math.max(b,v);o(k+20)}}},[]),$=m=>{m.editor.defineTheme("custom-diff-theme",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6a9955"},{token:"keyword",foreground:"569cd6"},{token:"string",foreground:"ce9178"},{token:"number",foreground:"b5cea8"}],colors:{"diffEditor.insertedTextBackground":"#014b01AA","diffEditor.removedTextBackground":"#750000AA","diffEditor.insertedLineBackground":"#003f00AA","diffEditor.removedLineBackground":"#5a0000AA","diffEditor.border":"#444444","editorUnnecessaryCode.border":"#00000000","editorUnnecessaryCode.opacity":"#00000077"}})},_=m=>{a.current=m,P();const g=m.getOriginalEditor(),b=m.getModifiedEditor();g.onDidContentSizeChange(P),b.onDidContentSizeChange(P)},C=(t==="U"?he.A:he[t])||"?";let y;if(typeof C=="string")y=d.jsx("span",{children:C});else{const m=C;y=d.jsx(m,{className:"w-5 h-5"})}const I=u||D;return d.jsxs("div",{"data-testid":"file-diff-viewer-outer",className:"w-full flex flex-col",children:[d.jsx("div",{className:re("flex justify-between items-center px-2.5 py-3.5 border border-neutral-600 rounded-xl hover:cursor-pointer",!r&&!u&&"border-b-0 rounded-b-none"),onClick:()=>n(m=>!m),children:d.jsxs("span",{className:"text-sm w-full text-content flex items-center gap-2",children:[I&&d.jsx(Ht,{className:"w-5 h-5"}),!I&&y,d.jsx("strong",{className:"w-full truncate",children:h}),d.jsx("button",{"data-testid":"collapse",type:"button",children:d.jsx(Ut,{className:re("w-4 h-4 transition-transform",r&&"transform rotate-180")})})]})}),N&&!r&&d.jsx("div",{className:"w-full border border-neutral-600 overflow-hidden",style:{height:`${i}px`},children:d.jsx(kt,{"data-testid":"file-diff-viewer",className:"w-full h-full",language:Vt(h),original:c?"":M.original,modified:f?"":M.modified,theme:"custom-diff-theme",onMount:_,beforeMount:$,options:{renderValidationDecorations:"off",readOnly:!0,renderSideBySide:!c&&!f,scrollBeyondLastLine:!1,minimap:{enabled:!1},hideUnchangedRegions:{enabled:!0},automaticLayout:!0,scrollbar:{alwaysConsumeMouseWheel:!1}}})})]})}const Bt=()=>{const{conversationId:e}=be(),[t,r]=w.useState([]),n=w.useRef(null),i=Ce(),o=me({queryKey:["file_changes",e],queryFn:()=>ve.getGitChanges(e),retry:!1,staleTime:1e3*60*5,gcTime:1e3*60*15,enabled:i&&!!e,meta:{disableToast:!0}});return w.useEffect(()=>{if(!o.isFetching&&o.isSuccess&&o.data){const a=o.data;if(a!==n.current)if(n.current=a,Array.isArray(a)){const c=new Set(a.map(u=>u.path)),f=new Set(t.map(u=>u.path)),h=a.filter(u=>!f.has(u.path)),M=t.filter(u=>c.has(u.path));r([...h,...M])}else r([a])}},[o.isFetching,o.isSuccess,o.data]),{data:t,isLoading:o.isLoading,isSuccess:o.isSuccess,isError:o.isError,error:o.error}},ne=[{key:E.TIPS$CUSTOMIZE_MICROAGENT,link:"https://docs.all-hands.dev/usage/prompting/microagents-repo"},{key:E.TIPS$SETUP_SCRIPT,link:"https://docs.all-hands.dev/usage/prompting/repository#setup-script"},{key:E.TIPS$VSCODE_INSTANCE},{key:E.TIPS$SAVE_WORK},{key:E.TIPS$SPECIFY_FILES,link:"https://docs.all-hands.dev/usage/prompting/prompting-best-practices"},{key:E.TIPS$HEADLESS_MODE,link:"https://docs.all-hands.dev/usage/how-to/headless-mode"},{key:E.TIPS$CLI_MODE,link:"https://docs.all-hands.dev/usage/how-to/cli-mode"},{key:E.TIPS$GITHUB_HOOK,link:"https://docs.all-hands.dev/usage/cloud/github-installation#working-on-github-issues-and-pull-requests-using-openhands"},{key:E.TIPS$BLOG_SIGNUP,link:"https://www.all-hands.dev/blog"},{key:E.TIPS$API_USAGE,link:"https://docs.all-hands.dev/api-reference/health-check"}];function Wt(){const e=Math.floor(Math.random()*ne.length);return ne[e]}function zt(){const{t:e}=ye(),[t,r]=w.useState(()=>ne[0]);return w.useEffect(()=>{r(Wt())},[]),t?d.jsxs("div",{className:"space-y-1",children:[d.jsxs("h4",{className:"font-bold",children:[e(E.TIPS$PROTIP),":"]}),d.jsxs("p",{children:[e(t.key)," ",t.link?d.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"underline",children:e(E.TIPS$LEARN_MORE)}):null]})]}):null}const ge=/not a git repository/i;function Kt({children:e}){return d.jsx("div",{className:"w-full h-full flex flex-col items-center text-center justify-center text-2xl text-tertiary-light",children:e})}function Fr(){const{t:e}=ye(),{data:t,isSuccess:r,isError:n,error:i,isLoading:o}=Bt(),[a,c]=w.useState(null),{curAgentState:f}=Te(),h=!Pe.includes(f),M=i&&ge.test(se(i));return w.useEffect(()=>{if(!h)c([E.DIFF_VIEWER$WAITING_FOR_RUNTIME]);else if(i){const u=se(i);ge.test(u)?c([E.DIFF_VIEWER$NOT_A_GIT_REPO,E.DIFF_VIEWER$ASK_OH]):c([u])}else c(o?[E.DIFF_VIEWER$LOADING]:null)},[h,M,o,i,c]),d.jsx("main",{className:"h-full overflow-y-scroll p-4 md:pr-1.5 gap-3 flex flex-col items-center custom-scrollbar-always",children:!r||!t.length?d.jsxs("div",{className:"relative flex h-full w-full items-center",children:[d.jsx("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2",children:a&&d.jsx(Kt,{children:a.map(u=>d.jsx("span",{children:e(u)},u))})}),d.jsx("div",{className:"absolute inset-x-0 bottom-0",children:!n&&t?.length===0&&d.jsx("div",{className:"max-w-2xl mb-4 text-m bg-tertiary rounded-xl p-4 text-left mx-auto",children:d.jsx(zt,{})})})]}):t.slice(0,100).map(u=>d.jsx(qt,{path:u.path,type:u.status},u.path))})}export{Fr as default};
