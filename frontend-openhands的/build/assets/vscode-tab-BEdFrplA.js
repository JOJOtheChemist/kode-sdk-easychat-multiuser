import{R as I,r as s,p as e}from"./chunk-NISHYRIK-CKdEls7F.js";import{I as n}from"./declaration-B9eIPmUJ.js";import{b as R,a as _,R as N}from"./parse-pr-url-DDbpIt54.js";import{a as C}from"./use-config-DZPclKuv.js";import{C as y}from"./git-provider-icon-Db_Bl_5f.js";import{u as h,t as g,W as w}from"./conversation-WQiCKy8A.js";import{u as m}from"./useTranslation-DONB_giz.js";import"./open-hands-axios-BIuoB8bl.js";import"./module-CWLbpm_7.js";import"./index-DWiKAxKp.js";import"./query-client-config-Dd99l1aU.js";import"./i18next-Lgj2Bm8L.js";import"./retrieve-axios-error-message-CYr77e_f.js";import"./custom-toast-handlers-fYPNAJaC.js";import"./option-service.api-CTPg1Fmy.js";import"./infiniteQueryBehavior-D7Qz1qlw.js";import"./use-user-providers-P0hmd5MI.js";import"./use-settings-B2QUSrrJ.js";import"./use-is-authed-Dg_tgDAm.js";import"./utils-BVnsmU2z.js";import"./bundle-mjs-0JNfDbnS.js";import"./close-bbjPMB7Q.js";import"./index-BDUzCKOA.js";import"./chunk-MSDKUXDP-Cfu5rKGn.js";import"./chunk-TX3FPB7D-DZsJI2yo.js";import"./brand-button-BQs8JWFf.js";import"./index-S5BalIfI.js";import"./tooltip-button-DdCqtqn-.js";import"./preload-helper-BXl3LOEh.js";import"./index-JAudiiL9.js";import"./index-CX-90vHk.js";import"./constants-DE11vt2u.js";import"./typography-dnvkoiv9.js";import"./repo-forked-BC1XV35P.js";import"./modal-backdrop-cp3dlfku.js";import"./modal-body-BthUSAn0.js";import"./base-modal-DLway4p0.js";import"./index-at5IPRPS.js";import"./Trans-CPaTqF-h.js";import"./settings-dropdown-input-CJWg5DfQ.js";import"./optional-tag-SXD2PjYq.js";import"./useSingleSelectListState-Dp1i9X5O.js";import"./loading-spinner-C-wnmolE.js";const O=()=>{const{t}=m(),{conversationId:r}=R(),o=h();return C({queryKey:["vscode_url",r],queryFn:async()=>{if(!r)throw new Error("No conversation ID");const i=await y.getVSCodeUrl(r);return i.vscode_url?{url:g(i.vscode_url),error:null}:{url:null,error:t(n.VSCODE$URL_NOT_AVAILABLE)}},enabled:o&&!!r,refetchOnMount:!0,retry:3})};function v(t,r=!1){try{const o=localStorage.getItem(`FEATURE_${t}`)||r.toString();return!!JSON.parse(o)}catch{return r}}const A=()=>v("VSCODE_IN_NEW_TAB");function Rr(){const{t}=m(),{data:r,isLoading:o,error:i}=O(),{curAgentState:c}=_(),u=N.includes(c),p=I.useRef(null),[f,d]=s.useState(!1),[a,E]=s.useState(null);s.useEffect(()=>{if(r?.url)try{const l=new URL(r.url).protocol,x=window.location.protocol;d(A()||l!==x)}catch{E(t("VSCODE$URL_PARSE_ERROR"))}},[r?.url]);const S=()=>{r?.url&&window.open(r.url,"_blank","noopener,noreferrer")};return u||o?e.jsx(w,{}):i||r&&r.error||!r?.url||a?e.jsx("div",{className:"w-full h-full flex items-center text-center justify-center text-2xl text-tertiary-light",children:a||r?.error||String(i)||t(n.VSCODE$URL_NOT_AVAILABLE)}):f?e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"text-xl text-tertiary-light text-center max-w-md",children:t("VSCODE$CROSS_ORIGIN_WARNING")}),e.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 bg-primary text-white rounded-sm hover:bg-primary-dark transition-colors",children:t("VSCODE$OPEN_IN_NEW_TAB")})]}):e.jsx("div",{className:"h-full w-full",children:e.jsx("iframe",{ref:p,title:t(n.VSCODE$TITLE),src:r.url,className:"w-full h-full border-0",allow:"clipboard-read; clipboard-write"})})}export{Rr as default};
