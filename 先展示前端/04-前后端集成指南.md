# å‰åç«¯é›†æˆæŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•å°†å‰ç«¯ï¼ˆç«¯å£ 3020ï¼‰ä¸åç«¯ Kode-SDKï¼ˆGLM-4.5-air æ¨¡å‹ï¼‰è¿æ¥èµ·æ¥ï¼Œå®ç°å®Œæ•´çš„å¯¹è¯åŠŸèƒ½ã€‚

---

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (3020)   â”‚         â”‚  WebSocket       â”‚         â”‚  Kode-SDK       â”‚
â”‚   React + SIO   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤  Bridge (3001)   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤  GLM-4.5-air    â”‚
â”‚                 â”‚ Socket  â”‚  é€‚é…å±‚          â”‚  Events â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
   â†“
å‰ç«¯ ChatInputField
   â†“
Socket.IO emit("oh_user_action")
   â†“
WebSocket Bridge æ¥æ”¶
   â†“
è½¬æ¢ä¸º Kode-SDK æ ¼å¼
   â†“
Agent.send(message)
   â†“
GLM-4.5-air æ¨¡å‹å¤„ç†
   â†“
Agent äº‹ä»¶æµï¼ˆProgress + Monitorï¼‰
   â†“
è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼
   â†“
Socket.IO emit("oh_event")
   â†“
å‰ç«¯æ¥æ”¶å¹¶æ˜¾ç¤º
```

---

## ä¸€ã€åç«¯æœåŠ¡å™¨å·²åˆ›å»º âœ…

### 1.1 WebSocket Bridge æœåŠ¡å™¨

**ä½ç½®**: `Kode-sdk/server/websocket-bridge.ts`

**åŠŸèƒ½**:
- âœ… Socket.IO æœåŠ¡å™¨ï¼ˆç«¯å£ 3001ï¼‰
- âœ… Kode-SDK Agent ç®¡ç†
- âœ… æ¶ˆæ¯æ ¼å¼è½¬æ¢ï¼ˆå‰ç«¯ â†” Kode-SDKï¼‰
- âœ… äº‹ä»¶æµè½¬å‘ï¼ˆKode-SDK â†’ å‰ç«¯ï¼‰
- âœ… GLM-4.5-air æ¨¡å‹é›†æˆ
- âœ… å·¥å…·è°ƒç”¨æ”¯æŒï¼ˆTODOã€æ–‡ä»¶ç³»ç»Ÿï¼‰

### 1.2 å·²å®‰è£…çš„ä¾èµ–

```json
{
  "dependencies": {
    "express": "^4.18.2",
    "socket.io": "^4.6.1",
    "cors": "^2.8.5"
  },
  "devDependencies": {
    "@types/express": "^4.17.17",
    "@types/cors": "^2.8.13",
    "ts-node-dev": "^2.0.0"
  }
}
```

---

## äºŒã€å‰ç«¯é…ç½®

### 2.1 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶

åœ¨ `frontend/` ç›®å½•ä¸‹åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```bash
# frontend/.env.local
VITE_BACKEND_BASE_URL=localhost:3001
```

### 2.2 WebSocket è¿æ¥é…ç½®

å‰ç«¯å·²ç»é…ç½®å¥½ Socket.IO å®¢æˆ·ç«¯ï¼Œä¼šè‡ªåŠ¨è¿æ¥åˆ° `VITE_BACKEND_BASE_URL` æŒ‡å®šçš„åœ°å€ã€‚

**è¿æ¥é€»è¾‘** (`frontend/src/context/ws-client-provider.tsx`):

```typescript
const baseUrl = 
  (import.meta.env.VITE_BACKEND_BASE_URL as string | undefined) ||
  window?.location.host;

const sio = io(baseUrl, {
  transports: ["websocket"],
  path: "/socket.io",
  query: {
    conversationId: conversationId,
    // ... å…¶ä»–å‚æ•°
  }
});
```

---

## ä¸‰ã€å¯åŠ¨æ­¥éª¤

### 3.1 å¯åŠ¨åç«¯æœåŠ¡å™¨

```bash
# è¿›å…¥åç«¯ç›®å½•
cd /Users/yeya/FlutterProjects/kode-sdk/Kode-sdk

# æ–¹å¼ 1: ç›´æ¥å¯åŠ¨
npm run server

# æ–¹å¼ 2: å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰
npm run server:dev
```

**é¢„æœŸè¾“å‡º**:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         WebSocket Bridge Server å·²å¯åŠ¨               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸŒ æœåŠ¡å™¨åœ°å€: http://localhost:3001
ğŸ”— å‰ç«¯åœ°å€: http://localhost:3020
ğŸ¤– AI æ¨¡å‹: glm-4.5-air

âœ… å‡†å¤‡æ¥æ”¶å‰ç«¯è¿æ¥...
```

### 3.2 é…ç½®å¹¶å¯åŠ¨å‰ç«¯

1. **åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶**:

```bash
# åœ¨ frontend ç›®å½•ä¸‹
echo "VITE_BACKEND_BASE_URL=localhost:3001" > .env.local
```

2. **å¯åŠ¨å‰ç«¯**:

```bash
cd /Users/yeya/FlutterProjects/kode-sdk/frontend
npm run dev
```

3. **è®¿é—®å‰ç«¯**:

æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3020`

---

## å››ã€æ¶ˆæ¯æ ¼å¼æ˜ å°„

### 4.1 å‰ç«¯ â†’ åç«¯

**å‰ç«¯å‘é€** (`Socket.IO emit`):

```typescript
// äº‹ä»¶å: "oh_user_action"
{
  action: "message",
  args: {
    content: "ä½ å¥½",
    image_urls: [],
    file_urls: [],
    timestamp: "2025-10-13T..."
  }
}
```

**åç«¯æ¥æ”¶å¹¶è½¬æ¢**:

```typescript
// æå– content å¹¶å‘é€ç»™ Agent
await agent.send(data.args.content);
```

### 4.2 åç«¯ â†’ å‰ç«¯

#### A. æ–‡æœ¬æµäº‹ä»¶

**Kode-SDK äº‹ä»¶**:
```typescript
{
  type: 'text_chunk',
  delta: 'ä½ å¥½'
}
```

**è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼** (`Socket.IO emit: "oh_event"`):
```typescript
{
  id: "1001",
  source: "agent",
  type: "message",
  message: "ä½ å¥½",
  timestamp: "2025-10-13T...",
  action: "message",
  args: { content: "ä½ å¥½" }
}
```

#### B. å·¥å…·è°ƒç”¨äº‹ä»¶

**Kode-SDK äº‹ä»¶**:
```typescript
{
  type: 'tool:start',
  call: {
    name: 'todo_write',
    id: 'call_123',
    inputPreview: { todos: [...] }
  }
}
```

**è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼**:
```typescript
{
  id: "1002",
  source: "agent",
  type: "tool_call_start",
  message: "è°ƒç”¨å·¥å…·: todo_write",
  timestamp: "2025-10-13T...",
  action: "todo_write",
  args: { todos: [...] },
  extras: {
    tool_name: "todo_write",
    tool_id: "call_123"
  }
}
```

#### C. å®Œæˆäº‹ä»¶

**Kode-SDK äº‹ä»¶**:
```typescript
{
  type: 'done',
  reason: 'completed'
}
```

**è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼**:
```typescript
{
  id: "1003",
  source: "agent",
  type: "agent_state_change",
  message: "finished",
  timestamp: "2025-10-13T...",
  extras: {
    agent_state: "finished",
    reason: "completed"
  }
}
```

---

## äº”ã€å®Œæ•´æµ‹è¯•æµç¨‹

### 5.1 å¯åŠ¨æœåŠ¡

1. **ç»ˆç«¯ 1 - å¯åŠ¨åç«¯**:
```bash
cd /Users/yeya/FlutterProjects/kode-sdk/Kode-sdk
npm run server
```

2. **ç»ˆç«¯ 2 - å¯åŠ¨å‰ç«¯**:
```bash
cd /Users/yeya/FlutterProjects/kode-sdk/frontend
# ç¡®ä¿å·²åˆ›å»º .env.local æ–‡ä»¶
npm run dev
```

### 5.2 æµ‹è¯•å¯¹è¯

1. **æ‰“å¼€æµè§ˆå™¨**: `http://localhost:3020`
2. **è¾“å…¥æµ‹è¯•æ¶ˆæ¯**: "ä½ å¥½"
3. **è§‚å¯Ÿè¡Œä¸º**:
   - âœ… å‰ç«¯å‘é€æ¶ˆæ¯
   - âœ… åç«¯æ¥æ”¶å¹¶å¤„ç†
   - âœ… GLM-4.5-air ç”Ÿæˆå›å¤
   - âœ… å‰ç«¯æ˜¾ç¤ºæµå¼å›å¤

### 5.3 æµ‹è¯•å·¥å…·è°ƒç”¨

1. **è¾“å…¥**: "è¯·å¸®æˆ‘åˆ›å»º2ä¸ªå¾…åŠäº‹é¡¹ï¼š1. å­¦ä¹ SDK 2. ç¼–å†™æ–‡æ¡£"
2. **é¢„æœŸè¡Œä¸º**:
   - âœ… æ˜¾ç¤ºå·¥å…·è°ƒç”¨å¼€å§‹ï¼ˆtodo_writeï¼‰
   - âœ… æ˜¾ç¤ºå·¥å…·æ‰§è¡Œå‚æ•°
   - âœ… æ˜¾ç¤ºå·¥å…·æ‰§è¡Œå®Œæˆ
   - âœ… æ˜¾ç¤ºAIçš„æœ€ç»ˆå›å¤

### 5.4 æŸ¥çœ‹æ—¥å¿—

**åç«¯æ—¥å¿—**:
```
ğŸ“¨ æ”¶åˆ°å‰ç«¯æ¶ˆæ¯: { action: 'message', args: { content: 'ä½ å¥½' } }
ğŸ“¤ å‘é€äº‹ä»¶åˆ°å‰ç«¯: message ä½ å¥½
ğŸ“¤ å‘é€äº‹ä»¶åˆ°å‰ç«¯: message_end 
ğŸ“¤ å‘é€äº‹ä»¶åˆ°å‰ç«¯: agent_state_change finished
```

**æµè§ˆå™¨æ§åˆ¶å°**:
- æŸ¥çœ‹ WebSocket è¿æ¥çŠ¶æ€
- æŸ¥çœ‹æ¥æ”¶åˆ°çš„äº‹ä»¶
- æŸ¥çœ‹ä»»ä½•é”™è¯¯ä¿¡æ¯

---

## å…­ã€å¸¸è§é—®é¢˜æ’æŸ¥

### 6.1 å‰ç«¯æ— æ³•è¿æ¥åˆ°åç«¯

**ç—‡çŠ¶**: å‰ç«¯æ˜¾ç¤º "Failed to connect to server"

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ**:
```bash
curl http://localhost:3001/health
# åº”è¿”å›: {"status":"ok","agents":0,...}
```

2. **æ£€æŸ¥ç¯å¢ƒå˜é‡**:
```bash
# åœ¨ frontend ç›®å½•ä¸‹
cat .env.local
# åº”æ˜¾ç¤º: VITE_BACKEND_BASE_URL=localhost:3001
```

3. **æ£€æŸ¥ç«¯å£å ç”¨**:
```bash
lsof -i :3001
# åº”è¯¥æ˜¾ç¤º node è¿›ç¨‹
```

4. **é‡å¯å‰ç«¯å¼€å‘æœåŠ¡å™¨**:
```bash
# ç¯å¢ƒå˜é‡æ›´æ”¹åéœ€è¦é‡å¯
npm run dev
```

### 6.2 æ¶ˆæ¯å‘é€æˆåŠŸä½†æ— å“åº”

**ç—‡çŠ¶**: å‰ç«¯å‘é€æ¶ˆæ¯ï¼Œåç«¯æ”¶åˆ°ï¼Œä½†æ— å›å¤

**æ£€æŸ¥æ­¥éª¤**:

1. **æŸ¥çœ‹åç«¯æ—¥å¿—**:
```bash
# åº”è¯¥çœ‹åˆ°ï¼š
ğŸ“¨ æ”¶åˆ°å‰ç«¯æ¶ˆæ¯: ...
ğŸ“¤ å‘é€äº‹ä»¶åˆ°å‰ç«¯: ...
```

2. **æ£€æŸ¥ GLM API Key**:
```bash
# åœ¨ Kode-sdk/server/websocket-bridge.ts ä¸­
# ç¡®è®¤ GLM_API_KEY æ­£ç¡®
```

3. **æµ‹è¯• GLM æ¨¡å‹**:
```bash
cd Kode-sdk
npx ts-node examples/test-glm.ts
# åº”è¯¥æˆåŠŸè·å¾—å›å¤
```

### 6.3 å·¥å…·è°ƒç”¨å¤±è´¥

**ç—‡çŠ¶**: AI å°è¯•è°ƒç”¨å·¥å…·ï¼Œä½†å¤±è´¥

**æ£€æŸ¥**:

1. **æŸ¥çœ‹åç«¯æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯**
2. **ç¡®è®¤å·¥å…·å·²æ³¨å†Œ** (åœ¨ `websocket-bridge.ts` ä¸­)
3. **æ£€æŸ¥å·¥å…·æƒé™** (æ–‡ä»¶ç³»ç»Ÿå·¥å…·éœ€è¦æ­£ç¡®çš„å·¥ä½œç›®å½•)

### 6.4 CORS é”™è¯¯

**ç—‡çŠ¶**: æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º CORS é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:

åç«¯å·²é…ç½® CORSï¼Œç¡®ä¿ `FRONTEND_URL` æ­£ç¡®ï¼š

```typescript
// websocket-bridge.ts
const FRONTEND_URL = 'http://localhost:3020';
```

å¦‚æœå‰ç«¯ç«¯å£ä¸åŒï¼Œä¿®æ”¹è¿™ä¸ªå€¼å¹¶é‡å¯åç«¯ã€‚

---

## ä¸ƒã€ç›‘æ§ä¸è°ƒè¯•

### 7.1 åç«¯æ—¥å¿—

åç«¯ä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š

```bash
ğŸ”Œ å®¢æˆ·ç«¯è¿æ¥: socket_id_123
ğŸ“ ä¼šè¯ ID: default
âœ… Agent å°±ç»ª: default
ğŸ“¨ æ”¶åˆ°å‰ç«¯æ¶ˆæ¯: { action: 'message', ... }
ğŸ”§ è°ƒç”¨å·¥å…·: todo_write
ğŸ“Š Token ä½¿ç”¨: è¾“å…¥=45, è¾“å‡º=28
ğŸ“¤ å‘é€äº‹ä»¶åˆ°å‰ç«¯: tool_call_start è°ƒç”¨å·¥å…·: todo_write
ğŸ“¤ å‘é€äº‹ä»¶åˆ°å‰ç«¯: message æˆ‘å·²ç»...
```

### 7.2 å‰ç«¯è°ƒè¯•

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š

1. **Network æ ‡ç­¾**:
   - æŸ¥çœ‹ WebSocket è¿æ¥ï¼ˆWSï¼‰
   - æŸ¥çœ‹æ¶ˆæ¯æ”¶å‘

2. **Console æ ‡ç­¾**:
   - æŸ¥çœ‹ä»»ä½• JavaScript é”™è¯¯
   - æŸ¥çœ‹ Socket.IO æ—¥å¿—ï¼ˆå¦‚æœå¯ç”¨ï¼‰

3. **React DevTools**:
   - æŸ¥çœ‹ç»„ä»¶çŠ¶æ€
   - æŸ¥çœ‹ Store æ•°æ®

### 7.3 å¥åº·æ£€æŸ¥ç«¯ç‚¹

```bash
# æ£€æŸ¥åç«¯çŠ¶æ€
curl http://localhost:3001/health

# è¿”å›ï¼š
{
  "status": "ok",
  "agents": 1,
  "timestamp": "2025-10-13T..."
}
```

---

## å…«ã€ä¼˜åŒ–å»ºè®®

### 8.1 ç”Ÿäº§ç¯å¢ƒé…ç½®

1. **ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯**:

```bash
# åç«¯
export GLM_API_KEY="your-api-key"
export PORT=3001

# å‰ç«¯
VITE_BACKEND_BASE_URL=your-production-domain:3001
```

2. **å¯ç”¨ HTTPS**:
- é…ç½® SSL è¯ä¹¦
- æ›´æ–° CORS è®¾ç½®

3. **æ·»åŠ è¯·æ±‚é™åˆ¶**:
- å®ç°é€Ÿç‡é™åˆ¶
- æ·»åŠ èº«ä»½éªŒè¯

### 8.2 æ€§èƒ½ä¼˜åŒ–

1. **Agent æ± ç®¡ç†**:
- é™åˆ¶å¹¶å‘ Agent æ•°é‡
- å®ç° Agent è¶…æ—¶æ¸…ç†

2. **æ¶ˆæ¯é˜Ÿåˆ—**:
- å¤„ç†é«˜å¹¶å‘è¯·æ±‚
- å®ç°æ¶ˆæ¯æŒä¹…åŒ–

3. **ç¼“å­˜ç­–ç•¥**:
- ç¼“å­˜å¸¸ç”¨å“åº”
- å®ç°ä¼šè¯æŒä¹…åŒ–

---

## ä¹ã€API å‚è€ƒ

### 9.1 WebSocket äº‹ä»¶

#### å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨

```typescript
// äº‹ä»¶: "oh_user_action"
socket.emit("oh_user_action", {
  action: "message",
  args: {
    content: string,
    image_urls?: string[],
    file_urls?: string[],
    timestamp?: string
  }
});
```

#### æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯

```typescript
// äº‹ä»¶: "oh_event"
socket.on("oh_event", (data: {
  id: string,
  source: "user" | "agent",
  type: string,
  message: string,
  timestamp: string,
  action?: string,
  args?: any,
  extras?: any
}) => {
  // å¤„ç†äº‹ä»¶
});
```

### 9.2 æ”¯æŒçš„äº‹ä»¶ç±»å‹

| äº‹ä»¶ç±»å‹ | è¯´æ˜ | æ¥æº |
|---------|------|------|
| `message` | æ–‡æœ¬æ¶ˆæ¯ | User/Agent |
| `message_start` | æ¶ˆæ¯å¼€å§‹ | Agent |
| `message_end` | æ¶ˆæ¯ç»“æŸ | Agent |
| `tool_call_start` | å·¥å…·è°ƒç”¨å¼€å§‹ | Agent |
| `tool_call_end` | å·¥å…·è°ƒç”¨ç»“æŸ | Agent |
| `agent_state_change` | Agent çŠ¶æ€å˜åŒ– | Agent |
| `error` | é”™è¯¯ | Agent |

---

## åã€ä¸‹ä¸€æ­¥

### 10.1 åŠŸèƒ½æ‰©å±•

- [ ] æ·»åŠ å›¾ç‰‡ä¸Šä¼ æ”¯æŒ
- [ ] æ·»åŠ æ–‡ä»¶ä¸Šä¼ æ”¯æŒ
- [ ] å®ç°ä¼šè¯å†å²
- [ ] æ·»åŠ ç”¨æˆ·è®¤è¯
- [ ] å®ç°å¤šç”¨æˆ·æ”¯æŒ

### 10.2 å‰ç«¯å¢å¼º

- [ ] ä¼˜åŒ–æ¶ˆæ¯æ˜¾ç¤º
- [ ] æ·»åŠ å·¥å…·è°ƒç”¨å¯è§†åŒ–
- [ ] å®ç°æ¶ˆæ¯ç¼–è¾‘
- [ ] æ·»åŠ å¿«æ·å‘½ä»¤

### 10.3 åç«¯å¢å¼º

- [ ] æ·»åŠ æ›´å¤šå·¥å…·
- [ ] å®ç°å·¥å…·å®¡æ‰¹æµç¨‹
- [ ] æ·»åŠ æ—¥å¿—ç³»ç»Ÿ
- [ ] å®ç°ç›‘æ§å‘Šè­¦

---

## é™„å½• A: å¿«é€Ÿå¯åŠ¨è„šæœ¬

### å¯åŠ¨åç«¯

```bash
#!/bin/bash
cd /Users/yeya/FlutterProjects/kode-sdk/Kode-sdk
npm run server
```

### å¯åŠ¨å‰ç«¯

```bash
#!/bin/bash
cd /Users/yeya/FlutterProjects/kode-sdk/frontend

# åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
if [ ! -f .env.local ]; then
  echo "VITE_BACKEND_BASE_URL=localhost:3001" > .env.local
fi

npm run dev
```

### å®Œæ•´å¯åŠ¨ï¼ˆéœ€è¦ tmux æˆ–å¤šç»ˆç«¯ï¼‰

```bash
#!/bin/bash
# å¯åŠ¨åç«¯
cd /Users/yeya/FlutterProjects/kode-sdk/Kode-sdk
npm run server &
BACKEND_PID=$!

# ç­‰å¾…åç«¯å¯åŠ¨
sleep 3

# å¯åŠ¨å‰ç«¯
cd /Users/yeya/FlutterProjects/kode-sdk/frontend
if [ ! -f .env.local ]; then
  echo "VITE_BACKEND_BASE_URL=localhost:3001" > .env.local
fi
npm run dev &
FRONTEND_PID=$!

echo "âœ… æœåŠ¡å·²å¯åŠ¨"
echo "   åç«¯ PID: $BACKEND_PID"
echo "   å‰ç«¯ PID: $FRONTEND_PID"
echo ""
echo "è®¿é—®: http://localhost:3020"
echo ""
echo "æŒ‰ Ctrl+C åœæ­¢æ‰€æœ‰æœåŠ¡"

# ç­‰å¾…ä¸­æ–­ä¿¡å·
trap "kill $BACKEND_PID $FRONTEND_PID; exit" INT
wait
```

---

## é™„å½• B: æµ‹è¯•ç”¨ä¾‹

### B.1 åŸºæœ¬å¯¹è¯æµ‹è¯•

```typescript
// æµ‹è¯•æ¶ˆæ¯
const testMessages = [
  "ä½ å¥½",
  "è¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±",
  "ä½ èƒ½åšä»€ä¹ˆ",
];

// é¢„æœŸè¡Œä¸º
// 1. å‘é€æ¶ˆæ¯
// 2. æ”¶åˆ° message_start äº‹ä»¶
// 3. æ”¶åˆ°å¤šä¸ª message äº‹ä»¶ï¼ˆæµå¼æ–‡æœ¬ï¼‰
// 4. æ”¶åˆ° message_end äº‹ä»¶
// 5. æ”¶åˆ° agent_state_change (finished) äº‹ä»¶
```

### B.2 å·¥å…·è°ƒç”¨æµ‹è¯•

```typescript
// æµ‹è¯•æ¶ˆæ¯
const toolTestMessages = [
  "è¯·åˆ›å»ºä¸€ä¸ªå¾…åŠäº‹é¡¹ï¼šå­¦ä¹  Kode-SDK",
  "åˆ—å‡ºæ‰€æœ‰å¾…åŠäº‹é¡¹",
  "è¯»å–å½“å‰ç›®å½•çš„æ–‡ä»¶",
];

// é¢„æœŸè¡Œä¸º
// 1. å‘é€æ¶ˆæ¯
// 2. æ”¶åˆ° tool_call_start äº‹ä»¶
// 3. æ”¶åˆ° tool_call_end äº‹ä»¶ï¼ˆå¸¦ç»“æœï¼‰
// 4. æ”¶åˆ° message äº‹ä»¶ï¼ˆAI çš„æ€»ç»“ï¼‰
// 5. æ”¶åˆ° agent_state_change (finished) äº‹ä»¶
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¶é—´**: 2025-10-13  
**ç»´æŠ¤è€…**: AI Assistant

