# Frontend AI å¯¹è¯ç•Œé¢æ¶æ„åˆ†æ

> æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Frontend é¡¹ç›®ä¸­ AI å¯¹è¯ç•Œé¢çš„å®Œæ•´æ¶æ„å’Œç»„ä»¶ä½“ç³»

## ç›®å½•

1. [æ ¸å¿ƒç»„ä»¶æ¶æ„](#æ ¸å¿ƒç»„ä»¶æ¶æ„)
2. [ç»„ä»¶è¯¦ç»†è¯´æ˜](#ç»„ä»¶è¯¦ç»†è¯´æ˜)
3. [æ¶ˆæ¯å‘é€æµç¨‹](#æ¶ˆæ¯å‘é€æµç¨‹)
4. [å…³é”®åŠŸèƒ½æ¨¡å—](#å…³é”®åŠŸèƒ½æ¨¡å—)
5. [çŠ¶æ€ç®¡ç†](#çŠ¶æ€ç®¡ç†)
6. [æ–‡ä»¶ä¸Šä¼ å¤„ç†](#æ–‡ä»¶ä¸Šä¼ å¤„ç†)

---

## æ ¸å¿ƒç»„ä»¶æ¶æ„

### ç»„ä»¶å±‚æ¬¡ç»“æ„æ ‘

```
ChatInterface (ä¸»å¯¹è¯ç•Œé¢)
â”œâ”€â”€ Messages (æ¶ˆæ¯åˆ—è¡¨æ˜¾ç¤º)
â”‚   â”œâ”€â”€ EventMessage (äº‹ä»¶æ¶ˆæ¯)
â”‚   â””â”€â”€ ChatMessage (èŠå¤©æ¶ˆæ¯)
â”‚       â”œâ”€â”€ UserAvatar (ç”¨æˆ·å¤´åƒ)
â”‚       â””â”€â”€ AssistantAvatar (AI å¤´åƒ)
â”œâ”€â”€ ScrollToBottomButton (æ»šåŠ¨åˆ°åº•éƒ¨æŒ‰é’®)
â”œâ”€â”€ TypingIndicator (æ‰“å­—æŒ‡ç¤ºå™¨)
â”œâ”€â”€ ErrorMessageBanner (é”™è¯¯æ¶ˆæ¯æ¨ªå¹…)
â””â”€â”€ InteractiveChatBox (äº¤äº’å¼èŠå¤©ç›’)
    â”œâ”€â”€ CustomChatInput (è‡ªå®šä¹‰èŠå¤©è¾“å…¥)
    â”‚   â”œâ”€â”€ HiddenFileInput (éšè—çš„æ–‡ä»¶è¾“å…¥)
    â”‚   â”œâ”€â”€ ChatInputGrip (è°ƒæ•´å¤§å°æ‰‹æŸ„)
    â”‚   â””â”€â”€ ChatInputContainer (è¾“å…¥å®¹å™¨)
    â”‚       â”œâ”€â”€ DragOver (æ‹–æ”¾æç¤º UI)
    â”‚       â”œâ”€â”€ UploadedFiles (å·²ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨)
    â”‚       â”œâ”€â”€ ChatInputRow (è¾“å…¥è¡Œ)
    â”‚       â”‚   â”œâ”€â”€ ChatAddFileButton (æ·»åŠ æ–‡ä»¶æŒ‰é’® ğŸ“)
    â”‚       â”‚   â”œâ”€â”€ ChatInputField (è¾“å…¥æ¡† âœï¸ æ ¸å¿ƒ!)
    â”‚       â”‚   â””â”€â”€ ChatSendButton (å‘é€æŒ‰é’® ğŸ“¤)
    â”‚       â””â”€â”€ ChatInputActions (èŠå¤©æ“ä½œ)
    â”‚           â”œâ”€â”€ StopButton (åœæ­¢æŒ‰é’®)
    â”‚           â””â”€â”€ ResumeButton (æ¢å¤æŒ‰é’®)
    â””â”€â”€ GitControlBar (Git æ§åˆ¶æ )
```

---

## ç»„ä»¶è¯¦ç»†è¯´æ˜

### 1. ChatInterface (ä¸»å¯¹è¯ç•Œé¢)

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/chat-interface.tsx`

**æ ¸å¿ƒèŒè´£**:
- ç®¡ç†æ•´ä¸ªå¯¹è¯ç•Œé¢çš„å¸ƒå±€å’ŒçŠ¶æ€
- å¤„ç†æ¶ˆæ¯å‘é€é€»è¾‘
- ç®¡ç†æ»šåŠ¨è¡Œä¸º
- å¤„ç†é”™è¯¯æ˜¾ç¤º
- é›†æˆ WebSocket é€šä¿¡

**å…³é”®æ–¹æ³•**:

```typescript
// å‘é€æ¶ˆæ¯çš„æ ¸å¿ƒæ–¹æ³•
const handleSendMessage = async (
  content: string,
  originalImages: File[],
  originalFiles: File[],
) => {
  // 1. éªŒè¯æ–‡ä»¶å¤§å°
  const validation = validateFiles(allFiles);
  
  // 2. è½¬æ¢å›¾ç‰‡ä¸º Base64
  const imageUrls = await Promise.all(promises);
  
  // 3. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
  const { uploaded_files } = await uploadFiles({ conversationId, files });
  
  // 4. é€šè¿‡ WebSocket å‘é€æ¶ˆæ¯
  send(createChatMessage(prompt, imageUrls, uploadedFiles, timestamp));
  
  // 5. è®¾ç½®ä¹è§‚æ›´æ–°
  setOptimisticUserMessage(content);
};
```

**çŠ¶æ€ç®¡ç†**:
- `curAgentState`: å½“å‰ Agent çŠ¶æ€ï¼ˆRUNNING, STOPPED, LOADING ç­‰ï¼‰
- `errorMessage`: é”™è¯¯æ¶ˆæ¯
- `events`: äº‹ä»¶åˆ—è¡¨ï¼ˆç”¨æˆ·æ¶ˆæ¯ã€AI å“åº”ï¼‰
- `optimisticUserMessage`: ä¹è§‚æ›´æ–°çš„ç”¨æˆ·æ¶ˆæ¯

**å…³é”®ç‰¹æ€§**:
- è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
- æ˜¾ç¤ºå»ºè®®ï¼ˆSuggestionsï¼‰
- åé¦ˆåŠŸèƒ½ï¼ˆæ­£é¢/è´Ÿé¢ï¼‰
- åŠ è½½çŠ¶æ€æŒ‡ç¤º
- Posthog äº‹ä»¶è¿½è¸ª

---

### 2. InteractiveChatBox (äº¤äº’å¼èŠå¤©ç›’)

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/interactive-chat-box.tsx`

**æ ¸å¿ƒèŒè´£**:
- å¤„ç†æ–‡ä»¶ä¸Šä¼ é€»è¾‘
- ç®¡ç†å›¾ç‰‡å’Œæ–‡ä»¶çš„éªŒè¯
- åè°ƒè¾“å…¥æ¡†å’Œ Git æ§åˆ¶æ 

**å…³é”®æ–¹æ³•**:

```typescript
// æ–‡ä»¶ä¸Šä¼ å¤„ç†
const handleUpload = async (selectedFiles: File[]) => {
  // 1. éªŒè¯å’Œè¿‡æ»¤æ–‡ä»¶
  const { validFiles, validImages } = validateAndFilterFiles(selectedFiles);
  
  // 2. æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
  showLoadingIndicators(validFiles, validImages);
  
  // 3. å¤„ç†æ–‡ä»¶ï¼ˆä½¿ç”¨çœŸå®çš„ FileReaderï¼‰
  const [fileResults, imageResults] = await Promise.all([
    processFiles(validFiles),
    processImages(validImages),
  ]);
  
  // 4. å¤„ç†æˆåŠŸå’Œå¤±è´¥çš„ç»“æœ
  handleSuccessfulFiles(fileResults);
  handleSuccessfulImages(imageResults);
  handleFailedFiles(fileResults, imageResults);
};
```

**çŠ¶æ€æ¥æº**:
- `useConversationStore`: å›¾ç‰‡ã€æ–‡ä»¶ã€åŠ è½½çŠ¶æ€
- `useAgentStore`: å½“å‰ Agent çŠ¶æ€
- `useActiveConversation`: å½“å‰å¯¹è¯æ•°æ®

**ç¦ç”¨é€»è¾‘**:
```typescript
const isDisabled =
  curAgentState === AgentState.LOADING ||
  curAgentState === AgentState.AWAITING_USER_CONFIRMATION;
```

---

### 3. CustomChatInput (è‡ªå®šä¹‰èŠå¤©è¾“å…¥)

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/custom-chat-input.tsx`

**æ ¸å¿ƒèŒè´£**:
- æ•´åˆæ‰€æœ‰è¾“å…¥ç›¸å…³çš„ hooks
- ç®¡ç†è¾“å…¥æ¡†çš„å„ç§äº¤äº’è¡Œä¸º
- å¤„ç†æ–‡ä»¶æ‹–æ”¾
- ç®¡ç†è¾“å…¥æ¡†å¤§å°è°ƒæ•´

**ä½¿ç”¨çš„è‡ªå®šä¹‰ Hooks**:

1. **useChatInputLogic**
   - ç®¡ç†è¾“å…¥æ¡†å¼•ç”¨
   - æ£€æŸ¥å†…å®¹æ˜¯å¦ä¸ºç©º
   - æ¸…ç©ºå†…å®¹å¤„ç†

2. **useFileHandling**
   - æ–‡ä»¶è¾“å…¥å¼•ç”¨
   - æ‹–æ”¾äº‹ä»¶å¤„ç†
   - æ–‡ä»¶é€‰æ‹©å¤„ç†

3. **useGripResize**
   - è°ƒæ•´è¾“å…¥æ¡†å¤§å°çš„æ‰‹æŸ„
   - æ™ºèƒ½è°ƒæ•´å¤§å°
   - æ‰‹åŠ¿äº‹ä»¶å¤„ç†

4. **useChatSubmission**
   - æäº¤æ¶ˆæ¯é€»è¾‘
   - æ¢å¤ Agent
   - åœæ­¢æ‰§è¡Œ

5. **useChatInputEvents**
   - è¾“å…¥äº‹ä»¶
   - ç²˜è´´äº‹ä»¶
   - é”®ç›˜äº‹ä»¶
   - ç„¦ç‚¹/å¤±ç„¦äº‹ä»¶

**ç”Ÿå‘½å‘¨æœŸ**:
```typescript
// ç»„ä»¶å¸è½½æ—¶æ¸…ç†
useEffect(
  () => () => {
    setShouldHideSuggestions(false);
    clearAllFiles();
  },
  [setShouldHideSuggestions, clearAllFiles],
);
```

---

### 4. ChatInputField (æ¶ˆæ¯è¾“å…¥æ¡†) â­ æ ¸å¿ƒè¾“å…¥ç»„ä»¶

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/components/chat-input-field.tsx`

**æ ¸å¿ƒèŒè´£**:
- **è¿™æ˜¯ç”¨æˆ·å®é™…è¾“å…¥æ¶ˆæ¯çš„åœ°æ–¹ï¼**
- æ¸²æŸ“å¯ç¼–è¾‘çš„è¾“å…¥æ¡†
- å¤„ç†è¾“å…¥ã€ç²˜è´´ã€é”®ç›˜äº‹ä»¶

**å…³é”®å®ç°**:

```tsx
<div
  ref={chatInputRef}
  className="chat-input bg-transparent text-white text-[16px] font-normal leading-[20px] outline-none resize-none custom-scrollbar min-h-[20px] max-h-[400px]"
  contentEditable
  data-placeholder={t("SUGGESTIONS$WHAT_TO_BUILD")}
  data-testid="chat-input"
  onInput={onInput}
  onPaste={onPaste}
  onKeyDown={onKeyDown}
  onFocus={onFocus}
  onBlur={onBlur}
/>
```

**æŠ€æœ¯ç‰¹ç‚¹**:
- ä½¿ç”¨ `contentEditable` div è€Œé `<textarea>`
- è‡ªåŠ¨é«˜åº¦è°ƒæ•´ï¼ˆæœ€å° 20pxï¼Œæœ€å¤§ 400pxï¼‰
- æ”¯æŒå¯Œæ–‡æœ¬ç²˜è´´
- è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼
- i18n å›½é™…åŒ–å ä½ç¬¦

**æ ·å¼ç‰¹ç‚¹**:
- é€æ˜èƒŒæ™¯
- ç™½è‰²æ–‡å­—
- 16px å­—ä½“å¤§å°
- 20px è¡Œé«˜
- è‡ªåŠ¨æ¢è¡Œ

---

### 5. ChatSendButton (å‘é€æŒ‰é’®) ğŸ“¤

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/chat-send-button.tsx`

**æ ¸å¿ƒèŒè´£**:
- æä¾›æ¶ˆæ¯å‘é€æŒ‰é’®
- ç®¡ç†ç¦ç”¨çŠ¶æ€çš„è§†è§‰åé¦ˆ

**å®ç°ç»†èŠ‚**:

```tsx
<button
  type="button"
  className={cn(
    "flex items-center justify-center rounded-full border border-white size-[35px]",
    disabled
      ? "cursor-not-allowed border-neutral-600"
      : "cursor-pointer hover:bg-[#959CB2]",
    buttonClassName,
  )}
  data-testid="submit-button"
  onClick={handleSubmit}
  disabled={disabled}
>
  <ArrowUp color={disabled ? "#959CB2" : "white"} />
</button>
```

**UI ç‰¹æ€§**:
- 35x35px åœ†å½¢æŒ‰é’®
- å‘ä¸Šç®­å¤´å›¾æ ‡ï¼ˆä½¿ç”¨ lucide-reactï¼‰
- ç™½è‰²è¾¹æ¡†ï¼ˆç¦ç”¨æ—¶ä¸ºä¸­æ€§ç°è‰²ï¼‰
- Hover æ•ˆæœï¼šèƒŒæ™¯å˜ä¸º `#959CB2`
- ç¦ç”¨çŠ¶æ€å›¾æ ‡å˜ç°

---

### 6. ChatInputContainer (è¾“å…¥å®¹å™¨)

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/components/chat-input-container.tsx`

**æ ¸å¿ƒèŒè´£**:
- æä¾›è¾“å…¥åŒºåŸŸçš„å®¹å™¨
- å¤„ç†æ‹–æ”¾æ–‡ä»¶
- æ˜¾ç¤ºå·²ä¸Šä¼ çš„æ–‡ä»¶
- æ˜¾ç¤ºèŠå¤©æ“ä½œæŒ‰é’®

**å¸ƒå±€ç»“æ„**:

```tsx
<div className="bg-[#25272D] rounded-[15px] w-full p-4 pt-3">
  {/* æ‹–æ”¾æç¤º UI */}
  {isDragOver && <DragOver />}
  
  {/* å·²ä¸Šä¼ æ–‡ä»¶åˆ—è¡¨ */}
  <UploadedFiles />
  
  {/* è¾“å…¥è¡Œ */}
  <ChatInputRow
    chatInputRef={chatInputRef}
    disabled={disabled}
    handleSubmit={handleSubmit}
    // ...
  />
  
  {/* èŠå¤©æ“ä½œï¼ˆåœæ­¢/æ¢å¤ï¼‰ */}
  <ChatInputActions
    conversationStatus={conversationStatus}
    handleStop={handleStop}
    handleResumeAgent={handleResumeAgent}
    // ...
  />
</div>
```

**æ ·å¼ç‰¹ç‚¹**:
- æ·±è‰²èƒŒæ™¯ `#25272D`
- åœ†è§’ 15px
- å†…è¾¹è· 16pxï¼ˆé¡¶éƒ¨ 12pxï¼‰
- æ”¯æŒæ‹–æ”¾äº¤äº’

---

### 7. ChatInputRow (è¾“å…¥è¡Œ)

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/components/chat-input-row.tsx`

**æ ¸å¿ƒèŒè´£**:
- æ°´å¹³æ’åˆ—è¾“å…¥å…ƒç´ 
- ç»„åˆæ–‡ä»¶æŒ‰é’®ã€è¾“å…¥æ¡†ã€å‘é€æŒ‰é’®

**å¸ƒå±€**:

```tsx
<div className="flex flex-row items-end justify-between w-full pb-[18px] gap-2">
  {/* å·¦ä¾§ï¼šæ–‡ä»¶æŒ‰é’® + è¾“å…¥æ¡† */}
  <div className="flex flex-row gap-4 grow items-end">
    <ChatAddFileButton />
    <ChatInputField />
  </div>
  
  {/* å³ä¾§ï¼šå‘é€æŒ‰é’® */}
  {showButton && <ChatSendButton />}
</div>
```

---

### 8. Messages (æ¶ˆæ¯åˆ—è¡¨)

**æ–‡ä»¶è·¯å¾„**: `frontend/src/components/features/chat/messages.tsx`

**æ ¸å¿ƒèŒè´£**:
- æ¸²æŸ“æ‰€æœ‰å†å²æ¶ˆæ¯
- æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯å’Œ AI å“åº”
- æ”¯æŒ Microagent åŠŸèƒ½
- å¤„ç†æ¶ˆæ¯ä¼˜åŒ–æ˜¾ç¤º

**æ¸²æŸ“é€»è¾‘**:

```tsx
{messages.map((message, index) => (
  <EventMessage
    key={index}
    event={message}
    hasObservationPair={actionHasObservationPair(message)}
    isAwaitingUserConfirmation={isAwaitingUserConfirmation}
    isLastMessage={messages.length - 1 === index}
    microagentStatus={getMicroagentStatusForEvent(message.id)}
    // ...
  />
))}

{/* ä¹è§‚æ›´æ–°çš„ç”¨æˆ·æ¶ˆæ¯ */}
{optimisticUserMessage && (
  <ChatMessage type="user" message={optimisticUserMessage} />
)}
```

**ç‰¹ç‚¹**:
- ä½¿ç”¨ `React.memo` ä¼˜åŒ–æ€§èƒ½
- æ”¯æŒ Microagent çŠ¶æ€è·Ÿè¸ª
- ä¹è§‚æ›´æ–°æœºåˆ¶
- ä»…åœ¨æ¶ˆæ¯æ•°é‡å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“

---

## æ¶ˆæ¯å‘é€æµç¨‹

### å®Œæ•´æµç¨‹å›¾

```
ç”¨æˆ·è¾“å…¥æ–‡æœ¬
    â†“
ç”¨æˆ·ç‚¹å‡»å‘é€æŒ‰é’® (æˆ–æŒ‰ Enter)
    â†“
ChatSendButton.onClick
    â†“
CustomChatInput.handleSubmit
    â†“
InteractiveChatBox.handleSubmit
    â†“
ChatInterface.handleSendMessage
    â†“
â”œâ”€ 1. éªŒè¯æ–‡ä»¶å¤§å° (validateFiles)
â”œâ”€ 2. è½¬æ¢å›¾ç‰‡ä¸º Base64 (convertImageToBase64)
â”œâ”€ 3. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨ (uploadFiles)
â”œâ”€ 4. æ„é€ æ¶ˆæ¯ prompt
â””â”€ 5. é€šè¿‡ WebSocket å‘é€ (send(createChatMessage(...)))
    â†“
setOptimisticUserMessage (ä¹è§‚æ›´æ–°)
    â†“
UI ç«‹å³æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
    â†“
ç­‰å¾… WebSocket å“åº”
    â†“
æ¥æ”¶ AI å“åº”å¹¶æ¸²æŸ“
```

### è¯¦ç»†æ­¥éª¤è¯´æ˜

#### Step 1: ç”¨æˆ·è¾“å…¥
```tsx
// ChatInputField.tsx
<div
  contentEditable
  onInput={onInput}
  onKeyDown={onKeyDown}
/>
```

#### Step 2: æäº¤è§¦å‘
```tsx
// æ–¹å¼ 1: ç‚¹å‡»å‘é€æŒ‰é’®
<ChatSendButton onClick={handleSubmit} />

// æ–¹å¼ 2: æŒ‰ Enter é”®
// åœ¨ useChatInputEvents hook ä¸­å¤„ç†
if (e.key === 'Enter' && !e.shiftKey) {
  handleSubmit();
}
```

#### Step 3: æ¶ˆæ¯å¤„ç†

```typescript
// ChatInterface.tsx - handleSendMessage
const handleSendMessage = async (content, images, files) => {
  // 1. Posthog è¿½è¸ª
  posthog.capture("user_message_sent", {
    session_message_count: events.length,
    current_message_length: content.length,
  });
  
  // 2. æ–‡ä»¶éªŒè¯
  const validation = validateFiles(allFiles);
  if (!validation.isValid) {
    displayErrorToast(`Error: ${validation.errorMessage}`);
    return;
  }
  
  // 3. å›¾ç‰‡è½¬ Base64
  const imageUrls = await Promise.all(
    images.map((image) => convertImageToBase64(image))
  );
  
  // 4. æ–‡ä»¶ä¸Šä¼ 
  const { uploaded_files } = await uploadFiles({
    conversationId: params.conversationId!,
    files
  });
  
  // 5. æ„é€ å®Œæ•´ prompt
  const filePrompt = `Files: ${uploadedFiles.join("\n\n")}`;
  const prompt = uploadedFiles.length > 0 
    ? `${content}\n\n${filePrompt}` 
    : content;
  
  // 6. WebSocket å‘é€
  send(createChatMessage(prompt, imageUrls, uploadedFiles, timestamp));
  
  // 7. ä¹è§‚æ›´æ–°
  setOptimisticUserMessage(content);
};
```

#### Step 4: WebSocket é€šä¿¡

```typescript
// ä½¿ç”¨ chat-service åˆ›å»ºæ¶ˆæ¯
import { createChatMessage } from "#/services/chat-service";

send(createChatMessage(
  prompt,        // æ¶ˆæ¯å†…å®¹
  imageUrls,     // Base64 å›¾ç‰‡
  uploadedFiles, // æ–‡ä»¶è·¯å¾„
  timestamp      // æ—¶é—´æˆ³
));
```

---

## å…³é”®åŠŸèƒ½æ¨¡å—

### 1. æ–‡ä»¶ä¸Šä¼ å¤„ç†

**æ”¯æŒçš„æ–‡ä»¶ç±»å‹**:
- å›¾ç‰‡æ–‡ä»¶ï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
- æ™®é€šæ–‡ä»¶ï¼ˆä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰

**å¤„ç†æµç¨‹**:

```typescript
// InteractiveChatBox.tsx - handleUpload
const handleUpload = async (selectedFiles: File[]) => {
  // 1. éªŒè¯å’Œåˆ†ç±»
  const validFiles = selectedFiles.filter(f => !isFileImage(f));
  const validImages = selectedFiles.filter(f => isFileImage(f));
  
  // 2. æ˜¾ç¤ºåŠ è½½çŠ¶æ€
  validFiles.forEach(file => addFileLoading(file.name));
  validImages.forEach(image => addImageLoading(image.name));
  
  // 3. å¤„ç†æ–‡ä»¶
  const [fileResults, imageResults] = await Promise.all([
    processFiles(validFiles),
    processImages(validImages)
  ]);
  
  // 4. æ›´æ–°çŠ¶æ€
  addFiles(fileResults.successful);
  addImages(imageResults.successful);
  
  // 5. æ˜¾ç¤ºé”™è¯¯
  fileResults.failed.forEach(({ file, error }) => {
    displayErrorToast(`Failed to process file ${file.name}: ${error.message}`);
  });
};
```

**æ‹–æ”¾æ”¯æŒ**:
- `onDragOver`: é«˜äº®æ‹–æ”¾åŒºåŸŸ
- `onDragLeave`: ç§»é™¤é«˜äº®
- `onDrop`: å¤„ç†æ–‡ä»¶æ‹–æ”¾

---

### 2. è¾“å…¥æ¡†å¤§å°è°ƒæ•´

**å®ç°æ–¹å¼**: `useGripResize` hook

**åŠŸèƒ½**:
- å¯è°ƒæ•´å¤§å°çš„æ‰‹æŸ„ï¼ˆGripï¼‰
- æ™ºèƒ½è‡ªåŠ¨è°ƒæ•´
- è§¦æ‘¸å’Œé¼ æ ‡äº‹ä»¶æ”¯æŒ
- ä¿å­˜ç”¨æˆ·çš„æ‰‹åŠ¨è°ƒæ•´

**ç»„ä»¶**:
```tsx
<ChatInputGrip
  gripRef={gripRef}
  isGripVisible={isGripVisible}
  handleGripMouseDown={handleGripMouseDown}
  handleGripTouchStart={handleGripTouchStart}
/>
```

---

### 3. åœæ­¢å’Œæ¢å¤åŠŸèƒ½

**åœæ­¢æ‰§è¡Œ**:
```typescript
const handleStop = () => {
  posthog.capture("stop_button_clicked");
  send(generateAgentStateChangeEvent(AgentState.STOPPED));
};
```

**æ¢å¤æ‰§è¡Œ**:
```typescript
// åœ¨ ChatInputActions ä¸­æä¾›æ¢å¤æŒ‰é’®
<ChatPlayButton onClick={handleResumeAgent} />
```

---

### 4. å»ºè®®ç³»ç»Ÿ

**ç»„ä»¶**: `ChatSuggestions`

**æ˜¾ç¤ºæ¡ä»¶**:
```typescript
{!hasSubstantiveAgentActions &&
  !optimisticUserMessage &&
  !userEventsExist && (
    <ChatSuggestions
      onSuggestionsClick={(message) => setMessageToSend(message)}
    />
  )}
```

**ç‰¹ç‚¹**:
- ä»…åœ¨æ²¡æœ‰æ¶ˆæ¯æ—¶æ˜¾ç¤º
- ç‚¹å‡»å»ºè®®ç›´æ¥å‘é€æ¶ˆæ¯
- ä¸ `GitControlBar` é›†æˆ

---

## çŠ¶æ€ç®¡ç†

### ä½¿ç”¨çš„çŠ¶æ€ç®¡ç†å·¥å…·

#### 1. useConversationStore

**ç®¡ç†å†…å®¹**:
- `submittedMessage`: æäº¤çš„æ¶ˆæ¯
- `messageToSend`: å¾…å‘é€æ¶ˆæ¯
- `images`: å·²é€‰æ‹©çš„å›¾ç‰‡
- `files`: å·²é€‰æ‹©çš„æ–‡ä»¶
- `shouldHideSuggestions`: æ˜¯å¦éšè—å»ºè®®
- æ–‡ä»¶åŠ è½½çŠ¶æ€

**å…³é”®æ–¹æ³•**:
- `addImages(images: File[])`
- `addFiles(files: File[])`
- `clearAllFiles()`
- `addFileLoading(filename: string)`
- `removeFileLoading(filename: string)`
- `setSubmittedMessage(message: string | null)`

#### 2. useAgentStore

**ç®¡ç†å†…å®¹**:
- `curAgentState`: å½“å‰ Agent çŠ¶æ€

**å¯èƒ½çš„çŠ¶æ€**:
- `AgentState.INIT`: åˆå§‹åŒ–
- `AgentState.LOADING`: åŠ è½½ä¸­
- `AgentState.RUNNING`: è¿è¡Œä¸­
- `AgentState.STOPPED`: å·²åœæ­¢
- `AgentState.AWAITING_USER_CONFIRMATION`: ç­‰å¾…ç”¨æˆ·ç¡®è®¤
- `AgentState.AWAITING_USER_INPUT`: ç­‰å¾…ç”¨æˆ·è¾“å…¥
- `AgentState.FINISHED`: å·²å®Œæˆ
- `AgentState.ERROR`: é”™è¯¯

#### 3. useEventStore

**ç®¡ç†å†…å®¹**:
- `events`: æ‰€æœ‰äº‹ä»¶åˆ—è¡¨ï¼ˆç”¨æˆ·æ¶ˆæ¯ã€Agent åŠ¨ä½œã€è§‚å¯Ÿç»“æœï¼‰

**è¿‡æ»¤é€»è¾‘**:
```typescript
const events = storeEvents
  .filter(isV0Event)
  .filter(isActionOrObservation)
  .filter(shouldRenderEvent);
```

#### 4. useOptimisticUserMessageStore

**ç®¡ç†å†…å®¹**:
- `optimisticUserMessage`: ä¹è§‚æ›´æ–°çš„ç”¨æˆ·æ¶ˆæ¯

**ä½œç”¨**:
- åœ¨å‘é€æ¶ˆæ¯åç«‹å³æ˜¾ç¤ºï¼Œä¸ç­‰å¾…æœåŠ¡å™¨å“åº”
- æå‡ç”¨æˆ·ä½“éªŒ

#### 5. useErrorMessageStore

**ç®¡ç†å†…å®¹**:
- `errorMessage`: å…¨å±€é”™è¯¯æ¶ˆæ¯

---

## æ–‡ä»¶ä¸Šä¼ å¤„ç†

### æ–‡ä»¶éªŒè¯

**éªŒè¯å·¥å…·**: `validateFiles` (from `#/utils/file-validation`)

**éªŒè¯å†…å®¹**:
- æ–‡ä»¶å¤§å°é™åˆ¶
- æ–‡ä»¶ç±»å‹æ£€æŸ¥
- é‡å¤æ–‡ä»¶æ£€æŸ¥

### æ–‡ä»¶å¤„ç†å·¥å…·

**å›¾ç‰‡å¤„ç†**:
```typescript
// convertImageToBase64
const imageUrls = await Promise.all(
  images.map((image) => convertImageToBase64(image))
);
```

**æ–‡ä»¶å¤„ç†**:
```typescript
// processFiles - ä½¿ç”¨çœŸå®çš„ FileReader
const fileResults = await processFiles(validFiles);
// è¿”å›: { successful: File[], failed: { file: File, error: Error }[] }
```

**å›¾ç‰‡å¤„ç†**:
```typescript
// processImages
const imageResults = await processImages(validImages);
// è¿”å›: { successful: File[], failed: { file: File, error: Error }[] }
```

### æ–‡ä»¶ä¸Šä¼  API

**ä½¿ç”¨çš„ Hook**: `useUploadFiles`

```typescript
const { mutateAsync: uploadFiles } = useUploadFiles();

const { uploaded_files, skipped_files } = await uploadFiles({
  conversationId: params.conversationId!,
  files
});
```

---

## WebSocket é€šä¿¡

### WebSocket å®¢æˆ·ç«¯

**Hook**: `useWsClient`

```typescript
const { send, isLoadingMessages } = useWsClient();
```

**æ¶ˆæ¯åˆ›å»º**:
```typescript
import { createChatMessage } from "#/services/chat-service";

send(createChatMessage(
  prompt,
  imageUrls,
  uploadedFiles,
  timestamp
));
```

### Agent çŠ¶æ€å˜æ›´

```typescript
import { generateAgentStateChangeEvent } from "#/services/agent-state-service";

// åœæ­¢ Agent
send(generateAgentStateChangeEvent(AgentState.STOPPED));
```

---

## UI/UX ç‰¹æ€§

### 1. å“åº”å¼è®¾è®¡

- ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯å¸ƒå±€é€‚é…
- è§¦æ‘¸å’Œé¼ æ ‡äº‹ä»¶æ”¯æŒ
- Flexbox å¸ƒå±€

### 2. è§†è§‰åé¦ˆ

- **åŠ è½½çŠ¶æ€**: `TypingIndicator` æ˜¾ç¤º AI æ­£åœ¨è¾“å…¥
- **ç¦ç”¨çŠ¶æ€**: è¾“å…¥æ¡†å’ŒæŒ‰é’®å˜ç°
- **é”™è¯¯æç¤º**: `ErrorMessageBanner` å’Œ Toast é€šçŸ¥
- **æ‹–æ”¾é«˜äº®**: æ‹–æ”¾æ–‡ä»¶æ—¶é«˜äº®æ˜¾ç¤º

### 3. é”®ç›˜å¿«æ·é”®

- **Enter**: å‘é€æ¶ˆæ¯
- **Shift + Enter**: æ¢è¡Œ
- **è‡ªåŠ¨èšç„¦**: é¡µé¢åŠ è½½åè‡ªåŠ¨èšç„¦è¾“å…¥æ¡†

### 4. æ»šåŠ¨è¡Œä¸º

**Hook**: `useScrollToBottom`

```typescript
const {
  scrollDomToBottom,
  onChatBodyScroll,
  hitBottom,
  autoScroll,
  setAutoScroll,
  setHitBottom,
} = useScrollToBottom(scrollRef);
```

**ç‰¹æ€§**:
- è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆæ–°æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼‰
- "æ»šåŠ¨åˆ°åº•éƒ¨"æŒ‰é’®ï¼ˆå½“ä¸åœ¨åº•éƒ¨æ—¶æ˜¾ç¤ºï¼‰
- å¹³æ»‘æ»šåŠ¨åŠ¨ç”»

---

## å›½é™…åŒ– (i18n)

**ä½¿ç”¨å·¥å…·**: `react-i18next`

**ç¿»è¯‘é”®**:
- `SUGGESTIONS$WHAT_TO_BUILD`: è¾“å…¥æ¡†å ä½ç¬¦
- `CHAT_INTERFACE$AUGMENTED_PROMPT_FILES_TITLE`: æ–‡ä»¶æç¤ºæ ‡é¢˜
- `MICROAGENT$ADD_TO_MEMORY`: Microagent å·¥å…·æç¤º

**æœ¬åœ°åŒ–æ–‡ä»¶**: `frontend/public/locales/*/translation.json`

---

## æ ·å¼ç³»ç»Ÿ

### Tailwind CSS ç±»

**ä¸»è¦é¢œè‰²**:
- èƒŒæ™¯: `bg-[#25272D]` (æ·±ç°è‰²)
- æ–‡æœ¬: `text-white`, `text-[#d0d9fa]` (æµ…è“ç™½è‰²)
- è¾¹æ¡†: `border-white`, `border-neutral-600`
- Hover: `hover:bg-[#959CB2]`

**è‡ªå®šä¹‰ CSS ç±»**:
- `.chat-input`: è¾“å…¥æ¡†æ ·å¼
- `.custom-scrollbar`: è‡ªå®šä¹‰æ»šåŠ¨æ¡
- `.custom-scrollbar-always`: å§‹ç»ˆæ˜¾ç¤ºæ»šåŠ¨æ¡
- `.fast-smooth-scroll`: å¹³æ»‘æ»šåŠ¨åŠ¨ç”»

---

## å…³é”® Hooks è¯´æ˜

### Chat ç›¸å…³ Hooks (ä½äº `src/hooks/chat/`)

1. **useChatInputLogic**
   - ç®¡ç†è¾“å…¥æ¡†å¼•ç”¨å’Œå†…å®¹
   - æ£€æŸ¥å†…å®¹æ˜¯å¦ä¸ºç©º
   - æ¸…ç©ºå†…å®¹å¤„ç†

2. **useFileHandling**
   - æ–‡ä»¶é€‰æ‹©å’Œæ‹–æ”¾
   - æ–‡ä»¶è¾“å…¥å¼•ç”¨ç®¡ç†
   - æ‹–æ”¾çŠ¶æ€ç®¡ç†

3. **useGripResize**
   - è¾“å…¥æ¡†å¤§å°è°ƒæ•´
   - æ‰‹æŸ„å¯è§æ€§
   - æ™ºèƒ½è°ƒæ•´é€»è¾‘

4. **useChatSubmission**
   - æ¶ˆæ¯æäº¤é€»è¾‘
   - Agent æ¢å¤é€»è¾‘
   - åœæ­¢æ‰§è¡Œé€»è¾‘

5. **useChatInputEvents**
   - è¾“å…¥äº‹ä»¶å¤„ç†
   - ç²˜è´´äº‹ä»¶å¤„ç†
   - é”®ç›˜äº‹ä»¶å¤„ç†
   - ç„¦ç‚¹äº‹ä»¶å¤„ç†

---

## æµ‹è¯•

### æµ‹è¯•æ–‡ä»¶ä½ç½®

- `__tests__/components/chat/` - ç»„ä»¶æµ‹è¯•
- `__tests__/components/interactive-chat-box.test.tsx`
- `__tests__/components/chat-message.test.tsx`

### æµ‹è¯•å·¥å…·

- **Vitest**: å•å…ƒæµ‹è¯•æ¡†æ¶
- **React Testing Library**: ç»„ä»¶æµ‹è¯•
- **MSW**: Mock Service Worker (WebSocket æ¨¡æ‹Ÿ)

---

## ä¸åç«¯å¯¹æ¥è¦ç‚¹

### 1. WebSocket æ¶ˆæ¯æ ¼å¼

**å‘é€æ¶ˆæ¯**:
```typescript
createChatMessage(
  prompt: string,
  imageUrls: string[],
  uploadedFiles: string[],
  timestamp: string
)
```

**æœŸæœ›çš„æ¶ˆæ¯æ ¼å¼éœ€è¦æŸ¥çœ‹** `src/services/chat-service.ts`

### 2. çŠ¶æ€åŒæ­¥

å‰ç«¯é€šè¿‡ WebSocket æ¥æ”¶åç«¯äº‹ä»¶å¹¶æ›´æ–°çŠ¶æ€ï¼š
- Agent çŠ¶æ€å˜æ›´
- æ¶ˆæ¯å“åº”
- é”™è¯¯äº‹ä»¶
- å®Œæˆäº‹ä»¶

### 3. æ–‡ä»¶ä¸Šä¼ 

**API Endpoint**: éœ€è¦æŸ¥çœ‹ `useUploadFiles` hook

**æµç¨‹**:
1. å‰ç«¯éªŒè¯æ–‡ä»¶
2. ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆè·å–æ–‡ä»¶è·¯å¾„ï¼‰
3. å°†æ–‡ä»¶è·¯å¾„åŒ…å«åœ¨æ¶ˆæ¯ä¸­
4. åç«¯é€šè¿‡è·¯å¾„è®¿é—®æ–‡ä»¶

---

## æ€§èƒ½ä¼˜åŒ–

### 1. React.memo

```typescript
export const Messages: React.FC<MessagesProps> = React.memo(
  ({ messages, isAwaitingUserConfirmation }) => {
    // ...
  },
  (prevProps, nextProps) => {
    // ä»…åœ¨æ¶ˆæ¯é•¿åº¦å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“
    return prevProps.messages.length === nextProps.messages.length;
  }
);
```

### 2. ä¹è§‚æ›´æ–°

- ç«‹å³æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
- ä¸ç­‰å¾…æœåŠ¡å™¨ç¡®è®¤
- æå‡å“åº”é€Ÿåº¦

### 3. æ‡’åŠ è½½

- å›¾ç‰‡æŒ‰éœ€åŠ è½½
- é•¿åˆ—è¡¨è™šæ‹ŸåŒ–ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## è¾…åŠ©ç»„ä»¶

### 1. TypingIndicator (æ‰“å­—æŒ‡ç¤ºå™¨)
- æ˜¾ç¤º AI æ­£åœ¨è¾“å…¥
- ä»…åœ¨ `AgentState.RUNNING` æ—¶æ˜¾ç¤º

### 2. ScrollToBottomButton (æ»šåŠ¨æŒ‰é’®)
- å½“ç”¨æˆ·å‘ä¸Šæ»šåŠ¨æ—¶æ˜¾ç¤º
- ç‚¹å‡»å¿«é€Ÿæ»šåŠ¨åˆ°åº•éƒ¨

### 3. ErrorMessageBanner (é”™è¯¯æ¨ªå¹…)
- æ˜¾ç¤ºå…¨å±€é”™è¯¯æ¶ˆæ¯
- ä» `useErrorMessageStore` è·å–

### 4. ConfirmationModeEnabled (ç¡®è®¤æ¨¡å¼æŒ‡ç¤º)
- æ˜¾ç¤ºæ˜¯å¦å¯ç”¨ç¡®è®¤æ¨¡å¼
- å½±å“ Agent è¡Œä¸º

### 5. TrajectoryActions (è½¨è¿¹æ“ä½œ)
- æ­£é¢/è´Ÿé¢åé¦ˆæŒ‰é’®
- ä»…åœ¨æœ‰äº‹ä»¶æ—¶æ˜¾ç¤º

### 6. GitControlBar (Git æ§åˆ¶æ )
- æä¾› Git ç›¸å…³å»ºè®®
- ç‚¹å‡»å»ºè®®ç›´æ¥å‘é€æ¶ˆæ¯

---

## è·¯ç”±é›†æˆ

**å¯¹è¯è·¯ç”±**: `frontend/src/routes/conversation.tsx`

**è®¿é—®è·¯å¾„**: é€šè¿‡ `useParams()` è·å– `conversationId`

```typescript
const params = useParams();
// params.conversationId
```

---

## å…³é”®ä¾èµ–

### NPM åŒ…

- `react`: UI æ¡†æ¶
- `react-i18next`: å›½é™…åŒ–
- `lucide-react`: å›¾æ ‡åº“
- `posthog-js`: åˆ†æè¿½è¸ª
- `react-router`: è·¯ç”±
- `zustand`: çŠ¶æ€ç®¡ç†ï¼ˆæŸäº› storeï¼‰

### å†…éƒ¨ä¾èµ–

- `#/services/chat-service`: èŠå¤©æœåŠ¡
- `#/services/agent-state-service`: Agent çŠ¶æ€æœåŠ¡
- `#/context/ws-client-provider`: WebSocket å®¢æˆ·ç«¯
- `#/utils/file-validation`: æ–‡ä»¶éªŒè¯å·¥å…·
- `#/utils/file-processing`: æ–‡ä»¶å¤„ç†å·¥å…·

---

## æ•°æ®æµæ€»ç»“

```
ç”¨æˆ·äº¤äº’
    â†“
React ç»„ä»¶ (ChatInputField)
    â†“
Event Handlers (useChatInputEvents)
    â†“
State Updates (useConversationStore)
    â†“
Submission Logic (useChatSubmission)
    â†“
API Layer (handleSendMessage)
    â†“
WebSocket (useWsClient)
    â†“
Backend
    â†“
WebSocket Response
    â†“
State Updates (useEventStore, useAgentStore)
    â†“
UI Re-render (Messages)
```

---

## å¾…å¯¹æ¥äº‹é¡¹

å¦‚æœè¦å°†æ­¤å‰ç«¯ä¸ Kode-SDK åç«¯å¯¹æ¥ï¼Œéœ€è¦å…³æ³¨ï¼š

1. **WebSocket æ¶ˆæ¯æ ¼å¼**
   - æŸ¥çœ‹ `src/services/chat-service.ts` çš„ `createChatMessage` å®ç°
   - ç¡®ä¿ä¸ Kode-SDK çš„æ¶ˆæ¯æ ¼å¼åŒ¹é…

2. **Agent çŠ¶æ€æ˜ å°„**
   - å‰ç«¯çš„ `AgentState` æšä¸¾
   - åç«¯çš„çŠ¶æ€äº‹ä»¶æ ¼å¼

3. **æ–‡ä»¶ä¸Šä¼ ç«¯ç‚¹**
   - æŸ¥çœ‹ `useUploadFiles` ä½¿ç”¨çš„ API
   - ç¡®ä¿åç«¯æä¾›ç›¸åº”çš„æ–‡ä»¶ä¸Šä¼ æ¥å£

4. **äº‹ä»¶ç±»å‹å®šä¹‰**
   - `OpenHandsAction` å’Œ `OpenHandsObservation`
   - éœ€è¦ä¸åç«¯äº‹ä»¶ç³»ç»Ÿå¯¹é½

---

## æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒç»„ä»¶æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | ç»„ä»¶åç§° | ä½œç”¨ |
|---------|---------|------|
| `chat-interface.tsx` | ChatInterface | ä¸»å¯¹è¯ç•Œé¢ |
| `interactive-chat-box.tsx` | InteractiveChatBox | äº¤äº’å¼èŠå¤©ç›’ |
| `custom-chat-input.tsx` | CustomChatInput | è‡ªå®šä¹‰èŠå¤©è¾“å…¥ |
| `components/chat-input-field.tsx` | ChatInputField | **æ¶ˆæ¯è¾“å…¥æ¡†** â­ |
| `components/chat-input-container.tsx` | ChatInputContainer | è¾“å…¥å®¹å™¨ |
| `components/chat-input-row.tsx` | ChatInputRow | è¾“å…¥è¡Œå¸ƒå±€ |
| `chat-send-button.tsx` | ChatSendButton | **å‘é€æŒ‰é’®** ğŸ“¤ |
| `chat-add-file-button.tsx` | ChatAddFileButton | æ·»åŠ æ–‡ä»¶æŒ‰é’® |
| `messages.tsx` | Messages | æ¶ˆæ¯åˆ—è¡¨ |
| `chat-message.tsx` | ChatMessage | å•æ¡æ¶ˆæ¯ |

### è¾…åŠ©ç»„ä»¶æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„ | ç»„ä»¶åç§° | ä½œç”¨ |
|---------|---------|------|
| `chat-suggestions.tsx` | ChatSuggestions | å»ºè®®ç³»ç»Ÿ |
| `typing-indicator.tsx` | TypingIndicator | æ‰“å­—æŒ‡ç¤ºå™¨ |
| `error-message-banner.tsx` | ErrorMessageBanner | é”™è¯¯æ¨ªå¹… |
| `git-control-bar.tsx` | GitControlBar | Git æ§åˆ¶æ  |
| `components/chat-input-grip.tsx` | ChatInputGrip | è°ƒæ•´å¤§å°æ‰‹æŸ„ |
| `components/chat-input-actions.tsx` | ChatInputActions | èŠå¤©æ“ä½œ |
| `components/hidden-file-input.tsx` | HiddenFileInput | éšè—æ–‡ä»¶è¾“å…¥ |

---

## å¼€å‘å»ºè®®

### 1. è°ƒè¯•æ¶ˆæ¯æµ

åœ¨ `ChatInterface.handleSendMessage` ä¸­æ·»åŠ  console.logï¼š

```typescript
console.log('å‘é€æ¶ˆæ¯:', {
  content,
  images: originalImages.length,
  files: originalFiles.length
});
```

### 2. æµ‹è¯• WebSocket è¿æ¥

æŸ¥çœ‹ `src/context/ws-client-provider.tsx` äº†è§£ WebSocket é…ç½®ã€‚

### 3. è‡ªå®šä¹‰æ¶ˆæ¯æ ¼å¼

ä¿®æ”¹ `src/services/chat-service.ts` çš„ `createChatMessage` æ–¹æ³•ã€‚

### 4. æ·»åŠ æ–°çš„è¾“å…¥åŠŸèƒ½

æ‰©å±• `CustomChatInput` å¹¶æ·»åŠ æ–°çš„ hooksã€‚

---

## æ€»ç»“

Frontend çš„ AI å¯¹è¯ç•Œé¢æ˜¯ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„ç»„ä»¶ç³»ç»Ÿï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

âœ… **æ¨¡å—åŒ–**: æ¸…æ™°çš„ç»„ä»¶å±‚æ¬¡å’ŒèŒè´£åˆ†ç¦»  
âœ… **å¯ç»´æŠ¤**: ä½¿ç”¨è‡ªå®šä¹‰ hooks å°è£…é€»è¾‘  
âœ… **ç”¨æˆ·ä½“éªŒ**: ä¹è§‚æ›´æ–°ã€æ‹–æ”¾ã€è‡ªåŠ¨è°ƒæ•´å¤§å°  
âœ… **æ€§èƒ½ä¼˜åŒ–**: React.memoã€çŠ¶æ€ç®¡ç†ä¼˜åŒ–  
âœ… **å›½é™…åŒ–**: å®Œæ•´çš„ i18n æ”¯æŒ  
âœ… **ç±»å‹å®‰å…¨**: TypeScript ç±»å‹å®šä¹‰  
âœ… **å¯æµ‹è¯•**: å®Œå–„çš„æµ‹è¯•è¦†ç›–  

**æ ¸å¿ƒå…¥å£ç‚¹**: ç”¨æˆ·åœ¨ `ChatInputField` è¾“å…¥æ¶ˆæ¯ï¼Œç‚¹å‡» `ChatSendButton` å‘é€ï¼

