# Kode-SDK + ChatKit-JS 项目总览

## 📂 项目结构

```
/Users/yeya/FlutterProjects/kode-sdk/
│
├── Kode-sdk/                          # 后端 AI Agent 框架
│   ├── src/
│   │   ├── core/                      # 核心功能
│   │   ├── infra/
│   │   │   ├── provider.ts            # 模型 Provider 接口
│   │   │   ├── glm-provider.ts        # GLM-4.5-air 实现 ✨
│   │   │   └── ...
│   │   └── tools/                     # 内置工具
│   ├── examples/
│   │   ├── test-glm.ts                # GLM 基础测试 ✨
│   │   ├── test-glm-advanced.ts       # GLM 高级测试 ✨
│   │   └── ...
│   ├── 快速开始.md                     # Kode-SDK 快速开始 ✨
│   ├── GLM-配置说明.md                 # GLM 配置详细说明 ✨
│   └── run-glm-test.sh                # 快速测试脚本 ✨
│
└── frontend/                          # 前端 UI 框架
    ├── chatkit-js/                    # ChatKit-JS 项目 🆕
    │   ├── packages/
    │   │   ├── chatkit/               # 核心包
    │   │   ├── chatkit-react/         # React 绑定
    │   │   └── docs/                  # 文档
    │   ├── package.json
    │   └── README.md
    ├── ChatKit-使用说明.md             # ChatKit 使用指南 🆕
    └── setup-chatkit.sh               # ChatKit 设置脚本 🆕
```

## 🎯 技术栈

### 后端 (Kode-SDK)
- **语言**: TypeScript/Node.js
- **AI 模型**: GLM-4.5-air (智谱 AI)
- **框架**: Kode-SDK (Event-driven Agent Runtime)
- **功能**:
  - ✅ Agent 管理
  - ✅ 工具调用 (Function Calling)
  - ✅ 事件系统 (Progress/Control/Monitor)
  - ✅ 断点恢复
  - ✅ 多 Agent 协作

### 前端 (ChatKit-JS)
- **语言**: TypeScript/React
- **框架**: ChatKit-JS (OpenAI)
- **包管理**: pnpm (monorepo)
- **功能**:
  - ✅ 完整的聊天 UI
  - ✅ 流式响应
  - ✅ 文件上传
  - ✅ 富文本组件
  - ✅ 深度自定义

## 🚀 快速开始

### 1. 测试 Kode-SDK (GLM-4.5-air)

```bash
# 进入 Kode-SDK 目录
cd /Users/yeya/FlutterProjects/kode-sdk/Kode-sdk

# 运行快速测试
./run-glm-test.sh

# 或手动运行
npx ts-node examples/test-glm.ts
```

### 2. 设置 ChatKit-JS

```bash
# 进入 frontend 目录
cd /Users/yeya/FlutterProjects/kode-sdk/frontend

# 运行设置脚本
./setup-chatkit.sh

# 或手动设置
cd chatkit-js
pnpm install
pnpm build
pnpm dev:docs
```

## 🔗 集成方案

### 架构图

```
┌─────────────────────────────────────┐
│         前端 (ChatKit-JS)            │
│  ┌───────────────────────────────┐  │
│  │  ChatKit React Component      │  │
│  │  - 聊天界面                    │  │
│  │  - 流式显示                    │  │
│  │  - 文件上传                    │  │
│  └───────────────────────────────┘  │
└──────────────┬──────────────────────┘
               │ HTTP/SSE
               ▼
┌─────────────────────────────────────┐
│        API 桥接层 (待实现)           │
│  ┌───────────────────────────────┐  │
│  │  - 会话管理                    │  │
│  │  - 格式转换                    │  │
│  │  │  OpenAI ←→ Kode-SDK       │  │
│  │  - 事件流转发                  │  │
│  └───────────────────────────────┘  │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│      后端 (Kode-SDK + GLM)          │
│  ┌───────────────────────────────┐  │
│  │  Kode-SDK Agent               │  │
│  │  - GLM-4.5-air 模型           │  │
│  │  - 工具执行                    │  │
│  │  - 事件系统                    │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
```

### 集成步骤

1. **创建 API 桥接服务**
   ```bash
   cd /Users/yeya/FlutterProjects/kode-sdk/frontend
   mkdir api-bridge
   cd api-bridge
   npm init -y
   npm install express cors openai
   ```

2. **实现 ChatKit Session API**
   - 创建 `/api/chatkit/session` 端点
   - 生成 client_secret
   - 管理会话状态

3. **实现消息转发逻辑**
   - 接收 ChatKit 消息
   - 转换为 Kode-SDK 格式
   - 调用 Agent.send()
   - 将响应流式返回

4. **前端集成**
   - 配置 ChatKit React 组件
   - 连接到 API 桥接层
   - 自定义 UI 主题

## 📊 功能对比

| 功能 | Kode-SDK | ChatKit-JS | 集成状态 |
|------|----------|------------|----------|
| AI 对话 | ✅ GLM-4.5-air | ✅ UI 展示 | 🔄 待桥接 |
| 流式响应 | ✅ SSE | ✅ 实时显示 | 🔄 待桥接 |
| 工具调用 | ✅ Function Calling | ✅ 工具可视化 | 🔄 待桥接 |
| 文件上传 | ✅ 文件工具 | ✅ 上传组件 | 🔄 待桥接 |
| 会话管理 | ✅ Agent 状态 | ✅ 线程管理 | 🔄 待桥接 |
| 事件系统 | ✅ 3通道事件 | ✅ 事件订阅 | 🔄 待桥接 |

## 📚 文档索引

### Kode-SDK 文档
- [快速开始.md](./Kode-sdk/快速开始.md) - Kode-SDK 入门指南
- [GLM-配置说明.md](./Kode-sdk/GLM-配置说明.md) - GLM 模型配置详解
- [README.md](./Kode-sdk/README.md) - 官方文档
- [docs/](./Kode-sdk/docs/) - API 文档

### ChatKit-JS 文档
- [ChatKit-使用说明.md](./frontend/ChatKit-使用说明.md) - ChatKit 使用指南
- [chatkit-js/README.md](./frontend/chatkit-js/README.md) - 官方 README
- [ChatKit 官方文档](https://openai.github.io/chatkit-js/) - 在线文档

### 示例代码
- `Kode-sdk/examples/test-glm.ts` - GLM 基础测试
- `Kode-sdk/examples/test-glm-advanced.ts` - GLM 高级功能
- `Kode-sdk/examples/01-agent-inbox.ts` - 事件驱动示例
- ChatKit Starter App - [GitHub](https://github.com/openai/openai-chatkit-starter-app)

## 🎨 使用场景

### 1. 简单对话应用
- 使用 ChatKit UI
- 后端调用 Kode-SDK GLM
- 适合快速原型

### 2. 企业级 Agent 系统
- ChatKit 提供专业界面
- Kode-SDK 处理复杂逻辑
- 工具调用可视化
- 审批流程集成

### 3. 多 Agent 协作
- ChatKit 展示多个对话
- Kode-SDK 管理 Agent Pool
- Room 协作功能

## 🔧 开发工具

### Kode-SDK
```bash
# 编译
npm run build

# 开发模式
npm run dev

# 测试
npm test

# 运行示例
npm run example:agent-inbox
```

### ChatKit-JS
```bash
# 安装依赖
pnpm install

# 构建
pnpm build

# 文档服务器
pnpm dev:docs

# 代码检查
pnpm lint

# 格式化
pnpm format
```

## 📈 下一步计划

### 短期 (1-2天)
- [ ] 创建 API 桥接层
- [ ] 实现基础消息转发
- [ ] 测试流式响应
- [ ] UI 基础集成

### 中期 (1周)
- [ ] 完整工具调用支持
- [ ] 文件上传处理
- [ ] 会话持久化
- [ ] 错误处理优化

### 长期 (1月)
- [ ] 多用户支持
- [ ] 权限管理
- [ ] 审批工作流
- [ ] 生产环境部署

## 🎯 核心价值

### 为什么选择这个组合？

1. **Kode-SDK**
   - ✅ 本地模型支持 (GLM-4.5-air)
   - ✅ 企业级功能 (审批、治理)
   - ✅ 长时运行支持
   - ✅ 多 Agent 协作

2. **ChatKit-JS**
   - ✅ 专业的 UI 组件
   - ✅ OpenAI 官方支持
   - ✅ 深度自定义
   - ✅ 开箱即用

3. **集成优势**
   - ✅ 最佳用户体验
   - ✅ 强大后端能力
   - ✅ 灵活扩展
   - ✅ 成熟技术栈

## 🆘 常见问题

### Q: 如何测试 Kode-SDK？
A: 运行 `cd Kode-sdk && ./run-glm-test.sh`

### Q: 如何启动 ChatKit 文档？
A: 运行 `cd frontend && ./setup-chatkit.sh` 然后 `pnpm dev:docs`

### Q: 两者如何集成？
A: 需要创建 API 桥接层，参考"集成方案"部分

### Q: 支持哪些模型？
A: Kode-SDK 当前配置了 GLM-4.5-air，可扩展其他模型

## 📞 资源链接

- [Kode-SDK GitHub](https://github.com/JOJOtheChemist/Kode-sdk)
- [ChatKit-JS GitHub](https://github.com/openai/chatkit-js)
- [ChatKit 文档](https://openai.github.io/chatkit-js/)
- [GLM API 文档](https://open.bigmodel.cn/dev/api)

---

**状态**: ✅ 两个项目已成功下载和配置  
**下一步**: 创建 API 桥接层进行集成

最后更新: 2025-10-13

